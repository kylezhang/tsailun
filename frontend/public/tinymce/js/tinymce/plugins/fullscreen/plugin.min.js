/**
 * Copyright (c) Tiny Technologies, Inc. All rights reserved.
 * Licensed under the LGPL or a commercial license.
 * For LGPL see License.txt in the project root for license information.
 * For commercial licenses see https://www.tiny.cloud/
 *
 * Version: 5.9.0 (TBD)
 */
!function(){"use strict";var c=function(n){var e=n;return{get:function(){return e},set:function(n){e=n}}},n=tinymce.util.Tools.resolve("tinymce.PluginManager"),i=function(n){return{isFullscreen:function(){return null!==n.get()}}},e=function(t){return function(n){return n=typeof(e=n),(null===e?"null":"object"==n&&(Array.prototype.isPrototypeOf(e)||e.constructor&&"Array"===e.constructor.name)?"array":"object"==n&&(String.prototype.isPrototypeOf(e)||e.constructor&&"String"===e.constructor.name)?"string":n)===t;var e}},t=function(e){return function(n){return typeof n===e}},r=e("string"),o=e("array"),u=t("boolean"),l=function(n){return!(null===(n=n)||n===undefined)},f=t("function"),a=t("number"),d=function(){},m=function(n){return function(){return n}},s=function(n){return n};var h=m(!1),g=m(!0),e=function(){return p},p={fold:function(n,e){return n()},isSome:h,isNone:g,getOr:s,getOrThunk:t=function(n){return n()},getOrDie:function(n){throw new Error(n||"error: getOrDie called on none.")},getOrNull:m(null),getOrUndefined:m(undefined),or:s,orThunk:t,map:e,each:d,bind:e,exists:h,forall:g,filter:function(){return p},toArray:function(){return[]},toString:m("none()")},v=function(t){var n=m(t),e=function(){return o},r=function(n){return n(t)},o={fold:function(n,e){return e(t)},isSome:g,isNone:h,getOr:n,getOrThunk:n,getOrDie:n,getOrNull:n,getOrUndefined:n,or:e,orThunk:e,map:function(n){return v(n(t))},each:function(n){n(t)},bind:r,exists:r,forall:r,filter:function(n){return n(t)?o:p},toArray:function(){return[t]},toString:function(){return"some("+t+")"}};return o},y={some:v,none:e,from:function(n){return null===n||n===undefined?p:v(n)}},w=function(){return n=function(n){return n.unbind()},e=c(y.none()),t=function(){return e.get().each(n)},{clear:function(){t(),e.set(y.none())},isSet:function(){return e.get().isSome()},set:function(n){t(),e.set(y.some(n))}};var n,e,t},b=Array.prototype.push,S=function(n,e){for(var t=n.length,r=new Array(t),o=0;o<t;o++){var u=n[o];r[o]=e(u,o)}return r},E=function(n,e){for(var t=0,r=n.length;t<r;t++)e(n[t],t)},F=function(n,e){for(var t=[],r=0,o=n.length;r<o;r++){var u=n[r];e(u,r)&&t.push(u)}return t},T=function(n,e){return function(n){for(var e=[],t=0,r=n.length;t<r;++t){if(!o(n[t]))throw new Error("Arr.flatten item "+t+" was not an array, input: "+n);b.apply(e,n[t])}return e}(S(n,e))},x=function(n){return e=n,(n=0)<=n&&n<e.length?y.some(e[n]):y.none();var e},D=Object.keys,k=function(n){return n.style!==undefined&&f(n.style.getPropertyValue)},C=function(n){if(null===n||n===undefined)throw new Error("Node cannot be null or undefined");return{dom:n}},O={fromHtml:function(n,e){e=(e||document).createElement("div");if(e.innerHTML=n,!e.hasChildNodes()||1<e.childNodes.length)throw console.error("HTML does not have a single root node",n),new Error("HTML must have a single root node");return C(e.childNodes[0])},fromTag:function(n,e){n=(e||document).createElement(n);return C(n)},fromText:function(n,e){n=(e||document).createTextNode(n);return C(n)},fromDom:C,fromPoint:function(n,e,t){return y.from(n.dom.elementFromPoint(e,t)).map(C)}},e=("undefined"!=typeof window||Function("return this;")(),function(e){return function(n){return n.dom.nodeType===e}}),A=e(1),M=e(3),N=e(9),P=e(11),L=function(n,e){n=n.dom;if(1!==n.nodeType)return!1;if(n.matches!==undefined)return n.matches(e);if(n.msMatchesSelector!==undefined)return n.msMatchesSelector(e);if(n.webkitMatchesSelector!==undefined)return n.webkitMatchesSelector(e);if(n.mozMatchesSelector!==undefined)return n.mozMatchesSelector(e);throw new Error("Browser lacks native selectors")},H=function(n){return O.fromDom(n.dom.ownerDocument)},q=function(e){return y.from(e.dom.parentNode).map(O.fromDom).map(R).map(function(n){return F(n,function(n){return e.dom!==n.dom})}).getOr([])},R=function(n){return S(n.dom.childNodes,O.fromDom)},e=f(Element.prototype.attachShadow)&&f(Node.prototype.getRootNode),V=m(e),W=e?function(n){return O.fromDom(n.dom.getRootNode())}:function(n){return N(n)?n:H(n)},B=function(n){var e=W(n);return P(n=e)&&l(n.dom.host)?y.some(e):y.none()},j=function(n){return O.fromDom(n.dom.host)},z=function(n){return l(n.dom.shadowRoot)},I=function(n){var e=M(n)?n.dom.parentNode:n.dom;if(e===undefined||null===e||null===e.ownerDocument)return!1;var t,r,o=e.ownerDocument;return B(O.fromDom(e)).fold(function(){return o.body.contains(e)},(t=I,r=j,function(n){return t(r(n))}))},U=function(n,e,t){!function(n,e,t){if(!(r(t)||u(t)||a(t)))throw console.error("Invalid call to Attribute.set. Key ",e,":: Value ",t,":: Element ",n),new Error("Attribute value was not simple");n.setAttribute(e,t+"")}(n.dom,e,t)},K=function(n,e){e=n.dom.getAttribute(e);return null===e?undefined:e},X=function(n,e){n.dom.removeAttribute(e)},Y=function(n,e){var t=n.dom;!function(n,e){for(var t=D(n),r=0,o=t.length;r<o;r++){var u=t[r];e(n[u],u)}}(e,function(n,e){!function(n,e,t){if(!r(t))throw console.error("Invalid call to CSS.set. Property ",e,":: Value ",t,":: Element ",n),new Error("CSS value must be a string: "+t);k(n)&&n.style.setProperty(e,t)}(t,e,n)})},_=function(n,e){return k(n)?n.style.getPropertyValue(e):""},G=function(n){var t,r,e=O.fromDom(function(n){if(V()&&l(n.target)){var e=O.fromDom(n.target);if(A(e)&&z(e)&&n.composed&&n.composedPath){e=n.composedPath();if(e)return x(e)}}return y.from(n.target)}(n).getOr(n.target)),o=function(){return n.stopPropagation()},u=function(){return n.preventDefault()},i=(t=u,r=o,function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return t(r.apply(null,n))});return{target:e,x:n.clientX,y:n.clientY,stop:o,prevent:u,kill:i,raw:n}},J=function(n,e,t,r,o){var u,i,r=(u=t,i=r,function(n){u(n)&&i(G(n))});return n.dom.addEventListener(e,r,o),{unbind:function(r){for(var o=[],n=1;n<arguments.length;n++)o[n-1]=arguments[n];return function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];var t=o.concat(n);return r.apply(null,t)}}(Q,n,e,r,o)}},Q=function(n,e,t,r){n.dom.removeEventListener(e,t,r)},Z=g,$=function(n,e,t){return J(n,e,Z,t,!1)},nn=function(t,r){return{left:t,top:r,translate:function(n,e){return nn(t+n,r+e)}}},en=nn,tn=function(n){n=n===undefined?window:n;return y.from(n.visualViewport)},rn=function(n,e,t,r){return{x:n,y:e,width:t,height:r,right:n+t,bottom:e+r}},on=function(n){var t=n===undefined?window:n,e=t.document,r=(n=O.fromDom(e),e=n!==undefined?n.dom:document,n=e.body.scrollLeft||e.documentElement.scrollLeft,e=e.body.scrollTop||e.documentElement.scrollTop,en(n,e));return tn(t).fold(function(){var n=t.document.documentElement,e=n.clientWidth,n=n.clientHeight;return rn(r.left,r.top,e,n)},function(n){return rn(Math.max(n.pageLeft,r.left),Math.max(n.pageTop,r.top),n.width,n.height)})},un=function(t,r,n){return tn(n).map(function(n){var e=function(n){return r(G(n))};return n.addEventListener(t,e),{unbind:function(){return n.removeEventListener(t,e)}}}).getOrThunk(function(){return{unbind:d}})},e=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),cn=tinymce.util.Tools.resolve("tinymce.Env"),ln=tinymce.util.Tools.resolve("tinymce.util.Delay"),fn=function(n,e){n.fire("FullscreenStateChanged",{state:e})},an=function(n){return n.getParam("fullscreen_native",!1,"boolean")},dn=function(n){var e=O.fromDom(n.getElement());return B(e).map(j).getOrThunk(function(){return function(n){n=n.dom.body;if(null===n||n===undefined)throw new Error("Body is not available yet");return O.fromDom(n)}(H(e))})},mn=function(n){return n.dom===((n=H(n).dom).fullscreenElement!==undefined?n.fullscreenElement:n.msFullscreenElement!==undefined?n.msFullscreenElement:n.webkitFullscreenElement!==undefined?n.webkitFullscreenElement:null)},sn=function(n,e,t){return F(function(n,e){for(var t=f(e)?e:h,r=n.dom,o=[];null!==r.parentNode&&r.parentNode!==undefined;){var u=r.parentNode,i=O.fromDom(u);if(o.push(i),!0===t(i))break;r=u}return o}(n,t),e)},hn=function(n){return e=n,n=t===undefined?document:t.dom,1!==(t=n).nodeType&&9!==t.nodeType&&11!==t.nodeType||0===t.childElementCount?[]:S(n.querySelectorAll(e),O.fromDom);var e,t},gn=function(n,e){return t=function(n){return L(n,e)},F(q(n),t);var t},pn="data-ephox-mobile-fullscreen-style",vn="position:absolute!important;",yn="top:0!important;left:0!important;margin:0!important;padding:0!important;width:100%!important;height:100%!important;overflow:visible!important;",wn=cn.os.isAndroid(),bn=function(n){var e,t,r,t=(t="background-color",r=(e=n).dom,""!==(n=window.getComputedStyle(r).getPropertyValue(t))||I(e)?n:_(r,t));return t!==undefined&&""!==t?"background-color:"+t+"!important":"background-color:rgb(255,255,255)!important;"},Sn=function(r,n,e){var t,o=function(t){return function(n){var e=K(n,"style"),e=e===undefined?"no-styles":e.trim();e===t||(U(n,pn,e),Y(n,r.parseStyle(t)))}},u=(t="*",sn(n,function(n){return L(n,t)},i)),i=T(u,function(n){return gn(n,"*:not(.tox-silver-sink)")}),e=bn(e);E(i,o("display:none!important;")),E(u,o(vn+yn+e)),o((!0===wn?"":vn)+yn+e)(n)},En=e.DOM,Fn=tn().fold(function(){return{bind:d,unbind:d}},function(e){var t,r=(t=c(y.none()),{clear:function(){return t.set(y.none())},set:function(n){return t.set(y.some(n))},isSet:function(){return t.get().isSome()},on:function(n){return t.get().each(n)}}),o=w(),u=w(),i=ln.throttle(function(){document.body.scrollTop=0,document.documentElement.scrollTop=0,window.requestAnimationFrame(function(){r.on(function(n){return Y(n,{top:e.offsetTop+"px",left:e.offsetLeft+"px",height:e.height+"px",width:e.width+"px"})})})},50);return{bind:function(n){r.set(n),i(),o.set(un("resize",i)),u.set(un("scroll",i))},unbind:function(){r.on(function(){o.clear(),u.clear()}),r.clear()}}}),Tn=function(e,r){var n,t=document.body,o=document.documentElement,u=e.getContainer(),i=O.fromDom(u),c=dn(e),l=r.get(),f=O.fromDom(e.getBody()),a=cn.deviceType.isTouch(),d=u.style,m=e.iframeElement.style,s=function(e){e(t,"tox-fullscreen"),e(o,"tox-fullscreen"),e(u,"tox-fullscreen"),B(i).map(function(n){return j(n).dom}).each(function(n){e(n,"tox-fullscreen"),e(n,"tox-shadowhost")})},h=function(){var t,n;a&&(t=e.dom,n=hn("["+pn+"]"),E(n,function(n){var e=K(n,pn);"no-styles"!==e?Y(n,t.parseStyle(e)):X(n,"style"),X(n,pn)})),s(En.removeClass),Fn.unbind(),y.from(r.get()).each(function(n){return n.fullscreenChangeHandler.unbind()})};l?(l.fullscreenChangeHandler.unbind(),an(e)&&mn(c)&&function(n){n=n.dom;n.exitFullscreen?n.exitFullscreen():n.msExitFullscreen?n.msExitFullscreen():n.webkitCancelFullScreen&&n.webkitCancelFullScreen()}(H(c)),m.width=l.iframeWidth,m.height=l.iframeHeight,d.width=l.containerWidth,d.height=l.containerHeight,d.top=l.containerTop,d.left=l.containerLeft,n=l.scrollPos,window.scrollTo(n.x,n.y),r.set(null),fn(e,!1),h(),e.off("remove",h)):(l=$(H(c),document.fullscreenElement!==undefined?"fullscreenchange":document.msFullscreenElement!==undefined?"MSFullscreenChange":document.webkitFullscreenElement!==undefined?"webkitfullscreenchange":"fullscreenchange",function(n){an(e)&&(mn(c)||null===r.get()||Tn(e,r))}),l={scrollPos:{x:(n=on(window)).x,y:n.y},containerWidth:d.width,containerHeight:d.height,containerTop:d.top,containerLeft:d.left,iframeWidth:m.width,iframeHeight:m.height,fullscreenChangeHandler:l},a&&Sn(e.dom,i,f),m.width=m.height="100%",d.width=d.height="",s(En.addClass),Fn.bind(i),e.on("remove",h),r.set(l),an(e)&&function(n){n=n.dom;n.requestFullscreen?n.requestFullscreen():n.msRequestFullscreen?n.msRequestFullscreen():n.webkitRequestFullScreen&&n.webkitRequestFullScreen()}(c),fn(e,!0))},xn=function(t,r){return function(e){e.setActive(null!==r.get());var n=function(n){return e.setActive(n.state)};return t.on("FullscreenStateChanged",n),function(){return t.off("FullscreenStateChanged",n)}}};n.add("fullscreen",function(n){var e,t,r,o,u=c(null);return n.inline||(t=u,(e=n).addCommand("mceFullScreen",function(){Tn(e,t)}),o=u,(r=n).ui.registry.addToggleMenuItem("fullscreen",{text:"Fullscreen",icon:"fullscreen",shortcut:"Meta+Shift+F",onAction:function(){return r.execCommand("mceFullScreen")},onSetup:xn(r,o)}),r.ui.registry.addToggleButton("fullscreen",{tooltip:"Fullscreen",icon:"fullscreen",onAction:function(){return r.execCommand("mceFullScreen")},onSetup:xn(r,o)}),n.addShortcut("Meta+Shift+F","","mceFullScreen")),i(u)})}();