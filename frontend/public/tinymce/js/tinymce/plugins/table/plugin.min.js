/**
 * Copyright (c) Tiny Technologies, Inc. All rights reserved.
 * Licensed under the LGPL or a commercial license.
 * For LGPL see License.txt in the project root for license information.
 * For commercial licenses see https://www.tiny.cloud/
 *
 * Version: 5.9.0 (TBD)
 */
!function(){"use strict";var e,n=function(t){return function(n){return n=typeof(e=n),(null===e?"null":"object"==n&&(Array.prototype.isPrototypeOf(e)||e.constructor&&"Array"===e.constructor.name)?"array":"object"==n&&(String.prototype.isPrototypeOf(e)||e.constructor&&"String"===e.constructor.name)?"string":n)===t;var e}},t=function(e){return function(n){return typeof n===e}},g=n("string"),p=n("object"),l=n("array"),r=t("boolean"),u=(e=undefined,function(n){return e===n}),c=function(n){return!(null===(n=n)||n===undefined)},a=t("function"),i=t("number"),y=function(){},h=function(n){return function(){return n}},f=function(n){return n},s=function(n,e){return n===e};function w(r){for(var o=[],n=1;n<arguments.length;n++)o[n-1]=arguments[n];return function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];var t=o.concat(n);return r.apply(null,t)}}var b=function(e){return function(n){return!e(n)}},m=h(!1),C=h(!0),o=function(){return d},d={fold:function(n,e){return n()},isSome:m,isNone:C,getOr:f,getOrThunk:tl=function(n){return n()},getOrDie:function(n){throw new Error(n||"error: getOrDie called on none.")},getOrNull:h(null),getOrUndefined:h(undefined),or:f,orThunk:tl,map:o,each:y,bind:o,exists:m,forall:C,filter:function(){return d},toArray:function(){return[]},toString:h("none()")},v=function(t){var n=h(t),e=function(){return o},r=function(n){return n(t)},o={fold:function(n,e){return e(t)},isSome:C,isNone:m,getOr:n,getOrThunk:n,getOrDie:n,getOrNull:n,getOrUndefined:n,or:e,orThunk:e,map:function(n){return v(n(t))},each:function(n){n(t)},bind:r,exists:r,forall:r,filter:function(n){return n(t)?o:d},toArray:function(){return[t]},toString:function(){return"some("+t+")"}};return o},S={some:v,none:o,from:function(n){return null===n||n===undefined?d:v(n)}},x=Array.prototype.slice,T=Array.prototype.indexOf,R=Array.prototype.push,D=function(n,e){return-1<T.call(n,e)},O=function(n,e){for(var t=0,r=n.length;t<r;t++)if(e(n[t],t))return!0;return!1},A=function(n,e){for(var t=[],r=0;r<n;r++)t.push(e(r));return t},k=function(n,e){for(var t=n.length,r=new Array(t),o=0;o<t;o++){var u=n[o];r[o]=e(u,o)}return r},I=function(n,e){for(var t=0,r=n.length;t<r;t++)e(n[t],t)},B=function(n,e){for(var t=[],r=0,o=n.length;r<o;r++){var u=n[r];e(u,r)&&t.push(u)}return t},M=function(n,e,t){return function(n,e){for(var t=n.length-1;0<=t;t--)e(n[t],t)}(n,function(n){t=e(t,n)}),t},P=function(n,e,t){return I(n,function(n){t=e(t,n)}),t},E=function(n,e){return function(n,e,t){for(var r=0,o=n.length;r<o;r++){var u=n[r];if(e(u,r))return S.some(u);if(t(u,r))break}return S.none()}(n,e,m)},N=function(n,e){for(var t=0,r=n.length;t<r;t++)if(e(n[t],t))return S.some(t);return S.none()},_=function(n){for(var e=[],t=0,r=n.length;t<r;++t){if(!l(n[t]))throw new Error("Arr.flatten item "+t+" was not an array, input: "+n);R.apply(e,n[t])}return e},W=function(n,e){return _(k(n,e))},L=function(n,e){for(var t=0,r=n.length;t<r;++t)if(!0!==e(n[t],t))return!1;return!0},j=function(n,e){for(var t={},r=0,o=n.length;r<o;r++){var u=n[r];t[String(u)]=e(u,r)}return t},z=function(n){return[n]},F=function(n,e){return 0<=e&&e<n.length?S.some(n[e]):S.none()},H=function(n){return F(n,0)},V=function(n){return F(n,n.length-1)},U=function(n,e){for(var t=0;t<n.length;t++){var r=e(n[t],t);if(r.isSome())return r}return S.none()},q=function(){return(q=Object.assign||function q(n){for(var e,t=1,r=arguments.length;t<r;t++)for(var o in e=arguments[t])Object.prototype.hasOwnProperty.call(e,o)&&(n[o]=e[o]);return n}).apply(this,arguments)};function $(n,e,t){if(t||2===arguments.length)for(var r,o=0,u=e.length;o<u;o++)!r&&o in e||((r=r||Array.prototype.slice.call(e,0,o))[o]=e[o]);return n.concat(r||e)}var K,G=function(t){var r,o=!1;return function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return o||(o=!0,r=t.apply(null,n)),r}},X=function(n,e){var t=function(n,e){for(var t=0;t<n.length;t++){var r=n[t];if(r.test(e))return r}return undefined}(n,e);if(!t)return{major:0,minor:0};n=function(n){return Number(e.replace(t,"$"+n))};return J(n(1),n(2))},Y=function(){return J(0,0)},J=function(n,e){return{major:n,minor:e}},Q={nu:J,detect:function(n,e){e=String(e).toLowerCase();return 0===n.length?Y():X(n,e)},unknown:Y},Z=function(n,e){var t=String(e).toLowerCase();return E(n,function(n){return n.search(t)})},nn=function(n,t){return Z(n,t).map(function(n){var e=Q.detect(n.versionRegexes,t);return{current:n.name,version:e}})},en=function(n,t){return Z(n,t).map(function(n){var e=Q.detect(n.versionRegexes,t);return{current:n.name,version:e}})},tn=function(n,e,t){return""===e||n.length>=e.length&&n.substr(t,t+e.length)===e},rn=function(n,e){return-1!==n.indexOf(e)},on=function(n,e){return tn(n,e,0)},un=function(n,e){return tn(n,e,n.length-e.length)},cn=(K=/^\s+|\s+$/g,function(n){return n.replace(K,"")}),ln=function(n){return 0<n.length},an=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,fn=function(e){return function(n){return rn(n,e)}},sn=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(n){return rn(n,"edge/")&&rn(n,"chrome")&&rn(n,"safari")&&rn(n,"applewebkit")}},{name:"Chrome",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,an],search:function(n){return rn(n,"chrome")&&!rn(n,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(n){return rn(n,"msie")||rn(n,"trident")}},{name:"Opera",versionRegexes:[an,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:fn("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:fn("firefox")},{name:"Safari",versionRegexes:[an,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(n){return(rn(n,"safari")||rn(n,"mobile/"))&&rn(n,"applewebkit")}}],dn=[{name:"Windows",search:fn("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(n){return rn(n,"iphone")||rn(n,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:fn("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:fn("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:fn("linux"),versionRegexes:[]},{name:"Solaris",search:fn("sunos"),versionRegexes:[]},{name:"FreeBSD",search:fn("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:fn("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}],mn={browsers:h(sn),oses:h(dn)},gn="Firefox",pn=function(n){var e=n.current,t=n.version,n=function(n){return function(){return e===n}};return{current:e,version:t,isEdge:n("Edge"),isChrome:n("Chrome"),isIE:n("IE"),isOpera:n("Opera"),isFirefox:n(gn),isSafari:n("Safari")}},hn={unknown:function(){return pn({current:undefined,version:Q.unknown()})},nu:pn,edge:h("Edge"),chrome:h("Chrome"),ie:h("IE"),opera:h("Opera"),firefox:h(gn),safari:h("Safari")},bn="Windows",vn="Android",wn="Solaris",yn="FreeBSD",Cn="ChromeOS",Sn=function(n){var e=n.current,t=n.version,n=function(n){return function(){return e===n}};return{current:e,version:t,isWindows:n(bn),isiOS:n("iOS"),isAndroid:n(vn),isOSX:n("OSX"),isLinux:n("Linux"),isSolaris:n(wn),isFreeBSD:n(yn),isChromeOS:n(Cn)}},xn={unknown:function(){return Sn({current:undefined,version:Q.unknown()})},nu:Sn,windows:h(bn),ios:h("iOS"),android:h(vn),linux:h("Linux"),osx:h("OSX"),solaris:h(wn),freebsd:h(yn),chromeos:h(Cn)},Tn=function(n,e){var t,r,o=mn.browsers(),u=mn.oses(),i=nn(o,n).fold(hn.unknown,hn.nu),c=en(u,n).fold(xn.unknown,xn.nu);return{browser:i,os:c,deviceType:(t=i,r=n,o=e,i=(u=c).isiOS()&&!0===/ipad/i.test(r),n=u.isiOS()&&!i,e=u.isiOS()||u.isAndroid(),c=e||o("(pointer:coarse)"),o=i||!n&&e&&o("(min-device-width:768px)"),e=n||e&&!o,r=t.isSafari()&&u.isiOS()&&!1===/safari/i.test(r),{isiPad:h(i),isiPhone:h(n),isTablet:h(o),isPhone:h(e),isTouch:h(c),isAndroid:u.isAndroid,isiOS:u.isiOS,isWebView:h(r),isDesktop:h(!e&&!o&&!r)})}},Rn=function(n){return window.matchMedia(n).matches},Dn=G(function(){return Tn(navigator.userAgent,Rn)}),On=function(n){if(null===n||n===undefined)throw new Error("Node cannot be null or undefined");return{dom:n}},An={fromHtml:function(n,e){e=(e||document).createElement("div");if(e.innerHTML=n,!e.hasChildNodes()||1<e.childNodes.length)throw console.error("HTML does not have a single root node",n),new Error("HTML must have a single root node");return On(e.childNodes[0])},fromTag:function(n,e){n=(e||document).createElement(n);return On(n)},fromText:function(n,e){n=(e||document).createTextNode(n);return On(n)},fromDom:On,fromPoint:function(n,e,t){return S.from(n.dom.elementFromPoint(e,t)).map(On)}},kn=function(n,e){n=n.dom;if(1!==n.nodeType)return!1;if(n.matches!==undefined)return n.matches(e);if(n.msMatchesSelector!==undefined)return n.msMatchesSelector(e);if(n.webkitMatchesSelector!==undefined)return n.webkitMatchesSelector(e);if(n.mozMatchesSelector!==undefined)return n.mozMatchesSelector(e);throw new Error("Browser lacks native selectors")},In=function(n){return 1!==n.nodeType&&9!==n.nodeType&&11!==n.nodeType||0===n.childElementCount},Bn=function(n,e){e=e===undefined?document:e.dom;return In(e)?S.none():S.from(e.querySelector(n)).map(An.fromDom)},Mn=function(n,e){return n.dom===e.dom},Pn=function(n,e){return t=n.dom,n=e.dom,e=Node.DOCUMENT_POSITION_CONTAINED_BY,0!=(t.compareDocumentPosition(n)&e);var t},En=function(n,e){return(Dn().browser.isIE()?Pn:function(n,e){n=n.dom,e=e.dom;return n!==e&&n.contains(e)})(n,e)},Nn=kn,_n=Object.keys,Wn=Object.hasOwnProperty,Ln=function(n,e){for(var t=_n(n),r=0,o=t.length;r<o;r++){var u=t[r];e(n[u],u)}},jn=function(n,t){return zn(n,function(n,e){return{k:e,v:t(n,e)}})},zn=function(n,t){var r={};return Ln(n,function(n,e){e=t(n,e);r[e.k]=e.v}),r},Fn=function(n,e){var t,r,o,u,i={};return t=e,u=i,r=function(n,e){u[e]=n},o=y,Ln(n,function(n,e){(t(n,e)?r:o)(n,e)}),i},Hn=function(n,t){var r=[];return Ln(n,function(n,e){r.push(t(n,e))}),r},Vn=function(n){return _n(n).length},Un=function(n,e){return qn(n,e)?S.from(n[e]):S.none()},qn=function(n,e){return Wn.call(n,e)},$n=function(n,e){return qn(n,e)&&n[e]!==undefined&&null!==n[e]},Kn=["tfoot","thead","tbody","colgroup"],Gn=function(n,e,t){return{element:n,rowspan:e,colspan:t}},Xn=function(n,e,t){return{element:n,cells:e,section:t}},Yn=function(n,e,t){return{element:n,isNew:e,isLocked:t}},Jn=function(n,e){return{cells:n,section:e}},Qn=("undefined"!=typeof window||Function("return this;")(),function(n){return n.dom.nodeName.toLowerCase()}),Zn=function(n){return n.dom.nodeType},ne=function(e){return function(n){return Zn(n)===e}},ee=function(n){return 8===Zn(n)||"#comment"===Qn(n)},te=ne(1),re=ne(3),oe=ne(9),ue=ne(11),ie=function(e){return function(n){return te(n)&&Qn(n)===e}},ce=function(n){return An.fromDom(n.dom.ownerDocument)},le=function(n){return oe(n)?n:ce(n)},ae=function(n){return S.from(n.dom.parentNode).map(An.fromDom)},fe=function(n,e){for(var t=a(e)?e:m,r=n.dom,o=[];null!==r.parentNode&&r.parentNode!==undefined;){var u=r.parentNode,i=An.fromDom(u);if(o.push(i),!0===t(i))break;r=u}return o},se=function(n){return S.from(n.dom.previousSibling).map(An.fromDom)},de=function(n){return S.from(n.dom.nextSibling).map(An.fromDom)},me=function(n){return k(n.dom.childNodes,An.fromDom)},ge=function(n,e){n=n.dom.childNodes;return S.from(n[e]).map(An.fromDom)},pe=a(Element.prototype.attachShadow)&&a(Node.prototype.getRootNode),he=h(pe),be=pe?function(n){return An.fromDom(n.dom.getRootNode())}:le,ve=function(n){var e=be(n);return ue(n=e)&&c(n.dom.host)?S.some(e):S.none()},we=function(n){return An.fromDom(n.dom.host)},ye=function(n){return c(n.dom.shadowRoot)},Ce=function(n){var e=re(n)?n.dom.parentNode:n.dom;if(e===undefined||null===e||null===e.ownerDocument)return!1;var t,r,o=e.ownerDocument;return ve(An.fromDom(e)).fold(function(){return o.body.contains(e)},(t=Ce,r=we,function(n){return t(r(n))}))},Se=function(n){n=n.dom.body;if(null===n||n===undefined)throw new Error("Body is not available yet");return An.fromDom(n)},xe=function(n,e){var t=[];return I(me(n),function(n){t=(t=e(n)?t.concat([n]):t).concat(xe(n,e))}),t},Te=function(n,e,t){return r=function(n){return kn(n,e)},B(fe(n,t),r);var r},Re=function(n,e){return t=function(n){return kn(n,e)},B(me(n),t);var t},De=function(n,e){return function(n,e){e=e===undefined?document:e.dom;return In(e)?[]:k(e.querySelectorAll(n),An.fromDom)}(e,n)};function Oe(n,e,t,r,o){return n(t,r)?S.some(t):a(o)&&o(t)?S.none():e(t,r,o)}var Ae,ke,Ie,Be=function(n,e,t){for(var r=n.dom,o=a(t)?t:m;r.parentNode;){var r=r.parentNode,u=An.fromDom(r);if(e(u))return S.some(u);if(o(u))break}return S.none()},Me=function(n,e,t){return Be(n,function(n){return kn(n,e)},t)},Pe=function(n,e){return t=function(n){return kn(n,e)},E(n.dom.childNodes,function(n){return t(An.fromDom(n))}).map(An.fromDom);var t},Ee=function(n,e){return Bn(e,n)},Ne=function(n,e,t){return Oe(kn,Me,n,e,t)},_e=function(n,e,t){if(!(g(t)||r(t)||i(t)))throw console.error("Invalid call to Attribute.set. Key ",e,":: Value ",t,":: Element ",n),new Error("Attribute value was not simple");n.setAttribute(e,t+"")},We=function(n,e,t){_e(n.dom,e,t)},Le=function(n,e){var t=n.dom;Ln(e,function(n,e){_e(t,e,n)})},je=function(n,e){e=n.dom.getAttribute(e);return null===e?undefined:e},ze=function(n,e){return S.from(je(n,e))},Fe=function(n,e){n.dom.removeAttribute(e)},He=function(n){return P(n.dom.attributes,function(n,e){return n[e.name]=e.value,n},{})},Ve=function(n){for(var e=[],t=function(n){e.push(n)},r=0;r<n.length;r++)n[r].each(t);return e},Ue=function(n,e){return n?S.some(e):S.none()},qe=function(n){return n.style!==undefined&&a(n.style.getPropertyValue)},$e=function(n,e,t){if(!g(t))throw console.error("Invalid call to CSS.set. Property ",e,":: Value ",t,":: Element ",n),new Error("CSS value must be a string: "+t);qe(n)&&n.style.setProperty(e,t)},Ke=function(n,e,t){n=n.dom;$e(n,e,t)},Ge=function(n,e){var t=n.dom;Ln(e,function(n,e){$e(t,e,n)})},Xe=function(n,e){var t=n.dom,r=window.getComputedStyle(t).getPropertyValue(e);return""!==r||Ce(n)?r:Ye(t,e)},Ye=function(n,e){return qe(n)?n.style.getPropertyValue(e):""},Je=function(n,e){n=n.dom,e=Ye(n,e);return S.from(e).filter(function(n){return 0<n.length})},Qe=function(n,e){var t,r,o=n.dom;e=e,qe(o=o)&&o.style.removeProperty(e),e=ze(n,"style").map(cn),t="",void 0===r&&(r=s),e.exists(function(n){return r(n,t)})&&Fe(n,"style")},Ze=function(n,e,t){return void 0===t&&(t=0),ze(n,e).map(function(n){return parseInt(n,10)}).getOr(t)},nt=function(n,e){return Ze(n,e,1)},et=function(n){return 1<nt(n,"colspan")},tt=function(n){return 1<nt(n,"rowspan")},rt=function(n,e){return parseInt(Xe(n,e),10)},ot=h(10),ut=h(10),it=function(n,e){return ct(n,e,C)},ct=function(n,e,t){return W(me(n),function(n){return kn(n,e)?t(n)?[n]:[]:ct(n,e,t)})},lt=function(n,e){return function(n,e,t){if((t=void 0===t?m:t)(e))return S.none();if(D(n,Qn(e)))return S.some(e);return Me(e,n.join(","),function(n){return kn(n,"table")||t(n)})}(["td","th"],n,e)},at=function(n){return it(n,"th,td")},ft=function(n){return kn(n,"colgroup")?Re(n,"col"):W(mt(n),function(n){return Re(n,"col")})},st=function(n,e){return Ne(n,"table",e)},dt=function(n){return it(n,"tr")},mt=function(n){return st(n).fold(h([]),function(n){return Re(n,"colgroup")})},gt=function(n,t){return k(n,function(n){if("colgroup"===Qn(n)){var e=k(ft(n),function(n){var e=Ze(n,"span",1);return Gn(n,1,e)});return Xn(n,e,"colgroup")}e=k(at(n),function(n){var e=Ze(n,"rowspan",1),t=Ze(n,"colspan",1);return Gn(n,e,t)});return Xn(n,e,t(n))})},pt=function(n){return ae(n).map(function(n){n=Qn(n);return D(Kn,n)?n:"tbody"}).getOr("tbody")},ht=function(n){var e=dt(n),e=$($([],mt(n)),e);return gt(e,pt)},bt=function(n,e,t){var r=n.cells,o=r.slice(0,e),e=r.slice(e),e=o.concat(t).concat(e);return yt(n,e)},vt=function(n,e,t){return bt(n,e,[t])},wt=function(n,e,t){n.cells[e]=t},yt=function(n,e){return Jn(e,n.section)},Ct=function(n,e){var t=n.cells,e=k(t,e);return Jn(e,n.section)},St=function(n,e){return n.cells[e]},xt=function(n,e){return St(n,e).element},Tt=function(n){return n.cells.length},Rt=function(n){n=function(n,e){for(var t=[],r=[],o=0,u=n.length;o<u;o++){var i=n[o];(e(i,o)?t:r).push(i)}return{pass:t,fail:r}}(n,function(n){return"colgroup"===n.section});return{rows:n.fail,cols:n.pass}},Dt="data-snooker-locked-cols",Ot=function(n){return ze(n,Dt).bind(function(n){return S.from(n.match(/\d+/g))}).map(function(n){return j(n,C)})},At=function(n){n=P(Rt(n).rows,function(t,n){return I(n.cells,function(n,e){n.isLocked&&(t[e]=!0)}),t},{});return function(n,e){n=x.call(n,0);return n.sort(e),n}(Hn(n,function(n,e){return parseInt(e,10)}))},kt=function(n,e){n=W(n.all,function(n){return n.cells});return B(n,e)},It=function(n){var l={},e=[],t={},a=H(n).map(function(n){return n.element}).bind(st).bind(Ot).getOr({}),u=0,f=0,s=0;return I(n,function(n){var c,r,o;"colgroup"===n.section?(r={},o=0,I(n.cells,function(e){var t=e.colspan;A(t,function(n){n=o+n;r[n]={element:e.element,colspan:t,column:n}}),o+=t}),t=r):(c=[],I(n.cells,function(n){for(var e=0;l[s+","+e]!==undefined;)e++;for(var t=$n(a,e.toString()),r={element:n.element,rowspan:n.rowspan,colspan:n.colspan,row:s,column:e,isLocked:t},o=0;o<n.colspan;o++)for(var u=0;u<n.rowspan;u++){var i=e+o;l[s+u+","+i]=r,f=Math.max(f,i+1)}c.push(r)}),u++,e.push(Xn(n.element,c,n.section)),s++)}),{grid:{rows:u,columns:f},access:l,all:e,columns:t}},Bt={fromTable:function(n){n=ht(n);return It(n)},generate:It,getAt:function(n,e,t){t=n.access[e+","+t];return t!==undefined?S.some(t):S.none()},findItem:function(n,e,t){n=kt(n,function(n){return t(e,n.element)});return 0<n.length?S.some(n[0]):S.none()},filterItems:kt,justCells:function(n){return W(n.all,function(n){return n.cells})},justColumns:function(n){return n=n.columns,Hn(n,f)},hasColumns:function(n){return 0<_n(n.columns).length},getColumnAt:function(n,e){return S.from(n.columns[e])}},Mt=function(n,e){var t=e.column,r=e.column+e.colspan-1,o=e.row,e=e.row+e.rowspan-1;return t<=n.finishCol&&r>=n.startCol&&o<=n.finishRow&&e>=n.startRow},Pt=function(n,e){return e.column>=n.startCol&&e.column+e.colspan-1<=n.finishCol&&e.row>=n.startRow&&e.row+e.rowspan-1<=n.finishRow},Et=function(n,e,t){var e=Bt.findItem(n,e,Mn),r=Bt.findItem(n,t,Mn);return e.bind(function(t){return r.map(function(n){return e=t,n=n,{startRow:Math.min(e.row,n.row),startCol:Math.min(e.column,n.column),finishRow:Math.max(e.row+e.rowspan-1,n.row+n.rowspan-1),finishCol:Math.max(e.column+e.colspan-1,n.column+n.colspan-1)};var e})})},Nt=function(e,n,t){return Et(e,n,t).bind(function(n){return function(n,e){for(var t=!0,r=w(Pt,e),o=e.startRow;o<=e.finishRow;o++)for(var u=e.startCol;u<=e.finishCol;u++)t=t&&Bt.getAt(n,o,u).exists(r);return t?S.some(e):S.none()}(e,n)})},_t=function(e,n,t){return Et(e,n,t).map(function(n){n=Bt.filterItems(e,w(Mt,n));return k(n,function(n){return n.element})})},Wt=function(n,e){return Bt.findItem(n,e,function(n,e){return En(e,n)}).map(function(n){return n.element})},Lt=function(e,u,i){return st(e).bind(function(n){var t,r,o,n=zt(n);return t=n,r=u,o=i,Bt.findItem(t,e,Mn).bind(function(n){var e=0<r?n.row+n.rowspan-1:n.row,n=0<o?n.column+n.colspan-1:n.column;return Bt.getAt(t,e+r,n+o).map(function(n){return n.element})})})},jt=function(n,e,t,r,o){var u=zt(n),e=Mn(n,t)?S.some(e):Wt(u,e),i=Mn(n,o)?S.some(r):Wt(u,r);return e.bind(function(e){return i.bind(function(n){return _t(u,e,n)})})},zt=Bt.fromTable,Ft=function(e,t){ae(e).each(function(n){n.dom.insertBefore(t.dom,e.dom)})},Ht=function(n,e){de(n).fold(function(){ae(n).each(function(n){Ut(n,e)})},function(n){Ft(n,e)})},Vt=function(e,t){ge(e,0).fold(function(){Ut(e,t)},function(n){e.dom.insertBefore(t.dom,n.dom)})},Ut=function(n,e){n.dom.appendChild(e.dom)},qt=function(n,e){Ft(n,e),Ut(e,n)},$t=function(t,r){I(r,function(n,e){e=0===e?t:r[e-1];Ht(e,n)})},Kt=function(e,n){I(n,function(n){Ut(e,n)})},Gt=function(n){n.dom.textContent="",I(me(n),function(n){Xt(n)})},Xt=function(n){n=n.dom;null!==n.parentNode&&n.parentNode.removeChild(n)},Yt=function(n){var e,t=me(n);0<t.length&&(e=n,I(t,function(n){Ft(e,n)})),Xt(n)},Jt=(Ae=re,ke="text",{get:function(n){if(!Ae(n))throw new Error("Can only get "+ke+" value of a "+ke+" node");return Ie(n).getOr("")},getOption:Ie=function(n){return Ae(n)?S.from(n.dom.nodeValue):S.none()},set:function(n,e){if(!Ae(n))throw new Error("Can only set raw "+ke+" value of a "+ke+" node");n.dom.nodeValue=e}}),Qt=function(n){return Jt.get(n)},Zt=function(n){return Jt.getOption(n)},nr=function(n,e){return Jt.set(n,e)},er=["body","p","div","article","aside","figcaption","figure","footer","header","nav","section","ol","ul","li","table","thead","tbody","tfoot","caption","tr","td","th","h1","h2","h3","h4","h5","h6","blockquote","pre","address"];function tr(){return{up:h({selector:Me,closest:Ne,predicate:Be,all:fe}),down:h({selector:De,predicate:xe}),styles:h({get:Xe,getRaw:Je,set:Ke,remove:Qe}),attrs:h({get:je,set:We,remove:Fe,copyTo:function(n,e){n=He(n);Le(e,n)}}),insert:h({before:Ft,after:Ht,afterAll:$t,append:Ut,appendAll:Kt,prepend:Vt,wrap:qt}),remove:h({unwrap:Yt,remove:Xt}),create:h({nu:An.fromTag,clone:function(n){return An.fromDom(n.dom.cloneNode(!1))},text:An.fromText}),query:h({comparePosition:function(n,e){return n.dom.compareDocumentPosition(e.dom)},prevSibling:se,nextSibling:de}),property:h({children:me,name:Qn,parent:ae,document:function(n){return le(n).dom},isText:re,isComment:ee,isElement:te,isSpecial:function(n){n=Qn(n);return D(["script","noscript","iframe","noframes","noembed","title","style","textarea","xmp"],n)},getText:Qt,setText:nr,isBoundary:function(n){return!!te(n)&&("body"===Qn(n)||D(er,Qn(n)))},isEmptyTag:function(n){return!!te(n)&&D(["br","img","hr","input"],Qn(n))},isNonEditable:function(n){return te(n)&&"false"===je(n,"contenteditable")}}),eq:Mn,is:Nn}}var rr=function(t,r,n,e){n=r(t,n);return M(e,function(n,e){e=r(t,e);return or(t,n,e)},n)},or=function(e,n,t){return n.bind(function(n){return t.filter(w(e.eq,n))})},ur=function(n,e,t){return 0<t.length?rr(n,e,t[0],t.slice(1)):S.none()},ir=function(e,n,t,r){void 0===r&&(r=m);var o=[n].concat(e.up().all(n)),n=[t].concat(e.up().all(t)),t=function(e){return N(e,r).fold(function(){return e},function(n){return e.slice(0,n+1)})},o=t(o),u=t(n),n=E(o,function(n){return O(u,w(e.eq,n))});return{firstpath:o,secondpath:u,shared:n}},cr=tr(),lr=function(t,n){return ur(cr,function(n,e){return t(e)},n)},ar=function(n){return Me(n,"table")},fr=function(u,i,c){var l=function(e){return function(n){return c!==undefined&&c(n)||Mn(n,e)}};return Mn(u,i)?S.some({boxes:S.some([u]),start:u,finish:i}):ar(u).bind(function(o){return ar(i).bind(function(r){if(Mn(o,r))return S.some({boxes:function(n,e,t){n=zt(n);return _t(n,e,t)}(o,u,i),start:u,finish:i});if(En(o,r)){var n=0<(e=Te(i,"td,th",l(o))).length?e[e.length-1]:i;return S.some({boxes:jt(o,u,o,i,r),start:u,finish:n})}if(En(r,o)){var e=0<(e=Te(u,"td,th",l(r))).length?e[e.length-1]:u;return S.some({boxes:jt(r,u,o,i,r),start:u,finish:e})}return ir(cr,u,i,t).shared.bind(function(n){return Ne(n,"table",c).bind(function(n){var e=Te(i,"td,th",l(n)),t=0<e.length?e[e.length-1]:i,e=Te(u,"td,th",l(n)),e=0<e.length?e[e.length-1]:u;return S.some({boxes:jt(n,u,o,i,r),start:e,finish:t})})});var t})})},sr=function(n,e){e=De(n,e);return 0<e.length?S.some(e):S.none()},dr=function(n,e,r){return Ee(n,e).bind(function(t){return Ee(n,r).bind(function(e){return lr(ar,[t,e]).map(function(n){return{first:t,last:e,table:n}})})})},mr=function(n,e,t,r,o){return u=o,E(n,function(n){return kn(n,u)}).bind(function(n){return Lt(n,e,t).bind(function(n){return t=r,Me(e=n,"table").bind(function(n){return Ee(n,t).bind(function(n){return fr(n,e).bind(function(e){return e.boxes.map(function(n){return{boxes:n,start:e.start,finish:e.finish}})})})});var e,t})});var u},gr=sr,pr=function(u,n,e){return dr(u,n,e).bind(function(t){var n=function(n){return Mn(u,n)},e="thead,tfoot,tbody,table",r=Me(t.first,e,n),o=Me(t.last,e,n);return r.bind(function(e){return o.bind(function(n){return Mn(e,n)?function(n,e,t){n=zt(n);return Nt(n,e,t)}(t.table,t.first,t.last):S.none()})})})},hr=function(i){if(!l(i))throw new Error("cases must be an array");if(0===i.length)throw new Error("there must be at least one case");var c=[],t={};return I(i,function(n,r){var e=_n(n);if(1!==e.length)throw new Error("one and only one name per case");var o=e[0],u=n[o];if(t[o]!==undefined)throw new Error("duplicate key detected:"+o);if("cata"===o)throw new Error("cannot have a case named cata (sorry)");if(!l(u))throw new Error("case arguments must be an array");c.push(o),t[o]=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var e=t.length;if(e!==u.length)throw new Error("Wrong number of arguments to case "+o+". Expected "+u.length+" ("+u+"), got "+e);return{fold:function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];if(n.length!==i.length)throw new Error("Wrong number of arguments to fold. Expected "+i.length+", got "+n.length);return n[r].apply(null,t)},match:function(n){var e=_n(n);if(c.length!==e.length)throw new Error("Wrong number of arguments to match. Expected: "+c.join(",")+"\nActual: "+e.join(","));if(!L(c,function(n){return D(e,n)}))throw new Error("Not all branches were specified when using match. Specified: "+e.join(", ")+"\nRequired: "+c.join(", "));return n[o].apply(null,t)},log:function(n){console.log(n,{constructors:c,constructor:o,params:t})}}}}),t},n=hr([{none:[]},{multiple:["elements"]},{single:["element"]}]),br=function(n,e,t,r){return n.fold(e,t,r)},vr=n.none,wr=n.multiple,yr=n.single,Cr=tinymce.util.Tools.resolve("tinymce.PluginManager"),Sr=function(n,e){return An.fromDom(n.dom.cloneNode(e))},xr=function(n){return Sr(n,!1)},Tr=function(n){return Sr(n,!0)},Rr=function(n,e){e=function(n,e){e=An.fromTag(e),n=He(n);return Le(e,n),e}(n,e),n=me(Tr(n));return Kt(e,n),e},t=function(t,r){var n=function(n){var e=r(n);if(e<=0||null===e){n=Xe(n,t);return parseFloat(n)||0}return e},o=function(t,n){return P(n,function(n,e){e=Xe(t,e),e=e===undefined?0:parseInt(e,10);return isNaN(e)?n:n+e},0)};return{set:function(n,e){if(!i(e)&&!e.match(/^[0-9]+$/))throw new Error(t+".set accepts only positive integer values. Value was "+e);n=n.dom;qe(n)&&(n.style[t]=e+"px")},get:n,getOuter:n,aggregate:o,max:function(n,e,t){t=o(n,t);return t<e?e-t:0}}},Dr=t("width",function(n){return n.dom.offsetWidth}),Or=function(n){return Dr.get(n)},Ar=function(n){return Dr.getOuter(n)},kr=function(t,r){void 0===r&&(r=C);var n=t.grid,e=A(n.columns,f),o=A(n.rows,f);return k(e,function(e){return Ir(function(){return W(o,function(n){return Bt.getAt(t,n,e).filter(function(n){return n.column===e}).toArray()})},function(n){return 1===n.colspan&&r(n.element)},function(){return Bt.getAt(t,0,e)})})},Ir=function(n,e,t){var r=n();return E(r,e).orThunk(function(){return S.from(r[0]).orThunk(t)}).map(function(n){return n.element})},Br=function(t){var n=t.grid,e=A(n.rows,f),r=A(n.columns,f);return k(e,function(e){return Ir(function(){return W(r,function(n){return Bt.getAt(t,e,n).filter(function(n){return n.row===e}).fold(h([]),function(n){return[n]})})},function(n){return 1===n.rowspan},function(){return Bt.getAt(t,e,0)})})},Mr=function(e,t){if(t<0||t>=e.length-1)return S.none();var n=e[t].fold(function(){var n=function(n){n=x.call(n,0);return n.reverse(),n}(e.slice(0,t));return U(n,function(n,e){return n.map(function(n){return{value:n,delta:e+1}})})},function(n){return S.some({value:n,delta:0})}),r=e[t+1].fold(function(){var n=e.slice(t+1);return U(n,function(n,e){return n.map(function(n){return{value:n,delta:e+1}})})},function(n){return S.some({value:n,delta:1})});return n.bind(function(t){return r.map(function(n){var e=n.delta+t.delta;return Math.abs(n.value-t.value)/e})})},Pr=function(e,t){return function(n){return"rtl"===Er(n)?t:e}},Er=function(n){return"rtl"===Xe(n,"direction")?"rtl":"ltr"},Nr=t("height",function(n){var e=n.dom;return Ce(n)?e.getBoundingClientRect().height:e.offsetHeight}),_r=function(n){return Nr.get(n)},Wr=function(n){return Nr.getOuter(n)},Lr=function(t,r){return{left:t,top:r,translate:function(n,e){return Lr(t+n,r+e)}}},jr=Lr,zr=function(n,e){return n!==undefined?n:e!==undefined?e:0},Fr=function(n){var e=n.dom.ownerDocument,t=e.body,r=e.defaultView,o=e.documentElement;if(t===n.dom)return jr(t.offsetLeft,t.offsetTop);var u=zr(null==r?void 0:r.pageYOffset,o.scrollTop),e=zr(null==r?void 0:r.pageXOffset,o.scrollLeft),r=zr(o.clientTop,t.clientTop),t=zr(o.clientLeft,t.clientLeft);return Hr(n).translate(e-t,u-r)},Hr=function(n){var e=n.dom,t=e.ownerDocument.body;return t===e?jr(t.offsetLeft,t.offsetTop):Ce(n)?function(n){n=n.getBoundingClientRect();return jr(n.left,n.top)}(e):jr(0,0)},Vr=function(n,e){return{row:n,y:e}},Ur=function(n,e){return{col:n,x:e}},qr=function(n){return Fr(n).left+Ar(n)},$r=function(n){return Fr(n).left},Kr=function(n,e){return Ur(n,$r(e))},Gr=function(n,e){return Ur(n,qr(e))},Xr=function(n){return Fr(n).top},Yr=function(n,e){return Vr(n,Xr(e))},Jr=function(n,e){return Vr(n,Xr(e)+Wr(e))},Qr=function(t,e,r){if(0===r.length)return[];var n=k(r.slice(1),function(n,e){return n.map(function(n){return t(e,n)})}),o=r[r.length-1].map(function(n){return e(r.length-1,n)});return n.concat([o])},Zr={delta:f,positions:function(n){return Qr(Yr,Jr,n)},edge:Xr},no=Pr({delta:f,edge:$r,positions:function(n){return Qr(Kr,Gr,n)}},{delta:function(n){return-n},edge:qr,positions:function(n){return Qr(Gr,Kr,n)}}),eo={delta:function(n,e){return no(e).delta(n,e)},positions:function(n,e){return no(e).positions(n,e)},edge:function(n){return no(n).edge(n)}},to={unsupportedLength:["em","ex","cap","ch","ic","rem","lh","rlh","vw","vh","vi","vb","vmin","vmax","cm","mm","Q","in","pc","pt","px"],fixed:["px","pt"],relative:["%"],empty:[""]},ro=(tl="[eE][+-]?[0-9]+",tl=["Infinity",(o="[0-9]+")+"\\."+(an=function(n){return"(?:"+n+")?"})(o)+an(tl),"\\."+o+an(tl),o+an(tl)].join("|"),new RegExp("^("+("[+-]?(?:"+tl+")")+")(.*)$")),oo=function(n,r){return S.from(ro.exec(n)).bind(function(n){var e,t=Number(n[1]),n=n[2];return e=n,O(r,function(n){return O(to[n],function(n){return e===n})})?S.some({value:t,unit:n}):S.none()})},uo=function(){var n=Dn().browser;return n.isIE()||n.isEdge()},io=function(n,e,t){return function(n,e){n=parseFloat(n);return isNaN(n)?e:n}(Xe(n,e),t)},co=function(n){return uo()?(t=(e=n).dom.getBoundingClientRect().height,"border-box"===Xe(e,"box-sizing")?t:t-io(e,"padding-top",0)-io(e,"padding-bottom",0)-(io(e,"border-top-width",0)+io(e,"border-bottom-width",0))):io(n,"height",_r(n));var e,t},lo=function(n){return uo()?(t=(e=n).dom.getBoundingClientRect().width,"border-box"===Xe(e,"box-sizing")?t:t-io(e,"padding-left",0)-io(e,"padding-right",0)-(io(e,"border-left-width",0)+io(e,"border-right-width",0))):io(n,"width",Or(n));var e,t},ao=/(\d+(\.\d+)?)%/,fo=/(\d+(\.\d+)?)px|em/,so=function(n,e){var t=S.from(n.dom.offsetParent).map(An.fromDom).getOr(Se(ce(n)));return e(n)/e(t)*100},mo=function(n,e){Ke(n,"width",e+"px")},go=function(n,e){Ke(n,"width",e+"%")},po=function(n,e){Ke(n,"height",e+"px")},ho=function(n,e,t,r){var o,u,i=parseInt(n,10);return un(n,"%")&&"table"!==Qn(e)?(o=i,u=t,t=r,e=st(r=e).map(function(n){n=u(n);return Math.floor(o/100*n)}).getOr(o),t(r,e),e):i},bo=function(n){var e,t=Je(e=n,"height").getOrThunk(function(){return co(e)+"px"});return t?ho(t,n,_r,po):_r(n)},vo=function(n){return Je(n,"width").fold(function(){return S.from(je(n,"width"))},function(n){return S.some(n)})},wo=function(n,e){return n/e.pixelWidth()*100},yo=function(e,t){return vo(e).fold(function(){var n=Or(e);return wo(n,t)},function(n){return function(n,e,t){e=ao.exec(e);if(null!==e)return parseFloat(e[1]);n=lo(n);return wo(n,t)}(e,n,t)})},Co=function(e,t){return vo(e).fold(function(){return lo(e)},function(n){return function(n,e,t){var r=fo.exec(e);if(null!==r)return parseInt(r[1],10);e=ao.exec(e);return null===e?lo(n):parseFloat(e[1])/100*t.pixelWidth()}(e,n,t)})},So=function(n){return e="rowspan",bo(n=n)/nt(n,e);var e},xo=function(n,e,t){Ke(n,"width",e+t)},To=function(n){return so(n,Or)+"%"},Ro=h(ao),Do=h(fo),Oo=ie("col"),Ao=function(n,e,t){return Je(n,e).getOrThunk(function(){return t(n)+"px"})},ko=function(n,e){return Ao(n,"width",function(n){return Oo(n)?Or(n):Co(n,e)})},Io=function(n){return Ao(n,"height",So)},Bo=function(n,e){return Je(n,e).isSome()},Mo=function(n,e,t,r,o,u){return n.filter(r).fold(function(){return u(Mr(t,e))},function(n){return o(n)})},Po=function(n,e,r,o,u){var i=kr(n,function(n){return Bo(n,"width")}),n=Bt.hasColumns(n)?k(Bt.justColumns(n),function(n){return S.from(n.element)}):i,c=[S.some(eo.edge(e))].concat(k(eo.positions(i,e),function(n){return n.map(function(n){return n.x})})),l=b(et);return k(n,function(n,t){return Mo(n,t,c,l,function(n){if(!Oo(e=n)||Bo(e,"width"))return r(n,u);var e,e=(e=i[t],n=f,e!==undefined&&null!==e?n(e):S.none());return Mo(e,t,c,l,function(n){return o(S.some(Or(n)))},o)},o)})},Eo=function(n){return n.map(function(n){return n+"px"}).getOr("")},No=function(n,e,t){return Po(n,e,Co,function(n){return n.getOrThunk(t.minCellWidth)},t)},_o=function(n,e,t,r,o){var n=Br(n),u=[S.some(t.edge(e))].concat(k(t.positions(n,e),function(n){return n.map(function(n){return n.y})}));return k(n,function(n,e){return Mo(n,e,u,b(tt),r,o)})},Wo=function(n){var e=n;return{get:function(){return e},set:function(n){e=n}}},Lo=function(t){var n=function(){return Or(t)},e=h(0);return{width:n,pixelWidth:n,getWidths:function(n,e){return No(n,t,e)},getCellDelta:e,singleColumnWidth:h([0]),minCellWidth:e,setElementWidth:y,adjustTableWidth:y,isRelative:!0,label:"none"}},jo=function(n,r){var t=Wo(parseFloat(n)),o=Wo(Or(r));return{width:t.get,pixelWidth:o.get,getWidths:function(n,e){return Po(n,r,yo,function(n){return n.fold(function(){return t.minCellWidth()},function(n){return n/t.pixelWidth()*100})},t=e);var t},getCellDelta:function(n){return n/o.get()*100},singleColumnWidth:function(n,e){return[100-n]},minCellWidth:function(){return ot()/o.get()*100},setElementWidth:go,adjustTableWidth:function(n){var e=t.get(),e=e+n/100*e;go(r,e),t.set(e),o.set(Or(r))},isRelative:!0,label:"percent"}},zo=function(n,t){var e=Wo(n),r=e.get;return{width:r,pixelWidth:r,getWidths:function(n,e){return No(n,t,e)},getCellDelta:f,singleColumnWidth:function(n,e){return[Math.max(ot(),n+e)-n]},minCellWidth:ot,setElementWidth:mo,adjustTableWidth:function(n){n=r()+n;mo(t,n),e.set(n)},isRelative:!1,label:"pixel"}},Fo=function(e){return vo(e).fold(function(){return Lo(e)},function(n){return function(n,e){var t=Ro().exec(e);if(null!==t)return jo(t[1],n);e=Do().exec(e);if(null!==e){var r=parseInt(e[1],10);return zo(r,n)}r=Or(n);return zo(r,n)}(e,n)})},Ho=zo,Vo=jo,Uo=function(n,e,t,r){for(var o=e.grid.columns,u=e.grid.rows,i=0;i<u;i++)for(var c=!1,l=0;l<o;l++)i<t.minRow||i>t.maxRow||l<t.minCol||l>t.maxCol||(Bt.getAt(e,i,l).filter(r).isNone()?function(n,e,t){n=n[t].element,t=An.fromTag("td");Ut(t,An.fromTag("br")),(e?Ut:Vt)(n,t)}(n,c,i):c=!0)},qo=function(n,e){var o,u,i,c,l,a,f,t=function(n){return kn(n.element,e)},r=Tr(n),s=ht(r),d=Fo(n),m=Bt.generate(s),g=(o=t,h=m.grid.columns,u=m.grid.rows,i=h,l=c=0,a=[],f=[],Ln(m.access,function(n){var e,t,r;a.push(n),o(n)&&(f.push(n),t=(e=n.row)+n.rowspan-1,n=(r=n.column)+n.colspan-1,e<u?u=e:c<t&&(c=t),r<i?i=r:l<n&&(l=n))}),{minRow:u,minCol:i,maxRow:c,maxCol:l,allCells:a,selectedCells:f}),p="th:not("+e+"),td:not("+e+")",h=ct(r,"th,td",function(n){return kn(n,p)});return I(h,Xt),Uo(s,m,g,t),function(n,e,t,r){Ln(t.columns,function(n){(n.column<e.minCol||n.column>e.maxCol)&&Xt(n.element)});t=B(it(n,"tr"),function(n){return 0===n.dom.childElementCount});I(t,Xt),e.minCol!==e.maxCol&&e.minRow!==e.maxRow||I(it(n,"th,td"),function(n){Fe(n,"rowspan"),Fe(n,"colspan")}),Fe(n,Dt),Fe(n,"data-snooker-col-series"),Fo(n).adjustTableWidth(r)}(r,g,m,function(n,e,t,r){if(0===r.minCol&&e.grid.columns===r.maxCol+1)return 0;e=No(e,n,t),n=P(e,function(n,e){return n+e},0),n=P(e.slice(r.minCol,r.maxCol+1),function(n,e){return n+e},0)/n*t.pixelWidth()-t.pixelWidth();return t.getCellDelta(n)}(n,Bt.fromTable(n),d,g)),r},$o=function(n){return"img"===Qn(n)?1:Zt(n).fold(function(){return me(n).length},function(n){return n.length})},Ko=["img","br"],Go=function(n){return Zt(n).filter(function(n){return 0!==n.trim().length||-1<n.indexOf("\xa0")}).isSome()||D(Ko,Qn(n))},Xo=function(n){return r=Go,(o=function(n){for(var e=0;e<n.childNodes.length;e++){var t=An.fromDom(n.childNodes[e]);if(r(t))return S.some(t);t=o(n.childNodes[e]);if(t.isSome())return t}return S.none()})(n.dom);var r,o},Yo=function(n){return Jo(n,Go)},Jo=function(n,o){var u=function(n){for(var e=me(n),t=e.length-1;0<=t;t--){var r=e[t];if(o(r))return S.some(r);r=u(r);if(r.isSome())return r}return S.none()};return u(n)},Qo={scope:["row","col"]},Zo=function(){var n=An.fromTag("td");return Ut(n,An.fromTag("br")),n},nu=function(){return An.fromTag("col")},eu=function(){return An.fromTag("colgroup")},tu=function(n,e,t){var r=Rr(n,e);return Ln(t,function(n,e){null===n?Fe(r,e):We(r,e,n)}),r},ru=function(n){return n},ou=function(n){return function(){return An.fromTag("tr",n.dom)}},uu=function(l,n,a){var f=function(n,e){!function(n,e){n=n.dom,e=e.dom;qe(n)&&qe(e)&&(e.style.cssText=n.style.cssText)}(n.element,e),Qe(e,"height"),1!==n.colspan&&Qe(e,"width")};return{col:function(n){var e=ce(n.element),e=An.fromTag(Qn(n.element),e.dom);return f(n,e),l(n.element,e),e},colgroup:eu,row:ou(n),cell:function(n){var t,r,o,u,i,e=ce(n.element),c=An.fromTag(Qn(n.element),e.dom),e=a.getOr(["strong","em","b","i","span","font","h1","h2","h3","h4","h5","h6","p","div"]),e=0<e.length?(t=n.element,r=c,o=e,Xo(t).map(function(n){var e=o.join(","),e=Te(n,e,function(n){return Mn(n,t)});return M(e,function(n,e){e=xr(e);return Fe(e,"contenteditable"),Ut(n,e),e},r)}).getOr(r)):c;return Ut(e,An.fromTag("br")),f(n,c),u=n.element,i=c,Ln(Qo,function(e,t){return ze(u,t).filter(function(n){return D(e,n)}).each(function(n){return We(i,t,n)})}),l(n.element,c),c},replace:tu,gap:Zo}},iu=function(n){return{col:nu,colgroup:eu,row:ou(n),cell:Zo,replace:ru,gap:Zo}},cu=function(n){return k(n,An.fromDom)},lu=function(n){return n.nodeName.toLowerCase()},au=function(n){return An.fromDom(n.getBody())},fu=function(n){return n.getBoundingClientRect().width},su=function(n){return n.getBoundingClientRect().height},du=function(e){return function(n){return Mn(n,au(e))}},mu=function(n){return/^\d+(\.\d+)?$/.test(n)?n+"px":n},gu=function(n){Fe(n,"data-mce-style");var e=function(n){return Fe(n,"data-mce-style")};I(at(n),e),I(ft(n),e)},pu=function(n,e){e=n.dom.getStyle(e,"width")||n.dom.getAttrib(e,"width");return S.from(e).filter(ln)},hu=function(n){return/^(\d+(\.\d+)?)%$/.test(n)},bu=function(n){return An.fromDom(n.selection.getStart())},vu=function(n){return br(n.get(),h([]),f,z)},fn="data-mce-selected",sn="data-mce-first-selected",dn="data-mce-last-selected",wu={selected:fn,selectedSelector:"td[data-mce-selected],th[data-mce-selected]",firstSelected:sn,firstSelectedSelector:"td[data-mce-first-selected],th[data-mce-first-selected]",lastSelected:dn,lastSelectedSelector:"td[data-mce-last-selected],th[data-mce-last-selected]"},yu=function(n,e,t){return{element:t,mergable:(o=e,u=wu,br(n.get(),S.none,function(e){return e.length<=1?S.none():pr(o,u.firstSelectedSelector,u.lastSelectedSelector).map(function(n){return{bounds:n,cells:e}})},S.none)),unmergable:(r=function(n,e){return ze(n,e).exists(function(n){return 1<parseInt(n,10)})},0<(e=vu(e=n)).length&&L(e,function(n){return r(n,"rowspan")||r(n,"colspan")})?S.some(e):S.none()),selection:vu(n)};var r,o,u},Cu=function(i,e,c,l){i.on("BeforeGetContent",function(t){var n=function(n){t.preventDefault(),st(n[0]).map(function(n){n=qo(n,"[data-mce-selected]");return gu(n),[n]}).each(function(n){var e;t.content="text"===t.format?k(n,function(n){return n.dom.innerText}).join(""):(e=i,k(n,function(n){return e.selection.serializer.serialize(n.dom,{})}).join(""))})};!0===t.selection&&br(e.get(),y,n,y)}),i.on("BeforeSetContent",function(u){!0===u.selection&&!0===u.paste&&S.from(i.dom.getParent(i.selection.getStart(),"th,td")).each(function(n){var o=An.fromDom(n);st(o).each(function(e){var n,t,r=B(function(n,e){e=(e||document).createElement("div");return e.innerHTML=n,me(An.fromDom(e))}(u.content),function(n){return"meta"!==Qn(n)});1===r.length&&(t=r[0],"table"===Qn(t))&&(u.preventDefault(),n=An.fromDom(i.getDoc()),n=iu(n),n={element:o,clipboard:r[0],generators:n},c.pasteCells(e,n).each(function(n){i.selection.setRng(n.rng),i.focus(),l.clear(e)}))})})})},ne=hr([{none:[]},{only:["index"]},{left:["index","next"]},{middle:["prev","index","next"]},{right:["prev","index"]}]),Su=q({},ne),xu=function(n,e,r,o,u){var i=n.slice(0),n=(e=e,0===(n=n).length?Su.none():1===n.length?Su.only(0):0===e?Su.left(0,1):e===n.length-1?Su.right(e-1,e):0<e&&e<n.length-1?Su.middle(e-1,e,e+1):Su.none()),e=h(k(i,h(0)));return n.fold(e,function(n){return o.singleColumnWidth(i[n],r)},function(n,e){return u.calcLeftEdgeDeltas(i,n,e,r,o.minCellWidth(),o.isRelative)},function(n,e,t){return u.calcMiddleDeltas(i,n,e,t,r,o.minCellWidth(),o.isRelative)},function(n,e){return u.calcRightEdgeDeltas(i,n,e,r,o.minCellWidth(),o.isRelative)})},Tu=function(n,e,t){for(var r=0,o=n;o<e;o++)r+=t[o]!==undefined?t[o]:0;return r},Ru=function(n,e){return(Bt.hasColumns(n)?function(n,t){n=Bt.justColumns(n);return k(n,function(n,e){return{element:n.element,width:t[e],colspan:n.colspan}})}:function(n,t){n=Bt.justCells(n);return k(n,function(n){var e=Tu(n.column,n.column+n.colspan,t);return{element:n.element,width:e,colspan:n.colspan}})})(n,e)},Du=function(n,e,t){e=Ru(n,e);I(e,function(n){t.setElementWidth(n.element,n.width)})},Ou=function(n,e,t,r,o){var u=Bt.fromTable(n),n=o.getCellDelta(e),i=o.getWidths(u,o),e=t===u.grid.columns-1,n=r.clampTableDelta(i,t,n,o.minCellWidth(),e),t=xu(i,t,n,o,r),t=k(t,function(n,e){return n+i[e]});Du(u,t,o),r.resizeTable(o.adjustTableWidth,n,e)},Au=function(n,t,r,e){var o,u=Bt.fromTable(n),i=_o(u,n,e,So,function(n){return n.getOrThunk(ut)}),e=k(i,function(n,e){return r===e?Math.max(t+n,ut()):n}),i=function(n,t){n=Bt.justCells(n);return k(n,function(n){var e=Tu(n.row,n.row+n.rowspan,t);return{element:n.element,height:e,rowspan:n.rowspan}})}(u,e),u=(o=e,k(u.all,function(n,e){return{element:n.element,height:o[e]}}));I(u,function(n){po(n.element,n.height)}),I(i,function(n){po(n.element,n.height)});e=M(e,function(n,e){return n+e},0);po(n,e)},ku=function(n){return k(n,h(0))},Iu=function(n,e,t,r,o){return o(n.slice(0,e)).concat(r).concat(o(n.slice(t)))},pe=function(o){return function(n,e,t,r){if(o(t)){r=Math.max(r,n[e]-Math.abs(t)),e=Math.abs(r-n[e]);return 0<=t?e:-e}return t}},Bu=pe(function(n){return n<0}),Mu=pe(C),Pu=function(){var i=function(n,t,e,r){var o=(100+e)/100,u=Math.max(r,(n[t]+e)/o);return k(n,function(n,e){return(e===t?u:n/o)-n})},c=function(n,e,t,r,o,u){return u?i(n,e,r,o):function(n,e,t,r,o){o=Bu(n,e,r,o);return Iu(n,e,t+1,[o,0],ku)}(n,e,t,r,o)};return{resizeTable:function(n,e){return n(e)},clampTableDelta:Bu,calcLeftEdgeDeltas:c,calcMiddleDeltas:function(n,e,t,r,o,u,i){return c(n,t,r,o,u,i)},calcRightEdgeDeltas:function(n,e,t,r,o,u){if(u)return i(n,t,r,o);o=Bu(n,t,r,o);return ku(n.slice(0,t)).concat([o])},calcRedestributedWidths:function(n,e,t,r){if(r){var o=(e+t)/e,e=k(n,function(n){return n/o});return{delta:100*o-100,newSizes:e}}return{delta:t,newSizes:n}}}},Eu=function(){var i=function(n,e,t,r,o){o=Mu(n,0<=r?t:e,r,o);return Iu(n,e,t+1,[o,-o],ku)};return{resizeTable:function(n,e,t){t&&n(e)},clampTableDelta:function(n,e,t,r,o){if(o){if(0<=t)return t;o=P(n,function(n,e){return n+e-r},0);return Math.max(-o,t)}return Bu(n,e,t,r)},calcLeftEdgeDeltas:i,calcMiddleDeltas:function(n,e,t,r,o,u){return i(n,t,r,o,u)},calcRightEdgeDeltas:function(n,e,t,r,o,u){if(u)return ku(n);r/=n.length;return k(n,h(r))},calcRedestributedWidths:function(n,e,t,r){return{delta:0,newSizes:n}}}},Nu=function(n,e){var t=S.from(n.dom.documentElement).map(An.fromDom).getOr(n);return{parent:h(t),view:h(n),origin:h(jr(0,0)),isResizable:e}},_u=function(n,e,t){return{parent:h(e),view:h(n),origin:h(jr(0,0)),isResizable:t}},Wu=hr([{invalid:["raw"]},{pixels:["value"]},{percent:["value"]}]),Lu=function(n,e,t){var r=t.substring(0,t.length-n.length),n=parseFloat(r);return r===n.toString()?e(n):Wu.invalid(t)},ju=q(q({},Wu),{from:function(n){return un(n,"%")?Lu("%",Wu.percent,n):un(n,"px")?Lu("px",Wu.pixels,n):Wu.invalid(n)}}),zu=function(n,r,o){return n.fold(function(){return r},function(n){return t=(e=n)/o,k(r,function(n){return ju.from(n).fold(function(){return n},function(n){return n*t+"px"},function(n){return n/100*e+"px"})});var e,t},function(n){return e=o,k(r,function(n){return ju.from(n).fold(function(){return n},function(n){return n/e*100+"%"},function(n){return n+"%"})});var e})},Fu=function(n,e,t){t=ju.from(t),e=L(n,function(n){return"0px"===n})?function(n,e){n=n.fold(function(){return h("")},function(n){return h(n/e+"px")},function(){return h(100/e+"%")});return A(e,n)}(t,n.length):zu(t,n,e);return Vu(e)},Hu=function(n,e){return 0===n.length?e:M(n,function(n,e){return ju.from(e).fold(h(0),f,f)+n},0)},Vu=function(n){if(0===n.length)return n;var e,t=M(n,function(n,e){var t=ju.from(e).fold(function(){return{value:e,remainder:0}},function(n){return e=n,t="px",{value:(n=Math.floor(e))+t,remainder:e-n};var e,t},function(n){return{value:n+"%",remainder:0}});return{output:[t.value].concat(n.output),remainder:n.remainder+t.remainder}},{output:[],remainder:0}),n=t.output;return n.slice(0,n.length-1).concat([(n=n[n.length-1],e=Math.round(t.remainder),ju.from(n).fold(h(n),function(n){return n+e+"px"},function(n){return n+e+"%"}))])},Uu=ju.from,qu=function(n){return Uu(n).fold(h("px"),h("px"),h("%"))},$u=function(l,n,e,a){var f=Bt.fromTable(l),i=f.all,s=Bt.justCells(f),d=Bt.justColumns(f);n.each(function(n){var t,r,o,u,e=qu(n),i=Or(l),c=Po(f,l,ko,Eo,a),i=Fu(c,i,n);Bt.hasColumns(f)?(o=i,u=e,I(d,function(n,e){e=Hu([o[e]],ot());Ke(n.element,"width",e+u)})):(t=i,r=e,I(s,function(n){var e=t.slice(n.column,n.colspan+n.column),e=Hu(e,ot());Ke(n.element,"width",e+r)})),Ke(l,"width",n)}),e.each(function(n){var t,r,e=qu(n),o=_r(l),u=_o(f,l,Zr,Io,Eo),o=Fu(u,o,n);t=o,o=i,r=e,I(s,function(n){var e=t.slice(n.row,n.rowspan+n.row),e=Hu(e,ut());Ke(n.element,"height",e+r)}),I(o,function(n,e){Ke(n.element,"height",t[e])}),Ke(l,"height",n)})},Ku=function(n){return vo(n).exists(function(n){return ao.test(n)})},Gu=function(n){return vo(n).exists(function(n){return fo.test(n)})},Xu=function(n){return vo(n).isNone()},Yu=To,Ju=function(n){return Bt.fromTable(n).grid},Qu=function(e){var o=[];return{bind:function(n){if(n===undefined)throw new Error("Event bind error: undefined handler");o.push(n)},unbind:function(e){o=B(o,function(n){return n!==e})},trigger:function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r={};I(e,function(n,e){r[n]=t[e]}),I(o,function(n){n(r)})}}},Zu=function(n){return{registry:jn(n,function(n){return{bind:n.bind,unbind:n.unbind}}),trigger:jn(n,function(n){return n.trigger})}},ni=function(n){return n.slice(0).sort()},ei=function(r,o,u){if(0===o.length)throw new Error("You must specify at least one required field.");var t;return function(e,n){if(!l(n))throw new Error("The "+e+" fields must be an array. Was: "+n+".");I(n,function(n){if(!g(n))throw new Error("The value "+n+" in the "+e+" fields was not a string.")})}("required",o),t=ni(o),E(t,function(n,e){return e<t.length-1&&n===t[e+1]}).each(function(n){throw new Error("The field: "+n+" occurs more than once in the combined fields: ["+t.join(", ")+"].")}),function(e){var t=_n(e);L(o,function(n){return D(t,n)})||function(n,e){throw new Error("All required keys ("+ni(n).join(", ")+") were not specified. Specified keys were: "+ni(e).join(", ")+".")}(o,t),r(o,t);var n=B(o,function(n){return!u.validate(e[n],n)});return 0<n.length&&function(n,e){throw new Error("All values need to be of type: "+e+". Keys ("+ni(n).join(", ")+") were not.")}(n,u.label),e}},ti=function(e,n){n=B(n,function(n){return!D(e,n)});0<n.length&&function(n){throw new Error("Unsupported keys for object: "+ni(n).join(", "))}(n)},n=function(n){return ei(ti,n,{validate:a,label:"function"})},t=n(["compare","extract","mutate","sink"]),ri=n(["element","start","stop","destroy"]),oi=n(["forceDrop","drop","move","delayDrop"]),ui=function(){var o=S.none(),u=Zu({move:Qu(["info"])});return{onEvent:function(n,r){r.extract(n).each(function(n){var e,t;(e=r,t=n,n=o.map(function(n){return e.compare(n,t)}),o=S.some(t),n).each(function(n){u.trigger.move(n)})})},reset:function(){o=S.none()},events:u.registry}},ii=function(){var n,e=(n=Zu({move:Qu(["info"])}),{onEvent:y,reset:y,events:n.registry}),t=ui(),r=e;return{on:function(){r.reset(),r=t},off:function(){r.reset(),r=e},isOn:function(){return r===t},onEvent:function(n,e){r.onEvent(n,e)},events:t.events}},ci=function(e,t,n){var r,o,u,i=!1,c=Zu({start:Qu([]),stop:Qu([])}),l=ii(),a=function(){d.stop(),l.isOn()&&(l.off(),c.trigger.stop())},f=(r=a,o=200,u=null,{cancel:function(){null!==u&&(clearTimeout(u),u=null)},throttle:function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];null!==u&&clearTimeout(u),u=setTimeout(function(){r.apply(null,n),u=null},o)}});l.events.move.bind(function(n){t.mutate(e,n.info)});var s=function(t){return function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];i&&t.apply(null,n)}},d=t.sink(oi({forceDrop:a,drop:s(a),move:s(function(n){f.cancel(),l.onEvent(n,t)}),delayDrop:s(f.throttle)}),n);return{element:d.element,go:function(n){d.start(n),l.on(),c.trigger.start()},on:function(){i=!0},off:function(){i=!1},destroy:function(){d.destroy()},events:c.registry}},li=function(n){var t,r,e=An.fromDom(function(n){if(he()&&c(n.target)){var e=An.fromDom(n.target);if(te(e)&&ye(e)&&n.composed&&n.composedPath){e=n.composedPath();if(e)return H(e)}}return S.from(n.target)}(n).getOr(n.target)),o=function(){return n.stopPropagation()},u=function(){return n.preventDefault()},i=(t=u,r=o,function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return t(r.apply(null,n))});return{target:e,x:n.clientX,y:n.clientY,stop:o,prevent:u,kill:i,raw:n}},ai=function(n,e,t,r,o){var u,i,r=(u=t,i=r,function(n){u(n)&&i(li(n))});return n.dom.addEventListener(e,r,o),{unbind:w(fi,n,e,r,o)}},fi=function(n,e,t,r){n.dom.removeEventListener(e,t,r)},si=C,di=function(n,e,t){return ai(n,e,si,t,!1)},mi=li,gi=function(n,e){e=je(n,e);return e===undefined||""===e?[]:e.split(" ")},pi=function(n){return n.dom.classList!==undefined},hi=function(n,e){return function(n,e,t){t=gi(n,e).concat([t]);return We(n,e,t.join(" ")),!0}(n,"class",e)},bi=function(n,e){pi(n)?n.dom.classList.add(e):hi(n,e)},vi=function(n,e){return pi(n)&&n.dom.classList.contains(e)},o=function(n){var e=n.replace(/\./g,"-");return{resolve:function(n){return e+"-"+n}}},wi=o("ephox-dragster").resolve,yi=t({compare:function(n,e){return jr(e.left-n.left,e.top-n.top)},extract:function(n){return S.some(jr(n.x,n.y))},sink:function(n,e){var t=function(n){var n=q({layerClass:wi("blocker")},n),e=An.fromTag("div");We(e,"role","presentation"),Ge(e,{position:"fixed",left:"0px",top:"0px",width:"100%",height:"100%"}),bi(e,wi("blocker")),bi(e,n.layerClass);return{element:h(e),destroy:function(){Xt(e)}}}(e),r=di(t.element(),"mousedown",n.forceDrop),o=di(t.element(),"mouseup",n.drop),u=di(t.element(),"mousemove",n.move),i=di(t.element(),"mouseout",n.delayDrop);return ri({element:t.element,start:function(n){Ut(n,t.element())},stop:function(){Xt(t.element())},destroy:function(){t.destroy(),o.unbind(),u.unbind(),i.unbind(),r.unbind()}})},mutate:function(n,e){n.mutate(e.left,e.top)}}),Ci=function(n){return"true"===je(n,"contenteditable")},an=o("ephox-snooker").resolve,Si=function(){var t,r=Zu({drag:Qu(["xDelta","yDelta","target"])}),o=S.none(),n={mutate:function(n,e){t.trigger.drag(n,e)},events:(t=Zu({drag:Qu(["xDelta","yDelta"])})).registry};n.events.drag.bind(function(e){o.each(function(n){r.trigger.drag(e.xDelta,e.yDelta,n)})});return{assign:function(n){o=S.some(n)},get:function(){return o},mutate:n.mutate,events:r.registry}},xi=an("resizer-bar"),Ti=an("resizer-rows"),Ri=an("resizer-cols"),Di=function(n){n=De(n.parent(),"."+xi);I(n,Xt)},Oi=function(e,n,t){var r=e.origin();I(n,function(n){n.each(function(n){n=t(r,n);bi(n,xi),Ut(e.parent(),n)})})},Ai=function(n,e,i,c){Oi(n,e,function(n,e){var t,r,o,u,n=(t=e.col,r=e.x-n.left,o=i.top-n.top,u=7,e=c,n=An.fromTag("div"),Ge(n,{position:"absolute",left:r-u/2+"px",top:o+"px",height:e+"px",width:u+"px"}),Le(n,{"data-column":t,role:"presentation"}),n);return bi(n,Ri),n})},ki=function(n,e,i,c){Oi(n,e,function(n,e){var t,r,o,u,n=(t=e.row,r=i.left-n.left,o=e.y-n.top,u=c,e=7,n=An.fromTag("div"),Ge(n,{position:"absolute",left:r+"px",top:o-e/2+"px",height:e+"px",width:u+"px"}),Le(n,{"data-row":t,role:"presentation"}),n);return bi(n,Ti),n})},Ii=function(n,e,t,r,o){var u,i=Fr(t),c=e.isResizable,r=0<r.length?Zr.positions(r,t):[],l=0<r.length?(u=c,W(n.all,function(n,e){return u(n.element)?[e]:[]})):[],r=B(r,function(n,e){return O(l,function(n){return e===n})});ki(e,r,i,Ar(t));var a,f,s,o=0<o.length?eo.positions(o,t):[],d=0<o.length?(f=c,s=[],A((a=n).grid.columns,function(n){Bt.getColumnAt(a,n).map(function(n){return n.element}).forall(f)&&s.push(n)}),B(s,function(e){var n=Bt.filterItems(a,function(n){return n.column===e});return L(n,function(n){return f(n.element)})})):[],o=B(o,function(n,e){return O(d,function(n){return e===n})});Ai(e,o,i,Wr(t))},Bi=function(n,e){var t,r,o;Di(n),n.isResizable(e)&&(t=Bt.fromTable(e),r=Br(t),o=kr(t),Ii(t,n,e,r,o))},Mi=function(n,e){n=De(n.parent(),"."+xi);I(n,e)},Pi=function(n){Mi(n,function(n){Ke(n,"display","none")})},Ei=function(n){Mi(n,function(n){Ke(n,"display","block")})},Ni=an("resizer-bar-dragging"),_i=function(o){var n,e,t=Si(),r=(e=(n=void 0===(n={})?{}:n).mode!==undefined?n.mode:yi,ci(t,e,n)),u=S.none(),i=function(n,e){return S.from(je(n,e))};t.events.drag.bind(function(t){i(t.target,"data-row").each(function(n){var e=rt(t.target,"top");Ke(t.target,"top",e+t.yDelta+"px")}),i(t.target,"data-column").each(function(n){var e=rt(t.target,"left");Ke(t.target,"left",e+t.xDelta+"px")})});var c=function(n,e){return rt(n,e)-Ze(n,"data-initial-"+e,0)};r.events.stop.bind(function(){t.get().each(function(r){u.each(function(t){i(r,"data-row").each(function(n){var e=c(r,"top");Fe(r,"data-initial-top"),m.trigger.adjustHeight(t,e,parseInt(n,10))}),i(r,"data-column").each(function(n){var e=c(r,"left");Fe(r,"data-initial-left"),m.trigger.adjustWidth(t,e,parseInt(n,10))}),Bi(o,t)})})});var l=function(n,e){m.trigger.startAdjust(),t.assign(n),We(n,"data-initial-"+e,rt(n,e)),bi(n,Ni),Ke(n,"opacity","0.2"),r.go(o.parent())},a=di(o.parent(),"mousedown",function(n){var e;e=n.target,vi(e,Ti)&&l(n.target,"top"),e=n.target,vi(e,Ri)&&l(n.target,"left")}),f=function(n){return Mn(n,o.view())},s=function(n){return Ne(n,"table",f).filter(function(n){return Ne(n,"[contenteditable]",f).exists(Ci)})},d=di(o.view(),"mouseover",function(n){s(n.target).fold(function(){Ce(n.target)&&Di(o)},function(n){u=S.some(n),Bi(o,n)})}),m=Zu({adjustHeight:Qu(["table","delta","row"]),adjustWidth:Qu(["table","delta","column"]),startAdjust:Qu([])});return{destroy:function(){a.unbind(),d.unbind(),r.destroy(),Di(o)},refresh:function(n){Bi(o,n)},on:r.on,off:r.off,hideBars:w(Pi,o),showBars:w(Ei,o),events:m.registry}},Wi=function(n,o,u){var r=Zr,i=eo,n=_i(n),c=Zu({beforeResize:Qu(["table","type"]),afterResize:Qu(["table","type"]),startDrag:Qu([])});return n.events.adjustHeight.bind(function(n){var e=n.table;c.trigger.beforeResize(e,"row");var t=r.delta(n.delta,e);Au(e,t,n.row,r),c.trigger.afterResize(e,"row")}),n.events.startAdjust.bind(function(n){c.trigger.startDrag()}),n.events.adjustWidth.bind(function(n){var e=n.table;c.trigger.beforeResize(e,"col");var t=i.delta(n.delta,e),r=u(e);Ou(e,t,n.column,o,r),c.trigger.afterResize(e,"col")}),{on:n.on,off:n.off,hideBars:n.hideBars,showBars:n.showBars,destroy:n.destroy,events:c.registry}},Li=function(n,e){return n.fire("newrow",{node:e})},ji=function(n,e){return n.fire("newcell",{node:e})},zi=function(n,e,t){n.fire("TableModified",q(q({},t),{table:e}))},Fi={structure:!1,style:!0},Hi={structure:!0,style:!1},Vi=/^#?([a-f\d])([a-f\d])([a-f\d])$/i,Ui=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i,qi=function(n){return(on(e=n,n="#")?(n=n.length,e.substring(n)):e).toUpperCase();var e},$i=function(n){return e=n,Vi.test(e)||Ui.test(e)?S.some({value:qi(n)}):S.none();var e},Ki=function(n){n=n.toString(16);return(1===n.length?"0"+n:n).toUpperCase()},Gi=function(n){return{value:Ki(n.red)+Ki(n.green)+Ki(n.blue)}},Xi=/^rgb\((\d+),\s*(\d+),\s*(\d+)\)/,Yi=/^rgba\((\d+),\s*(\d+),\s*(\d+),\s*(\d?(?:\.\d+)?)\)/,Ji=function(n,e,t,r){return{red:n,green:e,blue:t,alpha:r}},Qi=function(n,e,t,r){n=parseInt(n,10),e=parseInt(e,10),t=parseInt(t,10),r=parseFloat(r);return Ji(n,e,t,r)},Zi=function(o){return $i(o).orThunk(function(){return function(n){if("transparent"===n)return S.some(Ji(0,0,0,0));var e=Xi.exec(n);if(null!==e)return S.some(Qi(e[1],e[2],e[3],"1"));n=Yi.exec(n);return null!==n?S.some(Qi(n[1],n[2],n[3],n[4])):S.none()}(o).map(Gi)}).getOrThunk(function(){var n=document.createElement("canvas");n.height=1,n.width=1;var e=n.getContext("2d");e.clearRect(0,0,n.width,n.height),e.fillStyle="#FFFFFF",e.fillStyle=o,e.fillRect(0,0,1,1);var t=e.getImageData(0,0,1,1).data,r=t[0],n=t[1],e=t[2],t=t[3];return Gi(Ji(r,n,e,t))})},nc={"border-collapse":"collapse",width:"100%"},ec=A(5,function(n){n=n+1+"px";return{title:n,value:n}}),tc=k(["Solid","Dotted","Dashed","Double","Groove","Ridge","Inset","Outset","None","Hidden"],function(n){return{text:n,value:n.toLowerCase()}}),rc={border:"1"},oc="preservetable",uc=function(n){return n.getParam("table_sizing_mode","auto")},ic=function(n){return n.getParam("table_responsive_width")},cc=function(n){return n.getParam("table_border_widths",ec,"array")},lc=function(n){return n.getParam("table_border_styles",tc,"array")},ac=function(n){return n.getParam("table_default_attributes",rc,"object")},fc=function(n){return n.getParam("table_default_styles",function(n){if(vc(n)){var e=n.getBody().offsetWidth;return q(q({},nc),{width:e+"px"})}return wc(n)?Fn(nc,function(n,e){return"width"!==e}):nc}(n),"object")},sc=function(n){return n.getParam("table_cell_advtab",!0,"boolean")},dc=function(n){return n.getParam("table_row_advtab",!0,"boolean")},mc=function(n){return n.getParam("table_advtab",!0,"boolean")},gc=function(n){return n.getParam("table_style_by_css",!1,"boolean")},pc=function(n){return n.getParam("table_cell_class_list",[],"array")},hc=function(n){return n.getParam("table_class_list",[],"array")},bc=function(n){return"relative"===uc(n)||!0===ic(n)},vc=function(n){return"fixed"===uc(n)||!1===ic(n)},wc=function(n){return"responsive"===uc(n)},yc=function(n){var e="section",n=n.getParam("table_header_type",e,"string");return D(["section","cells","sectionCells","auto"],n)?n:e},Cc=function(n){var e=n.getParam("table_column_resizing",oc,"string");return E(["preservetable","resizetable"],function(n){return n===e}).getOr(oc)},Sc=function(n){return"preservetable"===Cc(n)},xc=function(n){return"resizetable"===Cc(n)},Tc=function(n){n=n.getParam("table_clone_elements");return g(n)?S.some(n.split(/[ ,]/)):Array.isArray(n)?S.some(n):S.none()},Rc=function(n,e){e=n.getParam(e,[],"array");return k(e,function(n){return{text:n.title,value:"#"+Zi(n.value).value,type:"choiceitem"}})},Dc=function(n){return Rc(n,"table_cell_background_color_map")},Oc=function(n){return Rc(n,"table_cell_border_color_map")},Ac=function(n,e){if(bc(n)){var t=pu(n,e.dom).filter(hu).getOrThunk(function(){return Yu(e)});return Vo(t,e)}return vc(n)?Ho(Or(e),e):Fo(e)},kc=function(n){Fe(n,"width")},Ic=function(n,e){var t=Or(n)+"px";$u(n,S.some(t),S.none(),e),kc(n)},Bc=function(n,e){var t=Ac(n,e);n=t,e=To(t=e),$u(t,S.some(e),S.none(),n),kc(t)},Mc=function(n,e){n=Ac(n,e);Ic(e,n)},Pc=function(n){Qe(n,"width");var e=ft(n),e=0<e.length?e:at(n);I(e,function(n){Qe(n,"width"),kc(n)}),kc(n)},Ec=function(){var n=An.fromTag("div");return Ge(n,{position:"static",height:"0",width:"0",padding:"0",margin:"0",border:"0"}),Ut(Se(An.fromDom(document)),n),n},Nc="bar-",_c=function(n){return"false"!==je(n,"data-mce-resize")},Wc=function(i){var c,l,u=S.none(),t=S.none(),r=S.none(),o=function(n){return"TABLE"===n.nodeName},n=function(){return t},a=function(n){return Ac(i,n)},f=function(){return(Sc(i)?Eu:Pu)()},s=function(n,e,t){var r,o,u=un(e,"e");""===l&&Bc(i,n),t!==c&&""!==l?(Ke(n,"width",l),r=f(),e=a(n),u=Sc(i)||u?Ju(n).columns-1:0,Ou(n,t-c,u,r,e)):hu(l)&&(o=parseFloat(l.replace("%","")),Ke(n,"width",t*o/c+"%")),/^(\d+(\.\d+)?)px$/.test(l)&&(o=n,n=Bt.fromTable(o),Bt.hasColumns(n)||I(at(o),function(n){var e=Xe(n,"width");Ke(n,"width",e),Fe(n,"width")}))};return i.on("init",function(){var n,e,n=(e=_c,(n=i).inline?_u(au(n),Ec(),e):Nu(An.fromDom(n.getDoc()),e));r=S.some(n),function(n){n=n.getParam("object_resizing",!0);return g(n)?"table"===n:n}(i)&&i.getParam("table_resize_bars",!0,"boolean")&&(e=f(),(e=Wi(n,e,a)).on(),e.events.startDrag.bind(function(n){u=S.some(i.selection.getRng())}),e.events.beforeResize.bind(function(n){var e,t,r,o=n.table.dom;e=i,r=fu(t=o),o=su(o),n=Nc+n.type,e.fire("ObjectResizeStart",{target:t,width:r,height:o,origin:n})}),e.events.afterResize.bind(function(n){var e,t,r=n.table,o=r.dom;gu(r),u.each(function(n){i.selection.setRng(n),i.focus()}),e=i,r=fu(t=o),o=su(o),n=Nc+n.type,e.fire("ObjectResized",{target:t,width:r,height:o,origin:n}),i.undoManager.add()}),t=S.some(e))}),i.on("ObjectResizeStart",function(n){var e,t=n.target;o(t)&&(e=An.fromDom(t),I(i.dom.select(".mce-clonedresizable"),function(n){i.dom.addClass(n,"mce-"+Cc(i)+"-columns")}),!Gu(e)&&vc(i)?Mc(i,e):!Ku(e)&&bc(i)&&Bc(i,e),Xu(e)&&on(n.origin,Nc)&&Bc(i,e),c=n.width,l=wc(i)?"":pu(i,t).getOr(""))}),i.on("ObjectResized",function(n){var e,t=n.target;o(t)&&(e=An.fromDom(t),t=n.origin,on(t,"corner-")&&s(e,t,n.width),gu(e),zi(i,e.dom,Fi))}),i.on("SwitchMode",function(){t.each(function(n){i.mode.isReadOnly()?n.hideBars():n.showBars()})}),{lazyResize:n,lazyWire:function(){return r.getOr(Nu(An.fromDom(i.getBody()),_c))},destroy:function(){t.each(function(n){n.destroy()}),r.each(function(n){n=n,i.inline&&Xt(n.parent())})}}},Lc=function(n,e){return{element:n,offset:e}},jc=function(e,n,t){return e.property().isText(n)&&0===e.property().getText(n).trim().length||e.property().isComment(n)?t(n).bind(function(n){return jc(e,n,t).orThunk(function(){return S.some(n)})}):S.none()},zc=function(n,e){return(n.property().isText(e)?n.property().getText(e):n.property().children(e)).length},Fc=function(n,e){var t=jc(n,e,n.query().prevSibling).getOr(e);if(n.property().isText(t))return Lc(t,zc(n,t));e=n.property().children(t);return 0<e.length?Fc(n,e[e.length-1]):Lc(t,zc(n,t))},Hc=Fc,Vc=tr(),Uc=function(t,r){1===nt(t,"colspan")&&vo(t).bind(function(n){return oo(n,["fixed","relative","empty"])}).each(function(n){var e=n.value/2;xo(t,e,n.unit),xo(r,e,n.unit)})},qc=function(n,e,t,r){t===r?Fe(n,e):We(n,e,t)},$c=function(n,e,t){V(Re(n,e)).fold(function(){return Vt(n,t)},function(n){return Ht(n,t)})},Kc=function(u,n){var t=[],r=[],i=function(n){return k(n,function(n){n.isNew&&t.push(n.element);var e=n.element;return Gt(e),I(n.cells,function(n){n.isNew&&r.push(n.element),qc(n.element,"colspan",n.colspan,1),qc(n.element,"rowspan",n.rowspan,1),Ut(e,n.element)}),e})},c=function(n){return W(n,function(n){return k(n.cells,function(n){return qc(n.element,"span",n.colspan,1),n.element})})},o=function(n,e){var t,r,o,o=(o=Pe(t=u,r=e).getOrThunk(function(){var n=An.fromTag(r,ce(t).dom);return"thead"===r?$c(t,"caption,colgroup",n):"colgroup"===r?$c(t,"caption",n):Ut(t,n),n}),Gt(o),o),n=("colgroup"===e?c:i)(n);Kt(o,n)},e=function(n,e){0<n.length?o(n,e):Pe(u,e).each(Xt)},l=[],a=[],f=[],s=[];return I(n,function(n){switch(n.section){case"thead":l.push(n);break;case"tbody":a.push(n);break;case"tfoot":f.push(n);break;case"colgroup":s.push(n)}}),e(s,"colgroup"),e(l,"thead"),e(a,"tbody"),e(f,"tfoot"),{newRows:t,newCells:r}},Gc=function(n,e){if(0===n.length)return 0;var t=n[0];return N(n,function(n){return!e(t.element,n.element)}).getOr(n.length)},Xc=function(n,e,t,r){var o,u=n[e].cells.slice(t),u=Gc(u,r),e=(o=t,k(n,function(n){return St(n,o)}).slice(e));return{colspan:u,rowspan:Gc(e,r)}},Yc=function(o,u){var i=k(o,function(n){return k(n.cells,m)});return k(o,function(n,r){return{details:W(n.cells,function(n,e){if(!1!==i[r][e])return[];var t=Xc(o,r,e,u);return function(n,e,t,r){for(var o=n;o<n+t;o++)for(var u=e;u<e+r;u++)i[o][u]=!0}(r,e,t.rowspan,t.colspan),[{element:n.element,rowspan:t.rowspan,colspan:t.colspan,isNew:n.isNew}]}),section:n.section}})},Jc=function(n,e,t){var r,o=[];Bt.hasColumns(n)&&(r=k(Bt.justColumns(n),function(n){return Yn(n.element,t,!1)}),o.push(Jn(r,"colgroup")));for(var u=0;u<n.grid.rows;u++){for(var i=[],c=0;c<n.grid.columns;c++){var l=Bt.getAt(n,u,c).map(function(n){return Yn(n.element,t,n.isLocked)}).getOrThunk(function(){return Yn(e.gap(),!0,!1)});i.push(l)}var a=Jn(i,n.all[u].section);o.push(a)}return o},Qc=function(n,t){return k(n,function(n){var e,e=(e=n.details,U(e,function(n){return ae(n.element).map(function(n){var e=ae(n).isNone();return Yn(n,e,!1)})}).getOrThunk(function(){return Yn(t.row(),!0,!1)}));return{element:e.element,cells:n.details,section:n.section,isNew:e.isNew}})},Zc=function(n,e){n=Yc(n,Mn);return Qc(n,e)},nl=function(n,e){return U(n.all,function(n){return E(n.cells,function(n){return Mn(e,n.element)})})},el=function(e,n,t){n=k(n.selection,function(n){return lt(n).bind(function(n){return nl(e,n)}).filter(t)}),n=Ve(n);return Ue(0<n.length,n)},tl=function(a,e,f,s,d){return function(o,u,n,r,i,c){var l=Bt.fromTable(u);return e(l,n).map(function(n){var e=Jc(l,r,!1),t=a(e,n,Mn,d(r)),e=At(t.grid);return{info:n,grid:Zc(t.grid,r),cursor:t.cursor,lockedColumns:e}}).bind(function(n){var e=Kc(u,n.grid),t=S.from(i).getOrThunk(function(){return Fo(u)}),r=S.from(c).getOrThunk(Eu);return f(u,n.grid,n.info,t,r),s(u),Bi(o,u),Fe(u,Dt),0<n.lockedColumns.length&&We(u,Dt,n.lockedColumns.join(",")),S.some({cursor:n.cursor,newRows:e.newRows,newCells:e.newCells})})}},rl=function(e,n){return lt(n.element).bind(function(n){return nl(e,n)})},ol=function(n,e){return el(n,e,C).map(function(n){return{cells:n,generators:e.generators,clipboard:e.clipboard}})},ul=function(n,e){return el(n,e,C)},fn=function(n,e){return rl(n,e).filter(function(n){return!n.isLocked})},il=function(n,e){return el(n,e,function(n){return!n.isLocked})},cl=function(e,n){return L(n,function(n){return nl(e,n).exists(function(n){return!n.isLocked})})},ll=function(e,n){return n.mergable.filter(function(n){return cl(e,n.cells)})},al=function(e,n){return n.unmergable.filter(function(n){return cl(e,n)})},fl=function(n,e,t,r){for(var o=Rt(n).rows,u=!0,i=0;i<o.length;i++)for(var c=0;c<Tt(o[0]);c++){var l=o[i],a=St(l,c),f=t(a.element,e);!0===f&&!1===u?wt(l,c,Yn(r(),!0,a.isLocked)):!0===f&&(u=!1)}return n},sl=function(n,t,i,c){var e,r,l=Rt(n).rows;return 0<t&&t<l.length&&(e=l[t-1].cells,r=i,e=P(e,function(n,e){return O(n,function(n){return r(n.element,e.element)})?n:n.concat([e])},[]),I(e,function(n){for(var o=S.none(),u=t;u<l.length;u++)for(var e=0;e<Tt(l[0]);e++)!function(e){var t=l[u],r=St(t,e);i(r.element,n.element)&&(o=o.isNone()?S.some(c()):o).each(function(n){wt(t,e,Yn(n,!0,r.isLocked))})}(e)})),n},dl=function(t){return{is:function(n){return t===n},isValue:C,isError:m,getOr:h(t),getOrThunk:h(t),getOrDie:h(t),or:function(n){return dl(t)},orThunk:function(n){return dl(t)},fold:function(n,e){return e(t)},map:function(n){return dl(n(t))},mapError:function(n){return dl(t)},each:function(n){n(t)},bind:function(n){return n(t)},exists:function(n){return n(t)},forall:function(n){return n(t)},toOptional:function(){return S.some(t)}}},ml=function(t){return{is:m,isValue:m,isError:C,getOr:f,getOrThunk:function(n){return n()},getOrDie:function(){return n=String(t),function(){throw new Error(n)}();var n},or:f,orThunk:function(n){return n()},fold:function(n,e){return n(t)},map:function(n){return ml(t)},mapError:function(n){return ml(n(t))},each:y,bind:function(n){return ml(t)},exists:m,forall:C,toOptional:S.none}},gl={value:dl,error:ml,fromOption:function(n,e){return n.fold(function(){return ml(e)},dl)}},pl=function(n,e){return{rowDelta:0,colDelta:Tt(n[0])-Tt(e[0])}},hl=function(n,e){return{rowDelta:n.length-e.length,colDelta:0}},bl=function(n,e,t,r){var o="colgroup"===e.section?t.col:t.cell;return A(n,function(n){return Yn(o(),!0,r(n))})},vl=function(t,n,r,o){return t.concat(A(n,function(){var n=t[t.length-1],e=bl(n.cells.length,n,r,function(n){return qn(o,n.toString())});return yt(n,e)}))},wl=function(n,t,r,o){return k(n,function(n){var e=bl(t,n,r,m);return bt(n,o,e)})},yl=function(n,e,t){var r=e.colDelta<0?wl:f,o=e.rowDelta<0?vl:f,u=At(n),i=Tt(n[0]),u=O(u,function(n){return n===i-1}),n=r(n,Math.abs(e.colDelta),t,u?i-1:i),u=At(n);return o(n,Math.abs(e.rowDelta),t,j(u,C))},Cl=function(n,e,t,r,o,u){for(var i,c,l,a=n.row,f=n.column,s=a+t.length,d=f+Tt(t[0])+u.length,m=j(u,C),g=a;g<s;g++)for(var p,h,b=0,v=f;v<d;v++)m[v]?b++:(h=v,l=void 0,l=w(c=o,St((i=e)[p=g],h).element),c=i[p],1<i.length&&1<Tt(c)&&(0<h&&l(xt(c,h-1))||h<c.cells.length-1&&l(xt(c,h+1))||0<p&&l(xt(i[p-1],h))||p<i.length-1&&l(xt(i[p+1],h)))&&fl(e,xt(e[g],v),o,r.cell),h=(p=St(t[g-a],v-f-b)).element,h=r.replace(h),wt(e[g],v,Yn(h,!0,p.isLocked)));return e},Sl=function(e,t,n){return B(n,function(n){return n>=e.column&&n<=Tt(t[0])+e.column})},xl=function(n,t,e,r,o){var u,i,c,l,a=At(t),f=(u=n,c=a,l=Tt((i=t)[0]),n=Rt(i).cols.length+u.row,i=A(l-u.column,function(n){return n+u.column}),{row:n,column:E(i,function(e){return L(c,function(n){return n!==e})}).getOr(l-1)}),s=Rt(e).rows,d=Sl(f,s,a);return function(n,e,t){if(n.row>=e.length||n.column>Tt(e[0]))return gl.error("invalid start address out of table bounds, row: "+n.row+", column: "+n.column);var r=e.slice(n.row),e=r[0].cells.slice(n.column),n=Tt(t[0]),t=t.length;return gl.value({rowDelta:r.length-t,colDelta:e.length-n})}(f,t,s).map(function(n){var e=q(q({},n),{colDelta:n.colDelta-d.length}),n=yl(t,e,r),e=At(n),e=Sl(f,s,e);return Cl(f,n,s,r,o,e)})},Tl=function(t,n,e,r,o){var u,i,c;l=n,u=t,i=o,c=r.cell,0<u&&u<l[0].cells.length&&I(l,function(n){var e=n.cells[u-1],t=n.cells[u];i(t.element,e.element)&&wt(n,u,Yn(c(),!0,t.isLocked))});var l=hl(e,n),a=yl(e,l,r),l=hl(n,a),r=yl(n,l,r);return k(r,function(n,e){return bt(n,t,a[e].cells)})},Rl=function(n,e,t,r,o){sl(e,n,o,r.cell);var u,i,c=At(e),l=pl(e,t),o=q(q({},l),{colDelta:l.colDelta-c.length}),l=yl(e,o,r),c=Rt(l),o=c.cols,c=c.rows,l=At(l),e=pl(t,e),e=q(q({},e),{colDelta:e.colDelta+l.length}),t=(u=r,i=l,k(t,function(r){return P(i,function(n,e){var t=bl(1,r,u,C)[0];return vt(n,e,t)},r)})),r=yl(t,e,r);return o.concat(c.slice(0,n)).concat(r).concat(c.slice(n,c.length))},Dl=function(n,t,e,r,o){var u=Rt(n),i=u.rows,c=u.cols,n=i.slice(0,t),u=i.slice(t),e=Ct(i[e],function(n,e){return 0<t&&t<i.length&&r(xt(i[t-1],e),xt(i[t],e))?St(i[t],e):Yn(o(n.element,r),!0,n.isLocked)});return c.concat(n).concat([e]).concat(u)},Ol=function(n,t,r,o,u){return k(n,function(n){var e=0<t&&t<Tt(n)&&o(xt(n,t-1),xt(n,t)),e=function(n,e,t,r,o,u,i){if("colgroup"!==t&&r)return St(n,e);o=St(n,o);return Yn(i(o.element,u),!0,!1)}(n,t,n.section,e,r,o,u);return vt(n,t,e)})},Al=function(n,t,r,o){return k(n,function(n){return Ct(n,function(n){return e=n,O(t,function(n){return r(e.element,n.element)})?Yn(o(n.element,r),!0,n.isLocked):n;var e})})},kl=function(n,e,t,r){return xt(n[e],t)!==undefined&&0<e&&r(xt(n[e-1],t),xt(n[e],t))},Il=function(n,e,t){return 0<e&&t(xt(n,e-1),xt(n,e))},Bl=function(t,r,o,n){var e=Rt(t).rows,e=W(e,function(n,e){return kl(t,e,r,o)||Il(n,r,o)?[]:[St(n,r)]});return Al(t,e,o,n)},Ml=function(n,t,r,e){var o=Rt(n).rows,u=o[t],i=W(u.cells,function(n,e){return kl(o,t,e,r)||Il(u,e,r)?[]:[n]});return Al(n,i,r,e)},Pl=function(n){return P(n,function(n,e){return O(n,function(n){return n.column===e.column})?n:n.concat([e])},[]).sort(function(n,e){return n.column-e.column})},El=function(n){return{element:n,colspan:Ze(n,"colspan",1),rowspan:Ze(n,"rowspan",1)}},Nl=function(n){return ze(n,"scope").map(function(n){return n.substr(0,3)})},sn=function(e,t){void 0===t&&(t=El);var r=Wo(S.none()),o=function(n){n=t(n);return"col"!==Qn((n=n).element)?e.cell(n):e.col(n)},u=function(n){var e=o(n);return r.get().isNone()&&r.set(S.some(e)),i=S.some({item:n,replacement:e}),e},i=S.none();return{getOrInit:function(e,t){return i.fold(function(){return u(e)},function(n){return t(e,n.item)?n.replacement:u(e)})},cursor:r.get}},dn=function(o,c){return function(t){var r=Wo(S.none()),u=[],i=function(n){var e=t.replace(n,c,{scope:o});return u.push({item:n,sub:e}),r.get().isNone()&&r.set(S.some(e)),e};return{replaceOrInit:function(e,t){return"col"===Qn(e)?e:(r=e,o=t,E(u,function(n){return o(n.item,r)}).fold(function(){return i(e)},function(n){return t(e,n.item)?n.sub:i(e)}));var r,o},cursor:r.get}}},ne=function(r){var e=Wo(S.none());return{unmerge:function(t){e.get().isNone()&&e.set(S.some(t));var n=Nl(t);return n.each(function(n){return We(t,"scope",n)}),function(){var e=r.cell({element:t,colspan:1,rowspan:1});return Qe(e,"width"),Qe(t,"width"),n.each(function(n){return We(e,"scope",n)}),e}},merge:function(r){return Qe(r[0],"width"),function(){var n=Ve(k(r,Nl));if(0===n.length)return S.none();var e=n[0],t=["row","col"];return O(n,function(n){return n!==e&&D(t,n)})?S.none():S.from(e)}().fold(function(){return Fe(r[0],"scope")},function(n){return We(r[0],"scope",n+"group")}),h(r[0])},cursor:e.get}},_l=["body","p","div","article","aside","figcaption","figure","footer","header","nav","section","ol","ul","table","thead","tfoot","tbody","caption","tr","td","th","h1","h2","h3","h4","h5","h6","blockquote","pre","address"],Wl=tr(),Ll=function(n){return function(n,e){e=n.property().name(e);return D(_l,e)}(Wl,n)},jl=function(n){return function(n,e){e=n.property().name(e);return D(["ol","ul"],e)}(Wl,n)},zl=function(n){return n=n,D(["br","img","hr","input"],Wl.property().name(n))},Fl=function(n){var e,u=function(n){return"br"===Qn(n)},t=function(o){return Yo(o).bind(function(t){var r=de(t).map(function(n){return!!Ll(n)||!!zl(n)&&"img"!==Qn(n)}).getOr(!1);return ae(t).map(function(n){return!0===r||("li"===Qn(e=n)||Be(e,jl).isSome())||u(t)||Ll(n)&&!Mn(o,n)?[]:[An.fromTag("br")];var e})}).getOr([])},r=0===(e=W(n,function(n){var e=me(n);return L(e,function(n){return u(n)||re(n)&&0===Qt(n).trim().length})?[]:e.concat(t(n))})).length?[An.fromTag("br")]:e;Gt(n[0]),Kt(n[0],r)},pe=function(n){0===at(n).length&&Xt(n)},Hl=function(n,e){return{grid:n,cursor:e}},Vl=function(n,e,t){var r=Rt(n).rows;return Ul(r,e,t).orThunk(function(){return Ul(r,0,0)})},Ul=function(n,e,t){return S.from(n[e]).bind(function(n){return S.from(n.cells[t]).bind(function(n){return S.from(n.element)})})},ql=function(n,e,t){var r=Rt(n).rows;return Hl(n,Ul(r,e,t))},$l=function(n){return P(n,function(n,e){return O(n,function(n){return n.row===e.row})?n:n.concat([e])},[]).sort(function(n,e){return n.row-e.row})},Kl=function(n,e,t){var r,n=(r=t.section,gt(n,function(){return r})),n=Bt.generate(n);return Jc(n,e,!0)},Gl=function(n,e){e=B(n,e);return 0===e.length?S.some("td"):e.length===n.length?S.some("th"):S.none()},n=function(n,e,t,r){var o=Bt.generate(e),e=r.getWidths(o,r);Du(o,e,r)},t=function(n,e,t,r,o){var u=Bt.generate(e),i=r.getWidths(u,r),e=r.pixelWidth(),e=o.calcRedestributedWidths(i,e,t.pixelDelta,r.isRelative),t=e.newSizes,e=e.delta;Du(u,t,r),r.adjustTableWidth(e)},Xl=function(n,e){return O(e,function(n){return 0===n.column&&n.isLocked})},Yl=function(e,n){return O(n,function(n){return n.column+n.colspan>=e.grid.columns&&n.isLocked})},Jl=function(n,e){var t=kr(n),e=Pl(e);return P(e,function(n,e){return n+t[e.column].map(Ar).getOr(0)},0)},o=function(t){return function(e,n){return ul(e,n).filter(function(n){return!(t?Xl:Yl)(e,n)}).map(function(n){return{details:n,pixelDelta:Jl(e,n)}})}},an=function(t){return function(e,n){return ol(e,n).filter(function(n){return!(t?Xl:Yl)(e,n.cells)})}},Ql=tl(function(n,e,t,r){var o=e[0].row,u=$l(e),n=M(u,function(n,e){return{grid:Dl(n.grid,o,e.row+n.delta,t,r.getOrInit),delta:n.delta+1}},{grid:n,delta:0}).grid;return ql(n,o,e[0].column)},ul,y,y,sn),Zl=tl(function(n,e,t,r){var o=$l(e),u=o[o.length-1],i=u.row+u.rowspan,n=M(o,function(n,e){return Dl(n,i,e.row,t,r.getOrInit)},n);return ql(n,i,e[0].column)},ul,y,y,sn),na=tl(function(n,e,t,r){var o=e.details,e=Pl(o),u=e[0].column,n=M(e,function(n,e){return{grid:Ol(n.grid,u,e.column+n.delta,t,r.getOrInit),delta:n.delta+1}},{grid:n,delta:0}).grid;return ql(n,o[0].row,u)},o(!0),t,y,sn),ea=tl(function(n,e,t,r){var o=e.details,e=o[o.length-1],u=e.column+e.colspan,e=Pl(o),n=M(e,function(n,e){return Ol(n,u,e.column,t,r.getOrInit)},n);return ql(n,o[0].row,u)},o(!1),t,y,sn),ta=tl(function(n,e,t,r){var o,e=Pl(e.details),n=(n=n,o=k(e,function(n){return n.column}),W(n,function(n){var e=n.cells,e=M(o,function(n,e){return 0<=e&&e<n.length?n.slice(0,e).concat(n.slice(e+1)):n},e);return 0<e.length?[Jn(e,n.section)]:[]})),e=Vl(n,e[0].row,e[0].column);return Hl(n,e)},function(e,n){return il(e,n).map(function(n){return{details:n,pixelDelta:-Jl(e,n)}})},t,pe,sn),ra=tl(function(n,e,t,r){var o,u,i=$l(e),n=(o=n,u=i[0].row,n=i[i.length-1].row,i=Rt(o),o=i.rows,i.cols.concat(o.slice(0,u)).concat(o.slice(n+1))),e=Vl(n,e[0].row,e[0].column);return Hl(n,e)},ul,y,pe,sn),oa=(tl(function(n,e,t,r){r=Bl(n,e.column,t,r.replaceOrInit);return ql(r,e.row,e.column)},fn,y,y,dn("row","th")),tl(function(n,e,t,r){var o=Pl(e),n=P(o,function(n,e){return Bl(n,e.column,t,r.replaceOrInit)},n);return ql(n,e[0].row,e[0].column)},il,y,y,dn("row","th"))),ua=(tl(function(n,e,t,r){r=Bl(n,e.column,t,r.replaceOrInit);return ql(r,e.row,e.column)},fn,y,y,dn(null,"td")),tl(function(n,e,t,r){var o=Pl(e),n=P(o,function(n,e){return Bl(n,e.column,t,r.replaceOrInit)},n);return ql(n,e[0].row,e[0].column)},il,y,y,dn(null,"td"))),ia=(tl(function(n,e,t,r){r=Ml(n,e.row,t,r.replaceOrInit);return ql(r,e.row,e.column)},rl,y,y,dn("col","th")),tl(function(n,e,t,r){var o=$l(e),n=P(o,function(n,e){return Ml(n,e.row,t,r.replaceOrInit)},n);return ql(n,e[0].row,e[0].column)},ul,y,y,dn("col","th")),tl(function(n,e,t,r){r=Ml(n,e.row,t,r.replaceOrInit);return ql(r,e.row,e.column)},rl,y,y,dn(null,"td")),tl(function(n,e,t,r){var o=$l(e),n=P(o,function(n,e){return Ml(n,e.row,t,r.replaceOrInit)},n);return ql(n,e[0].row,e[0].column)},ul,y,y,dn(null,"td")),tl(function(n,e,t,r){var o=e.cells;Fl(o);r=function(n,e,t){var r=Rt(n).rows;if(0===r.length)return n;for(var o=e.startRow;o<=e.finishRow;o++)for(var u=e.startCol;u<=e.finishCol;u++){var i=r[o],c=St(i,u).isLocked;wt(i,u,Yn(t(),!1,c))}return n}(n,e.bounds,r.merge(o));return Hl(r,S.from(o[0]))},ll,n,y,ne)),ca=tl(function(n,e,t,r){n=M(e,function(n,e){return fl(n,e,t,r.unmerge(e))},n);return Hl(n,S.from(e[0]))},al,n,y,ne),la=tl(function(n,t,e,r){var o=function(n,e){n=Bt.fromTable(n);return Jc(n,e,!0)}(t.clipboard,t.generators),u={row:t.row,column:t.column};return xl(u,n,o,t.generators,e).fold(function(){return Hl(n,S.some(t.element))},function(n){var e=Vl(n,t.row,t.column);return Hl(n,e)})},function(e,t){return lt(t.element).bind(function(n){return nl(e,n).map(function(n){return q(q({},n),{generators:t.generators,clipboard:t.clipboard})})})},n,y,sn),aa=tl(function(n,e,t,r){var o=Rt(n).rows,u=e.cells[0].column,o=o[e.cells[0].row],o=Kl(e.clipboard,e.generators,o),t=Tl(u,n,o,e.generators,t),e=Vl(t,e.cells[0].row,e.cells[0].column);return Hl(t,e)},an(!0),y,y,sn),fa=tl(function(n,e,t,r){var o=Rt(n).rows,u=e.cells[e.cells.length-1].column+e.cells[e.cells.length-1].colspan,o=o[e.cells[0].row],o=Kl(e.clipboard,e.generators,o),t=Tl(u,n,o,e.generators,t),e=Vl(t,e.cells[0].row,e.cells[0].column);return Hl(t,e)},an(!1),y,y,sn),sa=tl(function(n,e,t,r){var o=Rt(n).rows,u=e.cells[0].row,o=o[u],o=Kl(e.clipboard,e.generators,o),t=Rl(u,n,o,e.generators,t),e=Vl(t,e.cells[0].row,e.cells[0].column);return Hl(t,e)},ol,y,y,sn),da=tl(function(n,e,t,r){var o=Rt(n).rows,u=e.cells[e.cells.length-1].row+e.cells[e.cells.length-1].rowspan,o=o[e.cells[0].row],o=Kl(e.clipboard,e.generators,o),t=Rl(u,n,o,e.generators,t),e=Vl(t,e.cells[0].row,e.cells[0].column);return Hl(t,e)},ol,y,y,sn),ma=function(n,e){var o=Bt.fromTable(n);return ul(o,e).bind(function(n){var e=n[n.length-1],t=n[0].column,r=e.column+e.colspan,e=_(k(o.all,function(n){return B(n.cells,function(n){return n.column>=t&&n.column<r})}));return Gl(e,function(n){return"th"===Qn(n.element)})}).getOr("")},ga=function(n){return lu(n.parentNode)},pa=function(n,e){var t="thead"===ga(e),e=!O(e.cells,function(n){return"th"!==lu(n)});return t||e?S.some({thead:t,ths:e}):S.none()},ha=function(n,e){return"thead"===(t=pa(0,e).fold(function(){return ga(e)},function(n){return"thead"}))?"header":"tfoot"===t?"footer":"body";var t},ba=function(e,n,t){var r,o,u=e.getParent(n,"table"),i=n.parentNode,c=lu(i);t!==c&&((r=e.select(t,u)[0])||(r=e.create(t),o=u.firstChild,"thead"===t?V(Re(An.fromDom(u),"caption,colgroup")).fold(function(){return u.insertBefore(r,o)},function(n){return e.insertAfter(r,n.dom)}):u.appendChild(r)),"tbody"===t&&"thead"===c&&r.firstChild?r.insertBefore(n,r.firstChild):r.appendChild(n),i.hasChildNodes()||e.remove(i))},va=function(n,e,t,r){var o=n.dom,t=function(n,e,t){if(c(t)&&lu(e)!==t){t=n.dom.rename(e,t);return ji(n,t),t}return e}(n,e,t);return u(r)||o.setAttrib(t,"scope",r),t},wa=function(e,n,t,r){return I(n,function(n){return va(e,n,t,r)})},ya=function(n,e,t){var r,o,u=n.dom;"header"===t?(r="auto"===(r=yc(n))?(o=st(An.fromDom(e.cells[0])).map(dt).getOr([]),U(o,function(n){return pa(0,n.dom)}).map(function(n){return n.thead&&n.ths?"sectionCells":n.thead?"section":"cells"}).getOr("section")):r,wa(n,e.cells,"section"===r?"td":"th","col"),ba(u,e,"cells"===r?"tbody":"thead")):(wa(n,e.cells,"td",null),ba(u,e,"footer"===t?"tfoot":"tbody"))},an=function(o){return function(n,e){var t,r=Qn(n),n="col"===r||"colgroup"===r?st(t=n).bind(function(n){return gr(n,wu.firstSelectedSelector)}).fold(function(){return t},function(n){return n[0]}):n;return Ne(n,o,e)}},Ca=an("th,td"),Sa=an("th,td,caption"),xa=function(n,e,t){return Ca(n,t).map(function(n){return vu(e)}).getOr([])},Ta=function(n,t){var e=Ca(n),r=e.bind(function(n){return st(n)}).map(dt);return n=r,r=function(e,n){return B(n,function(n){return O(cu(n.dom.cells),function(n){return"1"===je(n,t)||Mn(n,e)})})},((e=e).isSome()&&n.isSome()?S.some(r(e.getOrDie(),n.getOrDie())):S.none()).getOr([])},Ra=function(s,n,r){var e=function(n){return"table"===Qn(au(n))},d=Tc(s),t=xc(s)?y:Uc,o=function(i,c,l,a,f){return function(n,e){gu(n);var t=a(),r=An.fromDom(s.getDoc()),o=uu(l,r,d),u=Ac(s,n),r=(xc(s)?Pu:Eu)();return c(n)?i(t,n,e,o,u,r).bind(function(n){return I(n.newRows,function(n){Li(s,n.dom)}),I(n.newCells,function(n){ji(s,n.dom)}),n.cursor.map(function(n){var e=Hc(Vc,n),n=s.dom.createRng();return n.setStart(e.element.dom,e.offset),n.setEnd(e.element.dom,e.offset),{rng:n,effect:f}})}):S.none()}},u=o(ra,function(n){return!1===e(s)||1<Ju(n).rows},y,n,Hi),i=o(ta,function(n){return!1===e(s)||1<Ju(n).columns},y,n,Hi),c=o(Ql,C,y,n,Hi),l=o(Zl,C,y,n,Hi),a=o(na,C,t,n,Hi),f=o(ea,C,t,n,Hi),m=o(ia,C,y,n,Hi),g=o(ca,C,y,n,Hi),p=o(aa,C,y,n,Hi),h=o(fa,C,y,n,Hi),b=o(sa,C,y,n,Hi),v=o(da,C,y,n,Hi),t=o(la,C,y,n,Hi),w=function(n,e){return Un(n,"type").filter(function(n){return D(e,n)})};return{deleteRow:u,deleteColumn:i,insertRowsBefore:c,insertRowsAfter:l,insertColumnsBefore:a,insertColumnsAfter:f,mergeCells:m,unmergeCells:g,pasteColsBefore:p,pasteColsAfter:h,pasteRowsBefore:b,pasteRowsAfter:v,pasteCells:t,setTableCellType:function(t,n){return w(n,["td","th"]).each(function(n){var e=k(xa(bu(t),r),function(n){return n.dom});wa(t,e,n,null)})},setTableRowType:function(t,n){return w(n,["header","body","footer"]).each(function(e){k(Ta(bu(t),wu.selected),function(n){return ya(t,n.dom,e)})})},makeColumnsHeader:o(oa,C,y,n,Hi),unmakeColumnsHeader:o(ua,C,y,n,Hi),getTableRowType:function(n){var e=Ta(bu(n),wu.selected);if(0<e.length){var t=k(e,function(n){return ha(0,n.dom)}),n=D(t,"header"),e=D(t,"footer");if(n||e){t=D(t,"body");return!n||t||e?n||t||!e?"":"footer":"header"}return"body"}},getTableCellType:function(n){return Gl(xa(bu(n),r),function(n){return"th"===Qn(n)}).getOr("")},getTableColType:ma}},Da={styles:{"border-collapse":"collapse",width:"100%"},attributes:{border:"1"},colGroups:!1},Oa=function(n,e,t,r){for(var o=An.fromTag("tr"),u=0;u<n;u++){var i=r<e||u<t?An.fromTag("th"):An.fromTag("td");u<t&&We(i,"scope","row"),r<e&&We(i,"scope","col"),Ut(i,An.fromTag("br")),Ut(o,i)}return o},Aa=function(n){var e=An.fromTag("colgroup");return A(n,function(){return Ut(e,An.fromTag("col"))}),e},ka=function(n,e,t,r){return A(n,function(n){return Oa(e,t,r,n)})},Ia=function(n,e){n.selection.select(e.dom,!0),n.selection.collapse(!0)},Ba=function(r,t,o,u,i){var c=fc(r),l={styles:c,attributes:ac(r),colGroups:r.getParam("table_use_colgroups",!1,"boolean")};return r.undoManager.ignore(function(){var n=function(n,e,t,r,o,u){void 0===u&&(u=Da);var i=An.fromTag("table"),c="cells"!==o;Ge(i,u.styles),Le(i,u.attributes),u.colGroups&&Ut(i,Aa(e));var l=Math.min(n,t);c&&0<t&&(u=An.fromTag("thead"),Ut(i,u),a=ka(t,e,"sectionCells"===o?l:0,r),Kt(u,a));var a=An.fromTag("tbody");Ut(i,a);r=ka(c?n-l:n,e,c?0:t,r);return Kt(a,r),i}(o,t,i,u,yc(r),l);We(n,"data-mce-id","__mce");var e,n=(e=n,n=An.fromTag("div"),e=An.fromDom(e.dom.cloneNode(!0)),Ut(n,e),n.dom.innerHTML);r.insertContent(n),r.addVisual()}),Ee(au(r),'table[data-mce-id="__mce"]').map(function(n){var e,t;return vc(r)?Mc(r,n):wc(r)?Pc(n):(bc(r)||(t=c.width,g(t)&&-1!==t.indexOf("%")))&&Bc(r,n),gu(n),Fe(n,"data-mce-id"),e=r,I(De(n,"tr"),function(n){Li(e,n.dom),I(De(n,"th,td"),function(n){ji(e,n.dom)})}),t=r,Ee(n,"td,th").each(w(Ia,t)),n.dom}).getOr(null)},Ma=function(n,e,t,r,o){void 0===r&&(r={});var u=function(n){return i(n)&&0<n};if(u(e)&&u(t)){u=r.headerRows||0,r=r.headerColumns||0;return Ba(n,t,e,r,u)}return console.error(o),null},Pa=function(n){return function(){return n().fold(function(){return[]},function(n){return k(n,function(n){return n.dom})})}},Ea=function(e){return function(n){n=0<n.length?S.some(cu(n)):S.none();e(n)}},Na=function(n,e,t,r){return{insertTable:(o=n,function(n,e,t){t=Ma(o,e,n,t=void 0===t?{}:t,"Invalid values for insertTable - rows and columns values are required to insert a table.");return o.undoManager.add(),t}),setClipboardRows:Ea(e.setRows),getClipboardRows:Pa(e.getRows),setClipboardCols:Ea(e.setColumns),getClipboardCols:Pa(e.getColumns),resizeHandler:t,selectionTargets:r};var o},_a=function(n,e,t){var r=Ze(n,e,1);1===t||r<=1?Fe(n,e):We(n,e,Math.min(t,r))},Wa=function(n,e){var u=Bt.fromTable(n);return il(u,e).map(function(n){var t,r,e=n[n.length-1],o=n[0].column,n=e.column+e.colspan,e=function(n,e,t){if(Bt.hasColumns(n)){var r=B(Bt.justColumns(n),function(n){return n.column>=e&&n.column<t}),n=k(r,function(n){n=Tr(n.element);return _a(n,"span",t-e),n}),r=An.fromTag("colgroup");return Kt(r,n),[r]}return[]}(u,o,n),n=(t=o,r=n,k(u.all,function(n){var e=B(n.cells,function(n){return n.column>=t&&n.column<r}),n=k(e,function(n){n=Tr(n.element);return _a(n,"colspan",r-t),n}),e=An.fromTag("tr");return Kt(e,n),e}));return $($([],e),n)})},La=function(n,e,t){var r=Bt.fromTable(n);return ul(r,e).bind(function(n){var e=Jc(r,t,!1),n=Rt(e).rows.slice(n[0].row,n[n.length-1].row+n[n.length-1].rowspan),n=W(n,function(n){var e=B(n.cells,function(n){return!n.isLocked});return 0<e.length?[q(q({},n),{cells:e})]:[]}),n=Zc(n,t);return Ue(0<n.length,n)}).map(function(n){return k(n,function(n){var t=xr(n.element);return I(n.cells,function(n){var e=Tr(n.element);qc(e,"colspan",n.colspan,1),qc(e,"rowspan",n.rowspan,1),Ut(t,e)}),t})})},ja=tinymce.util.Tools.resolve("tinymce.util.Tools"),za=function(o,n,u){return function(n,e){for(var t=0;t<e.length;t++){var r=o.getStyle(e[t],u);if((n=void 0===n?r:n)!==r)return""}return n}(void 0,o.select("td,th",n))},Fa=function(n,e,t){t&&n.formatter.apply("align"+t,{},e)},Ha=function(e,t){ja.each("left center right".split(" "),function(n){e.formatter.remove("align"+n,{},t)})},Va=[{text:"None",value:""},{text:"Top",value:"top"},{text:"Middle",value:"middle"},{text:"Bottom",value:"bottom"}],Ua=function(n,e){return(e||[]).concat(k(n,function(n){var e=n.text||n.title;return $n(n,"menu")?{text:e,items:Ua(n.menu)}:{text:e,value:n.value}}))},qa=function(e){return function(n){return on(n,"rgb")?e.toHex(n):n}},$a=function(n,e){e=An.fromDom(e);return{borderwidth:Je(e,"border-width").getOr(""),borderstyle:Je(e,"border-style").getOr(""),bordercolor:Je(e,"border-color").map(qa(n)).getOr(""),backgroundcolor:Je(e,"background-color").map(qa(n)).getOr("")}},Ka=function(n){var o=n[0],n=n.slice(1);return I(n,function(n){I(_n(o),function(r){Ln(n,function(n,e){var t=o[r];""!==t&&r===e&&t!==n&&(o[r]="")})})}),o},tl=function(n,e,t,r){return E(n,function(n){return t.formatter.matchNode(r,e+n)}).getOr("")},Ga=w(tl,["left","center","right"],"align"),Xa=w(tl,["top","middle","bottom"],"valign"),Ya=[{name:"width",type:"input",label:"Width"},{name:"height",type:"input",label:"Height"},{name:"celltype",type:"listbox",label:"Cell type",items:[{text:"Cell",value:"td"},{text:"Header cell",value:"th"}]},{name:"scope",type:"listbox",label:"Scope",items:[{text:"None",value:""},{text:"Row",value:"row"},{text:"Column",value:"col"},{text:"Row group",value:"rowgroup"},{text:"Column group",value:"colgroup"}]},{name:"halign",type:"listbox",label:"Horizontal align",items:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]},{name:"valign",type:"listbox",label:"Vertical align",items:Va}],Ja=function(n){return Ya.concat(function(n){n=Ua(pc(n));return 0<n.length?S.some({name:"class",type:"listbox",label:"Class",items:n}):S.none()}(n).toArray())},Qa=function(n,e){n=[{name:"borderstyle",type:"listbox",label:"Border style",items:[{text:"Select...",value:""}].concat(lc(n))},{name:"bordercolor",type:"colorinput",label:"Border color"},{name:"backgroundcolor",type:"colorinput",label:"Background color"}];return{title:"Advanced",name:"advanced",items:"cell"===e?[{name:"borderwidth",type:"input",label:"Border width"}].concat(n):n}},sn=function(u){return function(t,r){var o=t.dom;return{setAttrib:function(n,e){u&&!e||o.setAttrib(r,n,e)},setStyle:function(n,e){u&&!e||o.setStyle(r,n,e)},setFormat:function(n,e){u&&!e||(""===e?t.formatter.remove(n,{value:null},r,!0):t.formatter.apply(n,{value:e},r))}}}},Za={normal:sn(!1),ifTruthy:sn(!0)},nf=function(t){return st(t[0]).map(function(n){var e=Bt.fromTable(n),n=Bt.justCells(e),n=B(n,function(e){return O(t,function(n){return Mn(e.element,n)})});return k(n,function(n){return{element:n.element.dom,column:Bt.getColumnAt(e,n.column).map(function(n){return n.element.dom})}})})},ef=function(a,n,t,f){var e,r,s=1===n.length,o=Fn(f,function(n,e){return t[e]!==n});0<Vn(o)&&1<=n.length&&(e=st(n[0]),nf(n).each(function(n){I(n,function(n){var e,t,r,o,u,i=va(a,n.element,f.celltype),c=s?Za.normal(a,i):Za.ifTruthy(a,i),l=n.column.map(function(n){return s?Za.normal(a,n):Za.ifTruthy(a,n)}).getOr(c);e=l,n=f,(l=c).setAttrib("scope",n.scope),l.setAttrib("class",n["class"]),l.setStyle("height",mu(n.height)),e.setStyle("width",mu(n.width)),sc(a)&&(u=f,(o=c).setFormat("tablecellbackgroundcolor",u.backgroundcolor),o.setFormat("tablecellbordercolor",u.bordercolor),o.setFormat("tablecellborderstyle",u.borderstyle),o.setFormat("tablecellborderwidth",mu(u.borderwidth))),s&&(Ha(a,i),t=a,r=i,ja.each("top middle bottom".split(" "),function(n){t.formatter.remove("valign"+n,{},r)})),f.halign&&Fa(a,i,f.halign),f.valign&&(o=a,u=i,(i=f.valign)&&o.formatter.apply("valign"+i,{},u))})}),r=0<Vn(Fn(o,function(n,e){return"scope"!==e&&"celltype"!==e})),e.each(function(n){return zi(a,n.dom,{structure:qn(o,"celltype"),style:r})}))},tf=function(n,e,t,r){var o=r.getData();r.close(),n.undoManager.transact(function(){ef(n,e,t,o),n.focus()})},rf=function(i,n){n=nf(n).map(function(n){return k(n,function(n){return e=i,t=n.element,r=sc(i),o=n.column,u=e.dom,n=o.getOr(t),q({width:(o=function(n,e){return u.getStyle(n,e)||u.getAttrib(n,e)})(n,"width"),height:o(t,"height"),scope:u.getAttrib(t,"scope"),celltype:lu(t),"class":u.getAttrib(t,"class",""),halign:Ga(e,t),valign:Xa(e,t)},r?$a(u,t):{});var e,t,r,o,u})});return Ka(n.getOrDie())},of=function(n,e){var t,r,o=xa(bu(n),e);0!==o.length&&(t=rf(n,o),r={type:"tabpanel",tabs:[{title:"General",name:"general",items:Ja(n)},Qa(n,"cell")]},e={type:"panel",items:[{type:"grid",columns:2,items:Ja(n)}]},n.windowManager.open({title:"Cell Properties",size:"normal",body:sc(n)?r:e,buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:t,onSubmit:w(tf,n,o,t)}))},uf=[{type:"listbox",name:"type",label:"Row type",items:[{text:"Header",value:"header"},{text:"Body",value:"body"},{text:"Footer",value:"footer"}]},{type:"listbox",name:"align",label:"Alignment",items:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]},{label:"Height",name:"height",type:"input"}],cf=function(n){return uf.concat(function(n){n=Ua(n.getParam("table_row_class_list",[],"array"));return 0<n.length?S.some({name:"class",type:"listbox",label:"Class",items:n}):S.none()}(n).toArray())},lf=function(o,n,u,i){var e,t,c=1===n.length,r=Fn(i,function(n,e){return u[e]!==n});0<Vn(r)&&(I(n,function(n){i.type!==lu(n.parentNode)&&ya(o,n,i.type);var e,t,r=c?Za.normal(o,n):Za.ifTruthy(o,n);t=i,(e=r).setAttrib("class",t["class"]),e.setStyle("height",mu(t.height)),dc(o)&&(t=i,(r=r).setStyle("background-color",t.backgroundcolor),r.setStyle("border-color",t.bordercolor),r.setStyle("border-style",t.borderstyle)),i.align!==u.align&&(Ha(o,n),Fa(o,n,i.align))}),e=qn(r,"type"),t=!e||1<Vn(r),st(An.fromDom(n[0])).each(function(n){return zi(o,n.dom,{structure:e,style:t})}))},af=function(n,e,t,r){var o=r.getData();r.close(),n.undoManager.transact(function(){lf(n,e,t,o),n.focus()})},ff=function(o){var n,e,t,r=Ta(bu(o),wu.selected);0!==r.length&&(t=k(r,function(n){return e=o,t=n.dom,r=dc(o),n=e.dom,q({height:n.getStyle(t,"height")||n.getAttrib(t,"height"),"class":n.getAttrib(t,"class",""),type:ha(0,t),align:Ga(e,t)},r?$a(n,t):{});var e,t,r}),n=Ka(t),e={type:"tabpanel",tabs:[{title:"General",name:"general",items:cf(o)},Qa(o,"row")]},t={type:"panel",items:[{type:"grid",columns:2,items:cf(o)}]},o.windowManager.open({title:"Row Properties",size:"normal",body:dc(o)?e:t,buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:n,onSubmit:w(af,o,k(r,function(n){return n.dom}),n)}))},sf=function(n,e,t,r){if("TD"===e.tagName||"TH"===e.tagName)g(t)?n.setStyle(e,t,r):n.setStyle(e,t);else if(e.children)for(var o=0;o<e.children.length;o++)sf(n,e.children[o],t,r)},df=function(t,r,o,n){var u,i=t.dom,c=n.getData(),l=Fn(c,function(n,e){return o[e]!==n});n.close(),""===c["class"]&&delete c["class"],t.undoManager.transact(function(){var n,e;r||(n=parseInt(c.cols,10)||1,e=parseInt(c.rows,10)||1,r=Ba(t,n,e,0,0)),0<Vn(l)&&(function(n,e,t){var r,o=n.dom,u={},i={};if(u["class"]=t["class"],i.height=mu(t.height),o.getAttrib(e,"width")&&!gc(n)?u.width=(r=t.width)?r.replace(/px$/,""):"":i.width=mu(t.width),gc(n)?(i["border-width"]=mu(t.border),i["border-spacing"]=mu(t.cellspacing)):(u.border=t.border,u.cellpadding=t.cellpadding,u.cellspacing=t.cellspacing),gc(n)&&e.children)for(var c=0;c<e.children.length;c++)sf(o,e.children[c],{"border-width":mu(t.border),padding:mu(t.cellpadding)}),mc(n)&&sf(o,e.children[c],{"border-color":t.bordercolor});mc(n)&&(i["background-color"]=t.backgroundcolor,i["border-color"]=t.bordercolor,i["border-style"]=t.borderstyle),u.style=o.serializeStyle(q(q({},fc(n)),i)),o.setAttribs(e,q(q({},ac(n)),u))}(t,r,c),((u=i.select("caption",r)[0])&&!c.caption||!u&&c.caption)&&t.execCommand("mceTableToggleCaption"),""===c.align?Ha(t,r):Fa(t,r,c.align)),t.focus(),t.addVisual(),0<Vn(l)&&(e=!(n=qn(l,"caption"))||1<Vn(l),zi(t,r,{structure:n,style:e}))})},mf=function(n,e){var t,r,o,u,i,c,l,a=n.dom,r=(c=mc(r=n),u=fc(r),l=ac(r),c=c?(i=r.dom,{borderstyle:Un(u,"border-style").getOr(""),bordercolor:qa(i)(Un(u,"border-color").getOr("")),backgroundcolor:qa(i)(Un(u,"background-color").getOr(""))}):{},q(q(q(q(q(q({},{height:"",width:"100%",cellspacing:"",cellpadding:"",caption:!1,"class":"",align:"",border:""}),u),l),c),(o=u["border-width"],gc(r)&&o?{border:o}:Un(l,"border").fold(function(){return{}},function(n){return{border:n}}))),(i=Un(u,"border-spacing").or(Un(l,"cellspacing")).fold(function(){return{}},function(n){return{cellspacing:n}}),c=Un(u,"border-padding").or(Un(l,"cellpadding")).fold(function(){return{}},function(n){return{cellpadding:n}}),q(q({},i),c))));!1===e?(t=a.getParent(n.selection.getStart(),"table",n.getBody()))?(f=t,u=mc(o=n),l=o.dom,r=q({width:l.getStyle(f,"width")||l.getAttrib(f,"width"),height:l.getStyle(f,"height")||l.getAttrib(f,"height"),cellspacing:l.getStyle(f,"border-spacing")||l.getAttrib(f,"cellspacing"),cellpadding:l.getAttrib(f,"cellpadding")||za(o.dom,f,"padding"),border:(i=l,c=f,a=Je(An.fromDom(c),"border-width"),gc(o)&&a.isSome()?a.getOr(""):i.getAttrib(c,"border")||za(o.dom,c,"border-width")||za(o.dom,c,"border")),caption:!!l.select("caption",f)[0],"class":l.getAttrib(f,"class",""),align:Ga(o,f)},u?$a(l,f):{})):mc(n)&&(r.borderstyle="",r.bordercolor="",r.backgroundcolor=""):(r.cols="1",r.rows="1",mc(n)&&(r.borderstyle="",r.bordercolor="",r.backgroundcolor=""));var f=Ua(hc(n));0<f.length&&r["class"]&&(r["class"]=r["class"].replace(/\s*mce\-item\-table\s*/g,""));var s={type:"grid",columns:2,items:function(n,e,t){t=t?[{type:"input",name:"cols",label:"Cols",inputMode:"numeric"},{type:"input",name:"rows",label:"Rows",inputMode:"numeric"}]:[],n=n.getParam("table_appearance_options",!0,"boolean")?[{type:"input",name:"cellspacing",label:"Cell spacing",inputMode:"numeric"},{type:"input",name:"cellpadding",label:"Cell padding",inputMode:"numeric"},{type:"input",name:"border",label:"Border width"},{type:"label",label:"Caption",items:[{type:"checkbox",name:"caption",label:"Show caption"}]}]:[],e=0<e.length?[{type:"listbox",name:"class",label:"Class",items:e}]:[];return t.concat([{type:"input",name:"width",label:"Width"},{type:"input",name:"height",label:"Height"}]).concat(n).concat([{type:"listbox",name:"align",label:"Alignment",items:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]}]).concat(e)}(n,f,e)},e=mc(n)?{type:"tabpanel",tabs:[{title:"General",name:"general",items:[s]},Qa(n,"table")]}:{type:"panel",items:[s]};n.windowManager.open({title:"Table Properties",size:"normal",body:e,onSubmit:w(df,n,t,r),buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:r})},gf=function(n){return Sa(bu(n),du(n))},pf=function(i,r,t,c,e){var u=du(i),l=function(n){return st(n,u)},a=function(t){return Ca(bu(n=i),du(n)).bind(function(e){return l(e).map(function(n){return t(n,e)})});var n},f=function(e){return function(n){i.selection.setRng(n.rng),i.focus(),t.clear(e),gu(e),zi(i,e.dom,n.effect)}},o=function(t){return a(function(n,e){e=yu(c,n,e);t(n,e).each(f(n))})},n=function(){return a(function(n,e){var t=yu(c,n,e),e=uu(y,An.fromDom(i.getDoc()),S.none());return La(n,t,e)})},s=function(){return a(function(n,e){e=yu(c,n,e);return Wa(n,e)})},d=function(u,n){return n().each(function(n){var o=k(n,Tr);a(function(n,e){var t,r=iu(An.fromDom(i.getDoc())),r=(t=o,r=r,{selection:vu(c),clipboard:t,generators:r});u(n,r).each(f(n))})})};Ln({mceTableSplitCells:function(){return o(r.unmergeCells)},mceTableMergeCells:function(){return o(r.mergeCells)},mceTableInsertRowBefore:function(){return o(r.insertRowsBefore)},mceTableInsertRowAfter:function(){return o(r.insertRowsAfter)},mceTableInsertColBefore:function(){return o(r.insertColumnsBefore)},mceTableInsertColAfter:function(){return o(r.insertColumnsAfter)},mceTableDeleteCol:function(){return o(r.deleteColumn)},mceTableDeleteRow:function(){return o(r.deleteRow)},mceTableCutCol:function(){return s().each(function(n){e.setColumns(n),o(r.deleteColumn)})},mceTableCutRow:function(){return n().each(function(n){e.setRows(n),o(r.deleteRow)})},mceTableCopyCol:function(){return s().each(function(n){return e.setColumns(n)})},mceTableCopyRow:function(){return n().each(function(n){return e.setRows(n)})},mceTablePasteColBefore:function(){return d(r.pasteColsBefore,e.getColumns)},mceTablePasteColAfter:function(){return d(r.pasteColsAfter,e.getColumns)},mceTablePasteRowBefore:function(){return d(r.pasteRowsBefore,e.getRows)},mceTablePasteRowAfter:function(){return d(r.pasteRowsAfter,e.getRows)},mceTableDelete:function(){return gf(i).each(function(n){st(n,u).filter(b(u)).each(function(n){var e=An.fromText("");Ht(n,e),Xt(n),i.dom.isEmpty(i.getBody())?(i.setContent(""),i.selection.setCursorLocation()):((n=i.dom.createRng()).setStart(e.dom,0),n.setEnd(e.dom,0),i.selection.setRng(n),i.nodeChanged())})})},mceTableCellToggleClass:function(n,t){a(function(n,e){e=xa(e,c,u);I(e,function(n){i.formatter.toggle("tablecellclass",{value:t},n.dom)}),zi(i,n.dom,Fi)})},mceTableToggleClass:function(n,e){a(function(n){i.formatter.toggle("tableclass",{value:e},n.dom),zi(i,n.dom,Fi)})},mceTableToggleCaption:function(){gf(i).each(function(e){st(e,u).each(function(r){Pe(r,"caption").fold(function(){var n,e,t=An.fromTag("caption");Ut(t,An.fromText("Caption")),e=t,ge(n=r,0).fold(function(){Ut(n,e)},function(n){Ft(n,e)}),i.selection.setCursorLocation(t.dom,0)},function(n){ie("caption")(e)&&Bn("td",r).each(function(n){return i.selection.setCursorLocation(n.dom,0)}),Xt(n)}),zi(i,r.dom,Hi)})})},mceTableSizingMode:function(n,e){return t=e,gf(i).each(function(n){wc(i)||vc(i)||bc(i)||st(n,u).each(function(n){"relative"!==t||Ku(n)?"fixed"!==t||Gu(n)?"responsive"!==t||Xu(n)||Pc(n):Mc(i,n):Bc(i,n),gu(n),zi(i,n.dom,Hi)})});var t}},function(n,e){return i.addCommand(e,n)});var m=function(e,n){n.each(function(n){zi(e,n.dom,Hi)})};Ln({mceTableCellType:function(n,e){var t=st(bu(i),u);r.setTableCellType(i,e),m(i,t)},mceTableRowType:function(n,e){var t=st(bu(i),u);r.setTableRowType(i,e),m(i,t)}},function(n,e){return i.addCommand(e,n)}),i.addCommand("mceTableColType",function(n,e){return Un(e,"type").each(function(n){return o("th"===n?r.makeColumnsHeader:r.unmakeColumnsHeader)})}),Ln({mceTableProps:w(mf,i,!1),mceTableRowProps:w(ff,i),mceTableCellProps:w(of,i,c)},function(n,e){return i.addCommand(e,function(){return n()})}),i.addCommand("mceInsertTable",function(n,e){p(e)&&0<_n(e).length?Ma(i,e.rows,e.columns,e.options,"Invalid values for mceInsertTable - rows and columns values are required to insert a table."):mf(i,!0)}),i.addCommand("mceTableApplyCellStyle",function(n,e){var r,o=function(n){return"tablecell"+n.toLowerCase().replace("-","")};!p(e)||0!==(r=xa(bu(i),c,u)).length&&(function(n){for(var e in n)if(Wn.call(n,e))return!1;return!0}(e=Fn(e,function(n,e){return i.formatter.has(o(e))&&g(n)}))||(Ln(e,function(e,t){I(r,function(n){Za.normal(i,n.dom).setFormat(o(t),e)})}),l(r[0]).each(function(n){return zi(i,n.dom,Fi)})))})},hf=function(t,r,o){var n=du(t);Ln({mceTableRowType:function(){return r.getTableRowType(t)},mceTableCellType:function(){return r.getTableCellType(t)},mceTableColType:function(){return Ca(bu(t)).bind(function(t){return st(t,n).map(function(n){var e=yu(o,n,t);return r.getTableColType(n,e)})}).getOr("")}},function(n,e){return t.addQueryValueHandler(e,n)})},bf={tablecellbackgroundcolor:{selector:"td,th",styles:{backgroundColor:"%value"},remove_similar:!0},tablecellverticalalign:{selector:"td,th",styles:{"vertical-align":"%value"},remove_similar:!0},tablecellbordercolor:{selector:"td,th",styles:{borderColor:"%value"},remove_similar:!0},tablecellclass:{selector:"td,th",classes:["%value"],remove_similar:!0},tableclass:{selector:"table",classes:["%value"],remove_similar:!0},tablecellborderstyle:{selector:"td,th",styles:{borderStyle:"%value"},remove_similar:!0},tablecellborderwidth:{selector:"td,th",styles:{borderWidth:"%value"},remove_similar:!0}},vf=hr([{none:["current"]},{first:["current"]},{middle:["current","target"]},{last:["current"]}]),wf=q(q({},vf),{none:function(n){return void 0===n&&(n=undefined),vf.none(n)}}),yf=function(t,n){return st(t,n).bind(function(n){var e=at(n);return N(e,function(n){return Mn(t,n)}).map(function(n){return{index:n,all:e}})})},Cf=function(n,e,t,r){return{start:n,soffset:e,finish:t,foffset:r}},an=hr([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),Sf={before:an.before,on:an.on,after:an.after,cata:function(n,e,t,r){return n.fold(e,t,r)},getStart:function(n){return n.fold(f,f,f)}},xf=hr([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),Tf={domRange:xf.domRange,relative:xf.relative,exact:xf.exact,exactFromRange:function(n){return xf.exact(n.start,n.soffset,n.finish,n.foffset)},getWin:function(n){n=n.match({domRange:function(n){return An.fromDom(n.startContainer)},relative:function(n,e){return Sf.getStart(n)},exact:function(n,e,t,r){return n}});return An.fromDom(le(n).dom.defaultView)},range:Cf},Rf=function(n,e){return n.selectNodeContents(e.dom)},Df=function(n,e,t){var r,o,n=n.document.createRange();return r=n,e.fold(function(n){r.setStartBefore(n.dom)},function(n,e){r.setStart(n.dom,e)},function(n){r.setStartAfter(n.dom)}),o=n,t.fold(function(n){o.setEndBefore(n.dom)},function(n,e){o.setEnd(n.dom,e)},function(n){o.setEndAfter(n.dom)}),n},Of=function(n,e,t,r,o){n=n.document.createRange();return n.setStart(e.dom,t),n.setEnd(r.dom,o),n},Af=function(n){return{left:n.left,top:n.top,right:n.right,bottom:n.bottom,width:n.width,height:n.height}},kf=hr([{ltr:["start","soffset","finish","foffset"]},{rtl:["start","soffset","finish","foffset"]}]),If=function(n,e,t){return e(An.fromDom(t.startContainer),t.startOffset,An.fromDom(t.endContainer),t.endOffset)},Bf=function(n,e){var o,t,e=(o=n,e.match({domRange:function(n){return{ltr:h(n),rtl:S.none}},relative:function(n,e){return{ltr:G(function(){return Df(o,n,e)}),rtl:G(function(){return S.some(Df(o,e,n))})}},exact:function(n,e,t,r){return{ltr:G(function(){return Of(o,n,e,t,r)}),rtl:G(function(){return S.some(Of(o,t,r,n,e))})}}}));return(t=(e=e).ltr()).collapsed?e.rtl().filter(function(n){return!1===n.collapsed}).map(function(n){return kf.rtl(An.fromDom(n.endContainer),n.endOffset,An.fromDom(n.startContainer),n.startOffset)}).getOrThunk(function(){return If(0,kf.ltr,t)}):If(0,kf.ltr,t)},Mf=function(u,n){return Bf(u,n).match({ltr:function(n,e,t,r){var o=u.document.createRange();return o.setStart(n.dom,e),o.setEnd(t.dom,r),o},rtl:function(n,e,t,r){var o=u.document.createRange();return o.setStart(t.dom,r),o.setEnd(n.dom,e),o}})},Pf=(kf.ltr,kf.rtl,function(n,e,t){return e>=n.left&&e<=n.right&&t>=n.top&&t<=n.bottom}),Ef=function(t,r,n,e,o){var u=function(n){var e=t.dom.createRange();return e.setStart(r.dom,n),e.collapse(!0),e},i=Qt(r).length,i=function(n,e,t,r,o){if(0===o)return 0;if(e===r)return o-1;for(var u=r,i=1;i<o;i++){var c=n(i),l=Math.abs(e-c.left);if(t<=c.bottom){if(t<c.top||u<l)return i-1;u=l}}return 0}(function(n){return u(n).getBoundingClientRect()},n,e,o.right,i);return u(i)},Nf=function(n,e,t,r){return re(e)?function(e,t,r,o){var n=e.dom.createRange();n.selectNode(t.dom);n=n.getClientRects();return U(n,function(n){return Pf(n,r,o)?S.some(n):S.none()}).map(function(n){return Ef(e,t,r,o,n)})}(n,e,t,r):(e=e,u=t,i=r,c=(o=n).dom.createRange(),e=me(e),U(e,function(n){return c.selectNode(n.dom),Pf(c.getBoundingClientRect(),u,i)?Nf(o,n,u,i):S.none()}));var o,u,i,c},_f=function(n,e){return e-n.left<n.right-e},Wf=function(n,e,t){n=n.dom.createRange();return n.selectNode(e.dom),n.collapse(t),n},Lf=function(e,n,t){var r=e.dom.createRange();r.selectNode(n.dom);var r=r.getBoundingClientRect(),o=_f(r,t);return(!0===o?Xo:Yo)(n).map(function(n){return Wf(e,n,o)})},jf=function(n,e,t){var r=e.dom.getBoundingClientRect(),t=_f(r,t);return S.some(Wf(n,e,t))},zf=function(n,e,t,r){var o=n.dom.createRange();o.selectNode(e.dom);o=o.getBoundingClientRect();return function(n,e,t,r){var o=n.dom.createRange();o.selectNode(e.dom);o=o.getBoundingClientRect(),t=Math.max(o.left,Math.min(o.right,t)),r=Math.max(o.top,Math.min(o.bottom,r));return Nf(n,e,t,r)}(n,e,Math.max(o.left,Math.min(o.right,t)),Math.max(o.top,Math.min(o.bottom,r)))},Ff=document.caretPositionFromPoint?function(t,n,e){return S.from(t.dom.caretPositionFromPoint(n,e)).bind(function(n){if(null===n.offsetNode)return S.none();var e=t.dom.createRange();return e.setStart(n.offsetNode,n.offset),e.collapse(),S.some(e)})}:document.caretRangeFromPoint?function(n,e,t){return S.from(n.dom.caretRangeFromPoint(e,t))}:function(o,u,e){return An.fromPoint(o,u,e).bind(function(r){var n=function(){return n=o,t=u,(0===me(e=r).length?jf:Lf)(n,e,t);var n,e,t};return 0===me(r).length?n():zf(o,r,u,e).orThunk(n)})},Hf=function(n,e){var t=Qn(n);return"input"===t?Sf.after(n):D(["br","img"],t)?0===e?Sf.before(n):Sf.after(n):Sf.on(n,e)},Vf=function(n,e){n=n.fold(Sf.before,Hf,Sf.after),e=e.fold(Sf.before,Hf,Sf.after);return Tf.relative(n,e)},Uf=function(n,e,t,r){e=Hf(n,e),r=Hf(t,r);return Tf.relative(e,r)},qf=function(n,e,t,r){var o,u,i,c,l,l=(u=e,i=t,c=r,(l=ce(o=n).dom.createRange()).setStart(o.dom,u),l.setEnd(i.dom,c),l),r=Mn(n,t)&&e===r;return l.collapsed&&!r},$f=function(n){return S.from(n.getSelection())},Kf=function(n,e){$f(n).each(function(n){n.removeAllRanges(),n.addRange(e)})},Gf=function(n,e,t,r,o){o=Of(n,e,t,r,o);Kf(n,o)},Xf=function(a,n){return Bf(a,n).match({ltr:function(n,e,t,r){Gf(a,n,e,t,r)},rtl:function(u,i,c,l){$f(a).each(function(n){if(n.setBaseAndExtent)n.setBaseAndExtent(u.dom,i,c.dom,l);else if(n.extend)try{t=c,r=l,(e=n).collapse(u.dom,i),e.extend(t.dom,r)}catch(o){Gf(a,c,l,u,i)}else Gf(a,c,l,u,i);var e,t,r})}})},Yf=function(n,e,t,r,o){o=Uf(e,t,r,o);Xf(n,o)},Jf=function(n,e,t){t=Vf(e,t);Xf(n,t)},Qf=function(n){var o=Tf.getWin(n).dom,e=function(n,e,t,r){return Of(o,n,e,t,r)},n=n.match({domRange:function(n){var e=An.fromDom(n.startContainer),t=An.fromDom(n.endContainer);return Uf(e,n.startOffset,t,n.endOffset)},relative:Vf,exact:Uf});return Bf(o,n).match({ltr:e,rtl:e})},Zf=function(n){if(0<n.rangeCount){var e=n.getRangeAt(0),n=n.getRangeAt(n.rangeCount-1);return S.some(Cf(An.fromDom(e.startContainer),e.startOffset,An.fromDom(n.endContainer),n.endOffset))}return S.none()},ns=function(n){if(null===n.anchorNode||null===n.focusNode)return Zf(n);var e=An.fromDom(n.anchorNode),t=An.fromDom(n.focusNode);return qf(e,n.anchorOffset,t,n.focusOffset)?S.some(Cf(e,n.anchorOffset,t,n.focusOffset)):Zf(n)},es=function(n,e){e=function(n,e){n=n.document.createRange();return Rf(n,e),n}(n,e);Kf(n,e)},ts=function(n){return $f(n).filter(function(n){return 0<n.rangeCount}).bind(ns).map(function(n){return Tf.exact(n.start,n.soffset,n.finish,n.foffset)})},rs=function(n,e){n=Mf(n,e);return 0<(e=0<(n=(e=n).getClientRects()).length?n[0]:e.getBoundingClientRect()).width||0<e.height?S.some(e).map(Af):S.none()},os=tinymce.util.Tools.resolve("tinymce.util.VK"),us=function(n,e,t){return ls(n,e,yf(r=t,o).fold(function(){return wf.none(r)},function(n){return n.index+1<n.all.length?wf.middle(r,n.all[n.index+1]):wf.last(r)}));var r,o},is=function(n,e,t){return ls(n,e,yf(r=t,o).fold(function(){return wf.none()},function(n){return 0<=n.index-1?wf.middle(r,n.all[n.index-1]):wf.first(r)}));var r,o},cs=function(n,e){e=Tf.exact(e,0,e,0);return Qf(e)},ls=function(e,t,n){return n.fold(S.none,S.none,function(n,e){return Xo(e).map(function(n){return cs(0,n)})},function(n){return st(n,t).bind(function(n){return e.execCommand("mceTableInsertRowAfter"),function(n){n=De(n,"tr");return V(n).bind(function(n){return Ee(n,"td,th").map(function(n){return cs(0,n)})})}(n)})})},as=["table","li","dl"],fs=function(n,e){return{selection:n,kill:e}},ss=function(n,e,t,r){return{start:Sf.on(n,e),finish:Sf.on(t,r)}},ds=function(n,e){e=Mf(n,e);return Cf(An.fromDom(e.startContainer),e.startOffset,An.fromDom(e.endContainer),e.endOffset)},ms=ss,gs=function(t,n,r,e,o){return Mn(r,e)?S.none():fr(r,e,n).bind(function(n){var e=n.boxes.getOr([]);return 0<e.length?(o(t,e,n.start,n.finish),S.some(fs(S.some(ms(r,0,r,$o(r))),!0))):S.none()})},ps=function(n,e){return{item:n,mode:e}},tl=function(n,e,t,r){return void 0===r&&(r=hs),n.property().parent(e).map(function(n){return ps(n,r)})},hs=function(n,e,t,r){return void 0===r&&(r=bs),t.sibling(n,e).map(function(n){return ps(n,r)})},bs=function(n,e,t,r){void 0===r&&(r=bs);e=n.property().children(e);return t.first(e).map(function(n){return ps(n,r)})},vs=[{current:tl,next:hs,fallback:S.none()},{current:hs,next:bs,fallback:S.some(tl)},{current:bs,next:bs,fallback:S.some(hs)}],ws=function(e,t,r,o,n){return E(n=void 0===n?vs:n,function(n){return n.current===r}).bind(function(n){return n.current(e,t,o,n.next).orThunk(function(){return n.fallback.bind(function(n){return ws(e,t,n,o)})})})},ys=function(){return{sibling:function(n,e){return n.query().prevSibling(e)},first:function(n){return 0<n.length?S.some(n[n.length-1]):S.none()}}},Cs=function(){return{sibling:function(n,e){return n.query().nextSibling(e)},first:function(n){return 0<n.length?S.some(n[0]):S.none()}}},Ss=function(e,n,t,r,o,u){return ws(e,n,r,o).bind(function(n){return u(n.item)?S.none():t(n.item)?S.some(n.item):Ss(e,n.item,t,n.mode,o,u)})},xs=function(e){return function(n){return 0===e.property().children(n).length}},Ts=function(n,e,t,r){return Ss(n,e,t,hs,ys(),r)},Rs=function(n,e,t,r){return Ss(n,e,t,hs,Cs(),r)},Ds=tr(),sn=function(n,e){return Ts(Ds,n,xs(Ds),e)},an=function(n,e){return Rs(Ds,n,xs(Ds),e)},Os=hr([{none:["message"]},{success:[]},{failedUp:["cell"]},{failedDown:["cell"]}]),As=function(n){return Ne(n,"tr")},ks=q(q({},Os),{verify:function(t,e,n,r,o,u,i){return Ne(r,"td,th",i).bind(function(n){return Ne(e,"td,th",i).map(function(e){return Mn(n,e)?Mn(r,n)&&$o(n)===o?u(e):Os.none("in same cell"):lr(As,[n,e]).fold(function(){return function(n,e,t){e=n.getRect(e),t=n.getRect(t);return t.right>e.left&&t.left<e.right}(t,e,n)?Os.success():u(e)},function(n){return u(e)})})}).getOr(Os.none("default"))},cata:function(n,e,t,r,o){return n.fold(e,t,r,o)}}),Is=function(n,e){return N(n,w(Mn,e))},Bs=function(n){return"br"===Qn(n)},Ms=function(n,e,t){return e(n,t).bind(function(n){return re(n)&&0===Qt(n).trim().length?Ms(n,e,t):S.some(n)})},Ps=function(e,n,t,r){return ge(o=n,u=t).filter(Bs).orThunk(function(){return ge(o,u-1).filter(Bs)}).bind(function(n){return r.traverse(n).fold(function(){return Ms(n,r.gather,e).map(r.relative)},function(n){return ae(r=n).bind(function(e){var t=me(e);return Is(t,r).map(function(n){return{parent:e,children:t,element:r,index:n}})}).map(function(n){return Sf.on(n.parent,n.index)});var r})});var o,u},Es=function(n,e,t,r){var o,u,i;return(Bs(e)?(o=n,u=e,(i=r).traverse(u).orThunk(function(){return Ms(u,i.gather,o)}).map(i.relative)):Ps(n,e,t,r)).map(function(n){return{start:n,finish:n}})},Ns=function(n,e){return{left:n.left,top:n.top+e,right:n.right,bottom:n.bottom+e}},_s=function(n,e){return{left:n.left,top:n.top-e,right:n.right,bottom:n.bottom-e}},Ws=function(n,e,t){return{left:n.left+e,top:n.top+t,right:n.right+e,bottom:n.bottom+t}},Ls=function(n){return{left:n.left,top:n.top,right:n.right,bottom:n.bottom}},js=function(n,e){return S.some(n.getRect(e))},zs=function(n,e,t){return te(e)?js(n,e).map(Ls):re(e)?(n=n,e=e,(0<=(t=t)&&t<$o(e)?n.getRangedRect(e,t,e,t+1):0<t?n.getRangedRect(e,t-1,e,t):S.none()).map(Ls)):S.none()},Fs=function(n,e){return te(e)?js(n,e).map(Ls):re(e)?n.getRangedRect(e,0,e,$o(e)).map(Ls):S.none()},Hs=hr([{none:[]},{retry:["caret"]}]),Vs=function(e,n,t){return Oe(function(n,e){return e(n)},Be,n,Ll,r).fold(m,function(n){return Fs(e,n).exists(function(n){return e=n,(n=t).left<e.left||Math.abs(e.right-n.left)<1||n.left>e.right;var e})});var r},tl={point:function(n){return n.bottom},adjuster:function(n,e,t,r,o){var u=Ns(o,5);return Math.abs(t.bottom-r.bottom)<1||t.top>o.bottom?Hs.retry(u):t.top===o.bottom?Hs.retry(Ns(o,1)):Vs(n,e,o)?Hs.retry(Ws(u,5,0)):Hs.none()},move:Ns,gather:an},Us=function(t,r,o,u,i){return 0===i?S.some(u):(n=t,e=u.left,c=r.point(u),n.elementFromPoint(e,c).filter(function(n){return"table"===Qn(n)}).isSome()?(c=i-1,Us(t,r,o,r.move(u,5),c)):t.situsFromPoint(u.left,r.point(u)).bind(function(n){return n.start.fold(S.none,function(e){return Fs(t,e).bind(function(n){return r.adjuster(t,e,n,o,u).fold(S.none,function(n){return Us(t,r,o,n,i-1)})}).orThunk(function(){return S.some(u)})},S.none)}));var n,e,c},hr=function(e,t,n){var r,o=e.move(n,5),u=Us(t,e,n,o,100).getOr(o);return r=u,n=t,((o=e).point(r)>n.getInnerHeight()?S.some(o.point(r)-n.getInnerHeight()):o.point(r)<0?S.some(-o.point(r)):S.none()).fold(function(){return t.situsFromPoint(u.left,e.point(u))},function(n){return t.scrollBy(0,n),t.situsFromPoint(u.left,e.point(u)-n)})},qs={tryUp:w(hr,{point:function(n){return n.top},adjuster:function(n,e,t,r,o){var u=_s(o,5);return Math.abs(t.top-r.top)<1||t.bottom<o.top?Hs.retry(u):t.bottom===o.top?Hs.retry(_s(o,1)):Vs(n,e,o)?Hs.retry(Ws(u,5,0)):Hs.none()},move:_s,gather:sn}),tryDown:w(hr,tl),ieTryUp:function(n,e){return n.situsFromPoint(e.left,e.top-5)},ieTryDown:function(n,e){return n.situsFromPoint(e.left,e.bottom+5)},getJumpSize:h(5)},$s=function(t,r,o){return t.getSelection().bind(function(e){return Es(r,e.finish,e.foffset,o).fold(function(){return S.some(Lc(e.finish,e.foffset))},function(n){n=t.fromSitus(n),n=ks.verify(t,e.finish,e.foffset,n.finish,n.foffset,o.failure,r);return ks.cata(n,function(n){return S.none()},function(){return S.none()},function(n){return S.some(Lc(n,0))},function(n){return S.some(Lc(n,$o(n)))})})})},Ks=function(t,r,o,u,i,c){return 0===c?S.none():Ys(t,r,o,u,i).bind(function(n){var e=t.fromSitus(n),e=ks.verify(t,o,u,e.finish,e.foffset,i.failure,r);return ks.cata(e,function(){return S.none()},function(){return S.some(n)},function(n){return Mn(o,n)&&0===u?Gs(t,o,u,_s,i):Ks(t,r,n,0,i,c-1)},function(n){return Mn(o,n)&&u===$o(n)?Gs(t,o,u,Ns,i):Ks(t,r,n,$o(n),i,c-1)})})},Gs=function(e,n,t,r,o){return zs(e,n,t).bind(function(n){return Xs(e,o,r(n,qs.getJumpSize()))})},Xs=function(n,e,t){var r=Dn().browser;return r.isChrome()||r.isSafari()||r.isFirefox()||r.isEdge()?e.otherRetry(n,t):r.isIE()?e.ieRetry(n,t):S.none()},Ys=function(e,n,t,r,o){return zs(e,t,r).bind(function(n){return Xs(e,o,n)})},Js=function(n,e){return Be(n,function(n){return ae(n).exists(function(n){return Mn(n,e)})},t).isSome();var t},Qs=function(u,i,c,n,l){return Ne(n,"td,th",i).bind(function(o){return Ne(o,"table",i).bind(function(n){return Js(l,n)?$s(e=u,t=i,r=c).bind(function(n){return Ks(e,t,n.element,n.offset,r,20).map(e.fromSitus)}).bind(function(e){return Ne(e.finish,"td,th",i).map(function(n){return{start:o,finish:n,range:e}})}):S.none();var e,t,r})})},Zs=function(n,e,t,r,o,u){return Dn().browser.isIE()?S.none():u(r,e).orThunk(function(){return Qs(n,e,t,r,o).map(function(n){n=n.range;return fs(S.some(ms(n.start,n.soffset,n.finish,n.foffset)),!0)})})},nd=function(n,r){return Ne(n,"tr",r).bind(function(t){return Ne(t,"table",r).bind(function(n){var e=De(n,"tr");return Mn(t,e[0])?Ts(Ds,n,function(n){return Yo(n).isSome()},r).map(function(n){var e=$o(n);return fs(S.some(ms(n,e,n,e)),!0)}):S.none()})})},ed=function(n,r){return Ne(n,"tr",r).bind(function(t){return Ne(t,"table",r).bind(function(n){var e=De(n,"tr");return Mn(t,e[e.length-1])?Rs(Ds,n,function(n){return Xo(n).isSome()},r).map(function(n){return fs(S.some(ms(n,0,n,0)),!0)}):S.none()})})},td=function(n,e,t,r,o,u,i){return Qs(n,t,r,o,u).bind(function(n){return gs(e,t,n.start,n.finish,i)})},rd=function(){return n=function(n){return n.unbind()},e=Wo(S.none()),t=function(){return e.get().each(n)},{clear:function(){t(),e.set(S.none())},isSet:function(){return e.get().isSome()},set:function(n){t(),e.set(S.some(n))}};var n,e,t},od=function(n,e){return Ne(n,"td,th",e)},ud=function(o,u,e,i){var t,r=(t=Wo(S.none()),{clear:function(){return t.set(S.none())},set:function(n){return t.set(S.some(n))},isSet:function(){return t.get().isSome()},on:function(n){return t.get().each(n)}}),c=r.clear,l=function(n){r.on(function(r){i.clearBeforeUpdate(u),od(n.target,e).each(function(t){fr(r,t,e).each(function(n){var e=n.boxes.getOr([]);(1<e.length||1===e.length&&!Mn(r,t))&&(i.selectRange(u,e,n.start,n.finish),o.selectContents(t))})})})};return{clearstate:c,mousedown:function(n){i.clear(u),od(n.target,e).each(r.set)},mouseover:function(n){l(n)},mouseup:function(n){l(n),c()}}},id={traverse:de,gather:an,relative:Sf.before,otherRetry:qs.tryDown,ieRetry:qs.ieTryDown,failure:ks.failedDown},cd={traverse:se,gather:sn,relative:Sf.before,otherRetry:qs.tryUp,ieRetry:qs.ieTryUp,failure:ks.failedUp},sn=function(e){return function(n){return n===e}},ld=sn(38),ad=sn(40),fd=function(n){return 37<=n&&n<=40},sd={isBackward:sn(37),isForward:sn(39)},dd={isBackward:sn(39),isForward:sn(37)},md=function(u){return{elementFromPoint:function(n,e){return An.fromPoint(An.fromDom(u.document),n,e)},getRect:function(n){return n.dom.getBoundingClientRect()},getRangedRect:function(n,e,t,r){r=Tf.exact(n,e,t,r);return rs(u,r)},getSelection:function(){return ts(u).map(function(n){return ds(u,n)})},fromSitus:function(n){n=Tf.relative(n.start,n.finish);return ds(u,n)},situsFromPoint:function(n,e){return function(n,e,t){n=An.fromDom(n.document);return Ff(n,e,t).map(function(n){return Cf(An.fromDom(n.startContainer),n.startOffset,An.fromDom(n.endContainer),n.endOffset)})}(u,n,e).map(function(n){return ss(n.start,n.soffset,n.finish,n.foffset)})},clearSelection:function(){$f(u).each(function(n){return n.removeAllRanges()})},collapseSelection:function(o){void 0===o&&(o=!1),ts(u).each(function(n){return n.fold(function(n){return n.collapse(o)},function(n,e){e=o?n:e;Jf(u,e,e)},function(n,e,t,r){t=o?n:t,r=o?e:r;Yf(u,t,r,t,r)})})},setSelection:function(n){Yf(u,n.start,n.soffset,n.finish,n.foffset)},setRelativeSelection:function(n,e){Jf(u,n,e)},selectContents:function(n){es(u,n)},getInnerHeight:function(){return u.innerHeight},getScrollY:function(){var n,e;return(n=An.fromDom(u.document),e=n!==undefined?n.dom:document,n=e.body.scrollLeft||e.documentElement.scrollLeft,e=e.body.scrollTop||e.documentElement.scrollTop,jr(n,e)).top},scrollBy:function(n,e){!function(n,e,t){t=(t!==undefined?t.dom:document).defaultView;t&&t.scrollBy(n,e)}(n,e,An.fromDom(u.document))}}},gd=function(n,e){return{rows:n,cols:e}},pd=function(n,d,m,g){var l=md(n),a=function(){return g.clear(d),S.none()};return{keydown:function(n,e,t,r,o,u){var n=n.raw,i=n.which,c=!0===n.shiftKey;return sr(d,g.selectedSelector).fold(function(){return ad(i)&&c?w(td,l,d,m,id,r,e,g.selectRange):ld(i)&&c?w(td,l,d,m,cd,r,e,g.selectRange):ad(i)?w(Zs,l,m,id,r,e,ed):ld(i)?w(Zs,l,m,cd,r,e,nd):S.none},function(o){var n=function(n){return function(){return U(n,function(n){return e=n.rows,n=n.cols,t=d,mr(o,e,n,(r=g).firstSelectedSelector,r.lastSelectedSelector).map(function(n){return r.clearBeforeUpdate(t),r.selectRange(t,n.boxes,n.start,n.finish),n.boxes});var e,t,r}).fold(function(){return dr(d,g.firstSelectedSelector,g.lastSelectedSelector).map(function(n){var e=ad(i)||u.isForward(i)?Sf.after:Sf.before;return l.setRelativeSelection(Sf.on(n.first,0),e(n.table)),g.clear(d),fs(S.none(),!0)})},function(n){return S.some(fs(S.none(),!0))})}};return ad(i)&&c?n([gd(1,0)]):ld(i)&&c?n([gd(-1,0)]):u.isBackward(i)&&c?n([gd(0,-1),gd(-1,0)]):u.isForward(i)&&c?n([gd(0,1),gd(1,0)]):fd(i)&&!1==c?a:S.none})()},keyup:function(c,l,a,f,s){return sr(d,g.selectedSelector).fold(function(){var t,r,n,o,u,e=c.raw,i=e.which;return!1!=(!0===e.shiftKey)&&fd(i)?(t=d,r=m,n=l,e=a,o=f,i=s,u=g.selectRange,Mn(n,o)&&e===i?S.none():Ne(n,"td,th",r).bind(function(e){return Ne(o,"td,th",r).bind(function(n){return gs(t,r,e,n,u)})})):S.none()},S.none)}}},hd=function(o,u,e){var t=function(n){Fe(n,o.selected),Fe(n,o.firstSelected),Fe(n,o.lastSelected)},i=function(n){We(n,o.selected,"1")},c=function(n){r(n),e()},r=function(n){n=De(n,o.selectedSelector);I(n,t)};return{clearBeforeUpdate:r,clear:c,selectRange:function(n,e,t,r){c(n),I(e,i),We(t,o.firstSelected,"1"),We(r,o.lastSelected,"1"),u(e,t,r)},selectedSelector:o.selectedSelector,firstSelectedSelector:o.firstSelectedSelector,lastSelectedSelector:o.lastSelectedSelector}},bd=function(n,e,t){var r=Bt.fromTable(n);return ul(r,e).map(function(n){var e=Jc(r,t,!1);return{upOrLeftCells:function(n,e,t){n=n.slice(0,e[e.length-1].row+1),t=Zc(n,t);return W(t,function(n){n=n.cells.slice(0,e[e.length-1].column+1);return k(n,function(n){return n.element})})}(e,n,t),downOrRightCells:function(n,e,t){n=n.slice(e[0].row+e[0].rowspan-1,n.length),t=Zc(n,t);return W(t,function(n){n=n.cells.slice(e[0].column+e[0].colspan-1,n.cells.length);return k(n,function(n){return n.element})})}(e,n,t)}})},vd=tinymce.util.Tools.resolve("tinymce.Env"),wd=function(n){return!1===vi(An.fromDom(n.target),"ephox-snooker-resizer-bar")};function yd(p,h,n){var b=hd(wu,function(r,o,u){n.targets().each(function(t){st(o).each(function(n){var e=Tc(p),e=uu(y,An.fromDom(p.getDoc()),e),e=bd(n,t,e);p.fire("TableSelectionChange",{cells:r,start:o,finish:u,otherCells:e})})})},function(){p.fire("TableSelectionClear")});return p.on("init",function(n){var r,e,o,u,t=p.getWin(),i=au(p),c=du(p),l=function(n,e,t,r){n=md(n),r=ud(n,e,t,r);return{clearstate:r.clearstate,mousedown:r.mousedown,mouseover:r.mouseover,mouseup:r.mouseup}}(t,i,c,b),a=pd(t,i,c,b),f=(r=i,e=c,o=b,u=md(t),function(n,t){o.clearBeforeUpdate(r),fr(n,t,e).each(function(n){var e=n.boxes.getOr([]);o.selectRange(r,e,n.start,n.finish),u.selectContents(t),u.collapseSelection()})});p.on("TableSelectorChange",function(n){return f(n.start,n.finish)});var s,d,m=function(n,e){!0===n.raw.shiftKey&&(e.kill&&n.kill(),e.selection.each(function(n){n=Tf.relative(n.start,n.finish),n=Mf(t,n);p.selection.setRng(n)}))},g=function(n){return 0===n.button},c=(s=Wo(An.fromDom(i)),d=Wo(0),{touchEnd:function(n){var e,t,r=An.fromDom(n.target);"td"!==Qn(r)&&"th"!==Qn(r)||(e=s.get(),t=d.get(),Mn(e,r)&&n.timeStamp-t<300&&(n.preventDefault(),f(r,r))),s.set(r),d.set(n.timeStamp)}});p.on("dragstart",function(n){l.clearstate()}),p.on("mousedown",function(n){g(n)&&wd(n)&&l.mousedown(mi(n))}),p.on("mouseover",function(n){var e;((e=n).buttons===undefined||vd.browser.isEdge()&&0===e.buttons||0!=(1&e.buttons))&&wd(n)&&l.mouseover(mi(n))}),p.on("mouseup",function(n){g(n)&&wd(n)&&l.mouseup(mi(n))}),p.on("touchend",c.touchEnd),p.on("keyup",function(n){var e,t,r=mi(n);r.raw.shiftKey&&fd(r.raw.which)&&(e=p.selection.getRng(),t=An.fromDom(e.startContainer),n=An.fromDom(e.endContainer),a.keyup(r,t,e.startOffset,n,e.endOffset).each(function(n){m(r,n)}))}),p.on("keydown",function(n){var e=mi(n);h().each(function(n){return n.hideBars()});var t=p.selection.getRng(),r=An.fromDom(t.startContainer),o=An.fromDom(t.endContainer),n=Pr(sd,dd)(An.fromDom(p.selection.getStart()));a.keydown(e,r,t.startOffset,o,t.endOffset,n).each(function(n){m(e,n)}),h().each(function(n){return n.showBars()})}),p.on("NodeChange",function(){var n=p.selection,e=An.fromDom(n.getStart()),n=An.fromDom(n.getEnd());lr(st,[e,n]).fold(function(){return b.clear(i)},y)})}),{clear:b.clear}}var Cd=function(o,r){var u=Wo(S.none()),n=Wo([]),t=S.none(),i=ie("caption"),e=function(e){return t.forall(function(n){return!n[e]})},c=function(){return Sa(bu(o),du(o)).bind(function(t){return st(t).map(function(n){return i(t)?{element:e=t,mergable:S.none(),unmergable:S.none(),selection:[e]}:yu(r,n,t);var e})})},l=function(e){return st(e.element).map(function(n){var t=Bt.fromTable(n),n=ul(t,e).getOr([]),n=P(n,function(n,e){return e.isLocked&&(n.onAny=!0,0===e.column?n.onFirst=!0:e.column+e.colspan>=t.grid.columns&&(n.onLast=!0)),n},{onAny:!1,onFirst:!1,onLast:!1});return{mergeable:ll(t,e).isSome(),unmergeable:al(t,e).isSome(),locked:n}})},a=function(){u.set(G(c)()),t=u.get().bind(l),I(n.get(),function(n){return n()})},f=function(e){return e(),n.set(n.get().concat([e])),function(){n.set(B(n.get(),function(n){return n!==e}))}},s=function(e,t){return f(function(){return u.get().fold(function(){e.setDisabled(!0)},function(n){e.setDisabled(t(n))})})},d=function(e){return t.exists(function(n){return n.locked[e]})};return o.on("NodeChange ExecCommand TableSelectorChange",a),{onSetupTable:function(n){return s(n,function(n){return!1})},onSetupCellOrRow:function(n){return s(n,function(n){return i(n.element)})},onSetupColumn:function(e){return function(n){return s(n,function(n){return i(n.element)||d(e)})}},onSetupPasteable:function(e){return function(n){return s(n,function(n){return i(n.element)||e().isNone()})}},onSetupPasteableColumn:function(e,t){return function(n){return s(n,function(n){return i(n.element)||e().isNone()||d(t)})}},onSetupMergeable:function(n){return s(n,function(n){return e("mergeable")})},onSetupUnmergeable:function(n){return s(n,function(n){return e("unmergeable")})},resetTargets:a,onSetupTableWithCaption:function(n){return e=n,t=m,r=function(n){return st(n.element,du(o)).exists(function(n){return Pe(n,"caption").isSome()})},f(function(){return u.get().fold(function(){e.setDisabled(!0),e.setActive(!1)},function(n){e.setDisabled(t(n)),e.setActive(r(n))})});var e,t,r},targets:function(){return u.get()}}},Sd=function(t,r){return function(n){var e;return t.execCommand("mceTableApplyCellStyle",!1,((e={})[r]=n.value,e))}},xd=function(n){return B(n,function(n){return ln(n.value)})},Td=function(n,e,t,r,o){return{text:r(e),type:"togglemenuitem",onAction:function(){return o(e)},onSetup:(u=n,i=t,c=e.value,function(e){var t=rd(),n=function(){e.setActive(u.formatter.match(i,{value:c}));var n=u.formatter.formatChanged(i,e.setActive);t.set(n)};return u.initialized?n():u.on("init",n),t.clear})};var u,i,c},Rd=function(e,n,t,r,o){return k(n,function(n){return Td(e,n,t,r,o)})},Dd=function(e,t,r,o,u){return function(n){return n(Rd(e,t,r,o,u))}},Od=function(t,n,r){return[{type:"fancymenuitem",fancytype:"colorswatch",initData:{colors:0<n.length?n:undefined,allowCustomColors:!1},onAction:function(n){n=n.value,function(n){var e;t.execCommand("mceTableApplyCellStyle",!1,((e={})[r]=n,e))}("remove"===n?"":n)}}]},Ad=function(e){var n=e.getParam("table_toolbar","tableprops tabledelete | tableinsertrowbefore tableinsertrowafter tabledeleterow | tableinsertcolbefore tableinsertcolafter tabledeletecol");0<n.length&&e.ui.registry.addContextToolbar("table",{predicate:function(n){return e.dom.is(n,"table")&&e.getBody().contains(n)},items:n,scope:"node",position:"node"})};Cr.add("table",function(i){var n,e,t,r,o,u,c=(n=function(){return au(i)},e=function(){return Sa(bu(i))},t=wu.selectedSelector,{get:function(){return gr(n(),t).fold(function(){return e().map(yr).getOrThunk(vr)},function(n){return wr(n)})}}),l=Cd(i,c),a=Wc(i),f=yd(i,a.lazyResize,l),s=Ra(i,a.lazyWire,c),d=(r=Wo(S.none()),o=Wo(S.none()),u=function(n){n.set(S.none())},{getRows:r.get,setRows:function(n){r.set(n),u(o)},clearRows:function(){return u(r)},getColumns:o.get,setColumns:function(n){o.set(n),u(r)},clearColumns:function(){return u(o)}});return pf(i,s,f,c,d),hf(i,s,c),Cu(i,c,s,f),function(e,n,t){var r=function(n){return function(){return e.execCommand(n)}},o=function(n){e.execCommand("mceInsertTable",!1,{rows:n.numRows,columns:n.numColumns})},u={text:"Table properties",onSetup:n.onSetupTable,onAction:r("mceTableProps")},i={text:"Delete table",icon:"table-delete-table",onSetup:n.onSetupTable,onAction:r("mceTableDelete")};e.ui.registry.addMenuItem("tableinsertrowbefore",{text:"Insert row before",icon:"table-insert-row-above",onAction:r("mceTableInsertRowBefore"),onSetup:n.onSetupCellOrRow}),e.ui.registry.addMenuItem("tableinsertrowafter",{text:"Insert row after",icon:"table-insert-row-after",onAction:r("mceTableInsertRowAfter"),onSetup:n.onSetupCellOrRow}),e.ui.registry.addMenuItem("tabledeleterow",{text:"Delete row",icon:"table-delete-row",onAction:r("mceTableDeleteRow"),onSetup:n.onSetupCellOrRow}),e.ui.registry.addMenuItem("tablerowprops",{text:"Row properties",icon:"table-row-properties",onAction:r("mceTableRowProps"),onSetup:n.onSetupCellOrRow}),e.ui.registry.addMenuItem("tablecutrow",{text:"Cut row",icon:"cut-row",onAction:r("mceTableCutRow"),onSetup:n.onSetupCellOrRow}),e.ui.registry.addMenuItem("tablecopyrow",{text:"Copy row",icon:"duplicate-row",onAction:r("mceTableCopyRow"),onSetup:n.onSetupCellOrRow}),e.ui.registry.addMenuItem("tablepasterowbefore",{text:"Paste row before",icon:"paste-row-before",onAction:r("mceTablePasteRowBefore"),onSetup:n.onSetupPasteable(t.getRows)}),e.ui.registry.addMenuItem("tablepasterowafter",{text:"Paste row after",icon:"paste-row-after",onAction:r("mceTablePasteRowAfter"),onSetup:n.onSetupPasteable(t.getRows)});var c={type:"nestedmenuitem",text:"Row",getSubmenuItems:h("tableinsertrowbefore tableinsertrowafter tabledeleterow tablerowprops | tablecutrow tablecopyrow tablepasterowbefore tablepasterowafter")};e.ui.registry.addMenuItem("tableinsertcolumnbefore",{text:"Insert column before",icon:"table-insert-column-before",onAction:r("mceTableInsertColBefore"),onSetup:n.onSetupColumn("onFirst")}),e.ui.registry.addMenuItem("tableinsertcolumnafter",{text:"Insert column after",icon:"table-insert-column-after",onAction:r("mceTableInsertColAfter"),onSetup:n.onSetupColumn("onLast")}),e.ui.registry.addMenuItem("tabledeletecolumn",{text:"Delete column",icon:"table-delete-column",onAction:r("mceTableDeleteCol"),onSetup:n.onSetupColumn("onAny")}),e.ui.registry.addMenuItem("tablecutcolumn",{text:"Cut column",icon:"cut-column",onAction:r("mceTableCutCol"),onSetup:n.onSetupColumn("onAny")}),e.ui.registry.addMenuItem("tablecopycolumn",{text:"Copy column",icon:"duplicate-column",onAction:r("mceTableCopyCol"),onSetup:n.onSetupColumn("onAny")}),e.ui.registry.addMenuItem("tablepastecolumnbefore",{text:"Paste column before",icon:"paste-column-before",onAction:r("mceTablePasteColBefore"),onSetup:n.onSetupPasteableColumn(t.getColumns,"onFirst")}),e.ui.registry.addMenuItem("tablepastecolumnafter",{text:"Paste column after",icon:"paste-column-after",onAction:r("mceTablePasteColAfter"),onSetup:n.onSetupPasteableColumn(t.getColumns,"onLast")});var l={type:"nestedmenuitem",text:"Column",getSubmenuItems:h("tableinsertcolumnbefore tableinsertcolumnafter tabledeletecolumn | tablecutcolumn tablecopycolumn tablepastecolumnbefore tablepastecolumnafter")};e.ui.registry.addMenuItem("tablecellprops",{text:"Cell properties",icon:"table-cell-properties",onAction:r("mceTableCellProps"),onSetup:n.onSetupCellOrRow}),e.ui.registry.addMenuItem("tablemergecells",{text:"Merge cells",icon:"table-merge-cells",onAction:r("mceTableMergeCells"),onSetup:n.onSetupMergeable}),e.ui.registry.addMenuItem("tablesplitcells",{text:"Split cell",icon:"table-split-cells",onAction:r("mceTableSplitCells"),onSetup:n.onSetupUnmergeable});t={type:"nestedmenuitem",text:"Cell",getSubmenuItems:h("tablecellprops tablemergecells tablesplitcells")};!1===e.getParam("table_grid",!0,"boolean")?e.ui.registry.addMenuItem("inserttable",{text:"Table",icon:"table",onAction:r("mceInsertTable")}):e.ui.registry.addNestedMenuItem("inserttable",{text:"Table",icon:"table",getSubmenuItems:function(){return[{type:"fancymenuitem",fancytype:"inserttable",onAction:o}]}}),e.ui.registry.addMenuItem("inserttabledialog",{text:"Insert table",icon:"table",onAction:r("mceInsertTable")}),e.ui.registry.addMenuItem("tableprops",u),e.ui.registry.addMenuItem("deletetable",i),e.ui.registry.addNestedMenuItem("row",c),e.ui.registry.addNestedMenuItem("column",l),e.ui.registry.addNestedMenuItem("cell",t),e.ui.registry.addContextMenu("table",{update:function(){return n.resetTargets(),n.targets().fold(h(""),function(n){return"caption"===Qn(n.element)?"tableprops deletetable":"cell row column | advtablesort | tableprops deletetable"})}});var a=xd(hc(e));0!==a.length&&e.ui.registry.addNestedMenuItem("tableclass",{icon:"table-classes",text:"Table styles",getSubmenuItems:function(){return Rd(e,a,"tableclass",function(n){return n.title},function(n){return e.execCommand("mceTableToggleClass",!1,n.value)})},onSetup:n.onSetupTable});var f=xd(pc(e));0!==f.length&&e.ui.registry.addNestedMenuItem("tablecellclasss",{icon:"table-cell-classes",text:"Cell styles",getSubmenuItems:function(){return Rd(e,f,"tablecellclass",function(n){return n.title},function(n){return e.execCommand("mceTableCellToggleClass",!1,n.value)})},onSetup:n.onSetupCellOrRow}),e.ui.registry.addNestedMenuItem("tablecellvalign",{icon:"vertical-align",text:"Vertical align",getSubmenuItems:function(){return Rd(e,Va,"tablecellverticalalign",function(n){return n.text},Sd(e,"vertical-align"))},onSetup:n.onSetupCellOrRow});var s=cc(e);e.ui.registry.addNestedMenuItem("tablecellborderwidth",{icon:"border-width",text:"Border width",getSubmenuItems:function(){return Rd(e,s,"tablecellborderwidth",function(n){return n.title},Sd(e,"border-width"))},onSetup:n.onSetupCellOrRow});var d=lc(e);e.ui.registry.addNestedMenuItem("tablecellborderstyle",{icon:"border-style",text:"Border style",getSubmenuItems:function(){return Rd(e,d,"tablecellborderstyle",function(n){return n.text},Sd(e,"border-style"))},onSetup:n.onSetupCellOrRow}),e.ui.registry.addToggleMenuItem("tablecaption",{icon:"table-caption",text:"Table caption",onAction:r("mceTableToggleCaption"),onSetup:n.onSetupTableWithCaption});var m=Dc(e);e.ui.registry.addNestedMenuItem("tablecellbackgroundcolor",{icon:"cell-background-color",text:"Background color",getSubmenuItems:function(){return Od(e,m,"background-color")},onSetup:n.onSetupCellOrRow});var g=Oc(e);e.ui.registry.addNestedMenuItem("tablecellbordercolor",{icon:"cell-border-color",text:"Border color",getSubmenuItems:function(){return Od(e,g,"border-color")},onSetup:n.onSetupCellOrRow})}(i,l,d),function(e,n,t){e.ui.registry.addMenuButton("table",{tooltip:"Table",icon:"table",fetch:function(n){return n("inserttable | cell row column | advtablesort | tableprops deletetable")}});var r=function(n){return function(){return e.execCommand(n)}};e.ui.registry.addButton("tableprops",{tooltip:"Table properties",onAction:r("mceTableProps"),icon:"table",onSetup:n.onSetupTable}),e.ui.registry.addButton("tabledelete",{tooltip:"Delete table",onAction:r("mceTableDelete"),icon:"table-delete-table",onSetup:n.onSetupTable}),e.ui.registry.addButton("tablecellprops",{tooltip:"Cell properties",onAction:r("mceTableCellProps"),icon:"table-cell-properties",onSetup:n.onSetupCellOrRow}),e.ui.registry.addButton("tablemergecells",{tooltip:"Merge cells",onAction:r("mceTableMergeCells"),icon:"table-merge-cells",onSetup:n.onSetupMergeable}),e.ui.registry.addButton("tablesplitcells",{tooltip:"Split cell",onAction:r("mceTableSplitCells"),icon:"table-split-cells",onSetup:n.onSetupUnmergeable}),e.ui.registry.addButton("tableinsertrowbefore",{tooltip:"Insert row before",onAction:r("mceTableInsertRowBefore"),icon:"table-insert-row-above",onSetup:n.onSetupCellOrRow}),e.ui.registry.addButton("tableinsertrowafter",{tooltip:"Insert row after",onAction:r("mceTableInsertRowAfter"),icon:"table-insert-row-after",onSetup:n.onSetupCellOrRow}),e.ui.registry.addButton("tabledeleterow",{tooltip:"Delete row",onAction:r("mceTableDeleteRow"),icon:"table-delete-row",onSetup:n.onSetupCellOrRow}),e.ui.registry.addButton("tablerowprops",{tooltip:"Row properties",onAction:r("mceTableRowProps"),icon:"table-row-properties",onSetup:n.onSetupCellOrRow}),e.ui.registry.addButton("tableinsertcolbefore",{tooltip:"Insert column before",onAction:r("mceTableInsertColBefore"),icon:"table-insert-column-before",onSetup:n.onSetupColumn("onFirst")}),e.ui.registry.addButton("tableinsertcolafter",{tooltip:"Insert column after",onAction:r("mceTableInsertColAfter"),icon:"table-insert-column-after",onSetup:n.onSetupColumn("onLast")}),e.ui.registry.addButton("tabledeletecol",{tooltip:"Delete column",onAction:r("mceTableDeleteCol"),icon:"table-delete-column",onSetup:n.onSetupColumn("onAny")}),e.ui.registry.addButton("tablecutrow",{tooltip:"Cut row",icon:"cut-row",onAction:r("mceTableCutRow"),onSetup:n.onSetupCellOrRow}),e.ui.registry.addButton("tablecopyrow",{tooltip:"Copy row",icon:"duplicate-row",onAction:r("mceTableCopyRow"),onSetup:n.onSetupCellOrRow}),e.ui.registry.addButton("tablepasterowbefore",{tooltip:"Paste row before",icon:"paste-row-before",onAction:r("mceTablePasteRowBefore"),onSetup:n.onSetupPasteable(t.getRows)}),e.ui.registry.addButton("tablepasterowafter",{tooltip:"Paste row after",icon:"paste-row-after",onAction:r("mceTablePasteRowAfter"),onSetup:n.onSetupPasteable(t.getRows)}),e.ui.registry.addButton("tablecutcol",{tooltip:"Cut column",icon:"cut-column",onAction:r("mceTableCutCol"),onSetup:n.onSetupColumn("onAny")}),e.ui.registry.addButton("tablecopycol",{tooltip:"Copy column",icon:"duplicate-column",onAction:r("mceTableCopyCol"),onSetup:n.onSetupColumn("onAny")}),e.ui.registry.addButton("tablepastecolbefore",{tooltip:"Paste column before",icon:"paste-column-before",onAction:r("mceTablePasteColBefore"),onSetup:n.onSetupPasteableColumn(t.getColumns,"onFirst")}),e.ui.registry.addButton("tablepastecolafter",{tooltip:"Paste column after",icon:"paste-column-after",onAction:r("mceTablePasteColAfter"),onSetup:n.onSetupPasteableColumn(t.getColumns,"onLast")}),e.ui.registry.addButton("tableinsertdialog",{tooltip:"Insert table",onAction:r("mceInsertTable"),icon:"table"});t=xd(hc(e));0!==t.length&&e.ui.registry.addMenuButton("tableclass",{icon:"table-classes",tooltip:"Table styles",fetch:Dd(e,t,"tableclass",function(n){return n.title},function(n){return e.execCommand("mceTableToggleClass",!1,n.value)}),onSetup:n.onSetupTable});t=xd(pc(e));0!==t.length&&e.ui.registry.addMenuButton("tablecellclass",{icon:"table-cell-classes",tooltip:"Cell styles",fetch:Dd(e,t,"tablecellclass",function(n){return n.title},function(n){return e.execCommand("mceTableCellToggleClass",!1,n.value)}),onSetup:n.onSetupCellOrRow}),e.ui.registry.addMenuButton("tablecellvalign",{icon:"vertical-align",tooltip:"Vertical align",fetch:Dd(e,Va,"tablecellverticalalign",function(n){return n.text},Sd(e,"vertical-align")),onSetup:n.onSetupCellOrRow});t=cc(e);e.ui.registry.addMenuButton("tablecellborderwidth",{icon:"border-width",tooltip:"Border width",fetch:Dd(e,t,"tablecellborderwidth",function(n){return n.title},Sd(e,"border-width")),onSetup:n.onSetupCellOrRow});t=lc(e);e.ui.registry.addMenuButton("tablecellborderstyle",{icon:"border-style",tooltip:"Border style",fetch:Dd(e,t,"tablecellborderstyle",function(n){return n.text},Sd(e,"border-style")),onSetup:n.onSetupCellOrRow}),e.ui.registry.addToggleButton("tablecaption",{tooltip:"Table caption",onAction:r("mceTableToggleCaption"),icon:"table-caption",onSetup:n.onSetupTableWithCaption});var o=Dc(e);e.ui.registry.addMenuButton("tablecellbackgroundcolor",{icon:"cell-background-color",tooltip:"Background color",fetch:function(n){return n(Od(e,o,"background-color"))},onSetup:n.onSetupCellOrRow});var u=Oc(e);e.ui.registry.addMenuButton("tablecellbordercolor",{icon:"cell-border-color",tooltip:"Border color",fetch:function(n){return n(Od(e,u,"border-color"))},onSetup:n.onSetupCellOrRow})}(i,l,d),Ad(i),i.on("PreInit",function(){i.serializer.addTempAttr(wu.firstSelected),i.serializer.addTempAttr(wu.lastSelected),i.formatter.register(bf)}),i.getParam("table_tab_navigation",!0,"boolean")&&i.on("keydown",function(n){var e,t,r,o,u;t=i,r=f,(e=n).keyCode===os.TAB&&(o=au(t),u=function(n){var e=Qn(n);return Mn(n,o)||D(as,e)},n=t.selection.getRng(),n=An.fromDom(e.shiftKey?n.startContainer:n.endContainer),lt(n,u).each(function(n){e.preventDefault(),st(n,u).each(r.clear),t.selection.collapse(e.shiftKey),(e.shiftKey?is:us)(t,u,n).each(function(n){t.selection.setRng(n)})}))}),i.on("remove",function(){a.destroy()}),Na(i,d,a,l)})}();