/**
 * Copyright (c) Tiny Technologies, Inc. All rights reserved.
 * Licensed under the LGPL or a commercial license.
 * For LGPL see License.txt in the project root for license information.
 * For commercial licenses see https://www.tiny.cloud/
 *
 * Version: 5.9.0 (TBD)
 */
!function(){"use strict";var e=tinymce.util.Tools.resolve("tinymce.PluginManager"),o=tinymce.util.Tools.resolve("tinymce.Env"),i=function(e,t){return t<0&&(t=0),3!==e.nodeType||(e=e.data.length)<t&&(t=e),t},c=function(e,t,n){1!==t.nodeType||t.hasChildNodes()?e.setStart(t,i(t,n)):e.setStartBefore(t)},g=function(e,t,n){1!==t.nodeType||t.hasChildNodes()?e.setEnd(t,i(t,n)):e.setEndAfter(t)},r=function(e,t,n){var o,i,r,a,s=e.getParam("autolink_pattern",/^(https?:\/\/|ssh:\/\/|ftp:\/\/|file:\/|www\.|(?:mailto:)?[A-Z0-9._%+\-]+@(?!.*@))(.+)$/i),d=e.getParam("default_link_target",!1);if("A"!==e.selection.getNode().tagName){var f=e.selection.getRng().cloneRange();if(f.startOffset<5){if(!(l=f.endContainer.previousSibling)){if(!f.endContainer.firstChild||!f.endContainer.firstChild.nextSibling)return;l=f.endContainer.firstChild.nextSibling}if(r=l.length,c(f,l,r),g(f,l,r),f.endOffset<5)return;o=f.endOffset,i=l}else{if(3!==(i=f.endContainer).nodeType&&i.firstChild){for(;3!==i.nodeType&&i.firstChild;)i=i.firstChild;3===i.nodeType&&(c(f,i,0),g(f,i,i.nodeValue.length))}o=1===f.endOffset?2:f.endOffset-1-t}for(var l=o;c(f,i,2<=o?o-2:0),g(f,i,1<=o?o-1:0),--o," "!==(a=f.toString())&&""!==a&&160!==a.charCodeAt(0)&&0<=o-2&&a!==n;);(t=f.toString())===n||" "===t||160===t.charCodeAt(0)?(c(f,i,o),g(f,i,l),o+=1):(0===f.startOffset?c(f,i,0):c(f,i,o),g(f,i,l)),"."===(t=f.toString()).charAt(t.length-1)&&g(f,i,l-1);var t=(t=f.toString().trim()).match(s),s=e.getParam("link_default_protocol","http","string");t&&("www."===t[1]?t[1]=s+"://www.":/@$/.test(t[1])&&!/^mailto:/.test(t[1])&&(t[1]="mailto:"+t[1]),s=e.selection.getBookmark(),e.selection.setRng(f),e.execCommand("createlink",!1,t[1]+t[2]),!1!==d&&e.dom.setAttrib(e.selection.getNode(),"target",d),e.selection.moveToBookmark(s),e.nodeChanged())}},t=function(t){var n;t.on("keydown",function(e){13===e.keyCode&&r(t,-1,"")}),o.browser.isIE()?t.on("focus",function(){if(!n){n=!0;try{t.execCommand("AutoUrlDetect",!1,!0)}catch(e){}}}):(t.on("keypress",function(e){41===e.keyCode&&r(t,-1,"(")}),t.on("keyup",function(e){32===e.keyCode&&r(t,0,"")}))};e.add("autolink",function(e){t(e)})}();