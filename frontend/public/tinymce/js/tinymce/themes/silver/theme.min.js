/**
 * Copyright (c) Tiny Technologies, Inc. All rights reserved.
 * Licensed under the LGPL or a commercial license.
 * For LGPL see License.txt in the project root for license information.
 * For commercial licenses see https://www.tiny.cloud/
 *
 * Version: 5.9.0 (TBD)
 */
!function(){"use strict";var n,t=function(e){return function(t){return t=typeof(n=t),(null===n?"null":"object"==t&&(Array.prototype.isPrototypeOf(n)||n.constructor&&"Array"===n.constructor.name)?"array":"object"==t&&(String.prototype.isPrototypeOf(n)||n.constructor&&"String"===n.constructor.name)?"string":t)===e;var n}},e=function(n){return function(t){return typeof t===n}},v=t("string"),b=t("object"),c=t("array"),y=e("boolean"),o=(n=undefined,function(t){return n===t}),u=function(t){return!(null===(t=t)||t===undefined)},l=e("function"),s=e("number"),a=function(t,n){if(c(t)){for(var e=0,o=t.length;e<o;++e)if(!n(t[e]))return!1;return!0}return!1},$=function(){},i=function(e,o){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return e(o.apply(null,t))}},U=function(t){return function(){return t}},h=function(t){return t},r=function(t,n){return t===n};function x(o){for(var r=[],t=1;t<arguments.length;t++)r[t-1]=arguments[t];return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var e=r.concat(t);return o.apply(null,e)}}var w=function(n){return function(t){return!n(t)}},f=function(t){return function(){throw new Error(t)}},d=U(!1),S=U(!0),m=tinymce.util.Tools.resolve("tinymce.ThemeManager"),Q=function(){return(Q=Object.assign||function Q(t){for(var n,e=1,o=arguments.length;e<o;e++)for(var r in n=arguments[e])Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r]);return t}).apply(this,arguments)};function g(t,n){var e={};for(r in t)Object.prototype.hasOwnProperty.call(t,r)&&n.indexOf(r)<0&&(e[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)n.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(e[r[o]]=t[r[o]]);return e}function p(t,n,e){if(e||2===arguments.length)for(var o,r=0,i=n.length;r<i;r++)!o&&r in n||((o=o||Array.prototype.slice.call(n,0,r))[r]=n[r]);return t.concat(o||n)}var k,C=function(){return O},O={fold:function(t,n){return t()},isSome:d,isNone:S,getOr:h,getOrThunk:Ja=function(t){return t()},getOrDie:function(t){throw new Error(t||"error: getOrDie called on none.")},getOrNull:U(null),getOrUndefined:U(undefined),or:h,orThunk:Ja,map:C,each:$,bind:C,exists:d,forall:S,filter:function(){return O},toArray:function(){return[]},toString:U("none()")},_=function(e){var t=U(e),n=function(){return r},o=function(t){return t(e)},r={fold:function(t,n){return n(e)},isSome:S,isNone:d,getOr:t,getOrThunk:t,getOrDie:t,getOrNull:t,getOrUndefined:t,or:n,orThunk:n,map:function(t){return _(t(e))},each:function(t){t(e)},bind:o,exists:o,forall:o,filter:function(t){return t(e)?r:O},toArray:function(){return[e]},toString:function(){return"some("+e+")"}};return r},Z={some:_,none:C,from:function(t){return null===t||t===undefined?O:_(t)}},T=Array.prototype.slice,E=Array.prototype.indexOf,D=Array.prototype.push,B=function(t,n){return E.call(t,n)},A=function(t,n){return-1<B(t,n)},M=function(t,n){for(var e=0,o=t.length;e<o;e++)if(n(t[e],e))return!0;return!1},F=function(t,n){for(var e=[],o=0;o<t;o++)e.push(n(o));return e},I=function(t,n){for(var e=[],o=0;o<t.length;o+=n){var r=T.call(t,o,o+n);e.push(r)}return e},R=function(t,n){for(var e=t.length,o=new Array(e),r=0;r<e;r++){var i=t[r];o[r]=n(i,r)}return o},tt=function(t,n){for(var e=0,o=t.length;e<o;e++)n(t[e],e)},V=function(t,n){for(var e=[],o=[],r=0,i=t.length;r<i;r++){var u=t[r];(n(u,r)?e:o).push(u)}return{pass:e,fail:o}},P=function(t,n){for(var e=[],o=0,r=t.length;o<r;o++){var i=t[o];n(i,o)&&e.push(i)}return e},H=function(t,n,e){return function(t,n){for(var e=t.length-1;0<=e;e--)n(t[e],e)}(t,function(t){e=n(e,t)}),e},z=function(t,n,e){return tt(t,function(t){e=n(e,t)}),e},L=function(t,n){return function(t,n,e){for(var o=0,r=t.length;o<r;o++){var i=t[o];if(n(i,o))return Z.some(i);if(e(i,o))break}return Z.none()}(t,n,d)},N=function(t,n){for(var e=0,o=t.length;e<o;e++)if(n(t[e],e))return Z.some(e);return Z.none()},nt=function(t){for(var n=[],e=0,o=t.length;e<o;++e){if(!c(t[e]))throw new Error("Arr.flatten item "+e+" was not an array, input: "+t);D.apply(n,t[e])}return n},j=function(t,n){return nt(R(t,n))},W=function(t,n){for(var e=0,o=t.length;e<o;++e)if(!0!==n(t[e],e))return!1;return!0},G=function(t){t=T.call(t,0);return t.reverse(),t},X=function(t,n){return P(t,function(t){return!A(n,t)})},Y=function(t){return[t]},q=function(t,n){t=T.call(t,0);return t.sort(n),t},K=function(t,n){return 0<=n&&n<t.length?Z.some(t[n]):Z.none()},J=function(t){return K(t,0)},et=function(t){return K(t,t.length-1)},ot=l(Array.from)?Array.from:function(t){return T.call(t)},rt=function(t,n){for(var e=0;e<t.length;e++){var o=n(t[e],e);if(o.isSome())return o}return Z.none()},it=function(e){return{is:function(t){return e===t},isValue:S,isError:d,getOr:U(e),getOrThunk:U(e),getOrDie:U(e),or:function(t){return it(e)},orThunk:function(t){return it(e)},fold:function(t,n){return n(e)},map:function(t){return it(t(e))},mapError:function(t){return it(e)},each:function(t){t(e)},bind:function(t){return t(e)},exists:function(t){return t(e)},forall:function(t){return t(e)},toOptional:function(){return Z.some(e)}}},ut=function(e){return{is:d,isValue:d,isError:S,getOr:h,getOrThunk:function(t){return t()},getOrDie:function(){return f(String(e))()},or:h,orThunk:function(t){return t()},fold:function(t,n){return t(e)},map:function(t){return ut(e)},mapError:function(t){return ut(t(e))},each:$,bind:function(t){return ut(e)},exists:d,forall:S,toOptional:Z.none}},at={value:it,error:ut,fromOption:function(t,n){return t.fold(function(){return ut(n)},it)}};(uc=k=k||{})[uc.Error=0]="Error",uc[uc.Value=1]="Value";var ct,st,lt,ft=function(t,n,e){return t.stype===k.Error?n(t.serror):e(t.svalue)},dt=function(t){return{stype:k.Value,svalue:t}},mt=function(t){return{stype:k.Error,serror:t}},gt=function(t){return t.fold(mt,dt)},pt=function(t){return ft(t,at.error,at.value)},ht=dt,vt=function(t){var n=[],e=[];return tt(t,function(t){ft(t,function(t){return e.push(t)},function(t){return n.push(t)})}),{values:n,errors:e}},bt=mt,yt=function(t,n){return t.stype===k.Value?n(t.svalue):t},xt=function(t,n){return t.stype===k.Error?n(t.serror):t},wt=function(t,n){return t.stype===k.Value?{stype:k.Value,svalue:n(t.svalue)}:t},St=function(t,n){return t.stype===k.Error?{stype:k.Error,serror:n(t.serror)}:t},kt=ft,Ct=function(t,n,e,o){return{tag:"field",key:t,newKey:n,presence:e,prop:o}},Ot=function(t,n,e){switch(t.tag){case"field":return n(t.key,t.newKey,t.presence,t.prop);case"custom":return e(t.newKey,t.instantiator)}},_t=Object.keys,Tt=Object.hasOwnProperty,Et=function(t,n){for(var e=_t(t),o=0,r=e.length;o<r;o++){var i=e[o];n(t[i],i)}},Dt=function(t,e){return Bt(t,function(t,n){return{k:n,v:e(t,n)}})},Bt=function(t,e){var o={};return Et(t,function(t,n){n=e(t,n);o[n.k]=n.v}),o},At=function(t,n){var e,o,r,i,u={};return e=n,i=u,o=function(t,n){i[n]=t},r=$,Et(t,function(t,n){(e(t,n)?o:r)(t,n)}),u},Mt=function(t,e){var o=[];return Et(t,function(t,n){o.push(e(t,n))}),o},Ft=function(t,n){for(var e=_t(t),o=0,r=e.length;o<r;o++){var i=e[o],u=t[i];if(n(u,i,t))return Z.some(u)}return Z.none()},It=function(t){return Mt(t,h)},Rt=function(t,n){return Vt(t,n)?Z.from(t[n]):Z.none()},Vt=function(t,n){return Tt.call(t,n)},Pt=function(t,n){return Vt(t,n)&&t[n]!==undefined&&null!==t[n]},Ht=function(u){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];if(0===t.length)throw new Error("Can't merge zero objects");for(var e={},o=0;o<t.length;o++){var r,i=t[o];for(r in i)Vt(i,r)&&(e[r]=u(e[r],i[r]))}return e}},zt=Ht(function(t,n){return b(t)&&b(n)?zt(t,n):n}),Lt=Ht(function(t,n){return n}),Nt=function(e){var o,r=!1;return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return r||(r=!0,o=e.apply(null,t)),o}},jt=function(){return{tag:"required",process:{}}},Wt=function(t){return{tag:"defaultedThunk",process:t}},Ut=function(t){return Wt(U(t))},Gt=function(){return{tag:"option",process:{}}},Xt=function(t){return{tag:"mergeWithThunk",process:t}},Yt=function(t){return i(bt,nt)(t)},qt=function(t){t=vt(t);return 0<t.errors.length?Yt(t.errors):ht(t.values)},Kt=function(t){return b(t)&&100<_t(t).length?" removed due to size":JSON.stringify(t,null,2)},Jt=function(t,n){return bt([{path:t,getErrorInfo:n}])},$t=function(e){return{extract:function(n,t){return xt(e(t),function(t){return Jt(n,U(t))})},toString:U("val")}},Qt=$t(ht),Zt=function(e,o,r,t){return Rt(o,r).fold(function(){return t=r,n=o,Jt(e,function(){return'Could not find valid *required* value for "'+t+'" in '+Kt(n)});var t,n},t)},tn=function(t,n,e,o){return o(Rt(t,n).getOrThunk(function(){return e(t)}))},nn=function(n,e,o,r,i){var u,a,c=function(t){return i.extract(e.concat([r]),t)},t=function(t){return t.fold(function(){return ht(Z.none())},function(t){t=i.extract(e.concat([r]),t);return wt(t,Z.some)})};switch(n.tag){case"required":return Zt(e,o,r,c);case"defaultedThunk":return tn(o,r,n.process,c);case"option":return t(Rt(o,r));case"defaultedOptionThunk":return u=o,a=n.process,t(Rt(u,r).map(function(t){return!0===t?a(u):t}));case"mergeWithThunk":return tn(o,r,U({}),function(t){t=zt(n.process(o),t);return c(t)})}},en=function(e){return{extract:function(t,n){return e().extract(t,n)},toString:function(){return e().toString()}}},on=function(t){var r=rn(t),i=H(t,function(e,t){return Ot(t,function(t){var n;return zt(e,((n={})[t]=!0,n))},U(e))},{});return{extract:function(t,n){var e,o=y(n)?[]:_t(At(n,u)),o=P(o,function(t){return!Pt(i,t)});return 0===o.length?r.extract(t,n):(e=o,Jt(t,function(){return"There are unsupported fields: ["+e.join(", ")+"] specified"}))},toString:r.toString}},rn=function(e){return{extract:function(t,n){return function(r,i,t){for(var u={},a=[],n=0,e=t;n<e.length;n++){var o=e[n];Ot(o,function(t,n,e,o){o=nn(e,r,i,t,o);kt(o,function(t){a.push.apply(a,t)},function(t){u[n]=t})},function(t,n){u[t]=n(i)})}return 0<a.length?bt(a):ht(u)}(t,n,e)},toString:function(){return"obj{\n"+R(e,function(t){return Ot(t,function(t,n,e,o){return t+" -> "+o.toString()},function(t,n){return"state("+t+")"})}).join("\n")+"}"}}},un=function(o){return{extract:function(e,t){t=R(t,function(t,n){return o.extract(e.concat(["["+n+"]"]),t)});return qt(t)},toString:function(){return"array("+o.toString()+")"}}},an=function(u){return{extract:function(t,n){for(var e=[],o=0,r=u;o<r.length;o++){var i=r[o].extract(t,n);if(i.stype===k.Value)return i;e.push(i)}return qt(e)},toString:function(){return"oneOf("+R(u,function(t){return t.toString()}).join(", ")+")"}}},cn=function(o,r){return{extract:function(n,e){var t=_t(e),t=un($t(o)).extract(n,t);return yt(t,function(t){t=R(t,function(t){return Ct(t,t,jt(),r)});return rn(t).extract(n,e)})},toString:function(){return"setOf("+r.toString()+")"}}},sn=i(un,rn),ln=U(Qt),fn=function(e,o){return $t(function(t){var n=typeof t;return e(t)?ht(t):bt("Expected type: "+o+" but got: "+n)})},dn=fn(s,"number"),mn=fn(v,"string"),gn=fn(y,"boolean"),pn=fn(l,"function"),hn=function(n){if(Object(n)!==n)return!0;switch({}.toString.call(n).slice(8,-1)){case"Boolean":case"Number":case"String":case"Date":case"RegExp":case"Blob":case"FileList":case"ImageData":case"ImageBitmap":case"ArrayBuffer":return!0;case"Array":case"Object":return Object.keys(n).every(function(t){return hn(n[t])});default:return!1}},vn=$t(function(t){return hn(t)?ht(t):bt("Expected value to be acceptable for sending via postMessage")}),bn=function(e,n,o,r){return Rt(o,r).fold(function(){return t=o,n=r,Jt(e,function(){return'The chosen schema: "'+n+'" did not exist in branches: '+Kt(t)});var t,n},function(t){return t.extract(e.concat(["branch: "+r]),n)})},yn=function(o,r){return{extract:function(n,e){return Rt(e,o).fold(function(){return t=o,Jt(n,function(){return'Choice schema did not contain choice key: "'+t+'"'});var t},function(t){return bn(n,e,r,t)})},toString:function(){return"chooseOn("+o+"). Possible values: "+_t(r)}}},xn=function(n){return $t(function(t){return n(t).fold(bt,ht)})},wn=function(n,t){return cn(function(t){return gt(n(t))},t)},Sn=function(t,n,e){return pt(function(t,n,e){t=n.extract([t],e);return St(t,function(t){return{input:e,errors:t}})}(t,n,e))},kn=function(t){return t.fold(function(t){throw new Error(On(t))},h)},Cn=function(t,n,e){return kn(Sn(t,n,e))},On=function(t){return"Errors: \n"+function(t){t=10<t.length?t.slice(0,10).concat([{path:[],getErrorInfo:U("... (only showing first ten failures)")}]):t;return R(t,function(t){return"Failed path: ("+t.path.join(" > ")+")\n"+t.getErrorInfo()})}(t.errors).join("\n")+"\n\nInput object: "+Kt(t.input)},_n=function(t,n){return yn(t,Dt(n,rn))},Tn=Ct,En=function(t,n){return{tag:"custom",newKey:t,instantiator:n}},Dn=function(n){return xn(function(t){return A(n,t)?at.value(t):at.error('Unsupported value: "'+t+'", choose one of "'+n.join(", ")+'".')})},Bn=function(t){return Tn(t,t,jt(),ln())},An=function(t,n){return Tn(t,t,jt(),n)},Mn=function(t){return An(t,mn)},Fn=function(t,n){return Tn(t,t,jt(),Dn(n))},In=function(t){return An(t,pn)},Rn=function(t,n){return Tn(t,t,jt(),rn(n))},Vn=function(t,n){return Tn(t,t,jt(),sn(n))},Pn=function(t,n){return Tn(t,t,jt(),un(n))},Hn=function(t){return Tn(t,t,Gt(),ln())},zn=function(t,n){return Tn(t,t,Gt(),n)},Ln=function(t){return zn(t,dn)},Nn=function(t){return zn(t,mn)},jn=function(t){return zn(t,pn)},Wn=function(t,n){return zn(t,rn(n))},Un=function(t,n){return Tn(t,t,Ut(n),ln())},Gn=function(t,n,e){return Tn(t,t,Ut(n),e)},Xn=function(t,n){return Gn(t,n,dn)},Yn=function(t,n){return Gn(t,n,mn)},qn=function(t,n,e){return Gn(t,n,Dn(e))},Kn=function(t,n){return Gn(t,n,gn)},Jn=function(t,n){return Gn(t,n,pn)},$n=function(t,n,e){return Gn(t,n,un(e))},Qn=function(t,n,e){return Gn(t,n,rn(e))},Zn=function(t){var n=t;return{get:function(){return n},set:function(t){n=t}}},te=function(t){if(null===t||t===undefined)throw new Error("Node cannot be null or undefined");return{dom:t}},ne={fromHtml:function(t,n){n=(n||document).createElement("div");if(n.innerHTML=t,!n.hasChildNodes()||1<n.childNodes.length)throw console.error("HTML does not have a single root node",t),new Error("HTML must have a single root node");return te(n.childNodes[0])},fromTag:function(t,n){t=(n||document).createElement(t);return te(t)},fromText:function(t,n){t=(n||document).createTextNode(t);return te(t)},fromDom:te,fromPoint:function(t,n,e){return Z.from(t.dom.elementFromPoint(n,e)).map(te)}},ee=function(t,n){var e=function(t,n){for(var e=0;e<t.length;e++){var o=t[e];if(o.test(n))return o}return undefined}(t,n);if(!e)return{major:0,minor:0};t=function(t){return Number(n.replace(e,"$"+t))};return re(t(1),t(2))},oe=function(){return re(0,0)},re=function(t,n){return{major:t,minor:n}},ie={nu:re,detect:function(t,n){n=String(n).toLowerCase();return 0===t.length?oe():ee(t,n)},unknown:oe},ue=function(t,n){var e=String(n).toLowerCase();return L(t,function(t){return t.search(e)})},ae=function(t,e){return ue(t,e).map(function(t){var n=ie.detect(t.versionRegexes,e);return{current:t.name,version:n}})},ce=function(t,e){return ue(t,e).map(function(t){var n=ie.detect(t.versionRegexes,e);return{current:t.name,version:n}})},se=function(t,n,e){return""===n||t.length>=n.length&&t.substr(e,e+n.length)===n},le=function(t,n){return-1!==t.indexOf(n)},fe=function(t,n){return se(t,n,0)},de=function(t,n){return se(t,n,t.length-n.length)},me=(ct=/^\s+|\s+$/g,function(t){return t.replace(ct,"")}),ge=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,pe=function(n){return function(t){return le(t,n)}},he=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(t){return le(t,"edge/")&&le(t,"chrome")&&le(t,"safari")&&le(t,"applewebkit")}},{name:"Chrome",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,ge],search:function(t){return le(t,"chrome")&&!le(t,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(t){return le(t,"msie")||le(t,"trident")}},{name:"Opera",versionRegexes:[ge,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:pe("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:pe("firefox")},{name:"Safari",versionRegexes:[ge,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(t){return(le(t,"safari")||le(t,"mobile/"))&&le(t,"applewebkit")}}],ve=[{name:"Windows",search:pe("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(t){return le(t,"iphone")||le(t,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:pe("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:pe("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:pe("linux"),versionRegexes:[]},{name:"Solaris",search:pe("sunos"),versionRegexes:[]},{name:"FreeBSD",search:pe("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:pe("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}],be={browsers:U(he),oses:U(ve)},ye="Firefox",xe=function(t){var n=t.current,e=t.version,t=function(t){return function(){return n===t}};return{current:n,version:e,isEdge:t("Edge"),isChrome:t("Chrome"),isIE:t("IE"),isOpera:t("Opera"),isFirefox:t(ye),isSafari:t("Safari")}},we={unknown:function(){return xe({current:undefined,version:ie.unknown()})},nu:xe,edge:U("Edge"),chrome:U("Chrome"),ie:U("IE"),opera:U("Opera"),firefox:U(ye),safari:U("Safari")},Se="Windows",ke="Android",Ce="Solaris",Oe="FreeBSD",_e="ChromeOS",Te=function(t){var n=t.current,e=t.version,t=function(t){return function(){return n===t}};return{current:n,version:e,isWindows:t(Se),isiOS:t("iOS"),isAndroid:t(ke),isOSX:t("OSX"),isLinux:t("Linux"),isSolaris:t(Ce),isFreeBSD:t(Oe),isChromeOS:t(_e)}},Ee={unknown:function(){return Te({current:undefined,version:ie.unknown()})},nu:Te,windows:U(Se),ios:U("iOS"),android:U(ke),linux:U("Linux"),osx:U("OSX"),solaris:U(Ce),freebsd:U(Oe),chromeos:U(_e)},De=function(t,n){var e,o,r=be.browsers(),i=be.oses(),u=ae(r,t).fold(we.unknown,we.nu),a=ce(i,t).fold(Ee.unknown,Ee.nu);return{browser:u,os:a,deviceType:(e=u,o=t,r=n,u=(i=a).isiOS()&&!0===/ipad/i.test(o),t=i.isiOS()&&!u,n=i.isiOS()||i.isAndroid(),a=n||r("(pointer:coarse)"),r=u||!t&&n&&r("(min-device-width:768px)"),n=t||n&&!r,o=e.isSafari()&&i.isiOS()&&!1===/safari/i.test(o),{isiPad:U(u),isiPhone:U(t),isTablet:U(r),isPhone:U(n),isTouch:U(a),isAndroid:i.isAndroid,isiOS:i.isiOS,isWebView:U(o),isDesktop:U(!n&&!r&&!o)})}},Be=function(t){return window.matchMedia(t).matches},Ae=Nt(function(){return De(navigator.userAgent,Be)}),Me=function(t,n){t=t.dom;if(1!==t.nodeType)return!1;if(t.matches!==undefined)return t.matches(n);if(t.msMatchesSelector!==undefined)return t.msMatchesSelector(n);if(t.webkitMatchesSelector!==undefined)return t.webkitMatchesSelector(n);if(t.mozMatchesSelector!==undefined)return t.mozMatchesSelector(n);throw new Error("Browser lacks native selectors")},Fe=function(t){return 1!==t.nodeType&&9!==t.nodeType&&11!==t.nodeType||0===t.childElementCount},Ie=function(t,n){return t.dom===n.dom},Re=function(t,n){return e=t.dom,t=n.dom,n=Node.DOCUMENT_POSITION_CONTAINED_BY,0!=(e.compareDocumentPosition(t)&n);var e},Ve=function(t,n){return(Ae().browser.isIE()?Re:function(t,n){t=t.dom,n=n.dom;return t!==n&&t.contains(n)})(t,n)},Pe=function(u){if(!c(u))throw new Error("cases must be an array");if(0===u.length)throw new Error("there must be at least one case");var a=[],e={};return tt(u,function(t,o){var n=_t(t);if(1!==n.length)throw new Error("one and only one name per case");var r=n[0],i=t[r];if(e[r]!==undefined)throw new Error("duplicate key detected:"+r);if("cata"===r)throw new Error("cannot have a case named cata (sorry)");if(!c(i))throw new Error("case arguments must be an array");a.push(r),e[r]=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=e.length;if(n!==i.length)throw new Error("Wrong number of arguments to case "+r+". Expected "+i.length+" ("+i+"), got "+n);return{fold:function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];if(t.length!==u.length)throw new Error("Wrong number of arguments to fold. Expected "+u.length+", got "+t.length);return t[o].apply(null,e)},match:function(t){var n=_t(t);if(a.length!==n.length)throw new Error("Wrong number of arguments to match. Expected: "+a.join(",")+"\nActual: "+n.join(","));if(!W(a,function(t){return A(n,t)}))throw new Error("Not all branches were specified when using match. Specified: "+n.join(", ")+"\nRequired: "+a.join(", "));return t[r].apply(null,e)},log:function(t){console.log(t,{constructors:a,constructor:r,params:e})}}}}),e},He=(Pe([{bothErrors:["error1","error2"]},{firstError:["error1","value2"]},{secondError:["value1","error2"]},{bothValues:["value1","value2"]}]),function(t,n){return e=n,o={},Et(t,function(t,n){A(e,n)||(o[n]=t)}),o;var e,o}),ze=function(t,n){return(e={})[t]=n,e;var e},Le=function(t){return n={},tt(t,function(t){n[t.key]=t.value}),n;var n},Ne=function(t,n){var e,o,r=(e=[],o=[],tt(t,function(t){t.fold(function(t){e.push(t)},function(t){o.push(t)})}),{errors:e,values:o});return 0<r.errors.length?(t=r.errors,at.error(nt(t))):(n=n,0===(r=r.values).length?at.value(n):at.value(zt(n,Lt.apply(undefined,r))))},je=function(t){return l(t)?t:d},We=function(t,n,e){for(var o=t.dom,r=je(e);o.parentNode;){var o=o.parentNode,i=ne.fromDom(o),u=n(i);if(u.isSome())return u;if(r(i))break}return Z.none()},Ue=function(t,n,e){var o=n(t),r=je(e);return o.orThunk(function(){return r(t)?Z.none():We(t,n,r)})},Ge=function(t,n){return Ie(t.element,n.event.target)},Xe={can:S,abort:d,run:$},Ye=function(t){if(!Pt(t,"can")&&!Pt(t,"abort")&&!Pt(t,"run"))throw new Error("EventHandler defined by: "+JSON.stringify(t,null,2)+" does not have can, abort, or run!");return Q(Q({},Xe),t)},qe=function(e){var n,o,r,i;return{can:(o=function(t){return t.can},function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return z(n,function(t,n){return t&&o(n).apply(undefined,e)},!0)}),abort:(r=n=e,i=function(t){return t.abort},function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return z(r,function(t,n){return t||i(n).apply(undefined,e)},!1)}),run:function(){for(var n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];tt(e,function(t){t.run.apply(undefined,n)})}}},Ke=U,Je=Ke("touchstart"),$e=Ke("touchmove"),Qe=Ke("touchend"),Ze=Ke("touchcancel"),to=Ke("mousedown"),no=Ke("mousemove"),eo=Ke("mouseout"),oo=Ke("mouseup"),ro=Ke("mouseover"),io=Ke("focusin"),uo=Ke("focusout"),ao=Ke("keydown"),co=Ke("keyup"),so=Ke("input"),lo=Ke("change"),fo=Ke("click"),mo=Ke("transitionend"),go=Ke("selectstart"),po=function(t){return U("alloy."+t)},ho={tap:po("tap")},vo=po("focus"),bo=po("blur.post"),yo=po("paste.post"),xo=po("receive"),wo=po("execute"),So=po("focus.item"),ko=ho.tap,Co=po("longpress"),Oo=po("sandbox.close"),_o=po("typeahead.cancel"),To=po("system.init"),Eo=po("system.touchmove"),Do=po("system.touchend"),Bo=po("system.scroll"),Ao=po("system.resize"),Mo=po("system.attached"),Fo=po("system.detached"),Io=po("system.dismissRequested"),Ro=po("system.repositionRequested"),Vo=po("focusmanager.shifted"),Po=po("slotcontainer.visibility"),Ho=po("change.tab"),zo=po("dismiss.tab"),Lo=po("highlight"),No=po("dehighlight"),jo=function(t,n){Xo(t,t.element,n,{})},Wo=function(t,n,e){Xo(t,t.element,n,e)},Uo=function(t){jo(t,wo())},Go=function(t,n,e){Xo(t,n,e,{})},Xo=function(t,n,e,o){o=Q({target:n},o);t.getSystem().triggerEvent(e,n,o)},Yo=function(t,n,e,o){t.getSystem().triggerEvent(e,n,o.event)},qo=Le,Ko=function(t,n){return{key:t,value:Ye({abort:n})}},Jo=function(t){return{key:t,value:Ye({run:function(t,n){n.event.prevent()}})}},$o=function(t,n){return{key:t,value:Ye({run:n})}},Qo=function(t,e,o){return{key:t,value:Ye({run:function(t,n){e.apply(undefined,[t,n].concat(o))}})}},Zo=function(t){return function(e){return{key:t,value:Ye({run:function(t,n){Ge(t,n)&&e(t,n)}})}}},tr=function(t,n,e){var o,r,e=n.partUids[e];return r=e,$o(o=t,function(t,n){t.getSystem().getByUid(r).each(function(t){Yo(t,t.element,o,n)})})},nr=function(t,r){return $o(t,function(n,t){var e=t.event,o=n.getSystem().getByDom(e.target).getOrThunk(function(){return Ue(e.target,function(t){return n.getSystem().getByDom(t).toOptional()},d).getOr(n)});r(n,o,t)})},er=function(t){return $o(t,function(t,n){n.cut()})},or=function(t,n){return Zo(t)(n)},rr=Zo(Mo()),ir=Zo(Fo()),ur=Zo(To()),ar=(st=wo(),function(t){return $o(st,t)}),cr=("undefined"!=typeof window||Function("return this;")(),function(t){return t.dom.nodeName.toLowerCase()}),sr=function(n){return function(t){return t.dom.nodeType===n}},lr=sr(1),fr=sr(3),dr=sr(9),mr=sr(11),gr=function(t){return ne.fromDom(t.dom.ownerDocument)},pr=function(t){return dr(t)?t:gr(t)},hr=function(t){return ne.fromDom(pr(t).dom.documentElement)},vr=function(t){return ne.fromDom(pr(t).dom.defaultView)},br=function(t){return Z.from(t.dom.parentNode).map(ne.fromDom)},yr=br,xr=function(t){return Z.from(t.dom.offsetParent).map(ne.fromDom)},wr=function(t){return R(t.dom.childNodes,ne.fromDom)},Sr=function(t,n){t=t.dom.childNodes;return Z.from(t[n]).map(ne.fromDom)},kr=function(t){return mr(t)&&u(t.dom.host)},Cr=l(Element.prototype.attachShadow)&&l(Node.prototype.getRootNode),Or=U(Cr),_r=Cr?function(t){return ne.fromDom(t.dom.getRootNode())}:pr,Tr=function(t){return kr(t)?t:ne.fromDom(pr(t).dom.body)},Er=function(t){t=_r(t);return kr(t)?Z.some(t):Z.none()},Dr=function(t){return ne.fromDom(t.dom.host)},Br=function(t){return u(t.dom.shadowRoot)},Ar=function(n,e){br(n).each(function(t){t.dom.insertBefore(e.dom,n.dom)})},Mr=function(t,n){Z.from(t.dom.nextSibling).map(ne.fromDom).fold(function(){br(t).each(function(t){Ir(t,n)})},function(t){Ar(t,n)})},Fr=function(n,e){Sr(n,0).fold(function(){Ir(n,e)},function(t){n.dom.insertBefore(e.dom,t.dom)})},Ir=function(t,n){t.dom.appendChild(n.dom)},Rr=function(n,t){tt(t,function(t){Ir(n,t)})},Vr=function(t){t.dom.textContent="",tt(wr(t),function(t){Pr(t)})},Pr=function(t){t=t.dom;null!==t.parentNode&&t.parentNode.removeChild(t)},Hr=function(t){var n,e=wr(t);0<e.length&&(n=t,tt(e,function(t){Ar(n,t)})),Pr(t)},zr=function(t){return t.dom.innerHTML},Lr=function(t,n){var e=gr(t).dom,o=ne.fromDom(e.createDocumentFragment()),e=function(t,n){n=(n||document).createElement("div");return n.innerHTML=t,wr(ne.fromDom(n))}(n,e);Rr(o,e),Vr(t),Ir(t,o)},Nr=function(t,n,e){if(!(v(e)||y(e)||s(e)))throw console.error("Invalid call to Attribute.set. Key ",n,":: Value ",e,":: Element ",t),new Error("Attribute value was not simple");t.setAttribute(n,e+"")},jr=function(t,n,e){Nr(t.dom,n,e)},Wr=function(t,n){n=t.dom.getAttribute(n);return null===n?undefined:n},Ur=function(t,n){return Z.from(Wr(t,n))},Gr=function(t,n){t=t.dom;return!(!t||!t.hasAttribute)&&t.hasAttribute(n)},Xr=function(t,n){t.dom.removeAttribute(n)},Yr=function(t){return n=!1,ne.fromDom(t.dom.cloneNode(n));var n},qr=function(t){if(kr(t))return"#shadow-root";var n=Yr(t);return t=n,n=ne.fromTag("div"),t=ne.fromDom(t.dom.cloneNode(!0)),Ir(n,t),zr(n)},Kr=qo([{key:vo(),value:Ye({can:function(t,n){var e=n.event,o=e.originator,r=e.target;return n=r,!(Ie(e=o,t.element)&&!Ie(e,n))||(console.warn(vo()+" did not get interpreted by the desired target. \nOriginator: "+qr(o)+"\nTarget: "+qr(r)+"\nCheck the "+vo()+" event handlers"),!1)}})}]),Jr=Object.freeze({__proto__:null,events:Kr}),$r=0,Qr=function(t){var n=(new Date).getTime();return t+"_"+Math.floor(1e9*Math.random())+ ++$r+String(n)},Zr=U("alloy-id-"),ti=U("data-alloy-id"),ni=Zr(),ei=ti(),oi=function(t,n){Object.defineProperty(t.dom,ei,{value:n,writable:!0})},ri=function(t){t=lr(t)?t.dom[ei]:null;return Z.from(t)},ii=Qr,ui=h,ai=function(n){var e=function(t){return"The component must be in a context to execute: "+t+(n?"\n"+qr(n().element)+" is not in context.":"")},t=function(t){return function(){throw new Error(e(t))}},o=function(t){return function(){console.warn(e(t))}};return{debugInfo:U("fake"),triggerEvent:o("triggerEvent"),triggerFocus:o("triggerFocus"),triggerEscape:o("triggerEscape"),broadcast:o("broadcast"),broadcastOn:o("broadcastOn"),broadcastEvent:o("broadcastEvent"),build:t("build"),addToWorld:t("addToWorld"),removeFromWorld:t("removeFromWorld"),addToGui:t("addToGui"),removeFromGui:t("removeFromGui"),getByUid:t("getByUid"),getByDom:t("getByDom"),isConnected:d}},ci=ai(),si=function(t){return R(t,function(t){return de(t,"/*")?t.substring(0,t.length-"/*".length):t})},li=function(t,n){var e=t.toString(),o=e.indexOf(")")+1,r=e.indexOf("("),i=e.substring(r+1,o-1).split(/,\s*/);return t.toFunctionAnnotation=function(){return{name:n,parameters:si(i)}},t},fi=Qr("alloy-premade"),di=function(t){return ze(fi,t)},mi=function(o){return t=function(t){for(var n=[],e=1;e<arguments.length;e++)n[e-1]=arguments[e];return o.apply(void 0,p([t.getApis(),t],n))},e=(n=o).toString(),r=e.indexOf(")")+1,n=e.indexOf("("),i=e.substring(n+1,r-1).split(/,\s*/),t.toFunctionAnnotation=function(){return{name:"OVERRIDE",parameters:si(i.slice(1))}},t;var t,n,e,r,i},gi={init:function(){return pi({readState:U("No State required")})}},pi=function(t){return t},hi=function(t,r){var i={};return Et(t,function(t,o){Et(t,function(t,n){var e=Rt(i,n).getOr([]);i[n]=e.concat([r(o,t)])})}),i},vi=function(t){return{classes:o(t.classes)?[]:t.classes,attributes:o(t.attributes)?{}:t.attributes,styles:o(t.styles)?{}:t.styles}},bi=function(r,i,t,u){try{var n=q(t,function(t,n){var e=t[i],o=n[i],t=u.indexOf(e),n=u.indexOf(o);if(-1===t)throw new Error("The ordering for "+r+" does not have an entry for "+e+".\nOrder specified: "+JSON.stringify(u,null,2));if(-1===n)throw new Error("The ordering for "+r+" does not have an entry for "+o+".\nOrder specified: "+JSON.stringify(u,null,2));return t<n?-1:n<t?1:0});return at.value(n)}catch(e){return at.error([e])}},yi=function(t){return t.cHandler},xi=function(t,n){return{name:t,handler:n}},wi=function(t,n,e){var o,r,n=Q(Q({},e),(o=t,r={},tt(n,function(t){r[t.name()]=t.handlers(o)}),r));return hi(n,xi)},Si=function(t){var r=l(t=t)?{can:S,abort:d,run:t}:t;return function(t,n){for(var e=[],o=2;o<arguments.length;o++)e[o-2]=arguments[o];t=[t,n].concat(e);r.abort.apply(undefined,t)?n.stop():r.can.apply(undefined,t)&&r.run.apply(undefined,t)}},ki=function(t,n,e){n=n[e];return n?bi("Event: "+e,"name",t,n).map(function(t){t=R(t,function(t){return t.handler});return qe(t)}):at.error(["The event ("+e+') has more than one behaviour that listens to it.\nWhen this occurs, you must specify an event ordering for the behaviours in your spec (e.g. [ "listing", "toggling" ]).\nThe behaviours that can trigger it are: '+JSON.stringify(R(t,function(t){return t.name}),null,2)])},Ci=function(t,r){t=Mt(t,function(e,o){return(1===e.length?at.value(e[0].handler):ki(e,r,o)).map(function(t){var n=Si(t),t=1<e.length?P(r[o],function(n){return M(e,function(t){return t.name===n})}).join(" > "):e[0].name;return ze(o,{handler:n,purpose:t})})});return Ne(t,{})},Oi="alloy.base.behaviour",_i=rn([Tn("dom","dom",jt(),rn([Bn("tag"),Un("styles",{}),Un("classes",[]),Un("attributes",{}),Hn("value"),Hn("innerHtml")])),Bn("components"),Bn("uid"),Un("events",{}),Un("apis",{}),Tn("eventOrder","eventOrder",((lt={})[wo()]=["disabling",Oi,"toggling","typeaheadevents"],lt[vo()]=[Oi,"focusing","keying"],lt[To()]=[Oi,"disabling","toggling","representing"],lt[so()]=[Oi,"representing","streaming","invalidating"],lt[Fo()]=[Oi,"representing","item-events","tooltipping"],lt[to()]=["focusing",Oi,"item-type-events"],lt[Je()]=["focusing",Oi,"item-type-events"],lt[ro()]=["item-type-events","tooltipping"],lt[xo()]=["receiving","reflecting","tooltipping"],lt,Xt(U(lt))),ln()),Hn("domModification")]),Ti=function(t,n){n=Wr(t,n);return n===undefined||""===n?[]:n.split(" ")},Ei=function(t){return t.dom.classList!==undefined},Di=function(t,n){return function(t,n,e){e=Ti(t,n).concat([e]);return jr(t,n,e.join(" ")),!0}(t,"class",n)},Bi=function(t,n){return o=n,0<(t=P(Ti(e=t,n="class"),function(t){return t!==o})).length?jr(e,n,t.join(" ")):Xr(e,n),!1;var e,o},Ai=function(t,n){Ei(t)?t.dom.classList.add(n):Di(t,n)},Mi=function(t){0===(Ei(t)?t.dom.classList:Ti(t,"class")).length&&Xr(t,"class")},Fi=function(t,n){Ei(t)?t.dom.classList.remove(n):Bi(t,n),Mi(t)},Ii=function(t,n){return Ei(t)&&t.dom.classList.contains(n)},Ri=function(n,t){tt(t,function(t){Ai(n,t)})},Vi=function(n,t){tt(t,function(t){Fi(n,t)})},Pi=function(t,n,e){return void 0===e&&(e=r),t.exists(function(t){return e(t,n)})},Hi=function(t){for(var n=[],e=function(t){n.push(t)},o=0;o<t.length;o++)t[o].each(e);return n},zi=function(t,n,e){return t.isSome()&&n.isSome()?Z.some(e(t.getOrDie(),n.getOrDie())):Z.none()},Li=function(t,n){return t?Z.some(n):Z.none()},Ni=function(t){return t.style!==undefined&&l(t.style.getPropertyValue)},ji=function(t){var n=fr(t)?t.dom.parentNode:t.dom;if(n===undefined||null===n||null===n.ownerDocument)return!1;var e,o,r=n.ownerDocument;return Er(ne.fromDom(n)).fold(function(){return r.body.contains(n)},(e=ji,o=Dr,function(t){return e(o(t))}))},Wi=function(){return Ui(ne.fromDom(document))},Ui=function(t){t=t.dom.body;if(null===t||t===undefined)throw new Error("Body is not available yet");return ne.fromDom(t)},Gi=function(t,n,e){if(!v(e))throw console.error("Invalid call to CSS.set. Property ",n,":: Value ",e,":: Element ",t),new Error("CSS value must be a string: "+e);Ni(t)&&t.style.setProperty(n,e)},Xi=function(t,n){Ni(t)&&t.style.removeProperty(n)},Yi=function(t,n,e){t=t.dom;Gi(t,n,e)},qi=function(t,n){var e=t.dom;Et(n,function(t,n){Gi(e,n,t)})},Ki=function(t,n){var e=t.dom;Et(n,function(t,n){t.fold(function(){Xi(e,n)},function(t){Gi(e,n,t)})})},Ji=function(t,n){var e=t.dom,o=window.getComputedStyle(e).getPropertyValue(n);return""!==o||ji(t)?o:$i(e,n)},$i=function(t,n){return Ni(t)?t.style.getPropertyValue(n):""},Qi=function(t,n){t=t.dom,n=$i(t,n);return Z.from(n).filter(function(t){return 0<t.length})},Zi=function(t,n,e){t=ne.fromTag(t);return Yi(t,n,e),Qi(t,n).isSome()},tu=function(t,n){var e=t.dom;Xi(e,n),Pi(Ur(t,"style").map(me),"")&&Xr(t,"style")},nu=function(t){return t.dom.offsetWidth},eu=function(t){return t.dom.value},ou=function(t,n){if(n===undefined)throw new Error("Value.set was undefined");t.dom.value=n},ru=function(t){var e,n=ne.fromTag(t.tag);o=t.attributes,e=n.dom,Et(o,function(t,n){Nr(e,n,t)}),Ri(n,t.classes),qi(n,t.styles),t.innerHtml.each(function(t){return Lr(n,t)});var o=t.domChildren;return Rr(n,o),t.value.each(function(t){ou(n,t)}),t.uid,oi(n,t.uid),n},iu=function(t,n){return e=t,n=R(t=n,function(t){return Wn(t.name(),[Bn("config"),Un("state",gi)])}),n=Sn("component.behaviours",rn(n),e.behaviours).fold(function(t){throw new Error(On(t)+"\nComplete spec:\n"+JSON.stringify(e,null,2))},h),{list:t,data:Dt(n,function(t){t=t.map(function(t){return{config:t.config,state:t.state.init(t.config)}});return U(t)})};var e},uu=function(t){var n,e,n=(e=Rt(n=t,"behaviours").getOr({}),n=P(_t(e),function(t){return e[t]!==undefined}),R(n,function(t){return e[t].me}));return iu(t,n)},au=function(t,n,e){var o,o=Q(Q({},(o=t).dom),{uid:o.uid,domChildren:R(o.components,function(t){return t.element})}),t=t.domModification.fold(function(){return vi({})},vi),t=0<n.length?function(n,t,e,o){var r=Q({},t);tt(e,function(t){r[t.name()]=t.exhibit(n,o)});var i=hi(r,function(t,n){return{name:t,modification:n}}),u=function(t){return H(t,function(t,n){return Q(Q({},n.modification),t)},{})},t=H(i.classes,function(t,n){return n.modification.concat(t)},[]),e=u(i.attributes),i=u(i.styles);return vi({classes:t,attributes:e,styles:i})}(e,{"alloy.base.modification":t},n,o):t;return t=t,Q(Q({},o=o),{attributes:Q(Q({},o.attributes),t.attributes),styles:Q(Q({},o.styles),t.styles),classes:o.classes.concat(t.classes)})},cu=function(t,n,e){var o={"alloy.base.behaviour":t.events};return function(t,n,e,o){o=wi(t,e,o);return Ci(o,n)}(e,t.eventOrder,n,o).getOrDie()},su=function(e){var t=function(){return s},n=Zn(ci),o=kn(Sn("custom.definition",_i,e)),r=uu(e),i=r.list,u=r.data,r=au(o,i,u),a=ru(r),i=cu(o,i,u),c=Zn(o.components),s={getSystem:n.get,config:function(t){var n=u;return(l(n[t.name()])?n[t.name()]:function(){throw new Error("Could not find "+t.name()+" in "+JSON.stringify(e,null,2))})()},hasConfigured:function(t){return l(u[t.name()])},spec:e,readState:function(t){return u[t]().map(function(t){return t.state.readState()}).getOr("not enabled")},getApis:function(){return o.apis},connect:function(t){n.set(t)},disconnect:function(){n.set(ai(t))},element:a,syncComponents:function(){var t=wr(a),t=j(t,function(t){return n.get().getByDom(t).fold(function(){return[]},Y)});c.set(t)},components:c.get,events:i};return s},lu=function(t){var n=ui(t),e=n.events,t=g(n,["events"]),n=function(t){t=Rt(t,"components").getOr([]);return R(t,gu)}(t),n=Q(Q({},t),{events:Q(Q({},Jr),e),components:n});return at.value(su(n))},fu=function(t){t=ne.fromText(t);return du({element:t})},du=function(t){var n=Cn("external.component",on([Bn("element"),Hn("uid")]),t),e=Zn(ai());n.uid.each(function(t){oi(n.element,t)});var o={getSystem:e.get,config:Z.none,hasConfigured:d,connect:function(t){e.set(t)},disconnect:function(){e.set(ai(function(){return o}))},getApis:function(){return{}},element:n.element,spec:t,readState:U("No state"),syncComponents:$,components:U([]),events:{}};return di(o)},mu=ii,gu=function(n){return Rt(n,fi).getOrThunk(function(){var t=Vt(n,"uid")?n:Q({uid:mu("")},n);return lu(t).getOrDie()})},pu=di,hu=function(e,o){var t=function(t){var n=o(t);if(n<=0||null===n){t=Ji(t,e);return parseFloat(t)||0}return n},r=function(e,t){return z(t,function(t,n){n=Ji(e,n),n=n===undefined?0:parseInt(n,10);return isNaN(n)?t:t+n},0)};return{set:function(t,n){if(!s(n)&&!n.match(/^[0-9]+$/))throw new Error(e+".set accepts only positive integer values. Value was "+n);t=t.dom;Ni(t)&&(t.style[e]=n+"px")},get:t,getOuter:t,aggregate:r,max:function(t,n,e){e=r(t,e);return e<n?n-e:0}}},vu=hu("height",function(t){var n=t.dom;return ji(t)?n.getBoundingClientRect().height:n.offsetHeight}),bu=function(t){return vu.get(t)},yu=function(t){return vu.getOuter(t)},xu=function(e,o){return{left:e,top:o,translate:function(t,n){return xu(e+t,o+n)}}},wu=xu,Su=function(t,n){return t!==undefined?t:n!==undefined?n:0},ku=function(t){var n=t.dom.ownerDocument,e=n.body,o=n.defaultView,r=n.documentElement;if(e===t.dom)return wu(e.offsetLeft,e.offsetTop);var i=Su(null==o?void 0:o.pageYOffset,r.scrollTop),n=Su(null==o?void 0:o.pageXOffset,r.scrollLeft),o=Su(r.clientTop,e.clientTop),e=Su(r.clientLeft,e.clientLeft);return Cu(t).translate(n-e,i-o)},Cu=function(t){var n=t.dom,e=n.ownerDocument.body;return e===n?wu(e.offsetLeft,e.offsetTop):ji(t)?function(t){t=t.getBoundingClientRect();return wu(t.left,t.top)}(n):wu(0,0)},Ou=hu("width",function(t){return t.dom.offsetWidth}),_u=function(t){return Ou.get(t)},Tu=function(t){return Ou.getOuter(t)},Eu=function(t){var n=ne.fromDom(function(t){if(Or()&&u(t.target)){var n=ne.fromDom(t.target);if(lr(n)&&Br(n)&&t.composed&&t.composedPath){n=t.composedPath();if(n)return J(n)}}return Z.from(t.target)}(t).getOr(t.target)),e=function(){return t.stopPropagation()},o=function(){return t.preventDefault()},r=i(o,e);return{target:n,x:t.clientX,y:t.clientY,stop:e,prevent:o,kill:r,raw:t}},Du=function(t,n,e,o,r){var i,u,o=(i=e,u=o,function(t){i(t)&&u(Eu(t))});return t.dom.addEventListener(n,o,r),{unbind:x(Bu,t,n,o,r)}},Bu=function(t,n,e,o){t.dom.removeEventListener(n,e,o)},Au=function(t){var n=t!==undefined?t.dom:document,t=n.body.scrollLeft||n.documentElement.scrollLeft,n=n.body.scrollTop||n.documentElement.scrollTop;return wu(t,n)},Mu=function(t,n,e){e=(e!==undefined?e.dom:document).defaultView;e&&e.scrollTo(t,n)},Fu=function(t,n,e,o){return{x:t,y:n,width:e,height:o,right:t+e,bottom:n+o}},Iu=function(t){var e=t===undefined?window:t,t=e.document,o=Au(ne.fromDom(t));return function(t){t=t===undefined?window:t;return Z.from(t.visualViewport)}(e).fold(function(){var t=e.document.documentElement,n=t.clientWidth,t=t.clientHeight;return Fu(o.left,o.top,n,t)},function(t){return Fu(Math.max(t.pageLeft,o.left),Math.max(t.pageTop,o.top),t.width,t.height)})},Ru=function(e,t){return e.view(t).fold(U([]),function(t){var n=e.owner(t),n=Ru(e,n);return[t].concat(n)})},Vu=Object.freeze({__proto__:null,view:function(t){return(t.dom===document?Z.none():Z.from(null===(t=t.dom.defaultView)||void 0===t?void 0:t.frameElement)).map(ne.fromDom)},owner:gr}),Pu=function(e){var t=ne.fromDom(document),o=Au(t);return function(t,n){t=n.owner(t),t=Ru(n,t);return Z.some(t)}(e,Vu).fold(x(ku,e),function(t){var n=Cu(e),t=H(t,function(t,n){n=Cu(n);return{left:t.left+n.left,top:t.top+n.top}},{left:0,top:0});return wu(t.left+n.left+o.left,t.top+n.top+o.top)})},Hu=function(t,n,e,o){return{x:t,y:n,width:e,height:o,right:t+e,bottom:n+o}},zu=function(t){var n=ku(t),e=Tu(t),t=yu(t);return Hu(n.left,n.top,e,t)},Lu=function(t){var n=Pu(t),e=Tu(t),t=yu(t);return Hu(n.left,n.top,e,t)},Nu=function(){return Iu(window)};function ju(t,n,e,o,r){return t(e,o)?Z.some(e):l(r)&&r(e)?Z.none():n(e,o,r)}var Wu,Uu=function(t,n,e){for(var o=t.dom,r=l(e)?e:d;o.parentNode;){var o=o.parentNode,i=ne.fromDom(o);if(n(i))return Z.some(i);if(r(i))break}return Z.none()},Gu=function(t,n,e){return ju(function(t,n){return n(t)},Uu,t,n,e)},Xu=function(t,n,e){return Gu(t,n,e).isSome()},Yu=function(t,n,e){return Uu(t,function(t){return Me(t,n)},e)},qu=function(t,n){return function(t,n){n=n===undefined?document:n.dom;return Fe(n)?Z.none():Z.from(n.querySelector(t)).map(ne.fromDom)}(n,t)},Ku=function(t,n,e){return ju(Me,Yu,t,n,e)},Ju=function(){var n=Qr("aria-owns");return{id:n,link:function(t){jr(t,"aria-owns",n)},unlink:function(t){Xr(t,"aria-owns")}}},$u=function(n,t){return Gu(t,function(t){if(!lr(t))return!1;t=Wr(t,"id");return t!==undefined&&-1<t.indexOf("aria-owns")}).bind(function(t){var n=Wr(t,"id"),t=_r(t);return qu(t,'[aria-owns="'+n+'"]')}).exists(function(t){return Qu(n,t)})},Qu=function(n,t){return Xu(t,function(t){return Ie(t,n.element)},d)||$u(n,t)},Zu="unknown";(pl=Wu=Wu||{})[pl.STOP=0]="STOP",pl[pl.NORMAL=1]="NORMAL",pl[pl.LOGGING=2]="LOGGING";var ta,na=Zn({}),ea=["alloy/data/Fields","alloy/debugging/Debugging"],oa=function(n,t,e){var o,r,i,u;switch(Rt(na.get(),n).orThunk(function(){var t=_t(na.get());return rt(t,function(t){return-1<n.indexOf(t)?Z.some(na.get()[t]):Z.none()})}).getOr(Wu.NORMAL)){case Wu.NORMAL:return e(ra());case Wu.LOGGING:var a=(o=n,r=t,i=[],u=(new Date).getTime(),{logEventCut:function(t,n,e){i.push({outcome:"cut",target:n,purpose:e})},logEventStopped:function(t,n,e){i.push({outcome:"stopped",target:n,purpose:e})},logNoParent:function(t,n,e){i.push({outcome:"no-parent",target:n,purpose:e})},logEventNoHandlers:function(t,n){i.push({outcome:"no-handlers-left",target:n})},logEventResponse:function(t,n,e){i.push({outcome:"response",purpose:e,target:n})},write:function(){var t=(new Date).getTime();A(["mousemove","mouseover","mouseout",To()],o)||console.log(o,{event:o,time:t-u,target:r.dom,sequence:R(i,function(t){return A(["cut","stopped","response"],t.outcome)?"{"+t.purpose+"} "+t.outcome+" at ("+qr(t.target)+")":t.outcome})})}}),c=e(a);return a.write(),c;case Wu.STOP:return!0}},ra=U({logEventCut:$,logEventStopped:$,logNoParent:$,logEventNoHandlers:$,logEventResponse:$,write:$}),ia=U([Bn("menu"),Bn("selectedMenu")]),ua=U([Bn("item"),Bn("selectedItem")]),aa=(U(rn(ua().concat(ia()))),U(rn(ua()))),ca=Rn("initSize",[Bn("numColumns"),Bn("numRows")]),sa=function(){return Rn("markers",[Bn("backgroundMenu")].concat(ia()).concat(ua()))},la=function(t){return Rn("markers",R(t,Bn))},fa=function(t,n,e){!function(){var t=new Error;if(t.stack===undefined)return;t=t.stack.split("\n");L(t,function(n){return 0<n.indexOf("alloy")&&!M(ea,function(t){return-1<n.indexOf(t)})}).getOr(Zu)}();return Tn(n,n,e,xn(function(e){return at.value(function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return e.apply(undefined,t)})}))},da=function(t){return fa(0,t,Ut($))},ma=function(t){return fa(0,t,Ut(Z.none))},ga=function(t){return fa(0,t,jt())},pa=function(t){return fa(0,t,jt())},ha=function(t,n){return En(t,U(n))},va=function(t){return En(t,h)},t=U(ca),ba=function(t,n,e,o,r,i,u,a){return{x:t,y:n,bubble:e,direction:o,placement:r,restriction:i,label:u+"-"+r,alwaysFit:a=void 0===a?!1:a}},e=Pe([{southeast:[]},{southwest:[]},{northeast:[]},{northwest:[]},{south:[]},{north:[]},{east:[]},{west:[]}]),ya=e.southeast,xa=e.southwest,wa=e.northeast,Sa=e.northwest,ka=e.south,Ca=e.north,Oa=e.east,_a=e.west,Ta=function(t,n,e,o){n=t+n;return o<n?e:n<e?o:n},Ea=function(t,n,e){return Math.min(Math.max(t,n),e)},Da=function(n,e){return function(t,n){for(var e={},o=0,r=t.length;o<r;o++){var i=t[o];e[String(i)]=n(i,o)}return e}(["left","right","top","bottom"],function(t){return Rt(e,t).map(function(t){return function(t,n){switch(n){case 1:return t.x;case 0:return t.x+t.width;case 2:return t.y;case 3:return t.y+t.height}}(n,t)})})},Ba="layout",Aa=function(t,n){return t.x+t.width/2-n.width/2},Ma=function(t,n){return t.x+t.width-n.width},Fa=function(t,n){return t.y-n.height},Ia=function(t){return t.y+t.height},Ra=function(t,n){return t.y+t.height/2-n.height/2},Va=function(t,n,e){return ba(t.x,Ia(t),e.southeast(),ya(),"southeast",Da(t,{left:1,top:3}),Ba)},Pa=function(t,n,e){return ba(Ma(t,n),Ia(t),e.southwest(),xa(),"southwest",Da(t,{right:0,top:3}),Ba)},Ha=function(t,n,e){return ba(t.x,Fa(t,n),e.northeast(),wa(),"northeast",Da(t,{left:1,bottom:2}),Ba)},za=function(t,n,e){return ba(Ma(t,n),Fa(t,n),e.northwest(),Sa(),"northwest",Da(t,{right:0,bottom:2}),Ba)},La=function(t,n,e){return ba(Aa(t,n),Fa(t,n),e.north(),Ca(),"north",Da(t,{bottom:2}),Ba)},Na=function(t,n,e){return ba(Aa(t,n),Ia(t),e.south(),ka(),"south",Da(t,{top:3}),Ba)},ja=function(t,n,e){return ba(t.x+t.width,Ra(t,n),e.east(),Oa(),"east",Da(t,{left:0}),Ba)},Wa=function(t,n,e){return ba(t.x-n.width,Ra(t,n),e.west(),_a(),"west",Da(t,{right:1}),Ba)},Ua=function(){return[Va,Pa,Ha,za,Na,La,ja,Wa]},Ga=function(){return[Pa,Va,za,Ha,Na,La,ja,Wa]},Xa=function(){return[Ha,za,Va,Pa,La,Na]},Ya=function(){return[za,Ha,Pa,Va,La,Na]},qa=function(){return[Va,Pa,Ha,za,Na,La]},Ka=function(){return[Pa,Va,za,Ha,Na,La]},Ja=Object.freeze({__proto__:null,events:function(u){return qo([$o(xo(),function(o,t){var n,r=u.channels,e=_t(r),i=t,e=(e=e,(n=i).universal?e:P(e,function(t){return A(n.channels,t)}));tt(e,function(t){var n=r[t],e=n.schema,e=Cn("channel["+t+"] data\nReceiver: "+qr(o.element),e,i.data);n.onReceive(o,e)})})])}}),C=[An("channels",wn(at.value,on([ga("onReceive"),Un("schema",ln())])))],$a=function(e,o,r){return ur(function(t,n){r(t,e,o)})},Qa=function(t,n,e,o,r,i){var u=on(t),t=Wn(n,[zn("config",on(t))]);return nc(u,t,n,e,o,r,i)},Za=function(r,i,u){var t,n,e,o,a,c;return t=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var o=[e].concat(t);return e.config({name:U(r)}).fold(function(){throw new Error("We could not find any behaviour configuration for: "+r+". Using API: "+u)},function(t){var n=Array.prototype.slice.call(o,1);return i.apply(undefined,[e,t.config,t.state].concat(n))})},n=u,o=(e=i).toString(),a=o.indexOf(")")+1,e=o.indexOf("("),c=o.substring(e+1,a-1).split(/,\s*/),t.toFunctionAnnotation=function(){return{name:n,parameters:si(c.slice(0,1).concat(c.slice(3)))}},t},tc=function(t){return{key:t,value:undefined}},nc=function(e,t,o,n,r,i,u){var a=function(t){return Pt(t,o)?t[o]():Z.none()},r=Dt(r,function(t,n){return Za(o,t,n)}),i=Dt(i,li),c=Q(Q(Q({},i),r),{revoke:x(tc,o),config:function(t){var n=Cn(o+"-config",e,t);return{key:o,value:{config:n,me:c,configAsRaw:Nt(function(){return Cn(o+"-config",e,t)}),initialConfig:t,state:u}}},schema:U(t),exhibit:function(t,e){return zi(a(t),Rt(n,"exhibit"),function(t,n){return n(e,t.config,t.state)}).getOrThunk(function(){return vi({})})},name:U(o),handlers:function(t){return a(t).map(function(t){return Rt(n,"events").getOr(function(){return{}})(t.config,t.state)}).getOr({})}});return c},ec=Le,oc=on([Bn("fields"),Bn("name"),Un("active",{}),Un("apis",{}),Un("state",gi),Un("extra",{})]),rc=function(t){t=Cn("Creating behaviour: "+t.name,oc,t);return Qa(t.fields,t.name,t.active,t.apis,t.extra,t.state)},ic=on([Bn("branchKey"),Bn("branches"),Bn("name"),Un("active",{}),Un("apis",{}),Un("state",gi),Un("extra",{})]),uc=function(t){var n,e,o,r,i,u=Cn("Creating behaviour: "+t.name,ic,t);return n=_n(u.branchKey,u.branches),e=u.name,o=u.active,r=u.apis,i=u.extra,t=u.state,n=Wn(e,[zn("config",u=n)]),nc(u,n,e,o,r,i,t)},ac=U(undefined),cc=rc({fields:C,name:"receiving",active:Ja}),Ht=Object.freeze({__proto__:null,exhibit:function(t,n){return vi({classes:[],styles:n.useFixed()?{}:{position:"relative"}})}}),sc=function(t){return t.dom.focus()},lc=function(t){var n=_r(t).dom;return t.dom===n.activeElement},fc=function(t){return void 0===t&&(t=ne.fromDom(document)),Z.from(t.dom.activeElement).map(ne.fromDom)},dc=function(n){return fc(_r(n)).filter(function(t){return n.dom.contains(t.dom)})},mc=function(t,e){var o=_r(e),n=fc(o).bind(function(n){var o,r,t=function(t){return Ie(n,t)};return t(e)?Z.some(e):(o=t,(r=function(t){for(var n=0;n<t.childNodes.length;n++){var e=ne.fromDom(t.childNodes[n]);if(o(e))return Z.some(e);e=r(t.childNodes[n]);if(e.isSome())return e}return Z.none()})(e.dom))}),t=t(e);return n.each(function(n){fc(o).filter(function(t){return Ie(t,n)}).fold(function(){sc(n)},$)}),t},gc=function(t,n,e,o,r){return{position:t,left:n,top:e,right:o,bottom:r}},pc=function(t,n){var e=function(t){return t+"px"};Ki(t,{position:Z.some(n.position),left:n.left.map(e),top:n.top.map(e),right:n.right.map(e),bottom:n.bottom.map(e)})},fn=Pe([{none:[]},{relative:["x","y","width","height"]},{fixed:["x","y","width","height"]}]),hc=function(t,n,e,o,r,i){var u=n.rect,a=u.x-e,c=u.y-o,s=r-(a+u.width),e=i-(c+u.height),l=Z.some(a),f=Z.some(c),d=Z.some(s),m=Z.some(e),g=Z.none();return o=n.direction,r=function(){return gc(t,l,f,g,g)},i=function(){return gc(t,g,f,d,g)},u=function(){return gc(t,l,g,g,m)},a=function(){return gc(t,g,g,d,m)},c=function(){return gc(t,l,f,g,g)},s=function(){return gc(t,l,g,g,m)},e=function(){return gc(t,l,f,g,g)},n=function(){return gc(t,g,f,d,g)},o.fold(r,i,u,a,c,s,e,n)},vc=function(t,n){var e=x(Pu,n),o=t.fold(e,e,function(){var t=Au();return Pu(n).translate(-t.left,-t.top)}),t=Tu(n),e=yu(n);return Hu(o.left,o.top,t,e)},bc=function(t,n,e){var o=wu(n,e);return t.fold(U(o),U(o),function(){var t=Au();return o.translate(-t.left,-t.top)})},yc=(fn.none,fn.relative),xc=fn.fixed,wc="data-alloy-placement",Sc=Pe([{fit:["reposition"]},{nofit:["reposition","visibleW","visibleH","isVisible"]}]),kc=function(t,n,e,o){var i,u,a,r,c,s,l,f,d,m,g,p,h,v,b=t.bubble,y=b.offset,x=(i=o,u=t.restriction,a=y,f=(s=function(o,r){return u[o].map(function(t){var n="top"===o||"bottom"===o,e=n?a.top:a.left,e=("left"===o||"top"===o?Math.max:Math.min)(t,r)+e;return n?Ea(e,i.y,i.bottom):Ea(e,i.x,i.right)}).getOr(r)})("left",i.x),l=s("top",i.y),c=s("right",i.right),s=s("bottom",i.bottom),Hu(f,l,c-f,s-l)),w=t.x+y.left,S=t.y+y.top,k=Hu(w,S,n,e),d=(d=k,r=x,c=x.x,f=x.y,s=x.right,l=x.bottom,y=k.x,w=k.y,n=k.right,e=k.bottom,r=k.width,d=k.height,{originInBounds:c<=y&&y<=s&&(f<=w&&w<=l),sizeInBounds:n<=s&&c<=n&&(e<=l&&f<=e),visibleW:Math.min(r,c<=y?s-y:n-c),visibleH:Math.min(d,f<=w?l-w:e-f)}),l=d.visibleW,w=d.visibleH,e=d.originInBounds&&d.sizeInBounds,m=e?k:(h=k,f=(g=x).x,d=g.y,p=g.right,v=g.bottom,k=h.x,x=h.y,m=h.width,C=h.height,g=Math.max(f,p-m),h=Math.max(d,v-C),g=Ea(k,f,g),h=Ea(x,d,h),p=Math.min(g+m,p)-g,v=Math.min(h+C,v)-h,Hu(g,h,p,v)),C=0<m.width&&0<m.height,v=(g=t.direction,h=o,v=U((p=m).bottom-h.y),o=U(h.bottom-p.y),v=g.fold(o,o,v,v,o,v,o,o),o=U(p.right-h.x),p=U(h.right-p.x),{maxWidth:g.fold(p,o,p,o,p,p,p,o),maxHeight:v}),S={rect:m,maxHeight:v.maxHeight,maxWidth:v.maxWidth,direction:t.direction,placement:t.placement,classes:{on:b.classesOn,off:b.classesOff},label:t.label,testY:S};return e||t.alwaysFit?Sc.fit(S):Sc.nofit(S,l,w,C)},Cc=function(t,n,e,o){tu(n,"max-height"),tu(n,"max-width");var r,s,l,f,d,m,g,p,i,r={width:Tu(r=n),height:yu(r)};return s=n,n=o.preference,l=t,f=r,d=e,m=o.bounds,g=f.width,p=f.height,i=function(t,r,i,u,a){var t=t(l,f,d,s),c=kc(t,g,p,m);return c.fold(U(c),function(t,n,e,o){return(a===o?u<e||i<n:!a&&o)?c:Sc.nofit(r,i,u,a)})},z(n,function(t,n){n=x(i,n);return t.fold(U(t),n)},Sc.nofit({rect:l,maxHeight:f.height,maxWidth:f.width,direction:ya(),placement:"southeast",classes:{on:[],off:[]},label:"none",testY:l.y},-1,-1,!1)).fold(h,h)},Oc=function(t,n,e){var r;pc(t,(e=e.origin,r=n,e.fold(function(){var t=r.rect;return gc("absolute",Z.some(t.x),Z.some(t.y),Z.none(),Z.none())},function(t,n,e,o){return hc("absolute",r,t,n,e,o)},function(t,n,e,o){return hc("fixed",r,t,n,e,o)})))},_c=function(t,n){n=n.placement,jr(t,wc,n)},Tc=function(t,n){!function(t,n){n=vu.max(t,n,["margin-top","border-top-width","padding-top","padding-bottom","border-bottom-width","margin-bottom"]);Yi(t,"max-height",n+"px")}(t,Math.floor(n))},Ec=U(function(t,n){Tc(t,n),qi(t,{"overflow-x":"hidden","overflow-y":"auto"})}),Dc=U(function(t,n){Tc(t,n)}),Bc=function(t,n,e){return t[n]===undefined?e:t[n]},Ac=function(t,n,e,o,r,i){var u,a=Bc(i,"maxHeightFunction",Ec()),c=Bc(i,"maxWidthFunction",$),i=t.anchorBox,t=t.origin,c={bounds:(u=t,r.fold(function(){return u.fold(Nu,Nu,Hu)},function(e){return u.fold(e,e,function(){var t=e(),n=bc(u,t.x,t.y);return Hu(n.left,n.top,t.width,t.height)})})),origin:t,preference:o,maxHeightFunction:a,maxWidthFunction:c};Mc(i,n,e,c)},Mc=function(t,n,e,o){e=Cc(t,n,e,o);Oc(n,e,o),_c(n,e),function(t,n){n=n.classes;Vi(t,n.off),Ri(t,n.on)}(n,e),(0,o.maxHeightFunction)(n,e.maxHeight),(0,o.maxWidthFunction)(n,e.maxWidth)},Fc=["valignCentre","alignLeft","alignRight","alignCentre","top","bottom","left","right"],Ic=function(t,n,e){var r=function(t){return Rt(e,t).getOr([])},o=function(t,n,e){var o=X(Fc,e);return{offset:wu(t,n),classesOn:j(e,r),classesOff:j(o,r)}};return{southeast:function(){return o(-t,n,["top","alignLeft"])},southwest:function(){return o(t,n,["top","alignRight"])},south:function(){return o(-t/2,n,["top","alignCentre"])},northeast:function(){return o(-t,-n,["bottom","alignLeft"])},northwest:function(){return o(t,-n,["bottom","alignRight"])},north:function(){return o(-t/2,-n,["bottom","alignCentre"])},east:function(){return o(t,-n/2,["valignCentre","left"])},west:function(){return o(-t,-n/2,["valignCentre","right"])},innerNortheast:function(){return o(t,n,["top","alignLeft"])},innerNorthwest:function(){return o(-t,n,["top","alignRight"])},innerNorth:function(){return o(-t/2,n,["top","alignCentre"])},innerSoutheast:function(){return o(t,-n,["bottom","alignLeft"])},innerSouthwest:function(){return o(-t,-n,["bottom","alignRight"])},innerSouth:function(){return o(-t/2,-n,["bottom","alignCentre"])},innerEast:function(){return o(-t,-n/2,["valignCentre","right"])},innerWest:function(){return o(t,-n/2,["valignCentre","left"])}}},Rc=function(){return Ic(0,0,{})},Vc=h,Pc=function(n,e){return function(t){return"rtl"===Hc(t)?e:n}},Hc=function(t){return"rtl"===Ji(t,"direction")?"rtl":"ltr"};(ge=ta=ta||{}).TopToBottom="toptobottom",ge.BottomToTop="bottomtotop";var zc,Lc,Nc,jc,Wc="data-alloy-vertical-dir",Uc=function(t){return Xu(t,function(t){return lr(t)&&Wr(t,"data-alloy-vertical-dir")===ta.BottomToTop})},pe=function(){return Wn("layouts",[Bn("onLtr"),Bn("onRtl"),Hn("onBottomLtr"),Hn("onBottomRtl")])},Gc=function(n,t,e,o,r,i,u){var a=u.map(Uc).getOr(!1),c=t.layouts.map(function(t){return t.onLtr(n)}),u=t.layouts.map(function(t){return t.onRtl(n)}),e=a?t.layouts.bind(function(t){return t.onBottomLtr.map(function(t){return t(n)})}).or(c).getOr(r):c.getOr(e),o=a?t.layouts.bind(function(t){return t.onBottomRtl.map(function(t){return t(n)})}).or(u).getOr(i):u.getOr(o);return Pc(e,o)(n)},he=[Bn("hotspot"),Hn("bubble"),Un("overrides",{}),pe(),ha("placement",function(t,n,e){var o=n.hotspot,o=vc(e,o.element),t=Gc(t.element,n,qa(),Ka(),Xa(),Ya(),Z.some(n.hotspot.element));return Z.some(Vc({anchorBox:o,bubble:n.bubble.getOr(Rc()),overrides:n.overrides,layouts:t,placer:Z.none()}))})],ve=[Bn("x"),Bn("y"),Un("height",0),Un("width",0),Un("bubble",Rc()),Un("overrides",{}),pe(),ha("placement",function(t,n,e){e=bc(e,n.x,n.y),e=Hu(e.left,e.top,n.width,n.height),t=Gc(t.element,n,Ua(),Ga(),Ua(),Ga(),Z.none());return Z.some(Vc({anchorBox:e,bubble:n.bubble,overrides:n.overrides,layouts:t,placer:Z.none()}))})],Ke=Pe([{screen:["point"]},{absolute:["point","scrollLeft","scrollTop"]}]),Xc=function(t){return t.fold(h,function(t,n,e){return t.translate(-n,-e)})},Yc=function(t){return t.fold(h,h)},qc=function(t){return z(t,function(t,n){return t.translate(n.left,n.top)},wu(0,0))},Kc=function(t){t=R(t,Yc);return qc(t)},Jc=Ke.screen,$c=Ke.absolute,Qc=function(t,n,e){var o=gr(t.element),o=Au(o),e=function(e,t){t=vr(t.root).dom;return Z.from(t.frameElement).map(ne.fromDom).filter(function(t){var n=gr(t),t=gr(e.element);return Ie(n,t)}).map(ku)}(t,e).getOr(o);return $c(e,o.left,o.top)},Zc=function(t,n,e,o){n=Jc(wu(t,n));return Z.some({point:n,width:e,height:o})},ts=function(t,i,u,a,c){return t.map(function(t){var n,e=[i,t.point],o=(n=function(){return Kc(e)},o=function(){return Kc(e)},r=function(){return function(t){t=R(t,Xc);return qc(t)}(e)},a.fold(n,o,r)),r={x:o.left,y:o.top,width:t.width,height:t.height},o=(u.showAbove?Xa:qa)(),t=(u.showAbove?Ya:Ka)(),t=Gc(c,u,o,t,o,t,Z.none());return Vc({anchorBox:r,bubble:u.bubble.getOr(Rc()),overrides:u.overrides,layouts:t,placer:Z.none()})})},ho=[Bn("node"),Bn("root"),Hn("bubble"),pe(),Un("overrides",{}),Un("showAbove",!1),ha("placement",function(e,o,r){var i=Qc(e,0,o);return o.node.filter(ji).bind(function(t){var n=t.dom.getBoundingClientRect(),t=Zc(n.left,n.top,n.width,n.height),n=o.node.getOr(e.element);return ts(t,i,o,r,n)})})],ns=function(t,n,e,o){return{start:t,soffset:n,finish:e,foffset:o}},po=Pe([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),es=(po.before,po.on,po.after,function(t){return t.fold(h,h,h)}),os=Pe([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),rs={domRange:os.domRange,relative:os.relative,exact:os.exact,exactFromRange:function(t){return os.exact(t.start,t.soffset,t.finish,t.foffset)},getWin:function(t){t=t.match({domRange:function(t){return ne.fromDom(t.startContainer)},relative:function(t,n){return es(t)},exact:function(t,n,e,o){return t}});return vr(t)},range:ns},is=function(t,n,e){var o,r,t=t.document.createRange();return o=t,n.fold(function(t){o.setStartBefore(t.dom)},function(t,n){o.setStart(t.dom,n)},function(t){o.setStartAfter(t.dom)}),r=t,e.fold(function(t){r.setEndBefore(t.dom)},function(t,n){r.setEnd(t.dom,n)},function(t){r.setEndAfter(t.dom)}),t},us=function(t,n,e,o,r){t=t.document.createRange();return t.setStart(n.dom,e),t.setEnd(o.dom,r),t},as=function(t){return{left:t.left,top:t.top,right:t.right,bottom:t.bottom,width:t.width,height:t.height}},cs=Pe([{ltr:["start","soffset","finish","foffset"]},{rtl:["start","soffset","finish","foffset"]}]),ss=function(t,n,e){return n(ne.fromDom(e.startContainer),e.startOffset,ne.fromDom(e.endContainer),e.endOffset)},ls=function(t,n){var r,e,n=(r=t,n.match({domRange:function(t){return{ltr:U(t),rtl:Z.none}},relative:function(t,n){return{ltr:Nt(function(){return is(r,t,n)}),rtl:Nt(function(){return Z.some(is(r,n,t))})}},exact:function(t,n,e,o){return{ltr:Nt(function(){return us(r,t,n,e,o)}),rtl:Nt(function(){return Z.some(us(r,e,o,t,n))})}}}));return(e=(n=n).ltr()).collapsed?n.rtl().filter(function(t){return!1===t.collapsed}).map(function(t){return cs.rtl(ne.fromDom(t.endContainer),t.endOffset,ne.fromDom(t.startContainer),t.startOffset)}).getOrThunk(function(){return ss(0,cs.ltr,e)}):ss(0,cs.ltr,e)},fs=(cs.ltr,cs.rtl,zc=fr,Lc="text",{get:function(t){if(!zc(t))throw new Error("Can only get "+Lc+" value of a "+Lc+" node");return Nc(t).getOr("")},getOption:Nc=function(t){return zc(t)?Z.from(t.dom.nodeValue):Z.none()},set:function(t,n){if(!zc(t))throw new Error("Can only set raw "+Lc+" value of a "+Lc+" node");t.dom.nodeValue=n}}),ds=function(t){return fs.getOption(t)},ms=["img","br"],gs=function(t){return ds(t).filter(function(t){return 0!==t.trim().length||-1<t.indexOf("\xa0")}).isSome()||A(ms,cr(t))},ps=function(t,r){var i=function(t){for(var n=wr(t),e=n.length-1;0<=e;e--){var o=n[e];if(r(o))return Z.some(o);o=i(o);if(o.isSome())return o}return Z.none()};return i(t)},hs=function(t,n){return function(t,n){n=n===undefined?document:n.dom;return Fe(n)?[]:R(n.querySelectorAll(t),ne.fromDom)}(n,t)},vs=function(t,n,e,o){var r,i,u,a,c,c=(i=n,u=e,a=o,(c=gr(r=t).dom.createRange()).setStart(r.dom,i),c.setEnd(u.dom,a),c),o=Ie(t,e)&&n===o;return c.collapsed&&!o},bs=function(t){if(0<t.rangeCount){var n=t.getRangeAt(0),t=t.getRangeAt(t.rangeCount-1);return Z.some(ns(ne.fromDom(n.startContainer),n.startOffset,ne.fromDom(t.endContainer),t.endOffset))}return Z.none()},ys=function(t){if(null===t.anchorNode||null===t.focusNode)return bs(t);var n=ne.fromDom(t.anchorNode),e=ne.fromDom(t.focusNode);return vs(n,t.anchorOffset,e,t.focusOffset)?Z.some(ns(n,t.anchorOffset,e,t.focusOffset)):bs(t)},xs=function(t){return Z.from(t.getSelection()).filter(function(t){return 0<t.rangeCount}).bind(ys)},ws=function(t,n){var i,t=ls(i=t,n).match({ltr:function(t,n,e,o){var r=i.document.createRange();return r.setStart(t.dom,n),r.setEnd(e.dom,o),r},rtl:function(t,n,e,o){var r=i.document.createRange();return r.setStart(e.dom,o),r.setEnd(t.dom,n),r}});return 0<(n=0<(t=(n=t).getClientRects()).length?t[0]:n.getBoundingClientRect()).width||0<n.height?Z.some(n).map(as):Z.none()},Ss=function(t,n){return{element:t,offset:n}},ks=function(t,n){var e=wr(t);if(0===e.length)return Ss(t,n);if(n<e.length)return Ss(e[n],0);n=e[e.length-1],e=fr(n)?fs.get(n).length:wr(n).length;return Ss(n,e)},Cs=function(t,n){return(fr(t)?Ss:ks)(t,n)},Os=function(t,n){return n.getSelection.getOrThunk(function(){return function(){return xs(t)}})().map(function(t){var n=Cs(t.start,t.soffset),t=Cs(t.finish,t.foffset);return rs.range(n.element,n.offset,t.element,t.offset)})},sr=[Hn("getSelection"),Bn("root"),Hn("bubble"),pe(),Un("overrides",{}),Un("showAbove",!1),ha("placement",function(t,n,e){var o=vr(n.root).dom,r=Qc(t,0,n),i=Os(o,n).bind(function(t){return ws(o,rs.exactFromRange(t)).orThunk(function(){var n=ne.fromText("\ufeff");return Ar(t.start,n),ws(o,rs.exact(n,0,n,1)).map(function(t){return Pr(n),t})}).bind(function(t){return Zc(t.left,t.top,t.width,t.height)})}),t=Os(o,n).bind(function(t){return lr(t.start)?Z.some(t.start):yr(t.start)}).getOr(t.element);return ts(i,r,n,e,t)})],_s="link-layout",Ts=function(t){return t.x+t.width},Es=function(t,n){return t.x-n.width},Ds=function(t,n){return t.y-n.height+t.height},Bs=function(t,n,e){return ba(Ts(t),t.y,e.southeast(),ya(),"southeast",Da(t,{left:0,top:2}),_s)},As=function(t,n,e){return ba(Es(t,n),t.y,e.southwest(),xa(),"southwest",Da(t,{right:1,top:2}),_s)},Ms=function(t,n,e){return ba(Ts(t),Ds(t,n),e.northeast(),wa(),"northeast",Da(t,{left:0,bottom:3}),_s)},Fs=function(t,n,e){return ba(Es(t,n),Ds(t,n),e.northwest(),Sa(),"northwest",Da(t,{right:1,bottom:3}),_s)},Is=function(){return[Bs,As,Ms,Fs]},Rs=function(){return[As,Bs,Fs,Ms]},Cr=[Bn("item"),pe(),Un("overrides",{}),ha("placement",function(t,n,e){e=vc(e,n.item.element),t=Gc(t.element,n,Is(),Rs(),Is(),Rs(),Z.none());return Z.some(Vc({anchorBox:e,bubble:Rc(),overrides:n.overrides,layouts:t,placer:Z.none()}))})],Vs=_n("anchor",{selection:sr,node:ho,hotspot:he,submenu:Cr,makeshift:ve}),Ps=function(t,n,e,o,r){n={anchorBox:e.anchorBox,origin:n};Ac(n,r.element,e.bubble,e.layouts,o,e.overrides)},Hs=function(t,n,e,o,r,i){i=i.map(zu);return zs(t,n,e,o,r,i)},zs=function(i,u,t,n,a,c){var s=Cn("positioning anchor.info",Vs,n);mc(function(){Yi(a.element,"position","fixed");var t=Qi(a.element,"visibility");Yi(a.element,"visibility","hidden");var n,e=u.useFixed()?(n=document.documentElement,xc(0,0,n.clientWidth,n.clientHeight)):(n=ku((o=i).element),o=o.element.dom.getBoundingClientRect(),yc(n.left,n.top,o.width,o.height)),o=s.placement,r=c.map(U).or(u.getBounds);o(i,s,e).each(function(t){t.placer.getOr(Ps)(i,e,t,r,a)}),t.fold(function(){tu(a.element,"visibility")},function(t){Yi(a.element,"visibility",t)}),Qi(a.element,"left").isNone()&&Qi(a.element,"top").isNone()&&Qi(a.element,"right").isNone()&&Qi(a.element,"bottom").isNone()&&Pi(Qi(a.element,"position"),"fixed")&&tu(a.element,"position")},a.element)},Kr=Object.freeze({__proto__:null,position:function(t,n,e,o,r){Hs(t,n,e,o,r,Z.none())},positionWithin:Hs,positionWithinBounds:zs,getMode:function(t,n,e){return n.useFixed()?"fixed":"absolute"}}),Zr=[Un("useFixed",d),Hn("getBounds")],Ls=rc({fields:Zr,name:"positioning",active:Ht,apis:Kr}),Ns=function(t){jo(t,Fo());t=t.components();tt(t,Ns)},js=function(t){var n=t.components();tt(n,js),jo(t,Mo())},Ws=function(t,n){Ir(t.element,n.element)},Us=function(n,t){var e,o=n.components();tt((e=n).components(),function(t){return Pr(t.element)}),Vr(e.element),e.syncComponents();o=X(o,t);tt(o,function(t){Ns(t),n.getSystem().removeFromWorld(t)}),tt(t,function(t){t.getSystem().isConnected()?Ws(n,t):(n.getSystem().addToWorld(t),Ws(n,t),ji(n.element)&&js(t)),n.syncComponents()})},Gs=function(t,n){Xs(t,n,Ir)},Xs=function(t,n,e){t.getSystem().addToWorld(n),e(t.element,n.element),ji(t.element)&&js(n),t.syncComponents()},Ys=function(t){Ns(t),Pr(t.element),t.getSystem().removeFromWorld(t)},qs=function(n){var t=br(n.element).bind(function(t){return n.getSystem().getByDom(t).toOptional()});Ys(n),t.each(function(t){t.syncComponents()})},Ks=function(t){var n=t.components();tt(n,Ys),Vr(t.element),t.syncComponents()},Js=function(t,n){$s(t,n,Ir)},$s=function(t,n,e){e(t,n.element);t=wr(n.element);tt(t,function(t){n.getByDom(t).each(js)})},Qs=function(n){var t=wr(n.element);tt(t,function(t){n.getByDom(t).each(Ns)}),Pr(n.element)},Zs=function(n,t,e,o){e.get().each(function(t){Ks(n)});t=t.getAttachPoint(n);Gs(t,n);o=n.getSystem().build(o);return Gs(n,o),e.set(o),o},tl=function(t,n,e,o){o=Zs(t,n,e,o);return n.onOpen(t,o),o},nl=function(n,e,o){o.get().each(function(t){Ks(n),qs(n),e.onClose(n,t),o.clear()})},el=function(t,n,e){return e.isOpen()},ol=function(t,n,e){var o,r,i=n.getAttachPoint(t);Yi(t.element,"position",Ls.getMode(i)),o=t,t="visibility",r=n.cloakVisibilityAttr,n="hidden",Qi(o.element,t).fold(function(){Xr(o.element,r)},function(t){jr(o.element,r,t)}),Yi(o.element,t,n)},rl=function(t,n,e){var o,r,i;o=t.element,M(["top","left","right","bottom"],function(t){return Qi(o,t).isSome()})||tu(t.element,"position"),r=t,i="visibility",n=n.cloakVisibilityAttr,Ur(r.element,n).fold(function(){return tu(r.element,i)},function(t){return Yi(r.element,i,t)})},ti=Object.freeze({__proto__:null,cloak:ol,decloak:rl,open:tl,openWhileCloaked:function(t,n,e,o,r){ol(t,n),tl(t,n,e,o),r(),rl(t,n)},close:nl,isOpen:el,isPartOf:function(n,e,t,o){return el(0,0,t)&&t.get().exists(function(t){return e.isPartOf(n,t,o)})},getState:function(t,n,e){return e.get()},setContent:function(t,n,e,o){return e.get().map(function(){return Zs(t,n,e,o)})}}),Oi=Object.freeze({__proto__:null,events:function(e,o){return qo([$o(Oo(),function(t,n){nl(t,e,o)})])}}),hu=[da("onOpen"),da("onClose"),Bn("isPartOf"),Bn("getAttachPoint"),Un("cloakVisibilityAttr","data-precloak-visibility")],il=rc({fields:hu,name:"sandboxing",active:Oi,apis:ti,state:Object.freeze({__proto__:null,init:function(){var n=Zn(Z.none()),t=U("not-implemented");return pi({readState:t,isOpen:function(){return n.get().isSome()},clear:function(){n.set(Z.none())},set:function(t){n.set(Z.some(t))},get:function(){return n.get()}})}})}),ul=U("dismiss.popups"),al=U("reposition.popups"),cl=U("mouse.released"),sl=on([Un("isExtraPart",d),Wn("fireEventInstead",[Un("event",Io())])]),ll=function(t){var e=Cn("Dismissal",sl,t),t={};return t[ul()]={schema:on([Bn("target")]),onReceive:function(n,t){il.isOpen(n)&&(il.isPartOf(n,t.target)||e.isExtraPart(n,t.target)||e.fireEventInstead.fold(function(){return il.close(n)},function(t){return jo(n,t.event)}))}},t},fl=on([Wn("fireEventInstead",[Un("event",Ro())]),In("doReposition")]),dl=function(t){var e=Cn("Reposition",fl,t),t={};return t[al()]={onReceive:function(n){il.isOpen(n)&&e.fireEventInstead.fold(function(){return e.doReposition(n)},function(t){return jo(n,t.event)})}},t},ml=function(t,n,e){n.store.manager.onLoad(t,n,e)},gl=function(t,n,e){n.store.manager.onUnload(t,n,e)},pl=Object.freeze({__proto__:null,onLoad:ml,onUnload:gl,setValue:function(t,n,e,o){n.store.manager.setValue(t,n,e,o)},getValue:function(t,n,e){return n.store.manager.getValue(t,n,e)},getState:function(t,n,e){return e}}),ca=Object.freeze({__proto__:null,events:function(e,o){var t=e.resetOnDom?[rr(function(t,n){ml(t,e,o)}),ir(function(t,n){gl(t,e,o)})]:[$a(e,o,ml)];return qo(t)}}),e=function(){var t=Zn(null);return pi({set:t.set,get:t.get,isNotSet:function(){return null===t.get()},clear:function(){t.set(null)},readState:function(){return{mode:"memory",value:t.get()}}})},C=function(){var i=Zn({}),u=Zn({});return pi({readState:function(){return{mode:"dataset",dataByValue:i.get(),dataByText:u.get()}},lookup:function(t){return Rt(i.get(),t).orThunk(function(){return Rt(u.get(),t)})},update:function(t){var n=i.get(),e=u.get(),o={},r={};tt(t,function(n){o[n.value]=n,Rt(n,"meta").each(function(t){Rt(t,"text").each(function(t){r[t]=n})})}),i.set(Q(Q({},n),o)),u.set(Q(Q({},e),r))},clear:function(){i.set({}),u.set({})}})},Ja=Object.freeze({__proto__:null,memory:e,dataset:C,manual:function(){return pi({readState:$})},init:function(t){return t.store.manager.state(t)}}),hl=function(t,n,e,o){var r=n.store;e.update([o]),r.setValue(t,o),n.onSetValue(t,o)},fn=[Hn("initialValue"),Bn("getFallbackEntry"),Bn("getDataKey"),Bn("setValue"),ha("manager",{setValue:hl,getValue:function(t,n,e){var o=n.store,r=o.getDataKey(t);return e.lookup(r).getOrThunk(function(){return o.getFallbackEntry(r)})},onLoad:function(n,e,o){e.store.initialValue.each(function(t){hl(n,e,o,t)})},onUnload:function(t,n,e){e.clear()},state:C})],ge=[Bn("getValue"),Un("setValue",$),Hn("initialValue"),ha("manager",{setValue:function(t,n,e,o){n.store.setValue(t,o),n.onSetValue(t,o)},getValue:function(t,n,e){return n.store.getValue(t)},onLoad:function(n,e,t){e.store.initialValue.each(function(t){e.store.setValue(n,t)})},onUnload:$,state:gi.init})],Ke=[Hn("initialValue"),ha("manager",{setValue:function(t,n,e,o){e.set(o),n.onSetValue(t,o)},getValue:function(t,n,e){return e.get()},onLoad:function(t,n,e){n.store.initialValue.each(function(t){e.isNotSet()&&e.set(t)})},onUnload:function(t,n,e){e.clear()},state:e})],po=[Gn("store",{mode:"memory"},_n("mode",{memory:Ke,manual:ge,dataset:fn})),da("onSetValue"),Un("resetOnDom",!1)],vl=rc({fields:po,name:"representing",active:ca,apis:pl,extra:{setValueFrom:function(t,n){n=vl.getValue(n);vl.setValue(t,n)}},state:Ja}),sr=function(o,t){return Qn(o,{},R(t,function(t){return n=t.name(),e="Cannot configure "+t.name()+" for "+o,Tn(n,n,Gt(),$t(function(t){return bt("The field: "+n+" is forbidden. "+e)}));var n,e}).concat([En("dump",h)]))},bl=function(t){return t.dump},yl=function(t,n){return Q(Q({},t.dump),ec(n))},xl=sr,wl=yl,Sl="placeholder",kl=Pe([{single:["required","valueThunk"]},{multiple:["required","valueThunks"]}]),Cl=function(t){return Vt(t,"uiType")},Ol=function(t,n,e,o){return Cl(e)&&e.uiType===Sl?(i=e,u=o,(r=t).exists(function(t){return t!==i.owner})?kl.single(!0,U(i)):Rt(u,i.name).fold(function(){throw new Error("Unknown placeholder component: "+i.name+"\nKnown: ["+_t(u)+"]\nNamespace: "+r.getOr("none")+"\nSpec: "+JSON.stringify(i,null,2))},function(t){return t.replace()})):kl.single(!1,U(e));var r,i,u},_l=function(o,r,i,u){return Ol(o,0,i,u).fold(function(t,n){var e=Cl(i)?n(r,i.config,i.validated):n(r),n=Rt(e,"components").getOr([]),n=j(n,function(t){return _l(o,r,t,u)});return[Q(Q({},e),{components:n})]},function(t,n){if(Cl(i)){var e=n(r,i.config,i.validated);return i.validated.preprocess.getOr(h)(e)}return n(r)})},Tl=function(n,e,t,o){var r,i,u,o=Dt(o,function(t,n){return o=t,r=!1,{name:U(e=n),required:function(){return o.fold(function(t,n){return t},function(t,n){return t})},used:function(){return r},replace:function(){if(r)throw new Error("Trying to use the same placeholder more than once: "+e);return r=!0,o}};var e,o,r}),t=(r=n,i=e,u=o,j(t,function(t){return _l(r,i,t,u)}));return Et(o,function(t){if(!1===t.used()&&t.required())throw new Error("Placeholder: "+t.name()+" was not found in components list\nNamespace: "+n.getOr("none")+"\nComponents: "+JSON.stringify(e.components,null,2))}),t},El=kl.single,Dl=kl.multiple,Bl=U(Sl),ho=Pe([{required:["data"]},{external:["data"]},{optional:["data"]},{group:["data"]}]),he=Un("factory",{sketch:h}),Cr=Un("schema",[]),ve=Bn("name"),Zr=Tn("pname","pname",Wt(function(t){return"<alloy."+Qr(t.name)+">"}),ln()),Ht=En("schema",function(){return[Hn("preprocess")]}),Kr=Un("defaults",U({})),hu=Un("overrides",U({})),Oi=rn([he,Cr,ve,Zr,Kr,hu]),ti=rn([he,Cr,ve,Kr,hu]),C=rn([he,Cr,ve,Zr,Kr,hu]),e=rn([he,Ht,ve,Bn("unit"),Zr,Kr,hu]),Al=function(t){return t.fold(Z.some,Z.none,Z.some,Z.some)},Ml=function(t){var n=function(t){return t.name};return t.fold(n,n,n,n)},Ke=function(n,e){return function(t){t=Cn("Converting part type",e,t);return n(t)}},Fl=Ke(ho.required,Oi),ge=Ke(ho.external,ti),Il=Ke(ho.optional,C),fn=Ke(ho.group,e),Rl=U("entirety"),po=Object.freeze({__proto__:null,required:Fl,external:ge,optional:Il,group:fn,asNamedPart:Al,name:Ml,asCommon:function(t){return t.fold(h,h,h,h)},original:Rl}),Vl=function(t,n,e,o){return zt(n.defaults(t,e,o),e,{uid:t.partUids[n.name]},n.overrides(t,e,o))},Pl=function(r,t){var n={};return tt(t,function(t){Al(t).each(function(e){var o=Hl(r,e.pname);n[e.name]=function(t){var n=Cn("Part: "+e.name+" in "+r,rn(e.schema),t);return Q(Q({},o),{config:t,validated:n})}})}),n},Hl=function(t,n){return{uiType:Bl(),owner:t,name:n}},zl=function(t,n,e){return{uiType:Bl(),owner:t,name:n,config:e,validated:{}}},Ll=function(t){return j(t,function(t){return t.fold(Z.none,Z.some,Z.none,Z.none).map(function(t){return Rn(t.name,t.schema.concat([va(Rl())]))}).toArray()})},Nl=function(t){return R(t,Ml)},jl=function(t,n,e){return o=n,i={},r={},tt(e,function(t){t.fold(function(o){i[o.pname]=El(!0,function(t,n,e){return o.factory.sketch(Vl(t,o,n,e))})},function(t){var n=o.parts[t.name];r[t.name]=U(t.factory.sketch(Vl(o,t,n[Rl()]),n))},function(o){i[o.pname]=El(!1,function(t,n,e){return o.factory.sketch(Vl(t,o,n,e))})},function(r){i[r.pname]=Dl(!0,function(n,t,e){var o=n[r.name];return R(o,function(t){return r.factory.sketch(zt(r.defaults(n,t,e),t,r.overrides(n,t)))})})})}),{internals:U(i),externals:U(r)};var o,i,r},Wl=function(t,n,e){return Tl(Z.some(t),n,n.components,e)},Ul=function(t,n,e){e=n.partUids[e];return t.getSystem().getByUid(e).toOptional()},Gl=function(t,n,e){return Ul(t,n,e).getOrDie("Could not find part: "+e)},Xl=function(t,n,e){var o={},r=n.partUids,i=t.getSystem();return tt(e,function(t){o[t]=U(i.getByUid(r[t]))}),o},Yl=function(t,n){var e=t.getSystem();return Dt(n.partUids,function(t,n){return U(e.getByUid(t))})},ql=function(t){return _t(t.partUids)},Kl=function(t,n,e){var o={},r=n.partUids,i=t.getSystem();return tt(e,function(t){o[t]=U(i.getByUid(r[t]).getOrDie())}),o},Jl=function(n,t){t=Nl(t);return Le(R(t,function(t){return{key:t,value:n+"-"+t}}))},$l=function(n){return Tn("partUids","partUids",Xt(function(t){return Jl(t.uid,n)}),ln())},ca=Object.freeze({__proto__:null,generate:Pl,generateOne:zl,schemas:Ll,names:Nl,substitutes:jl,components:Wl,defaultUids:Jl,defaultUidsSchema:$l,getAllParts:Yl,getAllPartNames:ql,getPart:Ul,getPartOrDie:Gl,getParts:Xl,getPartsOrDie:Kl}),Ql=function(t,n,e,o,r){r=r,r=(0<(o=o).length?[Rn("parts",o)]:[]).concat([Bn("uid"),Un("dom",{}),Un("components",[]),va("originalSpec"),Un("debug.sketcher",{})]).concat(r);return Cn(t+" [SpecSchema]",on(r.concat(n)),e)},Zl=function(t,n,e,o,r){var i=tf(r),u=Ll(e),r=$l(e),r=Ql(t,n,i,u,[r]),e=jl(0,r,e);return o(r,Wl(t,r,e.internals()),i,e.externals())},tf=function(t){return Vt(t,"uid")?t:Q(Q({},t),{uid:ii("uid")})},nf=on([Bn("name"),Bn("factory"),Bn("configFields"),Un("apis",{}),Un("extraApis",{})]),ef=on([Bn("name"),Bn("factory"),Bn("configFields"),Bn("partFields"),Un("apis",{}),Un("extraApis",{})]),of=function(t){var n=Cn("Sketcher for "+t.name,nf,t),e=Dt(n.apis,mi),t=Dt(n.extraApis,li);return Q(Q({name:n.name,configFields:n.configFields,sketch:function(t){return function(t,n,e,o){o=tf(o);return e(Ql(t,n,o,[],[]),o)}(n.name,n.configFields,n.factory,t)}},e),t)},pl=function(t){var n=Cn("Sketcher for "+t.name,ef,t),e=Pl(n.name,n.partFields),o=Dt(n.apis,mi),t=Dt(n.extraApis,li);return Q(Q({name:n.name,partFields:n.partFields,configFields:n.configFields,sketch:function(t){return Zl(n.name,n.configFields,n.partFields,n.factory,t)},parts:e},o),t)},rf=function(t){return"input"===cr(t)&&"radio"!==Wr(t,"type")||"textarea"===cr(t)},Ja=Object.freeze({__proto__:null,getCurrent:function(t,n,e){return n.find(t)}}),Cr=[Bn("find")],uf=rc({fields:Cr,name:"composing",apis:Ja}),af=function(e,o,t,r){var n=hs(e.element,"."+o.highlightClass);tt(n,function(n){M(r,function(t){return t.element===n})||(Fi(n,o.highlightClass),e.getSystem().getByDom(n).each(function(t){o.onDehighlight(e,t),jo(t,No())}))})},cf=function(t,n,e,o){af(t,n,0,[o]),sf(t,n,e,o)||(Ai(o.element,n.highlightClass),n.onHighlight(t,o),jo(o,Lo()))},sf=function(t,n,e,o){return Ii(o.element,n.highlightClass)},lf=function(t,n,e,o){n=hs(t.element,"."+n.itemClass);return Z.from(n[o]).fold(function(){return at.error(new Error("No element found with index "+o))},t.getSystem().getByDom)},ff=function(n,t,e){return qu(n.element,"."+t.itemClass).bind(function(t){return n.getSystem().getByDom(t).toOptional()})},df=function(n,t,e){t=hs(n.element,"."+t.itemClass);return(0<t.length?Z.some(t[t.length-1]):Z.none()).bind(function(t){return n.getSystem().getByDom(t).toOptional()})},mf=function(n,e,t,o){var r=hs(n.element,"."+e.itemClass);return N(r,function(t){return Ii(t,e.highlightClass)}).bind(function(t){t=Ta(t,o,0,r.length-1);return n.getSystem().getByDom(r[t]).toOptional()})},gf=function(n,t,e){t=hs(n.element,"."+t.itemClass);return Hi(R(t,function(t){return n.getSystem().getByDom(t).toOptional()}))},he=Object.freeze({__proto__:null,dehighlightAll:function(t,n,e){return af(t,n,0,[])},dehighlight:function(t,n,e,o){sf(t,n,e,o)&&(Fi(o.element,n.highlightClass),n.onDehighlight(t,o),jo(o,No()))},highlight:cf,highlightFirst:function(n,e,o){ff(n,e).each(function(t){cf(n,e,o,t)})},highlightLast:function(n,e,o){df(n,e).each(function(t){cf(n,e,o,t)})},highlightAt:function(n,e,o,t){lf(n,e,o,t).fold(function(t){throw t},function(t){cf(n,e,o,t)})},highlightBy:function(n,e,o,t){var r=gf(n,e);L(r,t).each(function(t){cf(n,e,o,t)})},isHighlighted:sf,getHighlighted:function(n,t,e){return qu(n.element,"."+t.highlightClass).bind(function(t){return n.getSystem().getByDom(t).toOptional()})},getFirst:ff,getLast:df,getPrevious:function(t,n,e){return mf(t,n,0,-1)},getNext:function(t,n,e){return mf(t,n,0,1)},getCandidates:gf}),Ht=[Bn("highlightClass"),Bn("itemClass"),da("onHighlight"),da("onDehighlight")],pf=rc({fields:Ht,name:"highlighting",apis:he}),hf=[8],vf=[9],bf=[13],yf=[27],xf=[32],wf=[37],Sf=[38],kf=[39],Cf=[40],Of=function(t,n,e){var o=G(t.slice(0,n)),n=G(t.slice(n+1));return L(o.concat(n),e)},_f=function(t,n,e){n=G(t.slice(0,n));return L(n,e)},Tf=function(t,n,e){var o=t.slice(0,n),n=t.slice(n+1);return L(n.concat(o),e)},Ef=function(t,n,e){n=t.slice(n+1);return L(n,e)},Df=function(n){return function(t){t=t.raw;return A(n,t.which)}},Bf=function(t){return function(n){return W(t,function(t){return t(n)})}},Af=function(t){return!0===t.raw.shiftKey},Mf=function(t){return!0===t.raw.ctrlKey},Ff=w(Af),If=function(t,n){return{matches:t,classification:n}},Rf=function(t,n,e){n.exists(function(n){return e.exists(function(t){return Ie(t,n)})})||Wo(t,Vo(),{prevFocus:n,newFocus:e})},Vf=function(){var o=function(t){return dc(t.element)};return{get:o,set:function(t,n){var e=o(t);t.getSystem().triggerFocus(n,t.element);n=o(t);Rf(t,e,n)}}},Pf=function(){var o=function(t){return pf.getHighlighted(t).map(function(t){return t.element})};return{get:o,set:function(n,t){var e=o(n);n.getSystem().getByDom(t).fold($,function(t){pf.highlight(n,t)});t=o(n);Rf(n,e,t)}}};(ve=jc=jc||{}).OnFocusMode="onFocus",ve.OnEnterOrSpaceMode="onEnterOrSpace",ve.OnApiMode="onApi";var Hf,zf=function(t,n,e,o,a){var c=function(n,e,t,o,r){var i,t=t(n,e,o,r);return i=e.event,L(t,function(t){return t.matches(i)}).map(function(t){return t.classification}).bind(function(t){return t(n,e,o,r)})},r={schema:function(){return t.concat([Un("focusManager",Vf()),Gn("focusInside","onFocus",xn(function(t){return A(["onFocus","onEnterOrSpace","onApi"],t)?at.value(t):at.error("Invalid value for focusInside")})),ha("handler",r),ha("state",n),ha("sendFocusIn",a)])},processKey:c,toEvents:function(i,u){var t=i.focusInside!==jc.OnFocusMode?Z.none():a(i).map(function(e){return $o(vo(),function(t,n){e(t,i,u),n.stop()})}),n=[$o(ao(),function(o,r){c(o,r,e,i,u).fold(function(){var n,e,t;n=o,e=r,t=Df(xf.concat(bf))(e.event),i.focusInside===jc.OnEnterOrSpaceMode&&t&&Ge(n,e)&&a(i).each(function(t){t(n,i,u),e.stop()})},function(t){r.stop()})}),$o(co(),function(t,n){c(t,n,o,i,u).each(function(t){n.stop()})})];return qo(t.toArray().concat(n))}};return r},Zr=function(t){var n=[Hn("onEscape"),Hn("onEnter"),Un("selector",'[data-alloy-tabstop="true"]:not(:disabled)'),Un("firstTabstop",0),Un("useTabstopAt",S),Hn("visibilitySelector")].concat([t]),i=function(t,n){t=t.visibilitySelector.bind(function(t){return Ku(n,t)}).getOr(n);return 0<bu(t)},e=function(n,e,t){!function(t,n){t=hs(t.element,n.selector),t=P(t,function(t){return i(n,t)});return Z.from(t[n.firstTabstop])}(n,e).each(function(t){e.focusManager.set(n,t)})},u=function(n,t,e,o,r){return r(t,e,function(t){return i(n=o,t=t)&&n.useTabstopAt(t);var n}).fold(function(){return o.cyclic?Z.some(!0):Z.none()},function(t){return o.focusManager.set(n,t),Z.some(!0)})},r=function(n,t,e,o){var r,i=hs(n.element,e.selector);return(r=e).focusManager.get(n).bind(function(t){return Ku(t,r.selector)}).bind(function(t){return N(i,x(Ie,t)).bind(function(t){return u(n,i,t,e,o)})})},o=U([If(Bf([Af,Df(vf)]),function(t,n,e){var o=e.cyclic?Of:_f;return r(t,0,e,o)}),If(Df(vf),function(t,n,e){var o=e.cyclic?Tf:Ef;return r(t,0,e,o)}),If(Df(yf),function(n,e,t){return t.onEscape.bind(function(t){return t(n,e)})}),If(Bf([Ff,Df(bf)]),function(n,e,t){return t.onEnter.bind(function(t){return t(n,e)})})]),t=U([]);return zf(n,gi.init,o,t,function(){return Z.some(e)})},Kr=Zr(En("cyclic",d)),hu=Zr(En("cyclic",S)),Oi=function(t,n,e){return rf(e)&&Df(xf)(n.event)?Z.none():(Go(t,e,wo()),Z.some(!0))},Lf=function(t,n){return Z.some(!0)},ti=[Un("execute",Oi),Un("useSpace",!1),Un("useEnter",!0),Un("useControlEnter",!1),Un("useDown",!1)],Nf=function(t,n,e){return e.execute(t,n,t.element)},C=zf(ti,gi.init,function(t,n,e,o){var r=e.useSpace&&!rf(t.element)?xf:[],i=e.useEnter?bf:[],t=e.useDown?Cf:[],t=r.concat(i).concat(t);return[If(Df(t),Nf)].concat(e.useControlEnter?[If(Bf([Mf,Df(bf)]),Nf)]:[])},function(t,n,e,o){return e.useSpace&&!rf(t.element)?[If(Df(xf),Lf)]:[]},function(){return Z.none()}),Ke=function(){var e=Zn(Z.none());return pi({readState:function(){return e.get().map(function(t){return{numRows:String(t.numRows),numColumns:String(t.numColumns)}}).getOr({numRows:"?",numColumns:"?"})},setGridSize:function(t,n){e.set(Z.some({numRows:t,numColumns:n}))},getNumRows:function(){return e.get().map(function(t){return t.numRows})},getNumColumns:function(){return e.get().map(function(t){return t.numColumns})}})},ho=Object.freeze({__proto__:null,flatgrid:Ke,init:function(t){return t.state(t)}}),jf=function(i){return function(t,n,e,o){var r=i(t.element);return Gf(r,t,n,e,o)}},Wf=function(t,n){n=Pc(t,n);return jf(n)},Uf=function(t,n){t=Pc(n,t);return jf(t)},e=function(r){return function(t,n,e,o){return Gf(r,t,n,e,o)}},Gf=function(n,e,t,o,r){return o.focusManager.get(e).bind(function(t){return n(e.element,t,o,r)}).map(function(t){return o.focusManager.set(e,t),!0})},Cr=e,Ja=e,Xf=e,Yf=function(t){return!((t=t.dom).offsetWidth<=0&&t.offsetHeight<=0)},qf=function(t,n,e){var o,e=hs(t,e),e=P(e,Yf);return N(o=e,function(t){return Ie(t,n)}).map(function(t){return{index:t,candidates:o}})},Kf=function(t,n){return N(t,function(t){return Ie(n,t)})},Jf=function(n,t,e,o){return o(Math.floor(t/e),t%e).bind(function(t){t=t.row*e+t.column;return 0<=t&&t<n.length?Z.some(n[t]):Z.none()})},$f=function(o,t,r,i,u){return Jf(o,t,i,function(t,n){var e=t===r-1?o.length-t*i:i,e=Ta(n,u,0,e-1);return Z.some({row:t,column:e})})},Qf=function(o,t,r,i,u){return Jf(o,t,i,function(t,n){var e=Ta(t,u,0,r-1),t=e===r-1?o.length-e*i:i,t=Ea(n,0,t-1);return Z.some({row:e,column:t})})},Ht=[Bn("selector"),Un("execute",Oi),ma("onEscape"),Un("captureTab",!1),t()],Zf=function(n,e,t){qu(n.element,e.selector).each(function(t){e.focusManager.set(n,t)})},he=function(r){return function(t,n,e,o){return qf(t,n,e.selector).bind(function(t){return r(t.candidates,t.index,o.getNumRows().getOr(e.initSize.numRows),o.getNumColumns().getOr(e.initSize.numColumns))})}},ve=function(t,n,e){return e.captureTab?Z.some(!0):Z.none()},Zr=he(function(t,n,e,o){return $f(t,n,e,o,-1)}),ti=he(function(t,n,e,o){return $f(t,n,e,o,1)}),e=he(function(t,n,e,o){return Qf(t,n,e,o,-1)}),he=he(function(t,n,e,o){return Qf(t,n,e,o,1)}),Zr=U([If(Df(wf),Wf(Zr,ti)),If(Df(kf),Uf(Zr,ti)),If(Df(Sf),Cr(e)),If(Df(Cf),Ja(he)),If(Bf([Af,Df(vf)]),ve),If(Bf([Ff,Df(vf)]),ve),If(Df(yf),function(t,n,e){return e.onEscape(t,n)}),If(Df(xf.concat(bf)),function(n,e,o,t){return(r=o).focusManager.get(n).bind(function(t){return Ku(t,r.selector)}).bind(function(t){return o.execute(n,e,t)});var r})]),ti=U([If(Df(xf),Lf)]),e=zf(Ht,Ke,Zr,ti,function(){return Z.some(Zf)}),td=function(t,n,e,r){var i=function(t,n,e){var o=Ta(n,r,0,e.length-1);return o===t?Z.none():(n=e[o],"button"===cr(n)&&"disabled"===Wr(n,"disabled")?i(t,o,e):Z.from(e[o]))};return qf(t,e,n).bind(function(t){var n=t.index,t=t.candidates;return i(n,n,t)})},he=[Bn("selector"),Un("getInitial",Z.none),Un("execute",Oi),ma("onEscape"),Un("executeOnMove",!1),Un("allowVertical",!0)],nd=function(n,e,o){return(r=o).focusManager.get(n).bind(function(t){return Ku(t,r.selector)}).bind(function(t){return o.execute(n,e,t)});var r},ed=function(n,e,t){e.getInitial(n).orThunk(function(){return qu(n.element,e.selector)}).each(function(t){e.focusManager.set(n,t)})},od=function(t,n,e){return td(t,e.selector,n,-1)},rd=function(t,n,e){return td(t,e.selector,n,1)},id=function(r){return function(t,n,e,o){return r(t,n,e,o).bind(function(){return e.executeOnMove?nd(t,n,e):Z.some(!0)})}},ud=function(t,n,e){return e.onEscape(t,n)},ve=U([If(Df(xf),Lf)]),Ht=zf(he,gi.init,function(t,n,e,o){var r=wf.concat(e.allowVertical?Sf:[]),e=kf.concat(e.allowVertical?Cf:[]);return[If(Df(r),id(Wf(od,rd))),If(Df(e),id(Uf(od,rd))),If(Df(bf),nd),If(Df(xf),nd),If(Df(yf),ud)]},ve,function(){return Z.some(ed)}),ad=function(t,n,e){return Z.from(t[n]).bind(function(t){return Z.from(t[e]).map(function(t){return{rowIndex:n,columnIndex:e,cell:t}})})},cd=function(t,n,e,o){var r=t[n].length,r=Ta(e,o,0,r-1);return ad(t,n,r)},sd=function(t,n,e,o){e=Ta(e,o,0,t.length-1),o=t[e].length,o=Ea(n,0,o-1);return ad(t,e,o)},ld=function(t,n,e,o){var r=t[n].length,r=Ea(e+o,0,r-1);return ad(t,n,r)},fd=function(t,n,e,o){e=Ea(e+o,0,t.length-1),o=t[e].length,o=Ea(n,0,o-1);return ad(t,e,o)},Ke=[Rn("selectors",[Bn("row"),Bn("cell")]),Un("cycles",!0),Un("previousSelector",Z.none),Un("execute",Oi)],dd=function(n,e,t){e.previousSelector(n).orThunk(function(){var t=e.selectors;return qu(n.element,t.cell)}).each(function(t){e.focusManager.set(n,t)})},Zr=function(t,n){return function(e,o,i){var u=i.cycles?t:n;return Ku(o,i.selectors.row).bind(function(t){var n=hs(t,i.selectors.cell);return Kf(n,o).bind(function(o){var r=hs(e,i.selectors.row);return Kf(r,t).bind(function(t){var n,e=(n=i,R(r,function(t){return hs(t,n.selectors.cell)}));return u(e,t,o).map(function(t){return t.cell})})})})}},ti=Zr(function(t,n,e){return cd(t,n,e,-1)},function(t,n,e){return ld(t,n,e,-1)}),he=Zr(function(t,n,e){return cd(t,n,e,1)},function(t,n,e){return ld(t,n,e,1)}),ve=Zr(function(t,n,e){return sd(t,e,n,-1)},function(t,n,e){return fd(t,e,n,-1)}),Zr=Zr(function(t,n,e){return sd(t,e,n,1)},function(t,n,e){return fd(t,e,n,1)}),Ja=U([If(Df(wf),Wf(ti,he)),If(Df(kf),Uf(ti,he)),If(Df(Sf),Cr(ve)),If(Df(Cf),Ja(Zr)),If(Df(xf.concat(bf)),function(n,e,o){return dc(n.element).bind(function(t){return o.execute(n,e,t)})})]),Zr=U([If(Df(xf),Lf)]),Ke=zf(Ke,gi.init,Ja,Zr,function(){return Z.some(dd)}),Ja=[Bn("selector"),Un("execute",Oi),Un("moveOnTab",!1)],Zr=function(n,e,o){return o.focusManager.get(n).bind(function(t){return o.execute(n,e,t)})},md=function(n,e,t){qu(n.element,e.selector).each(function(t){e.focusManager.set(n,t)})},gd=function(t,n,e){return td(t,e.selector,n,-1)},pd=function(t,n,e){return td(t,e.selector,n,1)},Oi=U([If(Df(Sf),Xf(gd)),If(Df(Cf),Xf(pd)),If(Bf([Af,Df(vf)]),function(t,n,e,o){return e.moveOnTab?Xf(gd)(t,n,e,o):Z.none()}),If(Bf([Ff,Df(vf)]),function(t,n,e,o){return e.moveOnTab?Xf(pd)(t,n,e,o):Z.none()}),If(Df(bf),Zr),If(Df(xf),Zr)]),Zr=U([If(Df(xf),Lf)]),Ja=zf(Ja,gi.init,Oi,Zr,function(){return Z.some(md)}),Oi=[ma("onSpace"),ma("onEnter"),ma("onShiftEnter"),ma("onLeft"),ma("onRight"),ma("onTab"),ma("onShiftTab"),ma("onUp"),ma("onDown"),ma("onEscape"),Un("stopSpaceKeyup",!1),Hn("focusIn")],Zr=zf(Oi,gi.init,function(t,n,e){return[If(Df(xf),e.onSpace),If(Bf([Ff,Df(bf)]),e.onEnter),If(Bf([Af,Df(bf)]),e.onShiftEnter),If(Bf([Af,Df(vf)]),e.onShiftTab),If(Bf([Ff,Df(vf)]),e.onTab),If(Df(Sf),e.onUp),If(Df(Cf),e.onDown),If(Df(wf),e.onLeft),If(Df(kf),e.onRight),If(Df(xf),e.onSpace),If(Df(yf),e.onEscape)]},function(t,n,e){return e.stopSpaceKeyup?[If(Df(xf),Lf)]:[]},function(t){return t.focusIn}),Oi=Kr.schema(),Kr=hu.schema(),hu=Ht.schema(),Ht=e.schema(),e=Ke.schema(),Ke=C.schema(),C=Ja.schema(),Ja=Zr.schema(),hd=uc({branchKey:"mode",branches:Object.freeze({__proto__:null,acyclic:Oi,cyclic:Kr,flow:hu,flatgrid:Ht,matrix:e,execution:Ke,menu:C,special:Ja}),name:"keying",active:{events:function(t,n){return t.handler.toEvents(t,n)}},apis:{focusIn:function(n,e,o){e.sendFocusIn(e).fold(function(){n.getSystem().triggerFocus(n.element,n.element)},function(t){t(n,e,o)})},setGridSize:function(t,n,e,o,r){Pt(e,"setGridSize")?e.setGridSize(o,r):console.error("Layout does not support setGridSize")}},state:ho}),vd=function(t,n,e,o){o=t.getSystem().build(o);Xs(t,o,e)},bd=function(t,n,e,o){t=yd(t);L(t,function(t){return Ie(o.element,t.element)}).each(qs)},yd=function(t,n){return t.components()},xd=function(n,t,e,r,o){var i=yd(n);return Z.from(i[r]).map(function(t){return bd(n,0,0,t),o.each(function(t){vd(n,0,function(t,n){var e,o;o=n,Sr(e=t,r).fold(function(){Ir(e,o)},function(t){Ar(t,o)})},t)}),t})},wd=rc({fields:[],name:"replacing",apis:Object.freeze({__proto__:null,append:function(t,n,e,o){vd(t,0,Ir,o)},prepend:function(t,n,e,o){vd(t,0,Fr,o)},remove:bd,replaceAt:xd,replaceBy:function(n,t,e,o,r){var i=yd(n);return N(i,o).bind(function(t){return xd(n,0,0,t,r)})},set:function(n,t,e,o){mc(function(){var t=R(o,n.getSystem().build);Us(n,t)},n.element)},contents:yd})}),Sd=function(t,n){return{key:t,value:{config:{},me:function(t,n){n=qo(n);return rc({fields:[Bn("enabled")],name:t,active:{events:U(n)}})}(t,n),configAsRaw:U({}),initialConfig:{},state:gi}}},kd=function(t,n){n.ignore||(sc(t.element),n.onFocus(t))},Zr=Object.freeze({__proto__:null,focus:kd,blur:function(t,n){n.ignore||t.element.dom.blur()},isFocused:function(t){return lc(t.element)}}),Oi=Object.freeze({__proto__:null,exhibit:function(t,n){n=n.ignore?{}:{attributes:{tabindex:"-1"}};return vi(n)},events:function(e){return qo([$o(vo(),function(t,n){kd(t,e),n.stop()})].concat(e.stopMousedown?[$o(to(),function(t,n){n.event.prevent()})]:[]))}}),Kr=[da("onFocus"),Un("stopMousedown",!1),Un("ignore",!1)],Cd=rc({fields:Kr,name:"focusing",active:Oi,apis:Zr}),Od=function(t,n,e){n=n.aria;n.update(t,n,e.get())},_d=function(n,t,e){t.toggleClass.each(function(t){(e.get()?Ai:Fi)(n.element,t)})},Td=function(t,n,e){Bd(t,n,e,!e.get())},Ed=function(t,n,e){e.set(!0),_d(t,n,e),Od(t,n,e)},Dd=function(t,n,e){e.set(!1),_d(t,n,e),Od(t,n,e)},Bd=function(t,n,e,o){(o?Ed:Dd)(t,n,e)},Ad=function(t,n,e){Bd(t,n,e,n.selected)},hu=Object.freeze({__proto__:null,onLoad:Ad,toggle:Td,isOn:function(t,n,e){return e.get()},on:Ed,off:Dd,set:Bd}),Ht=Object.freeze({__proto__:null,exhibit:function(){return vi({})},events:function(t,n){var e,o,r,i=(e=t,o=n,r=Td,ar(function(t){r(t,e,o)})),n=$a(t,n,Ad);return qo(nt([t.toggleOnExecute?[i]:[],[n]]))}}),Md=function(t,n,e){jr(t.element,"aria-expanded",e)},e=[Un("selected",!1),Hn("toggleClass"),Un("toggleOnExecute",!0),Gn("aria",{mode:"none"},_n("mode",{pressed:[Un("syncWithExpanded",!1),ha("update",function(t,n,e){jr(t.element,"aria-pressed",e),n.syncWithExpanded&&Md(t,n,e)})],checked:[ha("update",function(t,n,e){jr(t.element,"aria-checked",e)})],expanded:[ha("update",Md)],selected:[ha("update",function(t,n,e){jr(t.element,"aria-selected",e)})],none:[ha("update",$)]}))],Fd=rc({fields:e,name:"toggling",active:Ht,apis:hu,state:(Hf=!1,{init:function(){var n=Zn(Hf);return{get:function(){return n.get()},set:function(t){return n.set(t)},clear:function(){return n.set(Hf)},readState:function(){return n.get()}}}})}),Id=function(){var t=function(t,n){n.stop(),Uo(t)};return[$o(fo(),t),$o(ko(),t),er(Je()),er(to())]},Rd=function(t){return qo(nt([t.map(function(e){return ar(function(t,n){e(t),n.stop()})}).toArray(),Id()]))},Vd="alloy.item-hover",Pd="alloy.item-focus",Hd=function(t){(dc(t.element).isNone()||Cd.isFocused(t))&&(Cd.isFocused(t)||Cd.focus(t),Wo(t,Vd,{item:t}))},zd=function(t){Wo(t,Pd,{item:t})},Ld=U(Vd),Nd=U(Pd),Ke=[Bn("data"),Bn("components"),Bn("dom"),Un("hasSubmenu",!1),Hn("toggling"),xl("itemBehaviours",[Fd,Cd,hd,vl]),Un("ignoreFocus",!1),Un("domModification",{}),ha("builder",function(t){return{dom:t.dom,domModification:Q(Q({},t.domModification),{attributes:Q(Q(Q({role:t.toggling.isSome()?"menuitemcheckbox":"menuitem"},t.domModification.attributes),{"aria-haspopup":t.hasSubmenu}),t.hasSubmenu?{"aria-expanded":!1}:{})}),behaviours:wl(t.itemBehaviours,[t.toggling.fold(Fd.revoke,function(t){return Fd.config(Q({aria:{mode:"checked"}},t))}),Cd.config({ignore:t.ignoreFocus,stopMousedown:t.ignoreFocus,onFocus:function(t){zd(t)}}),hd.config({mode:"execution"}),vl.config({store:{mode:"memory",initialValue:t.data}}),Sd("item-type-events",p(p([],Id()),[$o(ro(),Hd),$o(So(),Cd.focus)]))]),components:t.components,eventOrder:t.eventOrder}}),Un("eventOrder",{})],C=[Bn("dom"),Bn("components"),ha("builder",function(t){return{dom:t.dom,components:t.components,events:qo([(t=So(),$o(t,function(t,n){n.stop()}))])}})],jd=U("item-widget"),Wd=U([Fl({name:"widget",overrides:function(n){return{behaviours:ec([vl.config({store:{mode:"manual",getValue:function(t){return n.data},setValue:$}})])}}})]),Ja=[Bn("uid"),Bn("data"),Bn("components"),Bn("dom"),Un("autofocus",!1),Un("ignoreFocus",!1),xl("widgetBehaviours",[vl,Cd,hd]),Un("domModification",{}),$l(Wd()),ha("builder",function(e){var t=jl(jd(),e,Wd()),n=Wl(jd(),e,t.internals()),o=function(t){return Ul(t,e,"widget").map(function(t){return hd.focusIn(t),t})},t=function(t,n){return rf(n.event.target)||e.autofocus&&n.setSource(t.element),Z.none()};return{dom:e.dom,components:n,domModification:e.domModification,events:qo([ar(function(t,n){o(t).each(function(t){n.stop()})}),$o(ro(),Hd),$o(So(),function(t,n){e.autofocus?o(t):Cd.focus(t)})]),behaviours:wl(e.widgetBehaviours,[vl.config({store:{mode:"memory",initialValue:e.data}}),Cd.config({ignore:e.ignoreFocus,onFocus:function(t){zd(t)}}),hd.config({mode:"special",focusIn:e.autofocus?function(t){o(t)}:ac(),onLeft:t,onRight:t,onEscape:function(t,n){return Cd.isFocused(t)||e.autofocus?(e.autofocus&&n.setSource(t.element),Z.none()):(Cd.focus(t),Z.some(!0))}})])}})],Ud=_n("type",{widget:Ja,item:Ke,separator:C}),ho=U([fn({factory:{sketch:function(t){t=Cn("menu.spec item",Ud,t);return t.builder(t)}},name:"items",unit:"item",defaults:function(t,n){return Vt(n,"uid")?n:Q(Q({},n),{uid:ii("item")})},overrides:function(t,n){return{type:n.type,ignoreFocus:t.fakeFocus,domModification:{classes:[t.markers.item]}}}})]),Kr=U([Bn("value"),Bn("items"),Bn("dom"),Bn("components"),Un("eventOrder",{}),sr("menuBehaviours",[pf,vl,uf,hd]),Gn("movement",{mode:"menu",moveOnTab:!0},_n("mode",{grid:[t(),ha("config",function(t,n){return{mode:"flatgrid",selector:"."+t.markers.item,initSize:{numColumns:n.initSize.numColumns,numRows:n.initSize.numRows},focusManager:t.focusManager}})],matrix:[ha("config",function(t,n){return{mode:"matrix",selectors:{row:n.rowSelector,cell:"."+t.markers.item},focusManager:t.focusManager}}),Bn("rowSelector")],menu:[Un("moveOnTab",!0),ha("config",function(t,n){return{mode:"menu",selector:"."+t.markers.item,moveOnTab:n.moveOnTab,focusManager:t.focusManager}})]})),An("markers",aa()),Un("fakeFocus",!1),Un("focusManager",Vf()),da("onHighlight")]),Gd=U("alloy.menu-focus"),Xd=pl({name:"Menu",configFields:Kr(),partFields:ho(),factory:function(t,n,e,o){return{uid:t.uid,dom:t.dom,markers:t.markers,behaviours:yl(t.menuBehaviours,[pf.config({highlightClass:t.markers.selectedItem,itemClass:t.markers.item,onHighlight:t.onHighlight}),vl.config({store:{mode:"memory",initialValue:t.value}}),uf.config({find:Z.some}),hd.config(t.movement.config(t,t.movement))]),events:qo([$o(Nd(),function(n,e){var t=e.event;n.getSystem().getByDom(t.target).each(function(t){pf.highlight(n,t),e.stop(),Wo(n,Gd(),{menu:n,item:t})})}),$o(Ld(),function(t,n){n=n.event.item;pf.highlight(t,n)})]),components:n,eventOrder:t.eventOrder,domModification:{attributes:{role:"menu"}}}}}),Yd=function(e,o,r,t){return Rt(r,t).bind(function(t){return Rt(e,t).bind(function(t){var n=Yd(e,o,r,t);return Z.some([t].concat(n))})}).getOr([])},qd=function(t,n){var e={};Et(t,function(t,n){tt(t,function(t){e[t]=n})});var o=n,r=Bt(n,function(t,n){return{k:t,v:n}}),i=Dt(r,function(t,n){return[n].concat(Yd(e,o,r,n))});return Dt(e,function(t){return Rt(i,t).getOr([t])})},Kd=function(t){return"prepared"===t.type?Z.some(t.menu):Z.none()},Jd={init:function(){var i=Zn({}),r=Zn({}),u=Zn({}),a=Zn(Z.none()),c=Zn({}),s=function(t,o,r){return e(t).bind(function(n){return e=t,Ft(i.get(),function(t,n){return t===e}).bind(function(t){return o(t).map(function(t){return{triggeredMenu:n,triggeringItem:t,triggeringPath:r}})});var e})},e=function(t){return n(t).bind(Kd)},n=function(t){return Rt(r.get(),t)},l=function(t){return Rt(i.get(),t)};return{setMenuBuilt:function(t,n){var e;r.set(Q(Q({},r.get()),((e={})[t]={type:"prepared",menu:n},e)))},setContents:function(t,n,e,o){a.set(Z.some(t)),i.set(e),r.set(n),c.set(o);e=qd(o,e);u.set(e)},expand:function(e){return Rt(i.get(),e).map(function(t){var n=Rt(u.get(),e).getOr([]);return[t].concat(n)})},refresh:function(t){return Rt(u.get(),t)},collapse:function(t){return Rt(u.get(),t).bind(function(t){return 1<t.length?Z.some(t.slice(1)):Z.none()})},lookupMenu:n,lookupItem:l,otherMenus:function(t){var n=c.get();return X(_t(n),t)},getPrimary:function(){return a.get().bind(e)},getMenus:function(){return r.get()},clear:function(){i.set({}),r.set({}),u.set({}),a.set(Z.none())},isClear:function(){return a.get().isNone()},getTriggeringPath:function(t,o){var n=P(l(t).toArray(),function(t){return e(t).isSome()});return Rt(u.get(),t).bind(function(t){var e=G(n.concat(t));return function(t){for(var n=[],e=0;e<t.length;e++){var o=t[e];if(!o.isSome())return Z.none();n.push(o.getOrDie())}return Z.some(n)}(j(e,function(t,n){return s(t,o,e.slice(0,n+1)).fold(function(){return Pi(a.get(),t)?[]:[Z.none()]},function(t){return[Z.some(t)]})}))})}}},extractPreparedMenu:Kd},$d=U("collapse-item"),Qd=of({name:"TieredMenu",configFields:[pa("onExecute"),pa("onEscape"),ga("onOpenMenu"),ga("onOpenSubmenu"),da("onRepositionMenu"),da("onCollapseMenu"),Un("highlightImmediately",!0),Rn("data",[Bn("primary"),Bn("menus"),Bn("expansions")]),Un("fakeFocus",!1),da("onHighlight"),da("onHover"),sa(),Bn("dom"),Un("navigateOnHover",!0),Un("stayInDom",!1),sr("tmenuBehaviours",[hd,pf,uf,wd]),Un("eventOrder",{})],apis:{collapseMenu:function(t,n){t.collapseMenu(n)},highlightPrimary:function(t,n){t.highlightPrimary(n)},repositionMenus:function(t,n){t.repositionMenus(n)}},factory:function(u,t){var a,o=Zn(Z.none()),c=Jd.init(),e=function(t){var o,r,t=(o=t,r=u.data.primary,n=u.data.menus,Dt(n,function(t,n){var e=function(){return Xd.sketch(Q(Q({},t),{value:n,markers:u.markers,fakeFocus:u.fakeFocus,onHighlight:u.onHighlight,focusManager:(u.fakeFocus?Pf:Vf)()}))};return n===r?{type:"prepared",menu:o.getSystem().build(e())}:{type:"notbuilt",nbMenu:e}})),n=i();return c.setContents(u.data.primary,t,u.data.expansions,n),c.getPrimary()},s=function(t){return vl.getValue(t).value},i=function(t){return Dt(u.data.menus,function(t,n){return j(t.items,function(t){return"separator"===t.type?[]:[t.data.value]})})},l=function(n,t){pf.highlight(n,t),pf.getHighlighted(t).orThunk(function(){return pf.getFirst(t)}).each(function(t){Go(n,t.element,So())})},f=function(n,t){return Hi(R(t,function(t){return n.lookupMenu(t).bind(function(t){return"prepared"===t.type?Z.some(t.menu):Z.none()})}))},d=function(n,t,e){e=f(t,t.otherMenus(e));tt(e,function(t){Vi(t.element,[u.markers.backgroundMenu]),u.stayInDom||wd.remove(n,t)})},m=function(t,e){var n,t=(n=t,o.get().getOrThunk(function(){var e={},t=hs(n.element,"."+u.markers.item),t=P(t,function(t){return"true"===Wr(t,"aria-haspopup")});return tt(t,function(t){n.getSystem().getByDom(t).each(function(t){var n=s(t);e[n]=t})}),o.set(Z.some(e)),e}));Et(t,function(t,n){n=A(e,n);jr(t.element,"aria-expanded",n)})},g=function(e,o,r){return Z.from(r[0]).bind(function(t){return o.lookupMenu(t).bind(function(t){if("notbuilt"===t.type)return Z.none();var n=t.menu,t=f(o,r.slice(1));return tt(t,function(t){Ai(t.element,u.markers.backgroundMenu)}),ji(n.element)||wd.append(e,pu(n)),Vi(n.element,[u.markers.backgroundMenu]),l(e,n),d(e,o,r),Z.some(n)})})};(b=a=a||{})[b.HighlightSubmenu=0]="HighlightSubmenu",b[b.HighlightParent=1]="HighlightParent";var r=function(o,r,i){void 0===i&&(i=a.HighlightSubmenu);var t=s(r);return c.expand(t).bind(function(e){return m(o,e),Z.from(e[0]).bind(function(n){return c.lookupMenu(n).bind(function(t){t=function(t,n,e){if("notbuilt"!==e.type)return e.menu;e=t.getSystem().build(e.nbMenu());return c.setMenuBuilt(n,e),e}(o,n,t);return ji(t.element)||wd.append(o,pu(t)),u.onOpenSubmenu(o,r,t,G(e)),i===a.HighlightSubmenu?(pf.highlightFirst(t),g(o,c,e)):(pf.dehighlightAll(t),Z.some(r))})})})},p=function(n,e){var t=s(e);return c.collapse(t).bind(function(t){return m(n,t),g(n,c,t).map(function(t){return u.onCollapseMenu(n,e,t),t})})},n=function(e){return function(n,t){return Ku(t.getSource(),"."+u.markers.item).bind(function(t){return n.getSystem().getByDom(t).toOptional().bind(function(t){return e(n,t).map(S)})})}},h=qo([$o(Gd(),function(n,e){var t=e.event.item;c.lookupItem(s(t)).each(function(){var t=e.event.menu;pf.highlight(n,t);t=s(e.event.item);c.refresh(t).each(function(t){return d(n,c,t)})})}),ar(function(n,t){t=t.event.target;n.getSystem().getByDom(t).each(function(t){0===s(t).indexOf("collapse-item")&&p(n,t),r(n,t,a.HighlightSubmenu).fold(function(){u.onExecute(n,t)},$)})}),rr(function(n,t){e(n).each(function(t){wd.append(n,pu(t)),u.onOpenMenu(n,t),u.highlightImmediately&&l(n,t)})})].concat(u.navigateOnHover?[$o(Ld(),function(t,n){n=n.event.item;!function(n,t){t=s(t);c.refresh(t).bind(function(t){return m(n,t),g(n,c,t)})}(t,n),r(t,n,a.HighlightParent),u.onHover(t,n)})]:[])),v=function(t){return pf.getHighlighted(t).bind(pf.getHighlighted)},b={collapseMenu:function(n){v(n).each(function(t){p(n,t)})},highlightPrimary:function(n){c.getPrimary().each(function(t){l(n,t)})},repositionMenus:function(e){c.getPrimary().bind(function(n){return v(e).bind(function(t){var n=s(t),t=It(c.getMenus()),e=Hi(R(t,Jd.extractPreparedMenu));return c.getTriggeringPath(n,function(t){return n=t,rt(e,function(t){if(!t.getSystem().isConnected())return Z.none();t=pf.getCandidates(t);return L(t,function(t){return s(t)===n})});var n})}).map(function(t){return{primary:n,triggeringPath:t}})}).fold(function(){Z.from(e.components()[0]).filter(function(t){return"menu"===Wr(t.element,"role")}).each(function(t){u.onRepositionMenu(e,t,[])})},function(t){var n=t.primary,t=t.triggeringPath;u.onRepositionMenu(e,n,t)})}};return{uid:u.uid,dom:u.dom,markers:u.markers,behaviours:yl(u.tmenuBehaviours,[hd.config({mode:"special",onRight:n(function(t,n){return rf(n.element)?Z.none():r(t,n,a.HighlightSubmenu)}),onLeft:n(function(t,n){return rf(n.element)?Z.none():p(t,n)}),onEscape:n(function(t,n){return p(t,n).orThunk(function(){return u.onEscape(t,n).map(function(){return t})})}),focusIn:function(n,t){c.getPrimary().each(function(t){Go(n,t.element,So())})}}),pf.config({highlightClass:u.markers.selectedMenu,itemClass:u.markers.menu}),uf.config({find:function(t){return pf.getHighlighted(t)}}),wd.config({})]),eventOrder:u.eventOrder,apis:b,events:h}},extraApis:{tieredData:function(t,n,e){return{primary:t,menus:n,expansions:e}},singleData:function(t,n){return{primary:t,menus:ze(t,n),expansions:{}}},collapseItem:function(t){return{value:Qr($d()),meta:{text:t}}}}}),Zd=of({name:"InlineView",configFields:[Bn("lazySink"),da("onShow"),da("onHide"),jn("onEscape"),sr("inlineBehaviours",[il,vl,cc]),Wn("fireDismissalEventInstead",[Un("event",Io())]),Wn("fireRepositionEventInstead",[Un("event",Ro())]),Un("getRelated",Z.none),Un("isExtraPart",d),Un("eventOrder",Z.none)],factory:function(f,t){var o=function(t,n,e,o){r(t,n,e,function(){return o.map(zu)})},r=function(t,n,e,o){var r=f.lazySink(t).getOrDie();il.openWhileCloaked(t,e,function(){return Ls.positionWithinBounds(r,n,t,o())}),vl.setValue(t,Z.some({mode:"position",anchor:n,getBounds:o}))},i=function(t,n,e,o){var r,i,u,a,c,s,l,e=(r=f,i=t,u=n,a=o,c=function(){return r.lazySink(i)},s="horizontal"===e.type?{layouts:{onLtr:qa,onRtl:Ka}}:{},l=function(t){return 2===t.length?s:{}},Qd.sketch({dom:{tag:"div"},data:e.data,markers:e.menu.markers,highlightImmediately:e.menu.highlightImmediately,onEscape:function(){return il.close(i),r.onEscape.map(function(t){return t(i)}),Z.some(!0)},onExecute:function(){return Z.some(!0)},onOpenMenu:function(t,n){Ls.positionWithinBounds(c().getOrDie(),u,n,a())},onOpenSubmenu:function(t,n,e,o){var r=c().getOrDie();Ls.position(r,Q({anchor:"submenu",item:n},l(o)),e)},onRepositionMenu:function(t,n,e){var o=c().getOrDie();Ls.positionWithinBounds(o,u,n,a()),tt(e,function(t){var n=l(t.triggeringPath);Ls.position(o,Q({anchor:"submenu",item:t.triggeringItem},n),t.triggeredMenu)})}}));il.open(t,e),vl.setValue(t,Z.some({mode:"menu",menu:e}))},n=function(e){il.isOpen(e)&&vl.getValue(e).each(function(t){switch(t.mode){case"menu":il.getState(e).each(function(t){Qd.repositionMenus(t)});break;case"position":var n=f.lazySink(e).getOrDie();Ls.positionWithinBounds(n,t.anchor,e,t.getBounds())}})},e={setContent:function(t,n){il.setContent(t,n)},showAt:function(t,n,e){o(t,n,e,Z.none())},showWithin:o,showWithinBounds:r,showMenuAt:function(t,n,e){i(t,n,e,function(){return Z.none()})},showMenuWithinBounds:i,hide:function(t){il.isOpen(t)&&(vl.setValue(t,Z.none()),il.close(t))},getContent:function(t){return il.getState(t)},reposition:n,isOpen:il.isOpen};return{uid:f.uid,dom:f.dom,behaviours:yl(f.inlineBehaviours,[il.config({isPartOf:function(t,n,e){return Qu(n,e)||(o=e,f.getRelated(t).exists(function(t){return Qu(t,o)}));var o},getAttachPoint:function(t){return f.lazySink(t).getOrDie()},onOpen:function(t){f.onShow(t)},onClose:function(t){f.onHide(t)}}),vl.config({store:{mode:"memory",initialValue:Z.none()}}),cc.config({channels:Q(Q({},ll(Q({isExtraPart:t.isExtraPart},f.fireDismissalEventInstead.map(function(t){return{fireEventInstead:{event:t.event}}}).getOr({})))),dl(Q(Q({},f.fireRepositionEventInstead.map(function(t){return{fireEventInstead:{event:t.event}}}).getOr({})),{doReposition:n})))})]),eventOrder:f.eventOrder,apis:e}},apis:{showAt:function(t,n,e,o){t.showAt(n,e,o)},showWithin:function(t,n,e,o,r){t.showWithin(n,e,o,r)},showWithinBounds:function(t,n,e,o,r){t.showWithinBounds(n,e,o,r)},showMenuAt:function(t,n,e,o){t.showMenuAt(n,e,o)},showMenuWithinBounds:function(t,n,e,o,r){t.showMenuWithinBounds(n,e,o,r)},hide:function(t,n){t.hide(n)},isOpen:function(t,n){return t.isOpen(n)},getContent:function(t,n){return t.getContent(n)},setContent:function(t,n,e){t.setContent(n,e)},reposition:function(t,n){t.reposition(n)}}}),tm="layout-inner",nm=function(t,n){return t.x+t.width/2-n.width/2},em=function(t,n){return t.x+t.width-n.width},om=function(t,n){return t.y+t.height-n.height},rm=function(t,n){return t.y+t.height/2-n.height/2},im=function(t,n,e){return ba(em(t,n),om(t,n),e.innerSouthwest(),Sa(),"southwest",Da(t,{right:0,bottom:3}),tm)},um=function(t,n,e){return ba(t.x,om(t,n),e.innerSoutheast(),wa(),"southeast",Da(t,{left:1,bottom:3}),tm)},am=function(t,n,e){return ba(em(t,n),t.y,e.innerNorthwest(),xa(),"northwest",Da(t,{right:0,top:2}),tm)},cm=function(t,n,e){return ba(t.x,t.y,e.innerNortheast(),ya(),"northeast",Da(t,{left:1,top:2}),tm)},sm=function(t,n,e){return ba(nm(t,n),t.y,e.innerNorth(),ka(),"north",Da(t,{top:2}),tm)},lm=function(t,n,e){return ba(nm(t,n),om(t,n),e.innerSouth(),Ca(),"south",Da(t,{bottom:3}),tm)},fm=function(t,n,e){return ba(em(t,n),rm(t,n),e.innerEast(),_a(),"east",Da(t,{right:0}),tm)},dm=function(t,n,e){return ba(t.x,rm(t,n),e.innerWest(),Oa(),"west",Da(t,{left:1}),tm)},mm=function(t,n,e,o){return function(t){switch(t){case"north":return sm;case"northeast":return cm;case"northwest":return am;case"south":return lm;case"southeast":return um;case"southwest":return im;case"east":return fm;case"west":return dm}}(Ur(o,wc).getOr("north"))(t,n,e,o)},gm=tinymce.util.Tools.resolve("tinymce.util.Delay"),pm=of({name:"Button",factory:function(t){var n=Rd(t.action),e=t.dom.tag,o=function(n){return Rt(t.dom,"attributes").bind(function(t){return Rt(t,n)})};return{uid:t.uid,dom:t.dom,components:t.components,events:n,behaviours:wl(t.buttonBehaviours,[Cd.config({}),hd.config({mode:"execution",useSpace:!0,useEnter:!0})]),domModification:{attributes:function(){if("button"!==e)return{role:o("role").getOr("button")};var t=o("type").getOr("button"),n=o("role").map(function(t){return{role:t}}).getOr({});return Q({type:t},n)}()},eventOrder:t.eventOrder}},configFields:[Un("uid",undefined),Bn("dom"),Un("components",[]),xl("buttonBehaviours",[Cd,hd]),Hn("action"),Hn("role"),Un("eventOrder",{})]}),hm=function(t){var n=t.uid!==undefined&&Pt(t,"uid")?t.uid:ii("memento");return{get:function(t){return t.getSystem().getByUid(n).getOrDie()},getOpt:function(t){return t.getSystem().getByUid(n).toOptional()},asSpec:function(){return Q(Q({},t),{uid:n})}}},vm=function(t){return Z.from(t()["temporary-placeholder"]).getOr("!not found!")},bm=function(t,n){return Z.from(n()[t.toLowerCase()]).getOrThunk(function(){return vm(n)})},ym={success:"checkmark",error:"warning",err:"error",warning:"warning",warn:"warning",info:"info"},xm=of({name:"Notification",factory:function(n){var e,o=hm({dom:{tag:"p",innerHtml:n.translationProvider(n.text)},behaviours:ec([wd.config({})])}),r=function(t){return{dom:{tag:"div",classes:["tox-bar"],attributes:{style:"width: "+t+"%"}}}},i=function(t){return{dom:{tag:"div",classes:["tox-text"],innerHtml:t+"%"}}},u=hm({dom:{tag:"div",classes:n.progress?["tox-progress-bar","tox-progress-indicator"]:["tox-progress-bar"]},components:[{dom:{tag:"div",classes:["tox-bar-container"]},components:[r(0)]},i(0)],behaviours:ec([wd.config({})])}),t={updateProgress:function(t,n){t.getSystem().isConnected()&&u.getOpt(t).each(function(t){wd.set(t,[{dom:{tag:"div",classes:["tox-bar-container"]},components:[r(n)]},i(n)])})},updateText:function(t,n){t.getSystem().isConnected()&&(t=o.get(t),wd.set(t,[fu(n)]))}},a=nt([n.icon.toArray(),n.level.toArray(),n.level.bind(function(t){return Z.from(ym[t])}).toArray()]),c=hm(pm.sketch({dom:{tag:"button",classes:["tox-notification__dismiss","tox-button","tox-button--naked","tox-button--icon"]},components:[{dom:{tag:"div",classes:["tox-icon"],innerHtml:bm("close",n.iconProvider),attributes:{"aria-label":n.translationProvider("Close")}}}],action:function(t){n.onAction(t)}})),a=[{dom:{tag:"div",classes:["tox-notification__icon"],innerHtml:(e=n.iconProvider,rt(a,function(t){return Z.from(e()[t.toLowerCase()])}).getOrThunk(function(){return vm(e)}))}},{dom:{tag:"div",classes:["tox-notification__body"]},components:[o.asSpec()],behaviours:ec([wd.config({})])}];return{uid:n.uid,dom:{tag:"div",attributes:{role:"alert"},classes:n.level.map(function(t){return["tox-notification","tox-notification--in","tox-notification--"+t]}).getOr(["tox-notification","tox-notification--in"])},behaviours:ec([Cd.config({}),Sd("notification-events",[$o(io(),function(t){c.getOpt(t).each(Cd.focus)})])]),components:a.concat(n.progress?[u.asSpec()]:[]).concat(n.closeButton?[c.asSpec()]:[]),apis:t}},configFields:[Hn("level"),Bn("progress"),Bn("icon"),Bn("onAction"),Bn("text"),Bn("iconProvider"),Bn("translationProvider"),Kn("closeButton",!0)],apis:{updateProgress:function(t,n,e){t.updateProgress(n,e)},updateText:function(t,n,e){t.updateText(n,e)}}});function wm(t,u,a){var c=u.backstage;return{open:function(t,n){var e=!t.closeButton&&t.timeout&&(0<t.timeout||t.timeout<0),o=function(){n(),Zd.hide(i)},r=gu(xm.sketch({text:t.text,level:A(["success","error","warning","warn","info"],t.type)?t.type:undefined,progress:!0===t.progressBar,icon:Z.from(t.icon),closeButton:!e,onAction:o,iconProvider:c.shared.providers.icons,translationProvider:c.shared.providers.translate})),i=gu(Zd.sketch(Q({dom:{tag:"div",classes:["tox-notifications-container"]},lazySink:u.backstage.shared.getSink,fireDismissalEventInstead:{}},c.shared.header.isPositionedAtTop()?{}:{fireRepositionEventInstead:{}})));return a.add(i),0<t.timeout&&gm.setTimeout(function(){o()},t.timeout),{close:o,moveTo:function(t,n){Zd.showAt(i,{anchor:"makeshift",x:t,y:n},pu(r))},moveRel:function(t,n){var e;"banner"!==n?(e=function(t){switch(t){case"bc-bc":return lm;case"tc-tc":return sm;case"tc-bc":return La;case"bc-tc":default:return Na}}(n),t={anchor:"node",root:Wi(),node:Z.some(ne.fromDom(t)),layouts:{onRtl:function(){return[e]},onLtr:function(){return[e]}}},Zd.showAt(i,t,pu(r))):Zd.showAt(i,u.backstage.shared.anchors.banner(),pu(r))},text:function(t){xm.updateText(r,t)},settings:t,getEl:function(){return r.element.dom},progressBar:{value:function(t){xm.updateProgress(r,t)}}}},close:function(t){t.close()},reposition:function(t){var e;tt(t,function(t){return t.moveTo(0,0)}),0<(e=t).length&&(J(e).each(function(t){return t.moveRel(null,"banner")}),tt(e,function(t,n){0<n&&t.moveRel(e[n-1].getEl(),"bc-tc")}))},getArgs:function(t){return t.settings}}}var Sm=function(e,o){var r=null;return{cancel:function(){null!==r&&(clearTimeout(r),r=null)},throttle:function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];null!==r&&clearTimeout(r),r=setTimeout(function(){e.apply(null,t),r=null},o)}}},km=tinymce.util.Tools.resolve("tinymce.dom.TextSeeker"),Cm=function(e,t,n,o,r){var i=km(e,function(t){return n=t,(t=e).isBlock(n)||A(["BR","IMG","HR","INPUT"],n.nodeName)||"false"===t.getContentEditable(n);var n});return Z.from(i.backwards(t,n,o,r))},Om=function(e,n){return _m(ne.fromDom(e.selection.getNode())).getOrThunk(function(){var t=ne.fromHtml('<span data-mce-autocompleter="1" data-mce-bogus="1"></span>',e.getDoc());return Ir(t,ne.fromDom(n.extractContents())),n.insertNode(t.dom),br(t).each(function(t){return t.dom.normalize()}),ps(t,gs).map(function(t){var n;e.selection.setCursorLocation(t.dom,"img"===cr(n=t)?1:ds(n).fold(function(){return wr(n).length},function(t){return t.length}))}),t})},_m=function(t){return Ku(t,"[data-mce-autocompleter]")},Tm=function(t){return t.toString().replace(/\u00A0/g," ").replace(/\uFEFF/g,"")},Em=function(t){return""!==t&&-1!==" \xa0\f\n\r\t\x0B".indexOf(t)},Dm=function(t,n){return t.substring(n.length)},Bm=function(t,e,o,r){if(void 0===r&&(r=0),!(n=e).collapsed||3!==n.startContainer.nodeType)return Z.none();var n=t.getParent(e.startContainer,t.isBlock)||t.getRoot();return Cm(t,e.startContainer,e.startOffset,function(t,n,e){return function(t,n,e){for(var o=n-1;0<=o;o--){var r=t.charAt(o);if(Em(r))return Z.none();if(r===e)break}return Z.some(o)}(e,n,o).getOr(n)},n).bind(function(t){var n=e.cloneRange();if(n.setStart(t.container,t.offset),n.setEnd(e.endContainer,e.endOffset),n.collapsed)return Z.none();t=Tm(n);return 0!==t.lastIndexOf(o)||Dm(t,o).length<r?Z.none():Z.some({text:Dm(t,o),range:n,triggerChar:o})})},Am=function(e,t,o,n){return void 0===n&&(n=0),_m(ne.fromDom(t.startContainer)).fold(function(){return Bm(e,t,o,n)},function(t){var n=e.createRng();n.selectNode(t.dom);t=Tm(n);return Z.some({range:n,text:Dm(t,o),triggerChar:o})})},Mm=function(e,t){t.on("keypress compositionend",e.onKeypress.throttle),t.on("remove",e.onKeypress.cancel);var o=function(t,n){Wo(t,ao(),{raw:n})};t.on("keydown",function(n){var t=function(){return e.getView().bind(pf.getHighlighted)};8===n.which&&e.onKeypress.throttle(n),e.isActive()&&(27===n.which&&e.cancelIfNecessary(),e.isMenuOpen()?13===n.which?(t().each(Uo),n.preventDefault()):40===n.which?(t().fold(function(){e.getView().each(pf.highlightFirst)},function(t){o(t,n)}),n.preventDefault(),n.stopImmediatePropagation()):37!==n.which&&38!==n.which&&39!==n.which||t().each(function(t){o(t,n),n.preventDefault(),n.stopImmediatePropagation()}):13!==n.which&&38!==n.which&&40!==n.which||e.cancelIfNecessary())}),t.on("NodeChange",function(t){e.isActive()&&!e.isProcessingAction()&&_m(ne.fromDom(t.element)).isNone()&&e.cancelIfNecessary()})},Fm=tinymce.util.Tools.resolve("tinymce.util.Promise"),Im=function(t,n){return{container:t,offset:n}},Rm=function(t){if(3===t.nodeType)return Im(t,t.data.length);var n=t.childNodes;return 0<n.length?Rm(n[n.length-1]):Im(t,n.length)},Vm=function(t,n){var e=t.childNodes;return 0<e.length&&n<e.length?Vm(e[n],0):0<e.length&&1===t.nodeType&&e.length===n?Rm(e[e.length-1]):Im(t,n)},Pm=function(n){return function(t){t=Vm(t.startContainer,t.startOffset);return!Cm(n,t.container,t.offset,function(t,n){return 0===n?-1:n},n.getRoot()).filter(function(t){t=t.container.data.charAt(t.offset-1);return!Em(t)}).isSome()}},Hm=function(n,e){var o,r,t=e(),i=n.selection.getRng();return o=n.dom,r=i,rt(t.triggerChars,function(t){return Am(o,r,t)}).bind(function(t){return zm(n,e,t)})},zm=function(n,t,e,o){void 0===o&&(o={});var t=t(),r=n.selection.getRng().startContainer.nodeValue,t=P(t.lookupByChar(e.triggerChar),function(t){return e.text.length>=t.minChars&&t.matches.getOrThunk(function(){return Pm(n.dom)})(e.range,r,e.text)});if(0===t.length)return Z.none();t=Fm.all(R(t,function(n){return n.fetch(e.text,n.maxResults,o).then(function(t){return{matchText:e.text,items:t,columns:n.columns,onAction:n.onAction,highlightOn:n.highlightOn}})}));return Z.some({lookupData:t,context:e})},Lm=rn([Mn("type"),Nn("text")]),Nm=rn([Un("type","autocompleteitem"),Un("active",!1),Un("disabled",!1),Un("meta",{}),Mn("value"),Nn("text"),Nn("icon")]),jm=rn([Mn("type"),Mn("ch"),Xn("minChars",1),Un("columns",1),Xn("maxResults",10),jn("matches"),In("fetch"),In("onAction"),$n("highlightOn",[],mn)]),Oi=[Kn("disabled",!1),Nn("tooltip"),Nn("icon"),Nn("text"),Jn("onSetup",function(){return $})],Wm=rn([Mn("type"),In("onAction")].concat(Oi)),Um=function(t){return Sn("toolbarbutton",Wm,t)},Zr=[Kn("active",!1)].concat(Oi),Gm=rn(Zr.concat([Mn("type"),In("onAction")])),Xm=function(t){return Sn("ToggleButton",Gm,t)},e=[Jn("predicate",d),qn("scope","node",["node","editor"]),qn("position","selection",["node","selection","line"])],Ht=Oi.concat([Un("type","contextformbutton"),Un("primary",!1),In("onAction"),En("original",h)]),hu=Zr.concat([Un("type","contextformbutton"),Un("primary",!1),In("onAction"),En("original",h)]),Ja=Oi.concat([Un("type","contextformbutton")]),Ke=Zr.concat([Un("type","contextformtogglebutton")]),C=_n("type",{contextformbutton:Ht,contextformtogglebutton:hu}),Ym=rn([Un("type","contextform"),Jn("initValue",U("")),Nn("label"),Pn("commands",C),zn("launch",_n("type",{contextformbutton:Ja,contextformtogglebutton:Ke}))].concat(e)),qm=rn([Un("type","contexttoolbar"),Mn("items")].concat(e)),Km=function(t){var n,e=t.ui.registry.getAll().popups,t=Dt(e,function(t){return Sn("Autocompleter",jm,t).fold(function(t){throw new Error(On(t))},h)}),e=(e=Mt(t,function(t){return t.ch}),n={},tt(e,function(t){n[t]={}}),_t(n)),o=It(t);return{dataset:t,triggerChars:e,lookupByChar:function(n){return P(o,function(t){return t.ch===n})}}};(t=sb=sb||{})[t.CLOSE_ON_EXECUTE=0]="CLOSE_ON_EXECUTE",t[t.BUBBLE_TO_SANDBOX=1]="BUBBLE_TO_SANDBOX";var Jm,$m=sb,Qm="tox-menu-nav__js",Zm="tox-collection__item",tg="tox-swatch",ng={normal:Qm,color:tg},eg="tox-collection__item--enabled",og="tox-collection__item-label",rg="tox-collection__item-caret",ig="tox-collection__item--active",ug="tox-collection__item-container",ag="tox-collection__item-container--row",cg=function(t){return Rt(ng,t).getOr(Qm)},sg=function(t){return{backgroundMenu:"tox-background-menu",selectedMenu:"tox-selected-menu",selectedItem:"tox-collection__item--active",hasIcons:"tox-menu--has-icons",menu:"color"===t?"tox-swatches":"tox-menu",tieredMenu:"tox-tiered-menu"}},lg=function(t){var n=sg(t);return{backgroundMenu:n.backgroundMenu,selectedMenu:n.selectedMenu,menu:n.menu,selectedItem:n.selectedItem,item:cg(t)}},fg=[Xd.parts.items({})],dg=function(t,n,e){var o=sg(e);return{dom:{tag:"div",classes:nt([[o.tieredMenu]])},markers:lg(e)}},mg=function(n,e){return function(t){t=I(t,e);return R(t,function(t){return{dom:n,components:t}})}},gg=function(t,e){var o=[],r=[];return tt(t,function(t,n){e(t,n)?(0<r.length&&o.push(r),r=[],Vt(t.dom,"innerHtml")&&r.push(t)):r.push(t)}),0<r.length&&o.push(r),R(o,function(t){return{dom:{tag:"div",classes:["tox-collection__group"]},components:t}})},pg=function(n,e,t){return{dom:{tag:"div",classes:["tox-menu","tox-collection"].concat(1===n?["tox-collection--list"]:["tox-collection--grid"])},components:[Xd.parts.items({preprocess:function(t){return"auto"!==n&&1<n?mg({tag:"div",classes:["tox-collection__group"]},n)(t):gg(t,function(t,n){return"separator"===e[n].type})}})]}},hg=function(t){return M(t,function(t){return"icon"in t&&t.icon!==undefined})},vg=function(t){return console.error(On(t)),console.log(t),Z.none()},bg=function(t,n,e,o,r){var i,u=(i=e,{dom:{tag:"div",classes:["tox-collection","tox-collection--horizontal"]},components:[Xd.parts.items({preprocess:function(t){return gg(t,function(t,n){return"separator"===i[n].type})}})]});return{value:t,dom:u.dom,components:u.components,items:e}},yg=function(t,n,e,o,r){var i;return"color"===r?{value:t,dom:(i=(i=o,{dom:{tag:"div",classes:["tox-menu","tox-swatches-menu"]},components:[{dom:{tag:"div",classes:["tox-swatches"]},components:[Xd.parts.items({preprocess:"auto"!==i?mg({tag:"div",classes:["tox-swatches__row"]},i):h})]}]})).dom,components:i.components,items:e}:"normal"===r&&"auto"===o?{value:t,dom:(i=pg(o,e)).dom,components:i.components,items:e}:"normal"===r&&1===o?{value:t,dom:(i=pg(1,e)).dom,components:i.components,items:e}:"normal"===r?{value:t,dom:(i=pg(o,e)).dom,components:i.components,items:e}:"listpreview"!==r||"auto"===o?{value:t,dom:function(t,n,e){e=sg(e);return{tag:"div",classes:nt([[e.menu,"tox-menu-"+n+"-column"],t?[e.hasIcons]:[]])}}(n,o,r),components:fg,items:e}:{value:t,dom:(i={dom:{tag:"div",classes:["tox-menu","tox-collection","tox-collection--toolbar","tox-collection--toolbar-lg"]},components:[Xd.parts.items({preprocess:mg({tag:"div",classes:["tox-collection__group"]},o)})]}).dom,components:i.components,items:e}},Kr=[Mn("type"),Mn("src"),Nn("alt"),$n("classes",[],mn)],xg=rn(Kr),ho=[Mn("type"),Mn("text"),Nn("name"),$n("classes",["tox-collection__item-label"],mn)],wg=rn(ho),Ro=en(function(){return yn("type",{cardimage:xg,cardtext:wg,cardcontainer:Sg})}),Sg=rn([Mn("type"),Yn("direction","horizontal"),Yn("align","left"),Yn("valign","middle"),Pn("items",Ro)]),Zr=[Kn("disabled",!1),Nn("text"),Nn("shortcut"),Tn("value","value",Wt(function(){return Qr("menuitem-value")}),ln()),Un("meta",{})],kg=rn([Mn("type"),Nn("label"),Pn("items",Ro),Jn("onSetup",function(){return $}),Jn("onAction",$)].concat(Zr)),Cg=rn([Mn("type"),Kn("active",!1),Nn("icon")].concat(Zr)),Og=rn([Mn("type"),Fn("fancytype",["inserttable","colorswatch"]),Un("initData",{}),Jn("onAction",$)]),_g=rn([Mn("type"),Jn("onSetup",function(){return $}),Jn("onAction",$),Nn("icon")].concat(Zr)),Tg=rn([Mn("type"),In("getSubmenuItems"),Jn("onSetup",function(){return $}),Nn("icon")].concat(Zr)),Eg=rn([Mn("type"),Nn("icon"),Kn("active",!1),Jn("onSetup",function(){return $}),In("onAction")].concat(Zr)),Dg=function(t,e,n){var o=hs(t.element,"."+n);if(0<o.length){n=N(o,function(t){var n=t.dom.getBoundingClientRect().top,t=o[0].dom.getBoundingClientRect().top;return Math.abs(n-t)>e}).getOr(o.length);return Z.some({numColumns:n,numRows:Math.ceil(o.length/n)})}return Z.none()},Bg=function(t,n){return ec([Sd(t,n)])},Ag=function(t){return Bg(Qr("unnamed-events"),t)},Mg=Qr("tooltip.exclusive"),Fg=Qr("tooltip.show"),Ig=Qr("tooltip.hide"),Rg=function(t,n,e){t.getSystem().broadcastOn([Mg],{})},Ht=Object.freeze({__proto__:null,hideAllExclusive:Rg,setComponents:function(t,n,e,o){e.getTooltip().each(function(t){t.getSystem().isConnected()&&wd.set(t,o)})}}),hu=Object.freeze({__proto__:null,events:function(r,i){var e=function(n){i.getTooltip().each(function(t){qs(t),r.onHide(n,t),i.clearTooltip()}),i.clearTimer()};return qo(nt([[$o(Fg,function(o){i.resetTimer(function(){var n,t,e;n=o,i.isShowing()||(Rg(n),t=r.lazySink(n).getOrDie(),e=n.getSystem().build({dom:r.tooltipDom,components:r.tooltipComponents,events:qo("normal"===r.mode?[$o(ro(),function(t){jo(n,Fg)}),$o(eo(),function(t){jo(n,Ig)})]:[]),behaviours:ec([wd.config({})])}),i.setTooltip(e),Gs(t,e),r.onShow(n,e),Ls.position(t,r.anchor(n),e))},r.delay)}),$o(Ig,function(t){i.resetTimer(function(){e(t)},r.delay)}),$o(xo(),function(t,n){n.universal||A(n.channels,Mg)&&e(t)}),ir(function(t){e(t)})],"normal"===r.mode?[$o(io(),function(t){jo(t,Fg)}),$o(bo(),function(t){jo(t,Ig)}),$o(ro(),function(t){jo(t,Fg)}),$o(eo(),function(t){jo(t,Ig)})]:[$o(Lo(),function(t,n){jo(t,Fg)}),$o(No(),function(t){jo(t,Ig)})]]))}}),C=[Bn("lazySink"),Bn("tooltipDom"),Un("exclusive",!0),Un("tooltipComponents",[]),Un("delay",300),qn("mode","normal",["normal","follow-highlight"]),Un("anchor",function(t){return{anchor:"hotspot",hotspot:t,layouts:{onLtr:U([Na,La,Va,Ha,Pa,za]),onRtl:U([Na,La,Va,Ha,Pa,za])}}}),da("onHide"),da("onShow")],Vg=rc({fields:C,name:"tooltipping",active:hu,state:Object.freeze({__proto__:null,init:function(){var e=Zn(Z.none()),n=Zn(Z.none()),o=function(){e.get().each(function(t){clearTimeout(t)})},t=U("not-implemented");return pi({getTooltip:function(){return n.get()},isShowing:function(){return n.get().isSome()},setTooltip:function(t){n.set(Z.some(t))},clearTooltip:function(){n.set(Z.none())},clearTimer:o,resetTimer:function(t,n){o(),e.set(Z.some(setTimeout(function(){t()},n)))},readState:t})}}),apis:Ht}),Pg=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),Hg=tinymce.util.Tools.resolve("tinymce.util.I18n"),zg=["input","button","textarea","select"],Lg=function(t,n,e){(n.disabled()?Xg:Yg)(t,n)},Ng=function(t,n){return!0===n.useNative&&A(zg,cr(t.element))},jg=function(t){jr(t.element,"disabled","disabled")},Wg=function(t){Xr(t.element,"disabled")},Ug=function(t){jr(t.element,"aria-disabled","true")},Gg=function(t){jr(t.element,"aria-disabled","false")},Xg=function(n,t,e){t.disableClass.each(function(t){Ai(n.element,t)}),(Ng(n,t)?jg:Ug)(n),t.onDisabled(n)},Yg=function(n,t,e){t.disableClass.each(function(t){Fi(n.element,t)}),(Ng(n,t)?Wg:Gg)(n),t.onEnabled(n)},qg=function(t,n){return Ng(t,n)?Gr(t.element,"disabled"):"true"===Wr(t.element,"aria-disabled")},Ja=Object.freeze({__proto__:null,enable:Yg,disable:Xg,isDisabled:qg,onLoad:Lg,set:function(t,n,e,o){(o?Xg:Yg)(t,n)}}),Ke=Object.freeze({__proto__:null,exhibit:function(t,n){return vi({classes:n.disabled()?n.disableClass.toArray():[]})},events:function(e,t){return qo([Ko(wo(),function(t,n){return qg(t,e)}),$a(e,t,Lg)])}}),e=[Jn("disabled",d),Un("useNative",!0),Hn("disableClass"),da("onDisabled"),da("onEnabled")],Kg=rc({fields:e,name:"disabling",active:Ke,apis:Ja}),Jg=tinymce.util.Tools.resolve("tinymce.EditorManager"),$g=function(t){return t.getParam("height",Math.max(t.getElement().offsetHeight,200))},Qg=function(t){return t.getParam("width",Pg.DOM.getStyle(t.getElement(),"width"))},Zg=function(t){return Z.from(t.getParam("min_width")).filter(s)},tp=function(t){return Z.from(t.getParam("min_height")).filter(s)},np=function(t){return Z.from(t.getParam("max_width")).filter(s)},ep=function(t){return Z.from(t.getParam("max_height")).filter(s)},op=function(t){return!1!==t.getParam("menubar",!0,"boolean")},rp=function(t){var n=t.getParam("toolbar",!0),e=!0===n,o=v(n),n=c(n)&&0<n.length;return!up(t)&&(n||o||e)},ip=function(n){var t=F(9,function(t){return n.getParam("toolbar"+(t+1),!1,"string")}),t=P(t,function(t){return"string"==typeof t});return 0<t.length?Z.some(t):Z.none()},up=function(t){return ip(t).fold(function(){return 0<t.getParam("toolbar",[],"string[]").length},S)};(t=Jm=Jm||{})["default"]="wrap",t.floating="floating",t.sliding="sliding",t.scrolling="scrolling";var ap,cp=function(t){return t.getParam("toolbar_mode","","string")};(sb=ap=ap||{}).auto="auto",sb.top="top",sb.bottom="bottom";var sp=function(t){return t.getParam("toolbar_location",ap.auto,"string")},lp=function(t){return sp(t)===ap.bottom},fp=function(t){if(!t.inline)return Z.none();var n=t.getParam("fixed_toolbar_container","","string");if(0<n.length)return qu(Wi(),n);t=t.getParam("fixed_toolbar_container_target");return u(t)?Z.some(ne.fromDom(t)):Z.none()},dp=function(t){return t.inline&&fp(t).isSome()},mp=function(t){return fp(t).getOrThunk(function(){return Tr(_r(ne.fromDom(t.getElement())))})},gp=function(t){return t.inline&&!op(t)&&!rp(t)&&!up(t)},pp=function(t){return(t.getParam("toolbar_sticky",!1,"boolean")||t.inline)&&!dp(t)&&!gp(t)},hp="silver.readonly",vp=rn([An("readonly",gn)]),bp=function(t,n){var e=t.outerContainer.element;n&&(t.mothership.broadcastOn([ul()],{target:e}),t.uiMothership.broadcastOn([ul()],{target:e})),t.mothership.broadcastOn([hp],{readonly:n}),t.uiMothership.broadcastOn([hp],{readonly:n})},yp=function(t,n){t.on("init",function(){t.mode.isReadOnly()&&bp(n,!0)}),t.on("SwitchMode",function(){return bp(n,t.mode.isReadOnly())}),t.getParam("readonly",!1,"boolean")&&t.setMode("readonly")},xp=function(){var t;return cc.config({channels:((t={})[hp]={schema:vp,onReceive:function(t,n){Kg.set(t,n.readonly)}},t)})},wp=function(t){return Kg.config({disabled:t,disableClass:"tox-collection__item--state-disabled"})},Sp=function(t){return Kg.config({disabled:t})},kp=function(t){return Kg.config({disabled:t,disableClass:"tox-tbtn--disabled"})},Cp=function(t){return Kg.config({disabled:t,disableClass:"tox-tbtn--disabled",useNative:!1})},Op=function(t,n){var e=t.getApi(n);return function(t){t(e)}},_p=function(n,e){return rr(function(t){Op(n,t)(function(t){t=n.onSetup(t);l(t)&&e.set(t)})})},Tp=function(n,e){return ir(function(t){return Op(n,t)(e.get())})},Ep=((Kr={})[wo()]=["disabling","alloy.base.behaviour","toggling","item-events"],Kr),Dp=Hi,Bp=function(t,n,e,o){var r,i,u=Zn($);return{type:"item",dom:n.dom,components:Dp(n.optComponents),data:t.data,eventOrder:Ep,hasSubmenu:t.triggersSubmenu,itemBehaviours:ec([Sd("item-events",[(r=t,i=e,ar(function(t,n){Op(r,t)(r.onAction),r.triggersSubmenu||i!==$m.CLOSE_ON_EXECUTE||(jo(t,Oo()),n.stop())})),_p(t,u),Tp(t,u)]),wp(function(){return t.disabled||o.isDisabled()}),xp(),wd.config({})].concat(t.itemBehaviours))}},Ap=function(t){return{value:t.value,meta:Q({text:t.text.getOr("")},t.meta)}},Mp=tinymce.util.Tools.resolve("tinymce.Env"),Fp=function(t){return{dom:{tag:"div",classes:["tox-collection__item-icon"],innerHtml:t}}},Ip=function(t){return{dom:{tag:"div",classes:[og]},components:[fu(Hg.translate(t))]}},Rp=function(t,n){return{dom:{tag:"div",classes:n,innerHtml:t}}},Vp=function(t,n){return{dom:{tag:"div",classes:[og]},components:[{dom:{tag:t.tag,styles:t.styles},components:[fu(Hg.translate(n))]}]}},Pp=function(t){return{dom:{tag:"div",classes:["tox-collection__item-accessory"],innerHtml:(t=t,e=Mp.mac?{alt:"&#x2325;",ctrl:"&#x2303;",shift:"&#x21E7;",meta:"&#x2318;",access:"&#x2303;&#x2325;"}:{meta:"Ctrl",access:"Shift+Alt"},t=t.split("+"),t=R(t,function(t){var n=t.toLowerCase().trim();return Vt(e,n)?e[n]:t}),Mp.mac?t.join(""):t.join("+"))}};var e},Hp=function(t){return{dom:{tag:"div",classes:["tox-collection__item-checkmark"],innerHtml:bm("checkmark",t)}}},zp=function(t,n){n=n.map(function(t){return{attributes:{title:Hg.translate(t)}}}).getOr({});return Q({tag:"div",classes:[Qm,Zm].concat(t?["tox-collection__item-icon-rtl"]:[])},n)},Lp=["list-num-default","list-num-lower-alpha","list-num-lower-greek","list-num-lower-roman","list-num-upper-alpha","list-num-upper-roman"],Np=["list-bull-circle","list-bull-default","list-bull-square"],jp=function(t,o,n,r){void 0===r&&(r=Z.none());var e,i,u,a,c,s,l=Hg.isRtl()&&t.iconContent.exists(function(t){return A(Np,t)}),f=t.iconContent.map(function(t){return Hg.isRtl()&&A(Lp,t)?t+"-rtl":t}).map(function(t){return n=t,e=o.icons,t=r,Z.from(e()[n.toLowerCase()]).or(t).getOrThunk(function(){return vm(e)});var n,e}),d=Z.from(t.meta).fold(function(){return Ip},function(t){return Vt(t,"style")?x(Vp,t.style):Ip});return"color"===t.presets?(s=t.ariaLabel,u=t.value,a=o,{dom:(c=f.getOr(""),s={tag:"div",attributes:s.map(function(t){return{title:a.translate(t)}}).getOr({}),classes:["tox-swatch"]},Q(Q({},s),"custom"===u?{tag:"button",classes:p(p([],s.classes),["tox-swatches__picker-btn"]),innerHtml:c}:"remove"===u?{classes:p(p([],s.classes),["tox-swatch--remove"]),innerHtml:c}:{attributes:Q(Q({},s.attributes),{"data-mce-color":u}),styles:{"background-color":u}})),optComponents:[]}):(e=t,f=f,i=d,d=l,n=(l=n)?f.or(Z.some("")).map(Fp):Z.none(),l=e.checkMark,f=e.htmlContent.fold(function(){return e.textContent.map(i)},function(t){return Z.some(Rp(t,[og]))}),{dom:zp(d,e.ariaLabel),optComponents:[n,f,e.shortcutContent.map(Pp),l,e.caret]})},Wp=function(t,n){return Rt(t,"tooltipWorker").map(function(e){return[Vg.config({lazySink:n.getSink,tooltipDom:{tag:"div",classes:["tox-tooltip-worker-container"]},tooltipComponents:[],anchor:function(t){return{anchor:"submenu",item:t,overrides:{maxHeightFunction:Dc}}},mode:"follow-highlight",onShow:function(n,t){e(function(t){Vg.setComponents(n,[du({element:ne.fromDom(t)})])})}})]}).getOr([])},Up=function(t,n){t=Hg.translate(t),t=Pg.DOM.encode(t);if(0<n.length){n=new RegExp(n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"gi");return t.replace(n,function(t){return'<span class="tox-autocompleter-highlight">'+t+"</span>"})}return t},Gp=function(t,u){return R(t,function(t){switch(t.type){case"cardcontainer":return o=Gp((e=t).items,u),r="vertical"===e.direction?"tox-collection__item-container--column":ag,i="left"===e.align?"tox-collection__item-container--align-left":"tox-collection__item-container--align-right",{dom:{tag:"div",classes:[ug,r,i,function(){switch(e.valign){case"top":return"tox-collection__item-container--valign-top";case"middle":return"tox-collection__item-container--valign-middle";case"bottom":return"tox-collection__item-container--valign-bottom"}}()]},components:o};case"cardimage":return i=t.src,o=t.classes,n=t.alt,{dom:{tag:"img",classes:o,attributes:{src:i,alt:n.getOr("")}}};case"cardtext":n=t.name.exists(function(t){return A(u.cardText.highlightOn,t)})?Z.from(u.cardText.matchText).getOr(""):"";return Rp(Up(t.text,n),t.classes)}var n,e,o,r,i})},Xp=Pl(jd(),Wd()),Yp=function(t){return{value:t}},qp=/^#?([a-f\d])([a-f\d])([a-f\d])$/i,Kp=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i,Jp=function(t){return qp.test(t)||Kp.test(t)},$p=function(t){return(fe(n=t,t="#")?(t=t.length,n.substring(t)):n).toUpperCase();var n},Qp=function(t){t={value:t.value.replace(qp,function(t,n,e,o){return n+n+e+e+o+o})},t=Kp.exec(t.value);return null===t?["FFFFFF","FF","FF","FF"]:t},Zp=function(t){t=t.toString(16);return(1===t.length?"0"+t:t).toUpperCase()},th=function(t){t=Zp(t.red)+Zp(t.green)+Zp(t.blue);return Yp(t)},nh=Math.min,eh=Math.max,oh=Math.round,rh=/^rgb\((\d+),\s*(\d+),\s*(\d+)\)/,ih=/^rgba\((\d+),\s*(\d+),\s*(\d+),\s*(\d?(?:\.\d+)?)\)/,uh=function(t,n,e,o){return{red:t,green:n,blue:e,alpha:o}},ah=function(t){var n=parseInt(t,10);return n.toString()===t&&0<=n&&n<=255},ch=function(t){var n,e,o,r=(t.hue||0)%360,i=t.saturation/100,t=t.value/100,i=eh(0,nh(i,1)),t=eh(0,nh(t,1));if(0===i)return n=e=o=oh(255*t),uh(n,e,o,1);var r=r/60,u=t*i,a=u*(1-Math.abs(r%2-1)),t=t-u;switch(Math.floor(r)){case 0:n=u,e=a,o=0;break;case 1:n=a,e=u,o=0;break;case 2:n=0,e=u,o=a;break;case 3:n=0,e=a,o=u;break;case 4:n=a,e=0,o=u;break;case 5:n=u,e=0,o=a;break;default:n=e=o=0}return n=oh(255*(n+t)),e=oh(255*(e+t)),o=oh(255*(o+t)),uh(n,e,o,1)},sh=function(t){var n=Qp(t),e=parseInt(n[1],16),t=parseInt(n[2],16),n=parseInt(n[3],16);return uh(e,t,n,1)},lh=function(t,n,e,o){t=parseInt(t,10),n=parseInt(n,10),e=parseInt(e,10),o=parseFloat(o);return uh(t,n,e,o)},fh=function(t){if("transparent"===t)return Z.some(uh(0,0,0,0));var n=rh.exec(t);if(null!==n)return Z.some(lh(n[1],n[2],n[3],"1"));t=ih.exec(t);return null!==t?Z.some(lh(t[1],t[2],t[3],t[4])):Z.none()},dh=function(t){return"rgba("+t.red+","+t.green+","+t.blue+","+t.alpha+")"},mh=uh(255,0,0,1),gh=function(t,n){return t.fire("ResizeContent",n)},ph=function(t,n,e){return{hue:t,saturation:n,value:e}},hh=function(t){var n,e=0,o=0,r=t.red/255,i=t.green/255,u=t.blue/255,a=Math.min(r,Math.min(i,u)),t=Math.max(r,Math.max(i,u));return a===t?ph(0,0,100*(o=a)):(e=60*((e=r===a?3:u===a?1:5)-(r===a?i-u:u===a?r-i:u-r)/(t-a)),n=(t-a)/t,o=t,ph(Math.round(e),Math.round(100*n),Math.round(100*o)))},vh=function(t){return th(ch(t))},bh=function(r){return(Jp(t=r)?Z.some({value:$p(t)}):Z.none()).orThunk(function(){return fh(r).map(th)}).getOrThunk(function(){var t=document.createElement("canvas");t.height=1,t.width=1;var n=t.getContext("2d");n.clearRect(0,0,t.width,t.height),n.fillStyle="#FFFFFF",n.fillStyle=r,n.fillRect(0,0,1,1);var e=n.getImageData(0,0,1,1).data,o=e[0],t=e[1],n=e[2],e=e[3];return th(uh(o,t,n,e))});var t},yh=tinymce.util.Tools.resolve("tinymce.util.LocalStorage"),xh="tinymce-custom-colors";var wh,Sh="choiceitem",kh=[{type:Sh,text:"Light Green",value:"#BFEDD2"},{type:Sh,text:"Light Yellow",value:"#FBEEB8"},{type:Sh,text:"Light Red",value:"#F8CAC6"},{type:Sh,text:"Light Purple",value:"#ECCAFA"},{type:Sh,text:"Light Blue",value:"#C2E0F4"},{type:Sh,text:"Green",value:"#2DC26B"},{type:Sh,text:"Yellow",value:"#F1C40F"},{type:Sh,text:"Red",value:"#E03E2D"},{type:Sh,text:"Purple",value:"#B96AD9"},{type:Sh,text:"Blue",value:"#3598DB"},{type:Sh,text:"Dark Turquoise",value:"#169179"},{type:Sh,text:"Orange",value:"#E67E23"},{type:Sh,text:"Dark Red",value:"#BA372A"},{type:Sh,text:"Dark Purple",value:"#843FA1"},{type:Sh,text:"Dark Blue",value:"#236FA1"},{type:Sh,text:"Light Gray",value:"#ECF0F1"},{type:Sh,text:"Medium Gray",value:"#CED4D9"},{type:Sh,text:"Gray",value:"#95A5A6"},{type:Sh,text:"Dark Gray",value:"#7E8C8D"},{type:Sh,text:"Navy Blue",value:"#34495E"},{type:Sh,text:"Black",value:"#000000"},{type:Sh,text:"White",value:"#ffffff"}],Ch=function(n){void 0===n&&(n=10);var t=yh.getItem(xh),t=v(t)?JSON.parse(t):[],e=n-(t=t).length<0?t.slice(0,n):t,o=function(t){e.splice(t,1)};return{add:function(t){!function(t,n){n=B(t,n);return-1===n?Z.none():Z.some(n)}(e,t).each(o),e.unshift(t),e.length>n&&e.pop(),yh.setItem(xh,JSON.stringify(e))},state:function(){return e.slice(0)}}}(10),Oh=function(t){return!1!==t.getParam("custom_colors")},_h=function(t){t=t.getParam("color_map");return t!==undefined?function(t){for(var n=[],e=0;e<t.length;e+=2)n.push({text:t[e+1],value:"#"+bh(t[e]).value,type:"choiceitem"});return n}(t):kh},Th=function(t){Ch.add(t)},Eh=function(i){i.addCommand("mceApplyTextcolor",function(t,n){var e,o,r;o=t,r=n,(e=i).undoManager.transact(function(){e.focus(),e.formatter.apply(o,{value:r}),e.nodeChanged()})}),i.addCommand("mceRemoveTextcolor",function(t){var n,e;e=t,(n=i).undoManager.transact(function(){n.focus(),n.formatter.remove(e,{value:null},null,!0),n.nodeChanged()})})},Dh=function(t){var n=_h(t),n=(n=n.length,Math.max(5,Math.ceil(Math.sqrt(n))));return t.getParam("color_cols",n,"number")},Bh=function(t){var n="choiceitem",e={type:n,text:"Remove color",icon:"color-swatch-remove-color",value:"remove"};return t?[e,{type:n,text:"Custom color",icon:"color-picker",value:"custom"}]:[e]},Ah=function(n,e,t,o){"custom"===t?Ph(n)(function(t){t.each(function(t){Th(t),n.execCommand("mceApplyTextcolor",e,t),o(t)})},"#000000"):"remove"===t?(o(""),n.execCommand("mceRemoveTextcolor",e)):(o(t),n.execCommand("mceApplyTextcolor",e,t))},Mh=function(t,n){return t.concat(R(Ch.state(),function(t){return{type:Sh,text:t,value:t}}).concat(Bh(n)))},Fh=function(n,e){return function(t){t(Mh(n,e))}},Ih=function(t,n,e){t.setIconFill("forecolor"===n?"tox-icon-text-color__color":"tox-icon-highlight-bg-color__color",e)},Rh=function(r,e,i,t,o){r.ui.registry.addSplitButton(e,{tooltip:t,presets:"color",icon:"forecolor"===e?"text-color":"highlight-bg-color",select:function(n){var e,o;return Z.from((e=i,r.dom.getParents(r.selection.getStart(),function(t){(t=t.style["forecolor"===e?"color":"background-color"])&&(o=o||t)}),o)).bind(function(t){return fh(t).map(function(t){t=th(t).value;return le(n.toLowerCase(),t)})}).getOr(!1)},columns:Dh(r),fetch:Fh(_h(r),Oh(r)),onAction:function(t){null!==o.get()&&Ah(r,i,o.get(),$)},onItemAction:function(t,n){Ah(r,i,n,function(t){o.set(t),t={name:e,color:t},r.fire("TextColorChange",t)})},onSetup:function(n){null!==o.get()&&Ih(n,e,o.get());var t=function(t){t.name===e&&Ih(n,t.name,t.color)};return r.on("TextColorChange",t),function(){r.off("TextColorChange",t)}}})},Vh=function(n,t,e,o){n.ui.registry.addNestedMenuItem(t,{text:o,icon:"forecolor"===t?"text-color":"highlight-bg-color",getSubmenuItems:function(){return[{type:"fancymenuitem",fancytype:"colorswatch",onAction:function(t){Ah(n,e,t.value,$)}}]}})},Ph=function(r){return function(e,t){var o=!1;r.windowManager.open({title:"Color Picker",size:"normal",body:{type:"panel",items:[{type:"colorpicker",name:"colorpicker",label:"Color"}]},buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:{colorpicker:t},onAction:function(t,n){"hex-valid"===n.name&&(o=n.value)},onSubmit:function(t){var n=t.getData().colorpicker;o?(e(Z.from(n)),t.close()):r.windowManager.alert(r.translate(["Invalid hex color code: {0}",n]))},onClose:$,onCancel:function(){e(Z.none())}})}},Hh=function(t,n,e,o,r,i,u,a){var c=hg(n),a=zh(n,e,o,"color"!==r?"normal":"color",i,u,a);return yg(t,c,a,o,r)},zh=function(e,o,r,i,u,a,c){return Hi(R(e,function(n){return"choiceitem"===n.type?Sn("choicemenuitem",Cg,n).fold(vg,function(t){return Z.some(function(n,t,e,o,r,i,u,a){void 0===a&&(a=!0);a=jp({presets:e,textContent:t?n.text:Z.none(),htmlContent:Z.none(),ariaLabel:n.text,iconContent:n.icon,shortcutContent:t?n.shortcut:Z.none(),checkMark:t?Z.some(Hp(u.icons)):Z.none(),caret:Z.none(),value:n.value},u,a);return zt(Bp({data:Ap(n),disabled:n.disabled,getApi:function(n){return{setActive:function(t){Fd.set(n,t)},isActive:function(){return Fd.isOn(n)},isDisabled:function(){return Kg.isDisabled(n)},setDisabled:function(t){return Kg.set(n,t)}}},onAction:function(t){return o(n.value)},onSetup:function(t){return t.setActive(r),$},triggersSubmenu:!1,itemBehaviours:[]},a,i,u),{toggling:{toggleClass:eg,toggleOnExecute:!1,selected:n.active}})}(t,1===r,i,o,a(n.value),u,c,hg(e)))}):Z.none()}))},Lh=function(t,n){var e=lg(n);return 1===t?{mode:"menu",moveOnTab:!0}:"auto"===t?{mode:"grid",selector:"."+e.item,initSize:{numColumns:1,numRows:1}}:{mode:"matrix",rowSelector:"."+("color"===n?"tox-swatches__row":"tox-collection__group")}},Nh=function(t,n){var e=!1!==t.initData.allowCustomColors&&n.colorinput.hasCustomColors();return c(t.initData.colors)?t.initData.colors.concat(Bh(e)):Mh(n.colorinput.getColors(),e)},jh=Qr("cell-over"),Wh=Qr("cell-execute"),Uh=function(t,n,e){for(var o=[],r=0;r<n;r++){for(var i=[],u=0;u<e;u++)i.push(function(n,e,t){var o,r=function(t){return Wo(t,Wh,{row:n,col:e})},i=function(t,n){n.stop(),r(t)};return gu({dom:{tag:"div",attributes:((o={role:"button"})["aria-labelledby"]=t,o)},behaviours:ec([Sd("insert-table-picker-cell",[$o(ro(),Cd.focus),$o(wo(),r),$o(fo(),i),$o(ko(),i)]),Fd.config({toggleClass:"tox-insert-table-picker__selected",toggleOnExecute:!1}),Cd.config({onFocus:function(t){return Wo(t,jh,{row:n,col:e})}})])})}(r,u,t));o.push(i)}return o},Gh={inserttable:function(o){var t=Qr("size-label"),r=Uh(t,10,10),i=hm({dom:{tag:"span",classes:["tox-insert-table-picker__label"],attributes:{id:t}},components:[fu("0x0")],behaviours:ec([wd.config({})])});return{type:"widget",data:{value:Qr("widget-id")},dom:{tag:"div",classes:["tox-fancymenuitem"]},autofocus:!0,components:[Xp.widget({dom:{tag:"div",classes:["tox-insert-table-picker"]},components:j(r,function(t){return R(t,pu)}).concat(i.asSpec()),behaviours:ec([Sd("insert-table-picker",[nr(jh,function(t,n,e){var o=e.event.row,e=e.event.col;!function(t,n,e,o,r){for(var i=0;i<o;i++)for(var u=0;u<r;u++)Fd.set(t[i][u],i<=n&&u<=e)}(r,o,e,10,10),wd.set(i.get(t),[fu(e+1+"x"+(o+1))])}),nr(Wh,function(t,n,e){o.onAction({numRows:e.event.row+1,numColumns:e.event.col+1}),jo(t,Oo())})]),hd.config({initSize:{numRows:10,numColumns:10},mode:"flatgrid",selector:'[role="button"]'})])})]}},colorswatch:function(n,t){var e=Nh(n,t),o=t.colorinput.getColorCols(),t=Hh(Qr("menu-value"),e,function(t){n.onAction({value:t})},o,"color",$m.CLOSE_ON_EXECUTE,d,t.shared.providers),o=Q(Q({},t),{markers:lg("color"),movement:Lh(o,"color")});return{type:"widget",data:{value:Qr("widget-id")},dom:{tag:"div",classes:["tox-fancymenuitem"]},autofocus:!0,components:[Xp.widget(Xd.sketch(o))]}}},Xh=function(n,e,t,o,r,i,u,a){void 0===a&&(a=!0);a=jp({presets:o,textContent:Z.none(),htmlContent:t?n.text.map(function(t){return Up(t,e)}):Z.none(),ariaLabel:n.text,iconContent:n.icon,shortcutContent:Z.none(),checkMark:Z.none(),caret:Z.none(),value:n.value},u.providers,a,n.icon);return Bp({data:Ap(n),disabled:n.disabled,getApi:U({}),onAction:function(t){return r(n.value,n.meta)},onSetup:U($),triggersSubmenu:!1,itemBehaviours:Wp(n.meta,u)},a,i,u.providers)},Yh=function(t){t=t.text.fold(function(){return{}},function(t){return{innerHtml:t}});return{type:"separator",dom:Q({tag:"div",classes:[Zm,"tox-collection__group-heading"]},t),components:[]}},qh=function(t,n,e,o){void 0===o&&(o=!0);o=jp({presets:"normal",iconContent:t.icon,textContent:t.text,htmlContent:Z.none(),ariaLabel:t.text,caret:Z.none(),checkMark:Z.none(),shortcutContent:t.shortcut},e,o);return Bp({data:Ap(t),getApi:function(n){return{isDisabled:function(){return Kg.isDisabled(n)},setDisabled:function(t){return Kg.set(n,t)}}},disabled:t.disabled,onAction:t.onAction,onSetup:t.onSetup,triggersSubmenu:!1,itemBehaviours:[]},o,n,e)},Kh=function(t,n,e,o,r){void 0===o&&(o=!0);var i,i=(r=void 0===r?!1:r)?(r=e.icons,{dom:{tag:"div",classes:[rg],innerHtml:bm("chevron-down",r)}}):(i=e.icons,{dom:{tag:"div",classes:[rg],innerHtml:bm("chevron-right",i)}}),o=jp({presets:"normal",iconContent:t.icon,textContent:t.text,htmlContent:Z.none(),ariaLabel:t.text,caret:Z.some(i),checkMark:Z.none(),shortcutContent:t.shortcut},e,o);return Bp({data:Ap(t),getApi:function(n){return{isDisabled:function(){return Kg.isDisabled(n)},setDisabled:function(t){return Kg.set(n,t)}}},disabled:t.disabled,onAction:$,onSetup:t.onSetup,triggersSubmenu:!0,itemBehaviours:[]},o,n,e)},Jh=function(t,n,e,o){void 0===o&&(o=!0);o=jp({iconContent:t.icon,textContent:t.text,htmlContent:Z.none(),ariaLabel:t.text,checkMark:Z.some(Hp(e.icons)),caret:Z.none(),shortcutContent:t.shortcut,presets:"normal",meta:t.meta},e,o);return zt(Bp({data:Ap(t),disabled:t.disabled,getApi:function(n){return{setActive:function(t){Fd.set(n,t)},isActive:function(){return Fd.isOn(n)},isDisabled:function(){return Kg.isDisabled(n)},setDisabled:function(t){return Kg.set(n,t)}}},onAction:t.onAction,onSetup:t.onSetup,triggersSubmenu:!1,itemBehaviours:[]},o,n,e),{toggling:{toggleClass:eg,toggleOnExecute:!1,selected:t.active}})},$h=function(n,e){return Rt(Gh,n.fancytype).map(function(t){return t(n,e)})},Qh=function(t,n,e,o){var r={dom:zp(!1,t.label),optComponents:[Z.some({dom:{tag:"div",classes:[ug,ag]},components:Gp(t.items,o)})]};return Bp({data:Ap(Q({text:Z.none()},t)),disabled:t.disabled,getApi:function(e){return{isDisabled:function(){return Kg.isDisabled(e)},setDisabled:function(n){Kg.set(e,n),tt(hs(e.element,"*"),function(t){e.getSystem().getByDom(t).each(function(t){t.hasConfigured(Kg)&&Kg.set(t,n)})})}}},onAction:t.onAction,onSetup:t.onSetup,triggersSubmenu:!1,itemBehaviours:Z.from(o.itemBehaviours).getOr([])},r,n,e.providers)};(ho=wh=wh||{})[ho.ContentFocus=0]="ContentFocus",ho[ho.UiFocus=1]="UiFocus";var Zh,tv,nv,ev,ov=function(t,n,e,o,r){var i=e.shared.providers,u=function(t){return r?Q(Q({},t),{shortcut:Z.none(),icon:t.text.isSome()?Z.none():t.icon}):t};switch(t.type){case"menuitem":return Sn("menuitem",_g,t).fold(vg,function(t){return Z.some(qh(u(t),n,i,o))});case"nestedmenuitem":return Sn("nestedmenuitem",Tg,t).fold(vg,function(t){return Z.some(Kh(u(t),n,i,o,r))});case"togglemenuitem":return Sn("togglemenuitem",Eg,t).fold(vg,function(t){return Z.some(Jh(u(t),n,i,o))});case"separator":return Sn("separatormenuitem",Lm,t).fold(vg,function(t){return Z.some(Yh(t))});case"fancymenuitem":return Sn("fancymenuitem",Og,t).fold(vg,function(t){return $h(u(t),e)});default:return console.error("Unknown item in general menu",t),Z.none()}},rv=function(t,e,o,n,r,i,u){var a=1===n,c=!a||hg(t);return Hi(R(t,function(t){switch(t.type){case"separator":return Sn("Autocompleter.Separator",Lm,t).fold(vg,function(t){return Z.some(Yh(t))});case"cardmenuitem":return Sn("cardmenuitem",kg,t).fold(vg,function(n){return Z.some(Qh(Q(Q({},n),{onAction:function(t){n.onAction(t),o(n.value,n.meta)}}),r,i,{itemBehaviours:Wp(n.meta,i),cardText:{matchText:e,highlightOn:u}}))});case"autocompleteitem":default:return Sn("Autocompleter.Item",Nm,t).fold(vg,function(t){return Z.some(Xh(t,e,a,"normal",o,r,i,c))})}}))},iv=function(t,n,e,o,r){var i=hg(n),n=Hi(R(n,function(t){var n=function(t){return ov(t,e,o,(t=t,r?!Vt(t,"text"):i),r)};return"nestedmenuitem"===t.type&&t.getSubmenuItems().length<=0?n(Q(Q({},t),{disabled:!0})):n(t)}));return(r?bg:yg)(t,i,n,1,"normal")},uv=function(t){return Qd.singleData(t.value,t)},av=function(a,c){var e=Zn(Z.none()),s=Zn(!1),l=gu(Zd.sketch({dom:{tag:"div",classes:["tox-autocompleter"]},components:[],fireDismissalEventInstead:{},inlineBehaviours:ec([Sd("dismissAutocompleter",[$o(Io(),function(){return d()})])]),lazySink:c.getSink})),o=function(){return e.get().isSome()},f=function(){o()&&Zd.hide(l)},d=function(){var t;o()&&(t=e.get().map(function(t){return t.element}),_m(t.getOr(ne.fromDom(a.selection.getNode()))).each(Hr),f(),e.set(Z.none()),s.set(!1))},r=Nt(function(){return Km(a)}),m=function(t,n,e,o){t.matchLength=n.text.length;var r,i,u=rt(e,function(t){return Z.from(t.columns)}).getOr(1);Zd.showAt(l,{anchor:"node",root:ne.fromDom(a.getBody()),node:Z.from(t.element)},Xd.sketch((r=yg("autocompleter-value",!0,o,u,"normal"),n=u,e=wh.ContentFocus,t="normal",o=(e===wh.ContentFocus?Pf:Vf)(),u=Lh(n,t),i=lg(t),{dom:r.dom,components:r.components,items:r.items,value:r.value,markers:{selectedItem:i.selectedItem,item:i.item},movement:u,fakeFocus:e===wh.ContentFocus,focusManager:o,menuBehaviours:Ag("auto"!==n?[]:[rr(function(e,t){Dg(e,4,i.item).each(function(t){var n=t.numColumns,t=t.numRows;hd.setGridSize(e,t,n)})})])}))),Zd.getContent(l).each(pf.highlightFirst)},g=function(t){var n;n=t,e.get().map(function(t){return Am(a.dom,a.selection.getRng(),t.triggerChar).bind(function(t){return zm(a,r,t,n)})}).getOrThunk(function(){return Hm(a,r)}).fold(d,function(u){var t,n;t=u.context,o()||(n=Om(a,t.range),e.set(Z.some({triggerChar:t.triggerChar,element:n,matchLength:t.text.length})),s.set(!1)),u.lookupData.then(function(i){e.get().map(function(t){var n,e,o,r=u.context;t.triggerChar===r.triggerChar&&(n=r.triggerChar,o=rt(e=i,function(t){return Z.from(t.columns)}).getOr(1),0<(e=j(e,function(r){var t=r.items;return rv(t,r.matchText,function(e,o){var t=a.selection.getRng();Am(a.dom,t,n).fold(function(){return console.error("Lost context. Cursor probably moved")},function(t){var n=t.range,t={hide:function(){d()},reload:function(t){f(),g(t)}};s.set(!0),r.onAction(t,n,e,o),s.set(!1)})},o,$m.BUBBLE_TO_SANDBOX,c,r.highlightOn)})).length?m(t,r,i,e):(10<=r.text.length-t.matchLength?d:f)())})})})},t={onKeypress:Sm(function(t){27!==t.which&&g()},50),cancelIfNecessary:d,isMenuOpen:function(){return Zd.isOpen(l)},isActive:o,isProcessingAction:s.get,getView:function(){return Zd.getContent(l)}};!1===a.hasPlugin("rtc")&&Mm(t,a)},cv=S,sv=function(t,n,e){return Du(t,n,cv,e,!1)},lv=function(t,n,e){return Du(t,n,cv,e,!0)},fv=Eu,dv=function(t,n,e){return Ku(t,n,e).isSome()},mv=function(e,o){var r=null;return{cancel:function(){null!==r&&(clearTimeout(r),r=null)},schedule:function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];r=setTimeout(function(){e.apply(null,t),r=null},o)}}},gv=function(t){t=t.raw;return t.touches===undefined||1!==t.touches.length?Z.none():Z.some(t.touches[0])},pv=function(e){var r=Zn(Z.none()),o=Zn(!1),i=mv(function(t){e.triggerEvent(Co(),t),o.set(!0)},400),u=Le([{key:Je(),value:function(n){return gv(n).each(function(t){i.cancel();t={x:t.clientX,y:t.clientY,target:n.target};i.schedule(n),o.set(!1),r.set(Z.some(t))}),Z.none()}},{key:$e(),value:function(t){return i.cancel(),gv(t).each(function(o){r.get().each(function(t){var n,e;n=o,e=t,t=Math.abs(n.clientX-e.x),e=Math.abs(n.clientY-e.y),(5<t||5<e)&&r.set(Z.none())})}),Z.none()}},{key:Qe(),value:function(n){i.cancel();return r.get().filter(function(t){return Ie(t.target,n.target)}).map(function(t){return o.get()?(n.prevent(),!1):e.triggerEvent(ko(),n)})}}]);return{fireIfReady:function(n,t){return Rt(u,t).bind(function(t){return t(n)})}}},hv=function(){return Ae().browser.isFirefox()},vv=on([In("triggerEvent"),Un("stopBackspace",!0)]),bv=function(n,t){var e,o=Cn("Getting GUI events settings",vv,t),r=pv(o),i=R(["touchstart","touchmove","touchend","touchcancel","gesturestart","mousedown","mouseup","mouseover","mousemove","mouseout","click"].concat(["selectstart","input","contextmenu","change","transitionend","drag","dragstart","dragend","dragenter","dragleave","dragover","drop","keyup"]),function(t){return sv(n,t,function(n){r.fireIfReady(n,t).each(function(t){t&&n.kill()}),o.triggerEvent(t,n)&&n.kill()})}),u=Zn(Z.none()),a=sv(n,"paste",function(n){r.fireIfReady(n,"paste").each(function(t){t&&n.kill()}),o.triggerEvent("paste",n)&&n.kill(),u.set(Z.some(setTimeout(function(){o.triggerEvent(yo(),n)},0)))}),c=sv(n,"keydown",function(t){var n;o.triggerEvent("keydown",t)?t.kill():!0!==o.stopBackspace||((n=t).raw.which!==hf[0]||A(["input","textarea"],cr(n.target))||dv(n.target,'[contenteditable="true"]'))||t.prevent()}),s=(e=n,t=function(t){o.triggerEvent("focusin",t)&&t.kill()},hv()?lv(e,"focus",t):sv(e,"focusin",t)),l=Zn(Z.none()),f=(e=n,t=function(t){o.triggerEvent("focusout",t)&&t.kill(),l.set(Z.some(setTimeout(function(){o.triggerEvent(bo(),t)},0)))},hv()?lv(e,"blur",t):sv(e,"focusout",t));return{unbind:function(){tt(i,function(t){t.unbind()}),c.unbind(),s.unbind(),f.unbind(),a.unbind(),u.get().each(clearTimeout),l.get().each(clearTimeout)}}},yv=function(t,n){n=Rt(t,"target").getOr(n);return Zn(n)},xv=Pe([{stopped:[]},{resume:["element"]},{complete:[]}]),wv=function(t,o,n,e,r,i){var u,a,t=t(o,e),c=(u=Zn(!1),a=Zn(!1),{stop:function(){u.set(!0)},cut:function(){a.set(!0)},isStopped:u.get,isCut:a.get,event:n,setSource:r.set,getSource:r.get});return t.fold(function(){return i.logEventNoHandlers(o,e),xv.complete()},function(n){var e=n.descHandler;return yi(e)(c),c.isStopped()?(i.logEventStopped(o,n.element,e.purpose),xv.stopped()):c.isCut()?(i.logEventCut(o,n.element,e.purpose),xv.complete()):br(n.element).fold(function(){return i.logNoParent(o,n.element,e.purpose),xv.complete()},function(t){return i.logEventResponse(o,n.element,e.purpose),xv.resume(t)})})},Sv=function(n,e,o,t,r,i){return wv(n,e,o,t,r,i).fold(S,function(t){return Sv(n,e,o,t,r,i)},d)},kv=function(t,n,e){var o,r=(o=Zn(!1),{stop:function(){o.set(!0)},cut:$,isStopped:o.get,isCut:d,event:n,setSource:f("Cannot set source of a broadcasted event"),getSource:f("Cannot get source of a broadcasted event")});return tt(t,function(t){t=t.descHandler;yi(t)(r)}),r.isStopped()},Cv=function(t,n,e,o,r){var i=yv(e,o);return Sv(t,n,e,o,i,r)},Ov=function(){var i={};return{registerId:function(o,r,t){Et(t,function(t,n){var e=i[n]!==undefined?i[n]:{};e[r]=(t=t,{cHandler:x.apply(undefined,[t.handler].concat(o)),purpose:t.purpose}),i[n]=e})},unregisterId:function(e){Et(i,function(t,n){Vt(t,e)&&delete t[e]})},filterByType:function(t){return Rt(i,t).map(function(t){return Mt(t,function(t,n){return{id:n,descHandler:t}})}).getOr([])},find:function(t,n,e){var r=Rt(i,n);return Ue(e,function(t){return e=r,ri(o=t).fold(function(){return Z.none()},function(n){return e.bind(function(t){return Rt(t,n)}).map(function(t){return{element:o,descHandler:t}})});var e,o},t)}}},_v=function(){var o=Ov(),r={},e=function(t){var n=t.element;return ri(n).getOrThunk(function(){return function(t,n){t=Qr(ni+t);return oi(n,t),t}("uid-",t.element)})},i=function(t){ri(t.element).each(function(t){delete r[t],o.unregisterId(t)})};return{find:function(t,n,e){return o.find(t,n,e)},filter:function(t){return o.filterByType(t)},register:function(t){var n=e(t);Pt(r,n)&&function(t,n){var e=r[n];if(e!==t)throw new Error('The tagId "'+n+'" is already used by: '+qr(e.element)+"\nCannot use it for: "+qr(t.element)+"\nThe conflicting element is"+(ji(e.element)?" ":" not ")+"already in the DOM");i(t)}(t,n),o.registerId([t],n,t.events),r[n]=t},unregister:i,getById:function(t){return Rt(r,t)}}},Tv=of({name:"Container",factory:function(t){var n=t.dom,e=n.attributes,n=g(n,["attributes"]);return{uid:t.uid,dom:Q({tag:"div",attributes:Q({role:"presentation"},e)},n),components:t.components,behaviours:bl(t.containerBehaviours),events:t.events,domModification:t.domModification,eventOrder:t.eventOrder}},configFields:[Un("components",[]),sr("containerBehaviours",[]),Un("events",{}),Un("domModification",{}),Un("eventOrder",{})]}),Ev=function(e){var o=function(n){return br(e.element).fold(S,function(t){return Ie(n,t)})},r=_v(),c=function(t,n){return r.find(o,t,n)},t=bv(e.element,{triggerEvent:function(n,e){return oa(n,e.target,function(t){return Cv(c,n,e,e.target,t)})}}),i={debugInfo:U("real"),triggerEvent:function(n,e,o){oa(n,e,function(t){return Cv(c,n,o,e,t)})},triggerFocus:function(u,a){ri(u).fold(function(){sc(u)},function(t){oa(vo(),u,function(t){var n,e,o,r,i;return n=c,e=vo(),i=t,t=yv(o={originator:a,kill:$,prevent:$,target:u},r=u),wv(n,e,o,r,t,i),!1})})},triggerEscape:function(t,n){i.triggerEvent("keydown",t.element,n.event)},getByUid:function(t){return g(t)},getByDom:function(t){return p(t)},build:gu,addToGui:function(t){a(t)},removeFromGui:function(t){s(t)},addToWorld:function(t){n(t)},removeFromWorld:function(t){u(t)},broadcast:function(t){f(t)},broadcastOn:function(t,n){d(t,n)},broadcastEvent:function(t,n){m(t,n)},isConnected:S},n=function(t){t.connect(i),fr(t.element)||(r.register(t),tt(t.components(),n),i.triggerEvent(To(),t.element,{target:t.element}))},u=function(t){fr(t.element)||(tt(t.components(),u),r.unregister(t)),t.disconnect()},a=function(t){Gs(e,t)},s=function(t){qs(t)},l=function(n){var t=r.filter(xo());tt(t,function(t){t=t.descHandler;yi(t)(n)})},f=function(t){l({universal:!0,data:t})},d=function(t,n){l({universal:!1,channels:t,data:n})},m=function(t,n){t=r.filter(t);return kv(t,n)},g=function(t){return r.getById(t).fold(function(){return at.error(new Error('Could not find component with uid: "'+t+'" in system.'))},at.value)},p=function(t){t=ri(t).getOr("not found");return g(t)};return n(e),{root:e,element:e.element,destroy:function(){t.unbind(),Pr(e.element)},add:a,remove:s,getByUid:g,getByDom:p,addToWorld:n,removeFromWorld:u,broadcast:f,broadcastOn:d,broadcastEvent:m}},Ro=U([Un("prefix","form-field"),sr("fieldBehaviours",[uf,vl])]),C=U([Il({schema:[Bn("dom")],name:"label"}),Il({factory:{sketch:function(t){return{uid:t.uid,dom:{tag:"span",styles:{display:"none"},attributes:{"aria-hidden":"true"},innerHtml:t.text}}}},schema:[Bn("text")],name:"aria-descriptor"}),Fl({factory:{sketch:function(t){var n=He(t,["factory"]);return t.factory.sketch(n)}},schema:[Bn("factory")],name:"field"})]),Dv=pl({name:"FormField",configFields:Ro(),partFields:C(),factory:function(r,t,n,e){var o=yl(r.fieldBehaviours,[uf.config({find:function(t){return Ul(t,r,"field")}}),vl.config({store:{mode:"manual",getValue:function(t){return uf.getCurrent(t).bind(vl.getValue)},setValue:function(t,n){uf.getCurrent(t).each(function(t){vl.setValue(t,n)})}}})]),i=qo([rr(function(t,n){var o=Xl(t,r,["label","field","aria-descriptor"]);o.field().each(function(e){var n=Qr(r.prefix);o.label().each(function(t){jr(t.element,"for",n),jr(e.element,"id",n)}),o["aria-descriptor"]().each(function(t){var n=Qr(r.prefix);jr(t.element,"id",n),jr(e.element,"aria-describedby",n)})})})]);return{uid:r.uid,dom:r.dom,components:t,behaviours:o,events:i,apis:{getField:function(t){return Ul(t,r,"field")},getLabel:function(t){return Ul(t,r,"label")}}}},apis:{getField:function(t,n){return t.getField(n)},getLabel:function(t,n){return t.getLabel(n)}}}),hu=Object.freeze({__proto__:null,exhibit:function(t,n){return vi({attributes:Le([{key:n.tabAttr,value:"true"}])})}}),Ht=[Un("tabAttr","data-alloy-tabstop")],Bv=rc({fields:Ht,name:"tabstopping",active:hu}),Av=tinymce.util.Tools.resolve("tinymce.html.Entities"),Mv=function(t,n,e,o){o=Fv(t,n,e,o);return Dv.sketch(o)},Fv=function(t,n,e,o){return{dom:Iv(e),components:t.toArray().concat([n]),fieldBehaviours:ec(o)}},Iv=function(t){return{tag:"div",classes:["tox-form__group"].concat(t)}},Rv=function(t,n){return Dv.parts.label({dom:{tag:"label",classes:["tox-label"],innerHtml:n.translate(t)}})},Vv=Qr("form-component-change"),Pv=Qr("form-close"),Hv=Qr("form-cancel"),zv=Qr("form-action"),Lv=Qr("form-submit"),Nv=Qr("form-block"),jv=Qr("form-unblock"),Wv=Qr("form-tabchange"),Uv=Qr("form-resize"),Gv=function(i,u){var t=i.label.map(function(t){return Rv(t,u)}),n=function(o){return function(n,e){Ku(e.event.target,"[data-collection-item-value]").each(function(t){o(n,e,t,Wr(t,"data-collection-item-value"))})}},e=n(function(t,n,e,o){n.stop(),u.isDisabled()||Wo(t,zv,{name:i.name,value:o})}),o=[$o(ro(),n(function(t,n,e){sc(e)})),$o(fo(),e),$o(ko(),e),$o(io(),n(function(t,n,e){qu(t.element,"."+ig).each(function(t){Fi(t,ig)}),Ai(e,ig)})),$o(uo(),n(function(t){qu(t.element,"."+ig).each(function(t){Fi(t,ig)})})),ar(n(function(t,n,e,o){Wo(t,zv,{name:i.name,value:o})}))],r=function(t,n){return R(hs(t.element,".tox-collection__item"),n)},o=Dv.parts.field({dom:{tag:"div",classes:["tox-collection"].concat(1!==i.columns?["tox-collection--grid"]:["tox-collection--list"])},components:[],factory:{sketch:h},behaviours:ec([Kg.config({disabled:u.isDisabled,onDisabled:function(t){r(t,function(t){Ai(t,"tox-collection__item--state-disabled"),jr(t,"aria-disabled",!0)})},onEnabled:function(t){r(t,function(t){Fi(t,"tox-collection__item--state-disabled"),Xr(t,"aria-disabled")})}}),xp(),wd.config({}),vl.config({store:{mode:"memory",initialValue:[]},onSetValue:function(e,t){!function(t,n){n=R(n,function(t){var n=Hg.translate(t.text),e=1===i.columns?'<div class="tox-collection__item-label">'+n+"</div>":"",o='<div class="tox-collection__item-icon">'+t.icon+"</div>",r={_:" "," - ":" ","-":" "},n=n.replace(/\_| \- |\-/g,function(t){return r[t]});return'<div class="tox-collection__item'+(u.isDisabled()?" tox-collection__item--state-disabled":"")+'" tabindex="-1" data-collection-item-value="'+Av.encodeAllRaw(t.value)+'" title="'+n+'" aria-label="'+n+'">'+o+e+"</div>"}),n="auto"!==i.columns&&1<i.columns?I(n,i.columns):[n],n=R(n,function(t){return'<div class="tox-collection__group">'+t.join("")+"</div>"});Lr(t.element,n.join(""))}(e,t),"auto"===i.columns&&Dg(e,5,"tox-collection__item").each(function(t){var n=t.numRows,t=t.numColumns;hd.setGridSize(e,n,t)}),jo(e,Uv)}}),Bv.config({}),hd.config((e=i.columns,n="normal",1===e?{mode:"menu",moveOnTab:!1,selector:".tox-collection__item"}:"auto"===e?{mode:"flatgrid",selector:".tox-collection__item",initSize:{numColumns:1,numRows:1}}:{mode:"matrix",selectors:{row:"color"===n?".tox-swatches__row":".tox-collection__group",cell:"color"===n?"."+tg:"."+Zm}})),Sd("collection-events",o)]),eventOrder:((o={})[wo()]=["disabling","alloy.base.behaviour","collection-events"],o)});return Mv(t,o,["tox-form__group--collection"],[])},e=U([Hn("data"),Un("inputAttributes",{}),Un("inputStyles",{}),Un("tag","input"),Un("inputClasses",[]),da("onSetValue"),Un("styles",{}),Un("eventOrder",{}),sr("inputBehaviours",[vl,Cd]),Un("selectOnFocus",!0)]),Xv=function(t){return ec([Cd.config({onFocus:t.selectOnFocus?function(t){var n=t.element,t=eu(n);n.dom.setSelectionRange(0,t.length)}:$})])},Yv=function(t){return{tag:t.tag,attributes:Q({type:"text"},t.inputAttributes),styles:t.inputStyles,classes:t.inputClasses}},qv=of({name:"Input",configFields:e(),factory:function(t,n){return{uid:t.uid,dom:Yv(t),components:[],behaviours:Q(Q({},Xv(e=t)),yl(e.inputBehaviours,[vl.config({store:Q(Q({mode:"manual"},e.data.map(function(t){return{initialValue:t}}).getOr({})),{getValue:function(t){return eu(t.element)},setValue:function(t,n){eu(t.element)!==n&&ou(t.element,n)}}),onSetValue:e.onSetValue})])),eventOrder:t.eventOrder};var e}}),Ke={},Ja={exports:Ke};Zh=undefined,tv=Ke,nv=Ja,ev=undefined,function(t){"object"==typeof tv&&void 0!==nv?nv.exports=t():"function"==typeof Zh&&Zh.amd?Zh([],t):("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).EphoxContactWrapper=t()}(function(){return function c(o,r,i){function u(n,t){if(!r[n]){if(!o[n]){var e="function"==typeof ev&&ev;if(!t&&e)return e(n,!0);if(a)return a(n,!0);throw(e=new Error("Cannot find module '"+n+"'")).code="MODULE_NOT_FOUND",e}e=r[n]={exports:{}},o[n][0].call(e.exports,function(t){return u(o[n][1][t]||t)},e,e.exports,c,o,r,i)}return r[n].exports}for(var a="function"==typeof ev&&ev,t=0;t<i.length;t++)u(i[t]);return u}({1:[function(t,n,e){var o,r,n=n.exports={};function i(){throw new Error("setTimeout has not been defined")}function u(){throw new Error("clearTimeout has not been defined")}function a(t){if(o===setTimeout)return setTimeout(t,0);if((o===i||!o)&&setTimeout)return o=setTimeout,setTimeout(t,0);try{return o(t,0)}catch(n){try{return o.call(null,t,0)}catch(n){return o.call(this,t,0)}}}!function(){try{o="function"==typeof setTimeout?setTimeout:i}catch(t){o=i}try{r="function"==typeof clearTimeout?clearTimeout:u}catch(t){r=u}}();var c,s=[],l=!1,f=-1;function d(){l&&c&&(l=!1,c.length?s=c.concat(s):f=-1,s.length&&m())}function m(){if(!l){var t=a(d);l=!0;for(var n=s.length;n;){for(c=s,s=[];++f<n;)c&&c[f].run();f=-1,n=s.length}c=null,l=!1,function(t){if(r===clearTimeout)return clearTimeout(t);if((r===u||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(t);try{r(t)}catch(n){try{return r.call(null,t)}catch(n){return r.call(this,t)}}}(t)}}function g(t,n){this.fun=t,this.array=n}function p(){}n.nextTick=function(t){var n=new Array(arguments.length-1);if(1<arguments.length)for(var e=1;e<arguments.length;e++)n[e-1]=arguments[e];s.push(new g(t,n)),1!==s.length||l||a(m)},g.prototype.run=function(){this.fun.apply(null,this.array)},n.title="browser",n.browser=!0,n.env={},n.argv=[],n.version="",n.versions={},n.on=p,n.addListener=p,n.once=p,n.off=p,n.removeListener=p,n.removeAllListeners=p,n.emit=p,n.prependListener=p,n.prependOnceListener=p,n.listeners=function(t){return[]},n.binding=function(t){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(t){throw new Error("process.chdir is not supported")},n.umask=function(){return 0}},{}],2:[function(t,f,n){!function(n){function o(){}function u(t){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof t)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=undefined,this._deferreds=[],l(t,this)}function r(o,r){for(;3===o._state;)o=o._value;0!==o._state?(o._handled=!0,u._immediateFn(function(){var t,n=1===o._state?r.onFulfilled:r.onRejected;if(null!==n){try{t=n(o._value)}catch(e){return void a(r.promise,e)}i(r.promise,t)}else(1===o._state?i:a)(r.promise,o._value)})):o._deferreds.push(r)}function i(t,n){try{if(n===t)throw new TypeError("A promise cannot be resolved with itself.");if(n&&("object"==typeof n||"function"==typeof n)){var e=n.then;if(n instanceof u)return t._state=3,t._value=n,void c(t);if("function"==typeof e)return void l((o=e,r=n,function(){o.apply(r,arguments)}),t)}t._state=1,t._value=n,c(t)}catch(i){a(t,i)}var o,r}function a(t,n){t._state=2,t._value=n,c(t)}function c(t){2===t._state&&0===t._deferreds.length&&u._immediateFn(function(){t._handled||u._unhandledRejectionFn(t._value)});for(var n=0,e=t._deferreds.length;n<e;n++)r(t,t._deferreds[n]);t._deferreds=null}function s(t,n,e){this.onFulfilled="function"==typeof t?t:null,this.onRejected="function"==typeof n?n:null,this.promise=e}function l(t,n){var e=!1;try{t(function(t){e||(e=!0,i(n,t))},function(t){e||(e=!0,a(n,t))})}catch(o){if(e)return;e=!0,a(n,o)}}var t,e;t=this,e=setTimeout,u.prototype["catch"]=function(t){return this.then(null,t)},u.prototype.then=function(t,n){var e=new this.constructor(o);return r(this,new s(t,n,e)),e},u.all=function(t){var c=Array.prototype.slice.call(t);return new u(function(r,i){if(0===c.length)return r([]);var u=c.length;function a(n,t){try{if(t&&("object"==typeof t||"function"==typeof t)){var e=t.then;if("function"==typeof e)return void e.call(t,function(t){a(n,t)},i)}c[n]=t,0==--u&&r(c)}catch(o){i(o)}}for(var t=0;t<c.length;t++)a(t,c[t])})},u.resolve=function(n){return n&&"object"==typeof n&&n.constructor===u?n:new u(function(t){t(n)})},u.reject=function(e){return new u(function(t,n){n(e)})},u.race=function(r){return new u(function(t,n){for(var e=0,o=r.length;e<o;e++)r[e].then(t,n)})},u._immediateFn="function"==typeof n?function(t){n(t)}:function(t){e(t,0)},u._unhandledRejectionFn=function(t){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",t)},u._setImmediateFn=function(t){u._immediateFn=t},u._setUnhandledRejectionFn=function(t){u._unhandledRejectionFn=t},void 0!==f&&f.exports?f.exports=u:t.Promise||(t.Promise=u)}.call(this,t("timers").setImmediate)},{timers:3}],3:[function(c,t,s){!function(t,n){var o=c("process/browser.js").nextTick,e=Function.prototype.apply,r=Array.prototype.slice,i={},u=0;function a(t,n){this._id=t,this._clearFn=n}s.setTimeout=function(){return new a(e.call(setTimeout,window,arguments),clearTimeout)},s.setInterval=function(){return new a(e.call(setInterval,window,arguments),clearInterval)},s.clearTimeout=s.clearInterval=function(t){t.close()},a.prototype.unref=a.prototype.ref=function(){},a.prototype.close=function(){this._clearFn.call(window,this._id)},s.enroll=function(t,n){clearTimeout(t._idleTimeoutId),t._idleTimeout=n},s.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},s._unrefActive=s.active=function(t){clearTimeout(t._idleTimeoutId);var n=t._idleTimeout;0<=n&&(t._idleTimeoutId=setTimeout(function(){t._onTimeout&&t._onTimeout()},n))},s.setImmediate="function"==typeof t?t:function(t){var n=u++,e=!(arguments.length<2)&&r.call(arguments,1);return i[n]=!0,o(function(){i[n]&&(e?t.apply(null,e):t.call(null),s.clearImmediate(n))}),n},s.clearImmediate="function"==typeof n?n:function(t){delete i[t]}}.call(this,c("timers").setImmediate,c("timers").clearImmediate)},{"process/browser.js":1,timers:3}],4:[function(t,n,e){var o=t("promise-polyfill"),t="undefined"!=typeof window?window:Function("return this;")();n.exports={boltExport:t.Promise||o}},{"promise-polyfill":2}]},{},[4])(4)});var Kv,Jv=Ja.exports.boltExport,$v=function(t){var e=Z.none(),n=[],o=function(t){r()?u(t):n.push(t)},r=function(){return e.isSome()},i=function(t){tt(t,u)},u=function(n){e.each(function(t){setTimeout(function(){n(t)},0)})};return t(function(t){r()||(e=Z.some(t),i(n),n=[])}),{get:o,map:function(e){return $v(function(n){o(function(t){n(e(t))})})},isReady:r}},Qv={nu:$v,pure:function(n){return $v(function(t){t(n)})}},Zv=function(t){setTimeout(function(){throw t},0)},tb=function(e){var t=function(t){e().then(t,Zv)};return{map:function(t){return tb(function(){return e().then(t)})},bind:function(n){return tb(function(){return e().then(function(t){return n(t).toPromise()})})},anonBind:function(t){return tb(function(){return e().then(function(){return t.toPromise()})})},toLazy:function(){return Qv.nu(t)},toCached:function(){var t=null;return tb(function(){return t=null===t?e():t})},toPromise:e,get:t}},nb=function(t){return tb(function(){return new Jv(t)})},eb=function(t){return tb(function(){return Jv.resolve(t)})},ob=["input","textarea"],rb=function(t){t=cr(t);return A(ob,t)},ib=function(t,n){var e=n.getRoot(t).getOr(t.element);Fi(e,n.invalidClass),n.notify.each(function(n){rb(t.element)&&jr(t.element,"aria-invalid",!1),n.getContainer(t).each(function(t){Lr(t,n.validHtml)}),n.onValid(t)})},ub=function(n,t,e,o){var r=t.getRoot(n).getOr(n.element);Ai(r,t.invalidClass),t.notify.each(function(t){rb(n.element)&&jr(n.element,"aria-invalid",!0),t.getContainer(n).each(function(t){Lr(t,o)}),t.onInvalid(n,o)})},ab=function(n,t,e){return t.validator.fold(function(){return eb(at.value(!0))},function(t){return t.validate(n)})},cb=function(n,e,t){return e.notify.each(function(t){t.onValidate(n)}),ab(n,e).map(function(t){return n.getSystem().isConnected()?t.fold(function(t){return ub(n,e,0,t),at.error(t)},function(t){return ib(n,e),at.value(t)}):at.error("No longer in system")})},t=Object.freeze({__proto__:null,markValid:ib,markInvalid:ub,query:ab,run:cb,isInvalid:function(t,n){t=n.getRoot(t).getOr(t.element);return Ii(t,n.invalidClass)}}),sb=Object.freeze({__proto__:null,events:function(n,t){return n.validator.map(function(t){return qo([$o(t.onEvent,function(t){cb(t,n).get(h)})].concat(t.validateOnLoad?[rr(function(t){cb(t,n).get($)})]:[]))}).getOr({})}}),Kr=[Bn("invalidClass"),Un("getRoot",Z.none),Wn("notify",[Un("aria","alert"),Un("getContainer",Z.none),Un("validHtml",""),da("onValid"),da("onInvalid"),da("onValidate")]),Wn("validator",[Bn("validate"),Un("onEvent","input"),Un("validateOnLoad",!0)])],lb=rc({fields:Kr,name:"invalidating",active:sb,apis:t,extra:{validation:function(n){return function(t){t=vl.getValue(t);return eb(n(t))}}}}),ho=Object.freeze({__proto__:null,getCoupled:function(t,n,e,o){return e.getOrCreate(t,n,o)}}),Ro=[An("others",wn(at.value,ln()))],fb=rc({fields:Ro,name:"coupling",apis:ho,state:Object.freeze({__proto__:null,init:function(){var r={},t=U({});return pi({readState:t,getOrCreate:function(n,e,o){var t=_t(e.others);if(t)return Rt(r,o).getOrThunk(function(){var t=Rt(e.others,o).getOrDie("No information found for coupled component: "+o)(n),t=n.getSystem().build(t);return r[o]=t});throw new Error("Cannot find coupled component: "+o+". Known coupled components: "+JSON.stringify(t,null,2))}})}})}),db=U("sink"),C=U(Il({name:db(),overrides:U({dom:{tag:"div"},behaviours:ec([Ls.config({useFixed:S})]),events:qo([er(ao()),er(to()),er(fo())])})}));(Ht=Kv=Kv||{})[Ht.HighlightFirst=0]="HighlightFirst",Ht[Ht.HighlightNone=1]="HighlightNone";var mb,gb,pb,hb,vb,bb,yb=function(t,n){var e=t.getHotspot(n).getOr(n),o=t.getAnchorOverrides();return t.layouts.fold(function(){return{anchor:"hotspot",hotspot:e,overrides:o}},function(t){return{anchor:"hotspot",hotspot:e,overrides:o,layouts:t}})},xb=function(t,n,e,o,r,i,u){var a,c,s,l,f,d,m=yb(t,e);return(a=m,c=e,s=o,l=r,f=u,n=n=n,n=(0,(t=t).fetch)(c).map(n),d=Cb(c,t),n.map(function(t){return t.bind(function(t){return Z.from(Qd.sketch(Q(Q({},l.menu()),{uid:ii(""),data:t,highlightImmediately:f===Kv.HighlightFirst,onOpenMenu:function(t,n){var e=d().getOrDie();Ls.position(e,a,n),il.decloak(s)},onOpenSubmenu:function(t,n,e){var o=d().getOrDie();Ls.position(o,{anchor:"submenu",item:n},e),il.decloak(s)},onRepositionMenu:function(t,n,e){var o=d().getOrDie();Ls.position(o,a,n),tt(e,function(t){Ls.position(o,{anchor:"submenu",item:t.triggeringItem},t.triggeredMenu)})},onEscape:function(){return Cd.focus(c),il.close(s),Z.some(!0)}})))})})).map(function(t){return t.fold(function(){il.isOpen(o)&&il.close(o)},function(t){il.cloak(o),il.open(o,t),i(o)}),o})},wb=function(t,n,e,o,r,i,u){return il.close(o),eb(o)},Sb=function(t,n,e,o,r,i){var u=fb.getCoupled(e,"sandbox");return(il.isOpen(u)?wb:xb)(t,n,e,u,o,r,i)},kb=function(t,n,e){n=uf.getCurrent(n).getOr(n),t=_u(t.element);e?Yi(n.element,"min-width",t+"px"):(n=n.element,Ou.set(n,t))},Cb=function(n,t){return n.getSystem().getByUid(t.uid+"-"+db()).map(function(t){return function(){return at.value(t)}}).getOrThunk(function(){return t.lazySink.fold(function(){return function(){return at.error(new Error("No internal sink is specified, nor could an external sink be found"))}},function(t){return function(){return t(n)}})})},Ob=function(t){il.getState(t).each(function(t){Qd.repositionMenus(t)})},_b=function(o,r,i){var u=Ju(),t=Cb(r,o);return{dom:{tag:"div",classes:o.sandboxClasses,attributes:{id:u.id,role:"listbox"}},behaviours:wl(o.sandboxBehaviours,[vl.config({store:{mode:"memory",initialValue:r}}),il.config({onOpen:function(t,n){var e=yb(o,r);u.link(r.element),o.matchWidth&&kb(e.hotspot,n,o.useMinWidth),o.onOpen(e,t,n),i!==undefined&&i.onOpen!==undefined&&i.onOpen(t,n)},onClose:function(t,n){u.unlink(r.element),i!==undefined&&i.onClose!==undefined&&i.onClose(t,n)},isPartOf:function(t,n,e){return Qu(n,e)||Qu(r,e)},getAttachPoint:function(){return t().getOrDie()}}),uf.config({find:function(t){return il.getState(t).bind(function(t){return uf.getCurrent(t)})}}),cc.config({channels:Q(Q({},ll({isExtraPart:d})),dl({doReposition:Ob}))})])}},Tb=function(t){t=fb.getCoupled(t,"sandbox");Ob(t)},hu=function(){return[Un("sandboxClasses",[]),xl("sandboxBehaviours",[uf,cc,il,vl])]},Ke=U([Bn("dom"),Bn("fetch"),da("onOpen"),ma("onExecute"),Un("getHotspot",Z.some),Un("getAnchorOverrides",U({})),pe(),sr("dropdownBehaviours",[Fd,fb,hd,Cd]),Bn("toggleClass"),Un("eventOrder",{}),Hn("lazySink"),Un("matchWidth",!1),Un("useMinWidth",!1),Hn("role")].concat(hu())),Ja=U([ge({schema:[sa()],name:"menu",defaults:function(t){return{onExecute:t.onExecute}}}),C()]),Eb=pl({name:"Dropdown",configFields:Ke(),partFields:Ja(),factory:function(n,t,e,o){var r,i=function(t){il.getState(t).each(function(t){Qd.highlightPrimary(t)})},u={expand:function(t){Fd.isOn(t)||Sb(n,h,t,o,$,Kv.HighlightNone).get($)},open:function(t){Fd.isOn(t)||Sb(n,h,t,o,$,Kv.HighlightFirst).get($)},isOpen:Fd.isOn,close:function(t){Fd.isOn(t)&&Sb(n,h,t,o,$,Kv.HighlightFirst).get($)},repositionMenus:function(t){Fd.isOn(t)&&Tb(t)}},a=function(t,n){return Uo(t),Z.some(!0)};return{uid:n.uid,dom:n.dom,components:t,behaviours:yl(n.dropdownBehaviours,[Fd.config({toggleClass:n.toggleClass,aria:{mode:"expanded"}}),fb.config({others:{sandbox:function(t){return _b(n,t,{onOpen:function(){return Fd.on(t)},onClose:function(){return Fd.off(t)}})}}}),hd.config({mode:"special",onSpace:a,onEnter:a,onDown:function(t,n){var e;return Eb.isOpen(t)?(e=fb.getCoupled(t,"sandbox"),i(e)):Eb.open(t),Z.some(!0)},onEscape:function(t,n){return Eb.isOpen(t)?(Eb.close(t),Z.some(!0)):Z.none()}}),Cd.config({})]),events:Rd(Z.some(function(t){Sb(n,h,t,o,i,Kv.HighlightFirst).get($)})),eventOrder:Q(Q({},n.eventOrder),((a={})[wo()]=["disabling","toggling","alloy.base.behaviour"],a)),apis:u,domModification:{attributes:Q(Q({"aria-haspopup":"true"},n.role.fold(function(){return{}},function(t){return{role:t}})),"button"===n.dom.tag?{type:(r="type",Rt(n.dom,"attributes").bind(function(t){return Rt(t,r)}).getOr("button"))}:{})}}},apis:{open:function(t,n){return t.open(n)},expand:function(t,n){return t.expand(n)},close:function(t,n){return t.close(n)},isOpen:function(t,n){return t.isOpen(n)},repositionMenus:function(t,n){return t.repositionMenus(n)}}}),Db=rc({fields:[],name:"unselecting",active:Object.freeze({__proto__:null,events:function(){return qo([Ko(go(),S)])},exhibit:function(){return vi({styles:{"-webkit-user-select":"none","user-select":"none","-ms-user-select":"none","-moz-user-select":"-moz-none"},attributes:{unselectable:"on"}})}})}),Bb=Qr("color-input-change"),Ab=Qr("color-swatch-change"),Mb=Qr("color-picker-cancel"),Fb=function(e,n,o){var r,i,t=Dv.parts.field({factory:qv,inputClasses:["tox-textfield"],onSetValue:function(t){return lb.run(t).get($)},inputBehaviours:ec([Kg.config({disabled:n.providers.isDisabled}),xp(),Bv.config({}),lb.config({invalidClass:"tox-textbox-field-invalid",getRoot:function(t){return br(t.element)},notify:{onValid:function(t){var n=vl.getValue(t);Wo(t,Bb,{color:n})}},validator:{validateOnLoad:!1,validate:function(t){var n=vl.getValue(t);if(0===n.length)return eb(at.value(!0));t=ne.fromTag("span");Yi(t,"background-color",n);t=Qi(t,"background-color").fold(function(){return at.error("blah")},function(t){return at.value(n)});return eb(t)}}})]),selectOnFocus:!1}),u=e.label.map(function(t){return Rv(t,n.providers)}),a=function(t,n){Wo(t,Ab,{value:n})},c=hm((r={dom:{tag:"span",attributes:{"aria-label":n.providers.translate("Color swatch")}},layouts:{onRtl:function(){return[Pa,Va,Na]},onLtr:function(){return[Va,Pa,Na]}},components:[],fetch:Fh(o.getColors(),o.hasCustomColors()),columns:o.getColorCols(),presets:"color",onItemAction:function(t,e){c.getOpt(t).each(function(n){"custom"===e?o.colorPicker(function(t){t.fold(function(){return jo(n,Mb)},function(t){a(n,t),Th(t)})},"#ffffff"):a(n,"remove"===e?"":e)})}},i=n,Eb.sketch({dom:r.dom,components:r.components,toggleClass:"mce-active",dropdownBehaviours:ec([Sp(i.providers.isDisabled),xp(),Db.config({}),Bv.config({})]),layouts:r.layouts,sandboxClasses:["tox-dialog__popups"],lazySink:i.getSink,fetch:function(n){return nb(function(t){return r.fetch(t)}).map(function(t){return Z.from(uv(zt(Hh(Qr("menu-value"),t,function(t){r.onItemAction(n,t)},r.columns,r.presets,$m.CLOSE_ON_EXECUTE,d,i.providers),{movement:Lh(r.columns,r.presets)})))})},parts:{menu:dg(0,0,r.presets)}})));return Dv.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:u.toArray().concat([{dom:{tag:"div",classes:["tox-color-input"]},components:[t,c.asSpec()]}]),fieldBehaviours:ec([Sd("form-field-events",[$o(Bb,function(t,n){c.getOpt(t).each(function(t){Yi(t.element,"background-color",n.event.color)}),Wo(t,Vv,{name:e.name})}),$o(Ab,function(n,e){Dv.getField(n).each(function(t){vl.setValue(t,e.event.value),uf.getCurrent(n).each(Cd.focus)})}),$o(Mb,function(n,t){Dv.getField(n).each(function(t){uf.getCurrent(n).each(Cd.focus)})})])])})},Kr=Il({schema:[Bn("dom")],name:"label"}),sb=function(n){return Il({name:n+"-edge",overrides:function(t){return t.model.manager.edgeActions[n].fold(function(){return{}},function(o){return{events:qo([Qo(Je(),function(t,n,e){return o(t,e)},[t]),Qo(to(),function(t,n,e){return o(t,e)},[t]),Qo(no(),function(t,n,e){e.mouseIsDown.get()&&o(t,e)},[t])])}})}})},t=sb("top-left"),wn=sb("top"),Ro=sb("top-right"),ho=sb("right"),Ht=sb("bottom-right"),Ke=sb("bottom"),Ja=sb("bottom-left"),Kr=[Kr,sb("left"),ho,wn,Ke,t,Ro,Ja,Ht,Fl({name:"thumb",defaults:U({dom:{styles:{position:"absolute"}}}),overrides:function(t){return{events:qo([tr(Je(),t,"spectrum"),tr($e(),t,"spectrum"),tr(Qe(),t,"spectrum"),tr(to(),t,"spectrum"),tr(no(),t,"spectrum"),tr(oo(),t,"spectrum")])}}}),Fl({schema:[En("mouseIsDown",function(){return Zn(!1)})],name:"spectrum",overrides:function(e){var o=e.model.manager,r=function(n,t){return o.getValueFromEvent(t).map(function(t){return o.setValueFrom(n,e,t)})};return{behaviours:ec([hd.config({mode:"special",onLeft:function(t){return o.onLeft(t,e)},onRight:function(t){return o.onRight(t,e)},onUp:function(t){return o.onUp(t,e)},onDown:function(t){return o.onDown(t,e)}}),Cd.config({})]),events:qo([$o(Je(),r),$o($e(),r),$o(to(),r),$o(no(),function(t,n){e.mouseIsDown.get()&&r(t,n)})])}}})],Ib=U("slider.change.value"),Rb=function(t){t=t.event.raw;return-1===t.type.indexOf("touch")?t.clientX!==undefined?Z.some(t).map(function(t){return wu(t.clientX,t.clientY)}):Z.none():t.touches!==undefined&&1===t.touches.length?Z.some(t.touches[0]).map(function(t){return wu(t.clientX,t.clientY)}):Z.none()},Vb=function(t){return t.model.minX},Pb=function(t){return t.model.minY},Hb=function(t){return t.model.minX-1},zb=function(t){return t.model.minY-1},Lb=function(t){return t.model.maxX},Nb=function(t){return t.model.maxY},jb=function(t){return t.model.maxX+1},Wb=function(t){return t.model.maxY+1},Ub=function(t,n,e){return n(t)-e(t)},Gb=function(t){return Ub(t,Lb,Vb)},Xb=function(t){return Ub(t,Nb,Pb)},Yb=function(t){return Gb(t)/2},qb=function(t){return Xb(t)/2},Kb=function(t){return t.stepSize},Jb=function(t){return t.snapToGrid},$b=function(t){return t.snapStart},Qb=function(t){return t.rounded},Zb=function(t,n){return t[n+"-edge"]!==undefined},ty=function(t){return Zb(t,"left")},ny=function(t){return Zb(t,"right")},ey=function(t){return Zb(t,"top")},oy=function(t){return Zb(t,"bottom")},ry=function(t){return t.model.value.get()},iy=function(t,n){return{x:t,y:n}},uy=function(t,n){Wo(t,Ib(),{value:n})},ay=function(t,n,e,o){return t<n?t:e<t?e:t===n?n-1:Math.max(n,t-o)},cy=function(t,n,e,o){return e<t?t:t<n?n:t===e?e+1:Math.min(e,t+o)},sy=function(t,n,e){return Math.max(n,Math.min(e,t))},ly=function(t){var n=t.min,e=t.max,o=t.range,r=t.value,i=t.step,u=t.snap,a=t.snapStart,c=t.rounded,s=t.hasMinEdge,l=t.hasMaxEdge,f=t.minBound,d=t.maxBound,t=t.screenRange,s=s?n-1:n,l=l?e+1:e;if(r<f)return s;if(d<r)return l;var m,g,p,h,f=(f=f,Math.min(d,Math.max(r,f))-f),l=sy(f/t*o+n,s,l);return u&&n<=l&&l<=e?(m=l,g=n,p=e,h=i,a.fold(function(){var t=Math.round((m-g)/h)*h;return sy(g+t,g-1,p+1)},function(t){var n=Math.round((m-t)%h/h),e=Math.floor((m-t)/h),o=Math.floor((p-t)/h),n=Math.min(o,e+n);return Math.max(t,t+n*h)})):c?Math.round(l):l},fy=function(t){var n=t.min,e=t.max,o=t.range,r=t.value,i=t.hasMinEdge,u=t.hasMaxEdge,a=t.maxBound,c=t.maxOffset,s=t.centerMinEdge,t=t.centerMaxEdge;return r<n?i?0:s:e<r?u?a:t:(r-n)/o*c},dy="left",my=function(t){return t.element.dom.getBoundingClientRect()},gy=function(t){return my(t)[dy]},py=function(t){return my(t).right},hy=function(t){return my(t).top},vy=function(t){return my(t).bottom},by=function(t){return my(t).width},yy=function(t){return my(t).height},xy=function(t,n){t=my(t),n=my(n);return(t[dy]+t.right)/2-n[dy]},wy=function(t,n){t=my(t),n=my(n);return(t.top+t.bottom)/2-n.top},Sy=function(t,n){Wo(t,Ib(),{value:n})},ky=function(t,n,e){t={min:Vb(n),max:Lb(n),range:Gb(n),value:e,step:Kb(n),snap:Jb(n),snapStart:$b(n),rounded:Qb(n),hasMinEdge:ty(n),hasMaxEdge:ny(n),minBound:gy(t),maxBound:py(t),screenRange:by(t)};return ly(t)},sb=function(e){return function(t,n){return function(t,n,e){e=(0<t?cy:ay)(ry(e).x,Vb(e),Lb(e),Kb(e));return Sy(n,{x:e}),Z.some(e)}(e,t,n).map(S)}},Cy=function(t,n,e,o,r,i){var u,a,o=(a=i,i=e,e=o,o=r,r=by(u=n),e=e.bind(function(t){return Z.some(xy(t,u))}).getOr(0),o=o.bind(function(t){return Z.some(xy(t,u))}).getOr(r),o={min:Vb(a),max:Lb(a),range:Gb(a),value:i,hasMinEdge:ty(a),hasMaxEdge:ny(a),minBound:gy(u),minOffset:0,maxBound:py(u),maxOffset:r,centerMinEdge:e,centerMaxEdge:o},fy(o));return gy(n)-gy(t)+o},ho=sb(-1),wn=sb(1),Ke=Z.none,t=Z.none,Ro={"top-left":Z.none(),top:Z.none(),"top-right":Z.none(),right:Z.some(function(t,n){uy(t,{x:jb(n)})}),"bottom-right":Z.none(),bottom:Z.none(),"bottom-left":Z.none(),left:Z.some(function(t,n){uy(t,{x:Hb(n)})})},Ja=Object.freeze({__proto__:null,setValueFrom:function(t,n,e){e=ky(t,n,e);return Sy(t,{x:e}),e},setToMin:function(t,n){n=Vb(n);Sy(t,{x:n})},setToMax:function(t,n){n=Lb(n);Sy(t,{x:n})},findValueOfOffset:ky,getValueFromEvent:function(t){return Rb(t).map(function(t){return t.left})},findPositionOfValue:Cy,setPositionFromValue:function(t,n,e,o){var r=ry(e),t=Cy(t,o.getSpectrum(t),r.x,o.getLeftEdge(t),o.getRightEdge(t),e),e=_u(n.element)/2;Yi(n.element,"left",t-e+"px")},onLeft:ho,onRight:wn,onUp:Ke,onDown:t,edgeActions:Ro}),Oy=function(t,n){Wo(t,Ib(),{value:n})},_y=function(t,n,e){t={min:Pb(n),max:Nb(n),range:Xb(n),value:e,step:Kb(n),snap:Jb(n),snapStart:$b(n),rounded:Qb(n),hasMinEdge:ey(n),hasMaxEdge:oy(n),minBound:hy(t),maxBound:vy(t),screenRange:yy(t)};return ly(t)},Ht=function(e){return function(t,n){return function(t,n,e){e=(0<t?cy:ay)(ry(e).y,Pb(e),Nb(e),Kb(e));return Oy(n,{y:e}),Z.some(e)}(e,t,n).map(S)}},Ty=function(t,n,e,o,r,i){var u,a,o=(a=i,i=e,e=o,o=r,r=yy(u=n),e=e.bind(function(t){return Z.some(wy(t,u))}).getOr(0),o=o.bind(function(t){return Z.some(wy(t,u))}).getOr(r),o={min:Pb(a),max:Nb(a),range:Xb(a),value:i,hasMinEdge:ey(a),hasMaxEdge:oy(a),minBound:hy(u),minOffset:0,maxBound:vy(u),maxOffset:r,centerMinEdge:e,centerMaxEdge:o},fy(o));return hy(n)-hy(t)+o},sb=Z.none,ho=Z.none,wn=Ht(-1),Ke=Ht(1),t={"top-left":Z.none(),top:Z.some(function(t,n){uy(t,{y:zb(n)})}),"top-right":Z.none(),right:Z.none(),"bottom-right":Z.none(),bottom:Z.some(function(t,n){uy(t,{y:Wb(n)})}),"bottom-left":Z.none(),left:Z.none()},Ro=Object.freeze({__proto__:null,setValueFrom:function(t,n,e){e=_y(t,n,e);return Oy(t,{y:e}),e},setToMin:function(t,n){n=Pb(n);Oy(t,{y:n})},setToMax:function(t,n){n=Nb(n);Oy(t,{y:n})},findValueOfOffset:_y,getValueFromEvent:function(t){return Rb(t).map(function(t){return t.top})},findPositionOfValue:Ty,setPositionFromValue:function(t,n,e,o){var r=ry(e),t=Ty(t,o.getSpectrum(t),r.y,o.getTopEdge(t),o.getBottomEdge(t),e),e=bu(n.element)/2;Yi(n.element,"top",t-e+"px")},onLeft:sb,onRight:ho,onUp:wn,onDown:Ke,edgeActions:t}),Ey=function(t,n){Wo(t,Ib(),{value:n})},Dy=function(t,n){return{x:t,y:n}},Ht=function(i,u){return function(t,n){return o=t,r=n,t=0<(e=i)?cy:ay,e=(n=u)?ry(r).x:t(ry(r).x,Vb(r),Lb(r),Kb(r)),r=n?t(ry(r).y,Pb(r),Nb(r),Kb(r)):ry(r).y,Ey(o,Dy(e,r)),Z.some(e).map(S);var e,o,r}},sb=Rb,ho=Ht(-1,!1),wn=Ht(1,!1),Ke=Ht(-1,!0),t=Ht(1,!0),Ht={"top-left":Z.some(function(t,n){uy(t,iy(Hb(n),zb(n)))}),top:Z.some(function(t,n){uy(t,iy(Yb(n),zb(n)))}),"top-right":Z.some(function(t,n){uy(t,iy(jb(n),zb(n)))}),right:Z.some(function(t,n){uy(t,iy(jb(n),qb(n)))}),"bottom-right":Z.some(function(t,n){uy(t,iy(jb(n),Wb(n)))}),bottom:Z.some(function(t,n){uy(t,iy(Yb(n),Wb(n)))}),"bottom-left":Z.some(function(t,n){uy(t,iy(Hb(n),Wb(n)))}),left:Z.some(function(t,n){uy(t,iy(Hb(n),qb(n)))})},t=Object.freeze({__proto__:null,setValueFrom:function(t,n,e){var o=ky(t,n,e.left),e=_y(t,n,e.top),e=Dy(o,e);return Ey(t,e),e},setToMin:function(t,n){var e=Vb(n),n=Pb(n);Ey(t,Dy(e,n))},setToMax:function(t,n){var e=Lb(n),n=Nb(n);Ey(t,Dy(e,n))},getValueFromEvent:sb,setPositionFromValue:function(t,n,e,o){var r=ry(e),i=Cy(t,o.getSpectrum(t),r.x,o.getLeftEdge(t),o.getRightEdge(t),e),o=Ty(t,o.getSpectrum(t),r.y,o.getTopEdge(t),o.getBottomEdge(t),e),t=_u(n.element)/2,e=bu(n.element)/2;Yi(n.element,"left",i-t+"px"),Yi(n.element,"top",o-e+"px")},onLeft:ho,onRight:wn,onUp:Ke,onDown:t,edgeActions:Ht}),By=pl({name:"Slider",configFields:[Un("stepSize",1),Un("onChange",$),Un("onChoose",$),Un("onInit",$),Un("onDragStart",$),Un("onDragEnd",$),Un("snapToGrid",!1),Un("rounded",!0),Hn("snapStart"),An("model",_n("mode",{x:[Un("minX",0),Un("maxX",100),En("value",function(t){return Zn(t.mode.minX)}),Bn("getInitialValue"),ha("manager",Ja)],y:[Un("minY",0),Un("maxY",100),En("value",function(t){return Zn(t.mode.minY)}),Bn("getInitialValue"),ha("manager",Ro)],xy:[Un("minX",0),Un("maxX",100),Un("minY",0),Un("maxY",100),En("value",function(t){return Zn({x:t.mode.minX,y:t.mode.minY})}),Bn("getInitialValue"),ha("manager",t)]})),sr("sliderBehaviours",[hd,vl]),En("mouseIsDown",function(){return Zn(!1)})],partFields:Kr,factory:function(r,t,n,e){var i=function(t){return Gl(t,r,"thumb")},u=function(t){return Gl(t,r,"spectrum")},o=function(t){return Ul(t,r,"left-edge")},a=function(t){return Ul(t,r,"right-edge")},c=function(t){return Ul(t,r,"top-edge")},s=function(t){return Ul(t,r,"bottom-edge")},l=r.model,f=l.manager,d=function(t,n){f.setPositionFromValue(t,n,r,{getLeftEdge:o,getRightEdge:a,getTopEdge:c,getBottomEdge:s,getSpectrum:u})},m=function(t,n){l.value.set(n);n=i(t);d(t,n)},g=function(e){var t=r.mouseIsDown.get();r.mouseIsDown.set(!1),t&&Ul(e,r,"thumb").each(function(t){var n=l.value.get();r.onChoose(e,t,n)})},p=function(t,n){n.stop(),r.mouseIsDown.set(!0),r.onDragStart(t,i(t))},h=function(t,n){n.stop(),r.onDragEnd(t,i(t)),g(t)};return{uid:r.uid,dom:r.dom,components:t,behaviours:yl(r.sliderBehaviours,[hd.config({mode:"special",focusIn:function(t){return Ul(t,r,"spectrum").map(hd.focusIn).map(S)}}),vl.config({store:{mode:"manual",getValue:function(t){return l.value.get()}}}),cc.config({channels:((t={})[cl()]={onReceive:g},t)})]),events:qo([$o(Ib(),function(t,n){!function(t,n){m(t,n);var e=i(t);r.onChange(t,e,n),Z.some(!0)}(t,n.event.value)}),rr(function(t,n){var e=l.getInitialValue();l.value.set(e);var o=i(t);d(t,o);e=u(t);r.onInit(t,o,e,l.value.get())}),$o(Je(),p),$o(Qe(),h),$o(to(),p),$o(oo(),h)]),apis:{resetToMin:function(t){f.setToMin(t,r)},resetToMax:function(t){f.setToMax(t,r)},setValue:m,refresh:d},domModification:{styles:{position:"relative"}}}},apis:{setValue:function(t,n,e){t.setValue(n,e)},resetToMin:function(t,n){t.resetToMin(n)},resetToMax:function(t,n){t.resetToMax(n)},refresh:function(t,n){t.refresh(n)}}}),Ay=Qr("rgb-hex-update"),My=Qr("slider-update"),Fy=Qr("palette-update"),Iy=[sr("formBehaviours",[vl])],Ry=function(t){return"<alloy.field."+t+">"},Vy=function(o,t){return{uid:o.uid,dom:o.dom,components:t,behaviours:yl(o.formBehaviours,[vl.config({store:{mode:"manual",getValue:function(t){t=Yl(t,o);return Dt(t,function(t,o){return t().bind(function(t){var n,e=uf.getCurrent(t);return e=e,n=new Error("Cannot find a current component to extract the value from for form part '"+o+"': "+qr(t.element)),e.fold(function(){return at.error(n)},at.value)}).map(vl.getValue)})},setValue:function(e,t){Et(t,function(n,t){Ul(e,o,t).each(function(t){uf.getCurrent(t).each(function(t){vl.setValue(t,n)})})})}}})]),apis:{getField:function(t,n){return Ul(t,o,n).bind(uf.getCurrent)}}}},Py={getField:mi(function(t,n,e){return t.getField(n,e)}),sketch:function(t){var e,n={field:function(t,n){return e.push(t),zl("form",Ry(t),n)},record:U(e=[])},t=t(n),n=n.record(),n=R(n,function(t){return Fl({name:t,pname:Ry(t)})});return Zl("form",Iy,n,Vy,t)}},Hy=Qr("valid-input"),zy=Qr("invalid-input"),Ly=Qr("validating-input"),Ny="colorcustom.rgb.",jy=function(d,m,g,p){var h=function(t,n,e,o,r){var i,u,a=d(Ny+"range"),t=[Dv.parts.label({dom:{tag:"label",innerHtml:e,attributes:{"aria-label":o}}}),Dv.parts.field({data:r,factory:qv,inputAttributes:Q({type:"text"},"hex"===n?{"aria-live":"polite"}:{}),inputClasses:[m("textfield")],inputBehaviours:ec([(i=n,u=t,lb.config({invalidClass:m("invalid"),notify:{onValidate:function(t){Wo(t,Ly,{type:i})},onValid:function(t){Wo(t,Hy,{type:i,value:vl.getValue(t)})},onInvalid:function(t){Wo(t,zy,{type:i,value:vl.getValue(t)})}},validator:{validate:function(t){t=vl.getValue(t),t=u(t)?at.value(!0):at.error(d("aria.input.invalid"));return eb(t)},validateOnLoad:!1}})),Bv.config({})]),onSetValue:function(t){lb.isInvalid(t)&&lb.run(t).get($)}})],a="hex"!==n?[Dv.parts["aria-descriptor"]({text:a})]:[];return{dom:{tag:"div",attributes:{role:"presentation"}},components:t.concat(a)}},v=function(t,n){var e=n.red,o=n.green,n=n.blue;vl.setValue(t,{red:e,green:o,blue:n})},b=hm({dom:{tag:"div",classes:[m("rgba-preview")],styles:{"background-color":"white"},attributes:{role:"presentation"}}}),y=function(t,n){b.getOpt(t).each(function(t){Yi(t.element,"background-color","#"+n.value)})};return of({factory:function(){var e={red:Zn(Z.some(255)),green:Zn(Z.some(255)),blue:Zn(Z.some(255)),hex:Zn(Z.some("ffffff"))},r=function(t){return e[t].get()},i=function(t,n){e[t].set(n)},o=function(t){var n=t.red,e=t.green,t=t.blue;i("red",Z.some(n)),i("green",Z.some(e)),i("blue",Z.some(t))},n=function(t,n){n=n.event;"hex"!==n.type?i(n.type,Z.none()):p(t)},u=function(o,t,n){n=parseInt(n,10);i(t,Z.some(n)),r("red").bind(function(e){return r("green").bind(function(n){return r("blue").map(function(t){return uh(e,n,t,1)})})}).each(function(t){var n,e,t=(n=o,e=th(t),Py.getField(n,"hex").each(function(t){Cd.isFocused(t)||vl.setValue(n,{hex:e.value})}),e);Wo(o,Ay,{hex:t}),y(o,t)})},a=function(t,n){n=n.event;"hex"===n.type?function(t,n){g(t);var e=Yp(n);i("hex",Z.some(n));n=sh(e);v(t,n),o(n),Wo(t,Ay,{hex:e}),y(t,e)}(t,n.value):u(t,n.type,n.value)},t=function(t){return{label:d(Ny+t+".label"),description:d(Ny+t+".description")}},c=t("red"),s=t("green"),l=t("blue"),f=t("hex");return zt(Py.sketch(function(t){return{dom:{tag:"form",classes:[m("rgb-form")],attributes:{"aria-label":d("aria.color.picker")}},components:[t.field("red",Dv.sketch(h(ah,"red",c.label,c.description,255))),t.field("green",Dv.sketch(h(ah,"green",s.label,s.description,255))),t.field("blue",Dv.sketch(h(ah,"blue",l.label,l.description,255))),t.field("hex",Dv.sketch(h(Jp,"hex",f.label,f.description,"ffffff"))),b.asSpec()],formBehaviours:ec([lb.config({invalidClass:m("form-invalid")}),Sd("rgb-form-events",[$o(Hy,a),$o(zy,n),$o(Ly,n)])])}}),{apis:{updateHex:function(t,n){vl.setValue(t,{hex:n.value}),function(t,n){n=sh(n);v(t,n),o(n)}(t,n),y(t,n)}}})},name:"RgbForm",configFields:[],apis:{updateHex:function(t,n,e){t.updateHex(n,e)}},extraApis:{}})},Wy=function(t,o){var r=By.parts.spectrum({dom:{tag:"canvas",attributes:{role:"presentation"},classes:[o("sv-palette-spectrum")]}}),i=By.parts.thumb({dom:{tag:"div",attributes:{role:"presentation"},classes:[o("sv-palette-thumb")],innerHtml:"<div class="+o("sv-palette-inner-thumb")+' role="presentation"></div>'}}),u=function(t,n){var e=t.width,o=t.height,t=t.getContext("2d");null!==t&&(t.fillStyle=n,t.fillRect(0,0,e,o),(n=t.createLinearGradient(0,0,e,0)).addColorStop(0,"rgba(255,255,255,1)"),n.addColorStop(1,"rgba(255,255,255,0)"),t.fillStyle=n,t.fillRect(0,0,e,o),(n=t.createLinearGradient(0,0,0,o)).addColorStop(0,"rgba(0,0,0,0)"),n.addColorStop(1,"rgba(0,0,0,1)"),t.fillStyle=n,t.fillRect(0,0,e,o))};return of({factory:function(t){var n=U({x:0,y:0}),e=ec([uf.config({find:Z.some}),Cd.config({})]);return By.sketch({dom:{tag:"div",attributes:{role:"presentation"},classes:[o("sv-palette")]},model:{mode:"xy",getInitialValue:n},rounded:!1,components:[r,i],onChange:function(t,n,e){Wo(t,Fy,{value:e})},onInit:function(t,n,e,o){u(e.element.dom,dh(mh))},sliderBehaviours:e})},name:"SaturationBrightnessPalette",configFields:[],apis:{setHue:function(t,n,e){!function(t,n){t=t.components()[0].element.dom,n=ph(n,100,100),n=ch(n);u(t,dh(n))}(n,e)},setThumb:function(t,n,e){!function(t,n){n=hh(sh(n));By.setValue(t,{x:n.saturation,y:100-n.value})}(n,e)}},extraApis:{}})},Uy=function(b,y){return of({name:"ColourPicker",configFields:[Bn("dom"),Un("onValidHex",$),Un("onInvalidHex",$)],factory:function(t){var n,e,o,r,i,u,a=jy(b,y,t.onValidHex,t.onInvalidHex),c=Wy(0,y),s={paletteRgba:Zn(mh),paletteHue:Zn(0)},l=hm((n=y,e=By.parts.spectrum({dom:{tag:"div",classes:[n("hue-slider-spectrum")],attributes:{role:"presentation"}}}),o=By.parts.thumb({dom:{tag:"div",classes:[n("hue-slider-thumb")],attributes:{role:"presentation"}}}),By.sketch({dom:{tag:"div",classes:[n("hue-slider")],attributes:{role:"presentation"}},rounded:!1,model:{mode:"y",getInitialValue:U({y:0})},components:[e,o],sliderBehaviours:ec([Cd.config({})]),onChange:function(t,n,e){Wo(t,My,{value:e})}}))),f=hm(c.sketch({})),d=hm(a.sketch({})),m=function(t,n,e){f.getOpt(t).each(function(t){c.setHue(t,e)})},g=function(t,n){d.getOpt(t).each(function(t){a.updateHex(t,n)})},p=function(t,n,e){l.getOpt(t).each(function(t){By.setValue(t,{y:100-e/360*100})})},h=function(t,n){f.getOpt(t).each(function(t){c.setThumb(t,n)})},v=function(n,e,o,t){!function(t,n){t=sh(t);s.paletteRgba.set(t),s.paletteHue.set(n)}(e,o),tt(t,function(t){t(n,e,o)})};return{uid:t.uid,dom:t.dom,components:[f.asSpec(),l.asSpec(),d.asSpec()],behaviours:ec([Sd("colour-picker-events",[$o(Ay,(u=[m,p,h],function(t,n){var e=n.event.hex,n=hh(sh(e));v(t,e,n.hue,u)})),$o(Fy,(i=[g],function(t,n){var e=n.event.value,n=s.paletteHue.get(),e=ph(n,e.x,100-e.y),e=vh(e);v(t,e,n,i)})),$o(My,(r=[m,g],function(t,n){var e=(100-n.event.value.y)/100*360,n=s.paletteRgba.get(),n=hh(n),n=ph(e,n.saturation,n.value),n=vh(n);v(t,n,e,r)}))]),uf.config({find:function(t){return d.getOpt(t)}}),hd.config({mode:"acyclic"})])}}})},Gy=function(){return uf.config({find:Z.some})},Xy=function(t){return uf.config({find:t.getOpt})},Yy=function(t){return uf.config({find:function(n){return Sr(n.element,t).bind(function(t){return n.getSystem().getByDom(t).toOptional()})}})},qy={"colorcustom.rgb.red.label":"R","colorcustom.rgb.red.description":"Red component","colorcustom.rgb.green.label":"G","colorcustom.rgb.green.description":"Green component","colorcustom.rgb.blue.label":"B","colorcustom.rgb.blue.description":"Blue component","colorcustom.rgb.hex.label":"#","colorcustom.rgb.hex.description":"Hex color code","colorcustom.rgb.range":"Range 0 to 255","colorcustom.sb.saturation":"Saturation","colorcustom.sb.brightness":"Brightness","colorcustom.sb.picker":"Saturation and Brightness Picker","colorcustom.sb.palette":"Saturation and Brightness Palette","colorcustom.sb.instructions":"Use arrow keys to select saturation and brightness, on x and y axes","colorcustom.hue.hue":"Hue","colorcustom.hue.slider":"Hue Slider","colorcustom.hue.palette":"Hue Palette","colorcustom.hue.instructions":"Use arrow keys to select a hue","aria.color.picker":"Color Picker","aria.input.invalid":"Invalid input"},Ky=function(t){return qy[t]},Jy=tinymce.util.Tools.resolve("tinymce.Resource"),$y=tinymce.util.Tools.resolve("tinymce.util.Tools"),Qy=rn([Un("preprocess",h),Un("postprocess",h)]),Zy=function(t,n,e){return vl.config(zt({store:{mode:"manual",getValue:n,setValue:e}},t.map(function(t){return{store:{initialValue:t}}}).getOr({})))},tx=function(t,n,e){return Zy(t,function(t){return n(t.element)},function(t,n){return e(t.element,n)})},nx=function(e,t){var o=Cn("RepresentingConfigs.memento processors",Qy,t);return vl.config({store:{mode:"manual",getValue:function(t){t=e.get(t),t=vl.getValue(t);return o.postprocess(t)},setValue:function(t,n){n=o.preprocess(n),t=e.get(t);vl.setValue(t,n)}}})},ex=Zy,ox=function(t){return tx(t,zr,Lr)},rx=function(t){return vl.config({store:{mode:"memory",initialValue:t}})},ix=function(o,r){var n=function(t,n){n.stop()},e=function(t){return function(n,e){tt(t,function(t){t(n,e)})}},i=function(t,n){Kg.isDisabled(t)||(n=n.event.raw,a(t,n.dataTransfer.files))},u=function(t,n){n=n.event.raw.target;a(t,n.files)},a=function(t,n){var e;vl.setValue(t,(n=n,e=$y.explode(r.getSetting("images_file_types","jpeg,jpg,jpe,jfi,jif,jfif,png,gif,bmp,webp","string")),P(ot(n),function(n){return M(e,function(t){return de(n.name.toLowerCase(),"."+t.toLowerCase())})}))),Wo(t,Vv,{name:o.name})},c=hm({dom:{tag:"input",attributes:{type:"file",accept:"image/*"},styles:{display:"none"}},behaviours:ec([Sd("input-file-events",[er(fo()),er(ko())])])}),t=o.label.map(function(t){return Rv(t,r)}),s=Dv.parts.field({factory:{sketch:function(t){return{uid:t.uid,dom:{tag:"div",classes:["tox-dropzone-container"]},behaviours:ec([rx([]),Gy(),Kg.config({}),Fd.config({toggleClass:"dragenter",toggleOnExecute:!1}),Sd("dropzone-events",[$o("dragenter",e([n,Fd.toggle])),$o("dragleave",e([n,Fd.toggle])),$o("dragover",n),$o("drop",e([n,i])),$o(lo(),u)])]),components:[{dom:{tag:"div",classes:["tox-dropzone"],styles:{}},components:[{dom:{tag:"p",innerHtml:r.translate("Drop an image here")}},pm.sketch({dom:{tag:"button",innerHtml:r.translate("Browse for an image"),styles:{position:"relative"},classes:["tox-button","tox-button--secondary"]},components:[c.asSpec()],action:function(t){c.get(t).element.dom.click()},buttonBehaviours:ec([Bv.config({}),Sp(r.isDisabled),xp()])})]}]}}}});return Mv(t,s,["tox-form__group--stretched"],[])},ux=Qr("alloy-fake-before-tabstop"),ax=Qr("alloy-fake-after-tabstop"),cx=function(t){return{dom:{tag:"div",styles:{width:"1px",height:"1px",outline:"none"},attributes:{tabindex:"0"},classes:t},behaviours:ec([Cd.config({ignore:!0}),Bv.config({})])}},sx=function(t){return{dom:{tag:"div",classes:["tox-navobj"]},components:[cx([ux]),t,cx([ax])],behaviours:ec([Yy(1)])}},lx=function(t,n){Wo(t,ao(),{raw:{which:9,shiftKey:n}})},fx=function(t,n){n=n.element;Ii(n,ux)?lx(t,!0):Ii(n,ax)&&lx(t,!1)},dx=function(t){return dv(t,["."+ux,"."+ax].join(","),d)},mx=!(Ae().browser.isIE()||Ae().browser.isEdge()),gx=function(t,n){var e,o,r=mx&&t.sandboxed,i=Q(Q({},t.label.map(function(t){return{title:t}}).getOr({})),r?{sandbox:"allow-scripts allow-same-origin"}:{}),u=(e=r,o=Zn(""),{getValue:function(t){return o.get()},setValue:function(t,n){e?jr(t.element,"srcdoc",n):(jr(t.element,"src","javascript:''"),(t=t.element.dom.contentWindow.document).open(),t.write(n),t.close()),o.set(n)}}),r=t.label.map(function(t){return Rv(t,n)}),t=Dv.parts.field({factory:{sketch:function(t){return sx({uid:t.uid,dom:{tag:"iframe",attributes:i},behaviours:ec([Bv.config({}),Cd.config({}),ex(Z.none(),u.getValue,u.setValue)])})}}});return Mv(r,t,["tox-form__group--stretched"],[])},px=function(t,n){return bx(document.createElement("canvas"),t,n)},hx=function(t){var n=px(t.width,t.height);return vx(n).drawImage(t,0,0),n},vx=function(t){return t.getContext("2d")},bx=function(t,n,e){return t.width=n,t.height=e,t},yx=function(t){return t.naturalWidth||t.width},xx=function(t){return t.naturalHeight||t.height},wx=window.Promise||(mb=function(t){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof t)throw new TypeError("not a function");this._state=null,this._value=null,this._deferreds=[],bb(t,hb(kx,this),hb(Cx,this))},gb=window,pb=mb.immediateFn||"function"==typeof gb.setImmediate&&gb.setImmediate||function(t){return setTimeout(t,1)},hb=function(e,o){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return e.apply(o,t)}},vb=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},bb=function(t,n,e){var o=!1;try{t(function(t){o||(o=!0,n(t))},function(t){o||(o=!0,e(t))})}catch(r){if(o)return;o=!0,e(r)}},mb.prototype["catch"]=function(t){return this.then(null,t)},mb.prototype.then=function(e,o){var r=this;return new mb(function(t,n){Sx.call(r,new _x(e,o,t,n))})},mb.all=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var c=Array.prototype.slice.call(1===t.length&&vb(t[0])?t[0]:t);return new mb(function(r,i){if(0===c.length)return r([]);for(var u=c.length,a=function(n,t){try{if(t&&("object"==typeof t||"function"==typeof t)){var e=t.then;if("function"==typeof e)return void e.call(t,function(t){a(n,t)},i)}c[n]=t,0==--u&&r(c)}catch(o){i(o)}},t=0;t<c.length;t++)a(t,c[t])})},mb.resolve=function(n){return n&&"object"==typeof n&&n.constructor===mb?n:new mb(function(t){t(n)})},mb.reject=function(e){return new mb(function(t,n){n(e)})},mb.race=function(r){return new mb(function(t,n){for(var e=0,o=r;e<o.length;e++)o[e].then(t,n)})},mb);function Sx(o){var r=this;null!==this._state?pb(function(){var t,n=r._state?o.onFulfilled:o.onRejected;if(null!==n){try{t=n(r._value)}catch(e){return void o.reject(e)}o.resolve(t)}else(r._state?o.resolve:o.reject)(r._value)}):this._deferreds.push(o)}function kx(t){try{if(t===this)throw new TypeError("A promise cannot be resolved with itself.");if(t&&("object"==typeof t||"function"==typeof t)){var n=t.then;if("function"==typeof n)return void bb(hb(n,t),hb(kx,this),hb(Cx,this))}this._state=!0,this._value=t,Ox.call(this)}catch(e){Cx.call(this,e)}}function Cx(t){this._state=!1,this._value=t,Ox.call(this)}function Ox(){for(var t=0,n=this._deferreds;t<n.length;t++){var e=n[t];Sx.call(this,e)}this._deferreds=[]}function _x(t,n,e,o){this.onFulfilled="function"==typeof t?t:null,this.onRejected="function"==typeof n?n:null,this.resolve=e,this.reject=o}var Tx,Ex,Dx,Bx=function(e){return new wx(function(t,n){!function(t){var n=t.split(","),t=/data:([^;]+)/.exec(n[0]);if(!t)return Z.none();for(var t=t[1],n=n[1],e=atob(n),o=e.length,r=Math.ceil(o/1024),i=new Array(r),u=0;u<r;++u){for(var a=1024*u,c=Math.min(1024+a,o),s=new Array(c-a),l=a,f=0;l<c;++f,++l)s[f]=e[l].charCodeAt(0);i[u]=new Uint8Array(s)}return Z.some(new Blob(i,{type:t}))}(e).fold(function(){n("uri is not base64: "+e)},t)})},Ax=function(t,o,r){return o=o||"image/png",l(HTMLCanvasElement.prototype.toBlob)?new wx(function(n,e){t.toBlob(function(t){t?n(t):e()},o,r)}):Bx(t.toDataURL(o,r))},Mx=function(t){return a=t,new wx(function(t,n){var e=URL.createObjectURL(a),o=new Image,r=function(){o.removeEventListener("load",i),o.removeEventListener("error",u)},i=function(){r(),t(o)},u=function(){r(),n("Unable to load data of type "+a.type+": "+e)};o.addEventListener("load",i),o.addEventListener("error",u),o.src=e,o.complete&&setTimeout(i,0)}).then(function(t){Fx(t);var n=px(yx(t),xx(t));return vx(n).drawImage(t,0,0),n});var a},Fx=function(t){URL.revokeObjectURL(t.src)},Ix=function(t,n,e){var o=n.type,r=U(o),o=U(e),i=function(n,e){return t.then(function(t){return t.toDataURL(n||"image/png",e)})};return{getType:r,toBlob:function(){return wx.resolve(n)},toDataURL:o,toBase64:function(){return e.split(",")[1]},toAdjustedBlob:function(n,e){return t.then(function(t){return Ax(t,n,e)})},toAdjustedDataURL:i,toAdjustedBase64:function(t,n){return i(t,n).then(function(t){return t.split(",")[1]})},toCanvas:function(){return t.then(hx)}}},Rx=function(n,t){return Ax(n,t).then(function(t){return Ix(wx.resolve(n),t,n.toDataURL())})},Vx=function(n){return e=n,new wx(function(t){var n=new FileReader;n.onloadend=function(){t(n.result)},n.readAsDataURL(e)}).then(function(t){return Ix(Mx(n),n,t)});var e},Px=function(t,n,e){t="string"==typeof t?parseFloat(t):t;return e<t?t=e:t<n&&(t=n),t},Hx=function(){return[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1]},zx=[0,.01,.02,.04,.05,.06,.07,.08,.1,.11,.12,.14,.15,.16,.17,.18,.2,.21,.22,.24,.25,.27,.28,.3,.32,.34,.36,.38,.4,.42,.44,.46,.48,.5,.53,.56,.59,.62,.65,.68,.71,.74,.77,.8,.83,.86,.89,.92,.95,.98,1,1.06,1.12,1.18,1.24,1.3,1.36,1.42,1.48,1.54,1.6,1.66,1.72,1.78,1.84,1.9,1.96,2,2.12,2.25,2.37,2.5,2.62,2.75,2.87,3,3.2,3.4,3.6,3.8,4,4.3,4.7,4.9,5,5.5,6,6.5,6.8,7,7.3,7.5,7.8,8,8.4,8.7,9,9.4,9.6,9.8,10],Lx=function(t,n){for(var e=[],o=new Array(25),r=0;r<5;r++){for(var i=0;i<5;i++)e[i]=n[i+5*r];for(i=0;i<5;i++){for(var u=0,a=0;a<5;a++)u+=t[i+5*a]*e[a];o[i+5*r]=u}}return o},Nx=function(n,e){return n.toCanvas().then(function(t){return jx(t,n.getType(),e)})},jx=function(t,n,e){var o=vx(t),e=function(t,n){for(var e,o,r,i,u=t.data,a=n[0],c=n[1],s=n[2],l=n[3],f=n[4],d=n[5],m=n[6],g=n[7],p=n[8],h=n[9],v=n[10],b=n[11],y=n[12],x=n[13],w=n[14],S=n[15],k=n[16],C=n[17],O=n[18],_=n[19],T=0;T<u.length;T+=4)e=u[T],o=u[T+1],r=u[T+2],i=u[T+3],u[T]=e*a+o*c+r*s+i*l+f,u[T+1]=e*d+o*m+r*g+i*p+h,u[T+2]=e*v+o*b+r*y+i*x+w,u[T+3]=e*S+o*k+r*C+i*O+_;return t}(o.getImageData(0,0,t.width,t.height),e);return o.putImageData(e,0,0),Rx(t,n)},Wx=function(t,n,e){var o=vx(t),r=function(t,n,e){for(var o=function(t,n,e){return e<t?t=e:t<n&&(t=n),t},r=Math.round(Math.sqrt(e.length)),i=Math.floor(r/2),u=t.data,a=n.data,c=t.width,s=t.height,l=0;l<s;l++)for(var f=0;f<c;f++){for(var d=0,m=0,g=0,p=0;p<r;p++)for(var h=0;h<r;h++){var v=o(f+h-i,0,c-1),b=4*(o(l+p-i,0,s-1)*c+v),v=e[p*r+h];d+=u[b]*v,m+=u[1+b]*v,g+=u[2+b]*v}var y=4*(l*c+f);a[y]=o(d,0,255),a[1+y]=o(m,0,255),a[2+y]=o(g,0,255)}return n}(o.getImageData(0,0,t.width,t.height),r=o.getImageData(0,0,t.width,t.height),e);return o.putImageData(r,0,0),Rx(t,n)},Ht=function(e){return function(t,n){return Nx(t,e(Hx(),n))}},Ux=(Tx=[-1,0,0,0,255,0,-1,0,0,255,0,0,-1,0,255,0,0,0,1,0,0,0,0,0,1],function(t){return Nx(t,Tx)}),Gx=Ht(function(t,n){return n=Px(255*n,-255,255),Lx(t,[1,0,0,0,n,0,1,0,0,n,0,0,1,0,n,0,0,0,1,0,0,0,0,0,1])}),Xx=Ht(function(t,n){var e;return n=Px(n,-1,1),e=(n*=100)<0?127+n/100*127:127*(e=0===(e=n%1)?zx[n]:zx[Math.floor(n)]*(1-e)+zx[Math.floor(n)+1]*e)+127,Lx(t,[e/127,0,0,0,.5*(127-e),0,e/127,0,0,.5*(127-e),0,0,e/127,0,.5*(127-e),0,0,0,1,0,0,0,0,0,1])}),Yx=(Ex=[0,-1,0,-1,5,-1,0,-1,0],function(t){return e=Ex,(n=t).toCanvas().then(function(t){return Wx(t,n.getType(),e)});var n,e}),qx=(Dx=function(t,n){return 255*Math.pow(t/255,1-n)},function(n,e){return n.toCanvas().then(function(t){return function(t,n,e){for(var o=vx(t),r=new Array(256),i=0;i<r.length;i++)r[i]=Dx(i,e);var u=function(t,n){for(var e=t.data,o=0;o<e.length;o+=4)e[o]=n[e[o]],e[o+1]=n[e[o+1]],e[o+2]=n[e[o+2]];return t}(o.getImageData(0,0,t.width,t.height),r);return o.putImageData(u,0,0),Rx(t,n)}(t,n.getType(),e)})}),Kx=function(t,n,e){var o=yx(t),r=xx(t),i=n/o,o=e/r,r=!1;(i<.5||2<i)&&(i=i<.5?.5:2,r=!0),(o<.5||2<o)&&(o=o<.5?.5:2,r=!0);o=Jx(t,i,o);return r?o.then(function(t){return Kx(t,n,e)}):o},Jx=function(u,a,c){return new wx(function(t){var n=yx(u),e=xx(u),o=Math.floor(n*a),r=Math.floor(e*c),i=px(o,r);vx(i).drawImage(u,0,0,n,e,0,0,o,r),t(i)})},$x=function(t,n){void 0===n&&(n=2);n=Math.pow(10,n),t=Math.round(t*n);return Math.ceil(t/n)},Qx=function(t,n,e){var o=(e<0?360+e:e)*Math.PI/180,r=t.width,i=t.height,u=Math.sin(o),a=Math.cos(o),c=$x(Math.abs(r*a)+Math.abs(i*u)),e=$x(Math.abs(r*u)+Math.abs(i*a)),u=px(c,e),a=vx(u);return a.translate(c/2,e/2),a.rotate(o),a.drawImage(t,-r/2,-i/2),Rx(u,n)},Zx=function(t,n,e){var o=px(t.width,t.height),r=vx(o);return"v"===e?(r.scale(1,-1),r.drawImage(t,0,-o.height)):(r.scale(-1,1),r.drawImage(t,-o.width,0)),Rx(o,n)},t0=function(t,n,e,o,r,i){i=px(r,i);return vx(i).drawImage(t,-e,-o),Rx(i,n)},n0=function(t){return Ux(t)},e0=function(t){return Yx(t)},o0=function(t,n){return qx(t,n)},r0=function(t,n,e,o){return Nx(t,(r=Hx(),t=n,e=e,o=o,t=Px(n,0,2),e=Px(e,0,2),o=Px(o,0,2),Lx(r,[t,0,0,0,0,0,e,0,0,0,0,0,o,0,0,0,0,0,1,0,0,0,0,0,1])));var r},i0=function(t,n){return Gx(t,n)},u0=function(t,n){return Xx(t,n)},a0=function(t,n){return o=n,(e=t).toCanvas().then(function(t){return Zx(t,e.getType(),o)});var e,o},c0=function(t,n,e,o,r){return u=n,a=e,c=o,s=r,(i=t).toCanvas().then(function(t){return t0(t,i.getType(),u,a,c,s)});var i,u,a,c,s},s0=function(t,n,e){return r=n,i=e,(o=t).toCanvas().then(function(t){return Kx(t,r,i).then(function(t){return Rx(t,o.getType())})});var o,r,i},l0=function(t,n){return o=n,(e=t).toCanvas().then(function(t){return Qx(t,e.getType(),o)});var e,o},f0=function(t,n){return Q({dom:{tag:"span",innerHtml:t,classes:["tox-icon","tox-tbtn__icon-wrap"]}},n)},d0=function(t,n){return f0(bm(t,n),{})},m0=function(t,n){return f0(bm(t,n),{behaviours:ec([wd.config({})])})},g0=function(t,n,e){return{dom:{tag:"span",innerHtml:e.translate(t),classes:[n+"__select-label"]},behaviours:ec([wd.config({})])}},p0=Qr("toolbar.button.execute"),h0=((Ja={})[wo()]=["disabling","alloy.base.behaviour","toggling","toolbar-button-events"],Ja),v0=Qr("update-menu-text"),b0=Qr("update-menu-icon"),y0=function(n,e,o){var t=Zn($),r=n.text.map(function(t){return hm(g0(t,e,o.providers))}),i=n.icon.map(function(t){return hm(m0(t,o.providers.icons))}),u=function(t,n){t=vl.getValue(t);return Cd.focus(t),Wo(t,"keydown",{raw:n.event.raw}),Eb.close(t),Z.some(!0)},a=n.role.fold(function(){return{}},function(t){return{role:t}}),c=n.tooltip.fold(function(){return{}},function(t){t=o.providers.translate(t);return{title:t,"aria-label":t}});return hm(Eb.sketch(Q(Q(Q({},n.uid?{uid:n.uid}:{}),a),{dom:{tag:"button",classes:[e,e+"--select"].concat(R(n.classes,function(t){return e+"--"+t})),attributes:Q({},c)},components:Dp([i.map(function(t){return t.asSpec()}),r.map(function(t){return t.asSpec()}),Z.some({dom:{tag:"div",classes:[e+"__select-chevron"],innerHtml:bm("chevron-down",o.providers.icons)}})]),matchWidth:!0,useMinWidth:!0,dropdownBehaviours:ec(p(p([],n.dropdownBehaviours),[Sp(function(){return n.disabled||o.providers.isDisabled()}),xp(),Db.config({}),wd.config({}),Sd("dropdown-events",[_p(n,t),Tp(n,t)]),Sd("menubutton-update-display-text",[$o(v0,function(n,e){r.bind(function(t){return t.getOpt(n)}).each(function(t){wd.set(t,[fu(o.providers.translate(e.event.text))])})}),$o(b0,function(n,e){i.bind(function(t){return t.getOpt(n)}).each(function(t){wd.set(t,[m0(e.event.icon,o.providers.icons)])})})])])),eventOrder:zt(h0,{mousedown:["focusing","alloy.base.behaviour","item-type-events","normal-dropdown-events"]}),sandboxBehaviours:ec([hd.config({mode:"special",onLeft:u,onRight:u})]),lazySink:o.getSink,toggleClass:e+"--active",parts:{menu:dg(0,n.columns,n.presets)},fetch:function(t){return nb(x(n.fetch,t))}}))).asSpec()},x0=function(t){return"separator"===t.type},w0={type:"separator"},S0=function(t,e){t=z(t,function(t,n){return v(n)?""===n?t:"|"===n?0<t.length&&!x0(t[t.length-1])?t.concat([w0]):t:Vt(e,n.toLowerCase())?t.concat([e[n.toLowerCase()]]):t:t.concat([n])},[]);return 0<t.length&&x0(t[t.length-1])&&t.pop(),t},k0=function(t,n){return Vt(t,"getSubmenuItems")?(o=n,n=(e=t).getSubmenuItems(),o=C0(n,o),{item:e,menus:zt(o.menus,ze(e.value,o.items)),expansions:zt(o.expansions,ze(e.value,e.value))}):{item:t,menus:{},expansions:{}};var e,o},C0=function(t,e){t=S0(v(t)?t.split(" "):t,e);return H(t,function(t,n){n=function(t){if(x0(t))return t;var n=Rt(t,"value").getOrThunk(function(){return Qr("generated-menu-item")});return zt({value:n},t)}(n),n=k0(n,e);return{menus:zt(t.menus,n.menus),items:[n.item].concat(t.items),expansions:zt(t.expansions,n.expansions)}},{menus:{},expansions:{},items:[]})},O0=function(t,e,o,n){var r=Qr("primary-menu"),i=C0(t,o.shared.providers.menuItems());if(0===i.items.length)return Z.none();t=iv(r,i.items,e,o,n),n=Dt(i.menus,function(t,n){return iv(n,t,e,o,!1)}),t=zt(n,ze(r,t));return Z.from(Qd.tieredData(r,t,i.expansions))},_0=function(e){return{isDisabled:function(){return Kg.isDisabled(e)},setDisabled:function(t){return Kg.set(e,t)},setActive:function(t){var n=e.element;t?(Ai(n,"tox-tbtn--enabled"),jr(n,"aria-pressed",!0)):(Fi(n,"tox-tbtn--enabled"),Xr(n,"aria-pressed"))},isActive:function(){return Ii(e.element,"tox-tbtn--enabled")}}},T0=function(e,t,o,n){return y0({text:e.text,icon:e.icon,tooltip:e.tooltip,role:n,fetch:function(t,n){e.fetch(function(t){n(O0(t,$m.CLOSE_ON_EXECUTE,o,!1))})},onSetup:e.onSetup,getApi:_0,columns:1,presets:"normal",classes:[],dropdownBehaviours:[Bv.config({})]},t,o.shared)},E0=function(n,r,i){return function(t){t(R(n,function(t){var n,e,o=t.text.fold(function(){return{}},function(t){return{text:t}});return Q(Q({type:t.type,active:!1},o),{onAction:function(t){var n=!t.isActive();t.setActive(n),e.storage.set(n),i.shared.getSink().each(function(t){r().getOpt(t).each(function(t){sc(t.element),Wo(t,zv,{name:e.name,value:e.storage.get()})})})},onSetup:(n=e=t,function(t){t.setActive(n.storage.get())})})}))}},D0=function(t,n,e,o,r,i){void 0===e&&(e=[]);n=n.fold(function(){return{}},function(t){return{action:t}}),n=Q({buttonBehaviours:ec([Sp(function(){return t.disabled||i.isDisabled()}),xp(),Bv.config({}),Sd("button press",[Jo("click"),Jo("mousedown")])].concat(e)),eventOrder:{click:["button press","alloy.base.behaviour"],mousedown:["button press","alloy.base.behaviour"]}},n),o=zt(n,{dom:o});return zt(o,{components:r})},B0=function(t,n,e,o){void 0===o&&(o=[]);var r={tag:"button",classes:["tox-tbtn"],attributes:t.tooltip.map(function(t){return{"aria-label":e.translate(t),title:e.translate(t)}}).getOr({})},i=t.icon.map(function(t){return d0(t,e.icons)}),i=Dp([i]);return D0(t,n,o,r,i,e)},A0=function(t,n,e,o){void 0===o&&(o=[]);o=B0(t,Z.some(n),e,o);return pm.sketch(o)},M0=function(t,n,e,o,r){void 0===o&&(o=[]),void 0===r&&(r=[]);var i=e.translate(t.text),u=t.icon?t.icon.map(function(t){return d0(t,e.icons)}):Z.none(),a=u.isSome()?Dp([u]):[],c=u.isSome()?{}:{innerHtml:i},r=p(p(p(p([],t.primary||t.borderless?["tox-button"]:["tox-button","tox-button--secondary"]),u.isSome()?["tox-button--icon"]:[]),t.borderless?["tox-button--naked"]:[]),r),i=Q(Q({tag:"button",classes:r},c),{attributes:{title:i}});return D0(t,n,o,i,a,e)},F0=function(t,n,e,o,r){void 0===o&&(o=[]),void 0===r&&(r=[]);r=M0(t,Z.some(n),e,o,r);return pm.sketch(r)},I0=function(n,e){return function(t){"custom"===e?Wo(t,zv,{name:n,value:{}}):"submit"===e?jo(t,Lv):"cancel"===e?jo(t,Hv):console.error("Unknown button type: ",e)}},R0=function(n,t,e){if("menu"===t){var o=n,r=Q(Q({},n),{onSetup:function(t){return t.setDisabled(n.disabled),$},fetch:E0(o.items,function(){return i},e)}),i=hm(T0(r,"tox-tbtn",e,Z.none()));return i.asSpec()}if("custom"===(o=t)||"cancel"===o||"submit"===o){r=I0(n.name,t),o=Q(Q({},n),{borderless:!1});return F0(o,r,e.shared.providers,[])}console.error("Unknown footer button type: ",t)},V0=function(t,n){var e,o=I0(t.name,"custom");return e=Z.none(),n=Dv.parts.field(Q({factory:pm},M0(t,Z.some(o),n,[rx(""),Gy()]))),Mv(e,n,[],[])},Ro=U([Un("field1Name","field1"),Un("field2Name","field2"),ga("onLockedChange"),la(["lockClass"]),Un("locked",!1),xl("coupledFieldBehaviours",[uf,vl])]),t=function(t,n){return Fl({factory:Dv,name:t,overrides:function(o){return{fieldBehaviours:ec([Sd("coupled-input-behaviour",[$o(so(),function(e){Ul(e,o,n).bind(uf.getCurrent).each(function(n){Ul(e,o,"lock").each(function(t){Fd.isOn(t)&&o.onLockedChange(e,n,t)})})})])])}}})},Kr=U([t("field1","field2"),t("field2","field1"),Fl({factory:pm,schema:[Bn("dom")],name:"lock",overrides:function(t){return{buttonBehaviours:ec([Fd.config({selected:t.locked,toggleClass:t.markers.lockClass,aria:{mode:"pressed"}})])}}})]),P0=pl({name:"FormCoupledInputs",configFields:Ro(),partFields:Kr(),factory:function(e,t,n,o){return{uid:e.uid,dom:e.dom,components:t,behaviours:wl(e.coupledFieldBehaviours,[uf.config({find:Z.some}),vl.config({store:{mode:"manual",getValue:function(t){var n=Kl(t,e,["field1","field2"]),t={};return t[e.field1Name]=vl.getValue(n.field1()),t[e.field2Name]=vl.getValue(n.field2()),t},setValue:function(t,n){t=Kl(t,e,["field1","field2"]);Pt(n,e.field1Name)&&vl.setValue(t.field1(),n[e.field1Name]),Pt(n,e.field2Name)&&vl.setValue(t.field2(),n[e.field2Name])}}})]),apis:{getField1:function(t){return Ul(t,e,"field1")},getField2:function(t){return Ul(t,e,"field2")},getLock:function(t){return Ul(t,e,"lock")}}}},apis:{getField1:function(t,n){return t.getField1(n)},getField2:function(t,n){return t.getField2(n)},getLock:function(t,n){return t.getLock(n)}}}),H0=function(t){var n=/^\s*(\d+(?:\.\d+)?)\s*(|cm|mm|in|px|pt|pc|em|ex|ch|rem|vw|vh|vmin|vmax|%)\s*$/.exec(t);if(null===n)return at.error(t);t=parseFloat(n[1]),n=n[2];return at.value({value:t,unit:n})},z0=function(t,n){var e={"":96,px:96,pt:72,cm:2.54,pc:12,mm:25.4,"in":1},o=function(t){return Vt(e,t)};return t.unit===n?Z.some(t.value):o(t.unit)&&o(n)?e[t.unit]===e[n]?Z.some(t.value):Z.some(t.value/e[t.unit]*e[n]):Z.none()},L0=function(t){return Z.none()},N0=function(t,n){t=H0(t).toOptional(),n=H0(n).toOptional();return zi(t,n,function(t,o){return z0(t,o.unit).map(function(t){return o.value/t}).map(function(t){return n=t,e=o.unit,function(t){return z0(t,e).map(function(t){return{value:t*n,unit:e}})};var n,e}).getOr(L0)}).getOr(L0)},j0=function(o,n){var r=L0,i=Qr("ratio-event"),t=P0.parts.lock({dom:{tag:"button",classes:["tox-lock","tox-button","tox-button--naked","tox-button--icon"],attributes:{title:n.translate(o.label.getOr("Constrain proportions"))}},components:[{dom:{tag:"span",classes:["tox-icon","tox-lock-icon__lock"],innerHtml:bm("lock",n.icons)}},{dom:{tag:"span",classes:["tox-icon","tox-lock-icon__unlock"],innerHtml:bm("unlock",n.icons)}}],buttonBehaviours:ec([Kg.config({disabled:function(){return o.disabled||n.isDisabled()}}),xp(),Bv.config({})])}),e=function(t){return{dom:{tag:"div",classes:["tox-form__group"]},components:t}},u=function(e){return Dv.parts.field({factory:qv,inputClasses:["tox-textfield"],inputBehaviours:ec([Kg.config({disabled:function(){return o.disabled||n.isDisabled()}}),xp(),Bv.config({}),Sd("size-input-events",[$o(io(),function(t,n){Wo(t,i,{isField1:e})}),$o(lo(),function(t,n){Wo(t,Vv,{name:o.name})})])]),selectOnFocus:!1})},a=function(t){return{dom:{tag:"label",classes:["tox-label"],innerHtml:n.translate(t)}}},c=P0.parts.field1(e([Dv.parts.label(a("Width")),u(!0)])),u=P0.parts.field2(e([Dv.parts.label(a("Height")),u(!1)]));return P0.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:[{dom:{tag:"div",classes:["tox-form__controls-h-stack"]},components:[c,u,e([a("&nbsp;"),t])]}],field1Name:"width",field2Name:"height",locked:!0,markers:{lockClass:"tox-locked"},onLockedChange:function(t,o,n){H0(vl.getValue(t)).each(function(t){r(t).each(function(t){var n,e;vl.setValue(o,(e={"":0,px:0,pt:1,mm:1,pc:2,ex:2,em:2,ch:2,rem:2,cm:3,"in":4,"%":4},(t=-1!==(t=(n=t).value.toFixed((t=n.unit)in e?e[t]:1)).indexOf(".")?t.replace(/\.?0*$/,""):t)+n.unit))})})},coupledFieldBehaviours:ec([Kg.config({disabled:function(){return o.disabled||n.isDisabled()},onDisabled:function(t){P0.getField1(t).bind(Dv.getField).each(Kg.disable),P0.getField2(t).bind(Dv.getField).each(Kg.disable),P0.getLock(t).each(Kg.disable)},onEnabled:function(t){P0.getField1(t).bind(Dv.getField).each(Kg.enable),P0.getField2(t).bind(Dv.getField).each(Kg.enable),P0.getLock(t).each(Kg.enable)}}),xp(),Sd("size-input-events2",[$o(i,function(t,n){var e=n.event.isField1,n=e?P0.getField1(t):P0.getField2(t),t=e?P0.getField2(t):P0.getField1(t),n=n.map(vl.getValue).getOr(""),t=t.map(vl.getValue).getOr("");r=N0(n,t)})])])})},W0={undo:U(Qr("undo")),redo:U(Qr("redo")),zoom:U(Qr("zoom")),back:U(Qr("back")),apply:U(Qr("apply")),swap:U(Qr("swap")),transform:U(Qr("transform")),tempTransform:U(Qr("temp-transform")),transformApply:U(Qr("transform-apply"))},Ht=U("save-state"),Ja=U("disable"),t=U("enable"),U0={formActionEvent:zv,saveState:Ht,disable:Ja,enable:t},G0=function(o,a){var t=function(t,n,e,o){return hm(F0({name:t,text:t,disabled:e,primary:o,icon:Z.none(),borderless:!1},n,a))},n=function(t,n,e,o){return hm(A0({name:t,icon:Z.some(t),tooltip:Z.some(n),disabled:o,primary:!1,borderless:!1},e,a))},u=function(t,n){t.map(function(t){t=t.get(n);t.hasConfigured(Kg)&&Kg.disable(t)})},c=function(t,n){t.map(function(t){t=t.get(n);t.hasConfigured(Kg)&&Kg.enable(t)})},s={tag:"div",classes:["tox-image-tools__toolbar","tox-image-tools-edit-panel"]},e=$,r=function(t,n,e){Wo(t,n,e)},i=function(t){return jo(t,U0.disable())},l=function(t){return jo(t,U0.enable())},f=function(t,n){i(t),r(t,W0.transform(),{transform:n}),l(t)},d=function(t){return function(){W.getOpt(t).each(function(t){wd.set(t,[j])})}},m=function(t,n){i(t),r(t,W0.transformApply(),{transform:n,swap:d(t)}),l(t)},g=function(){return t("Back",function(t){return r(t,W0.back(),{swap:d(t)})},!1,!1)},p=function(){return hm({dom:{tag:"div",classes:["tox-spacer"]},behaviours:ec([Kg.config({})])})},h=function(){return t("Apply",function(t){return r(t,W0.apply(),{swap:d(t)})},!0,!0)},v=[g(),p(),t("Apply",function(t){m(t,function(t){var n=o.getRect();return c0(t,n.x,n.y,n.w,n.h)}),o.hideCrop()},!1,!0)],b=Tv.sketch({dom:s,components:v.map(function(t){return t.asSpec()}),containerBehaviours:ec([Sd("image-tools-crop-buttons-events",[$o(U0.disable(),function(t,n){u(v,t)}),$o(U0.enable(),function(t,n){c(v,t)})])])}),y=hm(j0({name:"size",label:Z.none(),constrain:!0,disabled:!1},a)),x=[g(),p(),y,p(),t("Apply",function(r){y.getOpt(r).each(function(t){var n,e,o=vl.getValue(t),t=parseInt(o.width,10),o=parseInt(o.height,10),o=(n=t,e=o,function(t){return s0(t,n,e)});m(r,o)})},!1,!0)],w=Tv.sketch({dom:s,components:x.map(function(t){return t.asSpec()}),containerBehaviours:ec([Sd("image-tools-resize-buttons-events",[$o(U0.disable(),function(t,n){u(x,t)}),$o(U0.enable(),function(t,n){c(x,t)})])])}),S=function(n,e){return function(t){return n(t,e)}},k=S(a0,"h"),C=S(a0,"v"),O=S(l0,-90),_=S(l0,90),T=function(t,n){n=n,i(t=t),r(t,W0.tempTransform(),{transform:n}),l(t)},E=[g(),p(),n("flip-horizontally","Flip horizontally",function(t){T(t,k)},!1),n("flip-vertically","Flip vertically",function(t){T(t,C)},!1),n("rotate-left","Rotate counterclockwise",function(t){T(t,O)},!1),n("rotate-right","Rotate clockwise",function(t){T(t,_)},!1),p(),h()],D=Tv.sketch({dom:s,components:E.map(function(t){return t.asSpec()}),containerBehaviours:ec([Sd("image-tools-fliprotate-buttons-events",[$o(U0.disable(),function(t,n){u(E,t)}),$o(U0.enable(),function(t,n){c(E,t)})])])}),B=function(t,n,e,o,r){var i=By.parts.label({dom:{tag:"label",classes:["tox-label"],innerHtml:a.translate(t)}}),u=By.parts.spectrum({dom:{tag:"div",classes:["tox-slider__rail"],attributes:{role:"presentation"}}}),t=By.parts.thumb({dom:{tag:"div",classes:["tox-slider__handle"],attributes:{role:"presentation"}}});return hm(By.sketch({dom:{tag:"div",classes:["tox-slider"],attributes:{role:"presentation"}},model:{mode:"x",minX:e,maxX:r,getInitialValue:U({x:o})},components:[i,u,t],sliderBehaviours:ec([Cd.config({})]),onChoose:n}))},A=function(t,n,e,o,r){return[g(),(i=n,B(t,function(t,n,e){e=S(i,e.x/100);f(t,e)},e,o,r)),h()];var i},M=function(t,n,e,o,r){var i=A(t,n,e,o,r);return Tv.sketch({dom:s,components:i.map(function(t){return t.asSpec()}),containerBehaviours:ec([Sd("image-tools-filter-panel-buttons-events",[$o(U0.disable(),function(t,n){u(i,t)}),$o(U0.enable(),function(t,n){c(i,t)})])])})},F=[g(),p(),h()],I=Tv.sketch({dom:s,components:F.map(function(t){return t.asSpec()})}),R=M("Brightness",i0,-100,0,100),V=M("Contrast",u0,-100,0,100),P=M("Gamma",o0,-100,0,100),H=function(t){return B(t,function(c,t,n){var e=z.getOpt(c),o=N.getOpt(c),r=L.getOpt(c);e.each(function(a){o.each(function(u){r.each(function(t){var n,e,o,r=vl.getValue(a).x/100,i=vl.getValue(t).x/100,t=vl.getValue(u).x/100,t=(n=r,e=i,o=t,function(t){return r0(t,n,e,o)});f(c,t)})})})},0,100,200)},z=H("R"),L=H("G"),N=H("B"),p=[g(),z,L,N,h()],F=Tv.sketch({dom:s,components:p.map(function(t){return t.asSpec()})}),M=function(n,e,o){return function(t){r(t,W0.swap(),{transform:e,swap:function(){W.getOpt(t).each(function(t){wd.set(t,[n]),o(t)})}})}},H=Z.some(e0),p=Z.some(n0),e=[n("crop","Crop",M(b,Z.none(),function(t){o.showCrop()}),!1),n("resize","Resize",M(w,Z.none(),function(t){y.getOpt(t).each(function(t){var n=o.getMeasurements(),e=n.width,n=n.height;vl.setValue(t,{width:e,height:n})})}),!1),n("orientation","Orientation",M(D,Z.none(),e),!1),n("brightness","Brightness",M(R,Z.none(),e),!1),n("sharpen","Sharpen",M(I,H,e),!1),n("contrast","Contrast",M(V,Z.none(),e),!1),n("color-levels","Color levels",M(F,Z.none(),e),!1),n("gamma","Gamma",M(P,Z.none(),e),!1),n("invert","Invert",M(I,p,e),!1)],j=Tv.sketch({dom:s,components:e.map(function(t){return t.asSpec()})}),e=Tv.sketch({dom:{tag:"div"},components:[j],containerBehaviours:ec([wd.config({})])}),W=hm(e);return{memContainer:W,getApplyButton:function(t){return W.getOpt(t).map(function(t){t=t.components()[0];return t.components()[t.components().length-1]})}}},X0=tinymce.util.Tools.resolve("tinymce.geom.Rect"),Y0=tinymce.util.Tools.resolve("tinymce.dom.DomQuery"),q0=tinymce.util.Tools.resolve("tinymce.util.Observable"),K0=tinymce.util.Tools.resolve("tinymce.util.VK"),J0=function(t){var n,e;if(t.changedTouches)for(n="screenX screenY pageX pageY clientX clientY".split(" "),e=0;e<n.length;e++)t[n[e]]=t.changedTouches[0][n[e]]};function $0(t,s){var l,f,d,m,g=s.document||document,p=g.getElementById(s.handle||t),h=function(t){if(J0(t),t.button!==f)return v(t);t.deltaX=t.screenX-d,t.deltaY=t.screenY-m,t.preventDefault(),s.drag(t)},v=function(t){J0(t),Y0(g).off("mousemove touchmove",h).off("mouseup touchend",v),l.remove(),s.stop&&s.stop(t)};return Y0(p).on("mousedown touchstart",function(t){var n,e,o,r,i,u,a,n=(n=g,e=Math.max,o=n.documentElement,r=n.body,i=e(o.scrollWidth,r.scrollWidth),u=e(o.clientWidth,r.clientWidth),a=e(o.offsetWidth,r.offsetWidth),c=e(o.scrollHeight,r.scrollHeight),n=e(o.clientHeight,r.clientHeight),{width:i<a?u:i,height:c<e(o.offsetHeight,r.offsetHeight)?n:c});J0(t),t.preventDefault(),f=t.button;var c=p;d=t.screenX,m=t.screenY,c=window.getComputedStyle?window.getComputedStyle(c,null).getPropertyValue("cursor"):c.runtimeStyle.cursor,l=Y0("<div></div>").css({position:"absolute",top:0,left:0,width:n.width,height:n.height,zIndex:2147483647,opacity:1e-4,cursor:c}).appendTo(g.body),Y0(g).on("mousemove touchmove",h).on("mouseup touchend",v),s.start(t)}),{destroy:function(){Y0(p).off()}}}var Q0=0,Z0=function(a,e,c,o,r){var t,n="tox-",u="tox-crid-"+Q0++,s=[{name:"move",xMul:0,yMul:0,deltaX:1,deltaY:1,deltaW:0,deltaH:0,label:"Crop Mask"},{name:"nw",xMul:0,yMul:0,deltaX:1,deltaY:1,deltaW:-1,deltaH:-1,label:"Top Left Crop Handle"},{name:"ne",xMul:1,yMul:0,deltaX:0,deltaY:1,deltaW:1,deltaH:-1,label:"Top Right Crop Handle"},{name:"sw",xMul:0,yMul:1,deltaX:1,deltaY:0,deltaW:-1,deltaH:1,label:"Bottom Left Crop Handle"},{name:"se",xMul:1,yMul:1,deltaX:0,deltaY:0,deltaW:1,deltaH:1,label:"Bottom Right Crop Handle"}],i=["top","right","bottom","left"],l=function(t,n){return{x:n.x-t.x,y:n.y-t.y,w:n.w,h:n.h}},f=function(t,n,e,o){var r=n.x,i=n.y,u=n.w,n=n.h;r+=e*t.deltaX,i+=o*t.deltaY,u+=e*t.deltaW,n+=o*t.deltaH,t=a=X0.clamp({x:r,y:i,w:u=u<20?20:u,h:n=n<20?20:n},c,"move"===t.name),t=l(c,t=a),p.fire("updateRect",{rect:t}),g(t)},d=function(n){var t=function(t,n){n.h<0&&(n.h=0),n.w<0&&(n.w=0),Y0("#"+u+"-"+t,o).css({left:n.x,top:n.y,width:n.w,height:n.h})};$y.each(s,function(t){Y0("#"+u+"-"+t.name,o).css({left:n.w*t.xMul+n.x,top:n.h*t.yMul+n.y})}),t("top",{x:e.x,y:e.y,w:e.w,h:n.y-e.y}),t("right",{x:n.x+n.w,y:n.y,w:e.w-n.x-n.w+e.x,h:n.h}),t("bottom",{x:e.x,y:n.y+n.h,w:e.w,h:e.h-n.y-n.h+e.y}),t("left",{x:e.x,y:n.y,w:n.x-e.x,h:n.h}),t("move",n)},m=function(t){d(a=t)},g=function(t){m({x:t.x+c.x,y:t.y+c.y,w:t.w,h:t.h})};Y0('<div id="'+u+'" class="'+n+'croprect-container" role="grid" aria-dropeffect="execute">').appendTo(o),$y.each(i,function(t){Y0("#"+u,o).append('<div id="'+u+"-"+t+'"class="'+n+'croprect-block" style="display: none" data-mce-bogus="all">')}),$y.each(s,function(t){Y0("#"+u,o).append('<div id="'+u+"-"+t.name+'" class="'+n+"croprect-handle "+n+"croprect-handle-"+t.name+'"style="display: none" data-mce-bogus="all" role="gridcell" tabindex="-1" aria-label="'+t.label+'" aria-grabbed="false" title="'+t.label+'">')}),t=$y.map(s,function(n){var e;return $0(u,{document:o.ownerDocument,handle:u+"-"+n.name,start:function(){e=a},drag:function(t){f(n,e,t.deltaX,t.deltaY)}})}),d(a),Y0(o).on("focusin focusout",function(t){Y0(t.target).attr("aria-grabbed","focus"===t.type?"true":"false")}),Y0(o).on("keydown",function(n){var i;$y.each(s,function(t){if(n.target.id===u+"-"+t.name)return i=t,!1});var t=function(t,n,e,o,r){t.stopPropagation(),t.preventDefault(),f(i,e,o,r)};switch(n.keyCode){case K0.LEFT:t(n,0,a,-10,0);break;case K0.RIGHT:t(n,0,a,10,0);break;case K0.UP:t(n,0,a,0,-10);break;case K0.DOWN:t(n,0,a,0,10);break;case K0.ENTER:case K0.SPACEBAR:n.preventDefault(),r()}});var p=$y.extend({toggleVisibility:function(t){var n=$y.map(s,function(t){return"#"+u+"-"+t.name}).concat($y.map(i,function(t){return"#"+u+"-"+t})).join(",");t?Y0(n,o).show():Y0(n,o).hide()},setClampRect:function(t){c=t,d(a)},setRect:m,getInnerRect:function(){return l(c,a)},setInnerRect:g,setViewPortRect:function(t){e=t,d(a)},destroy:function(){$y.each(t,function(t){t.destroy()}),t=[]}},q0);return p},tw=function(n){var l=hm({dom:{tag:"div",classes:["tox-image-tools__image-bg"],attributes:{role:"presentation"}}}),f=Zn(1),d=Zn(Z.none()),m=Zn({x:0,y:0,w:1,h:1}),u=Zn({x:0,y:0,w:1,h:1}),a=function(t,s){c.getOpt(t).each(function(t){var e=f.get(),o=_u(t.element),r=bu(t.element),i=s.dom.naturalWidth*e,u=s.dom.naturalHeight*e,a=Math.max(0,o/2-i/2),c=Math.max(0,r/2-u/2),n={left:a.toString()+"px",top:c.toString()+"px",width:i.toString()+"px",height:u.toString()+"px",position:"absolute"};qi(s,n),l.getOpt(t).each(function(t){qi(t.element,n)}),d.get().each(function(t){var n=m.get();t.setRect({x:n.x*e+a,y:n.y*e+c,w:n.w*e,h:n.h*e}),t.setClampRect({x:a,y:c,w:i,h:u}),t.setViewPortRect({x:0,y:0,w:o,h:r})})})},e=function(t,n){var e,i=ne.fromTag("img");return jr(i,"src",n),e=i.dom,new Fm(function(t){var n=function(){e.removeEventListener("load",n),t(e)};e.complete?t(e):e.addEventListener("load",n)}).then(function(){t.getSystem().isConnected()&&c.getOpt(t).map(function(t){var n=du({element:i});wd.replaceAt(t,1,Z.some(n));var e=u.get(),o={x:0,y:0,w:i.dom.naturalWidth,h:i.dom.naturalHeight};u.set(o);var r,n=X0.inflate(o,-20,-20);m.set(n),e.w===o.w&&e.h===o.h||(r=i,c.getOpt(t).each(function(t){var n=_u(t.element),e=bu(t.element),o=r.dom.naturalWidth,t=r.dom.naturalHeight,t=Math.min(n/o,e/t);1<=t?f.set(1):f.set(t)})),a(t,i)})})},t=Tv.sketch({dom:{tag:"div",classes:["tox-image-tools__image"]},components:[l.asSpec(),{dom:{tag:"img",attributes:{src:n}}},{dom:{tag:"div"},behaviours:ec([Sd("image-panel-crop-events",[rr(function(t){c.getOpt(t).each(function(t){t=t.element.dom,t=Z0({x:10,y:10,w:100,h:100},{x:0,y:0,w:200,h:200},{x:0,y:0,w:200,h:200},t,$);t.toggleVisibility(!1),t.on("updateRect",function(t){var n=t.rect,t=f.get(),t={x:Math.round(n.x/t),y:Math.round(n.y/t),w:Math.round(n.w/t),h:Math.round(n.h/t)};m.set(t)}),d.set(Z.some(t))})})])])}],containerBehaviours:ec([wd.config({}),Sd("image-panel-events",[rr(function(t){e(t,n)})])])}),c=hm(t);return{memContainer:c,updateSrc:e,zoom:function(t,n){var e=f.get(),e=0<n?Math.min(2,e+.1):Math.max(.1,e-.1);f.set(e),c.getOpt(t).each(function(t){var n=t.components()[1].element;a(t,n)})},showCrop:function(){d.get().each(function(t){t.toggleVisibility(!0)})},hideCrop:function(){d.get().each(function(t){t.toggleVisibility(!1)})},getRect:function(){return m.get()},getMeasurements:function(){var t=u.get();return{width:t.w,height:t.h}}}},nw=function(t,n,e,o,r){return A0({name:t,icon:Z.some(n),disabled:e,tooltip:Z.some(t),primary:!1,borderless:!1},o,r)},ew=function(t,n){n?Kg.enable(t):Kg.disable(t)};var ow,rw,iw=function(t){var e,o,n,r,i=Zn(t),u=Zn(Z.none()),a=(o=-1,{data:e=[],add:function(t){var n=e.splice(++o);return e.push(t),{state:t,removed:n}},undo:function(){if(n())return e[--o]},redo:function(){if(r())return e[++o]},canUndo:n=function(){return 0<o},canRedo:r=function(){return-1!==o&&o<e.length-1}});a.add(t);var c=function(t){i.set(t)},s=function(t){return{blob:t,url:URL.createObjectURL(t)}},l=function(t){URL.revokeObjectURL(t.url)},f=function(){u.get().each(l),u.set(Z.none())},d=function(t){var n=s(t);c(n);t=a.add(n).removed;return $y.each(t,l),n.url};return{getBlobState:function(){return i.get()},setBlobState:c,addBlobState:d,getTempState:function(){return u.get().getOrThunk(i.get)},updateTempState:function(t){t=s(t);return f(),u.set(Z.some(t)),t.url},addTempState:function(t){t=s(t);return u.set(Z.some(t)),t.url},applyTempState:function(n){return u.get().fold($,function(t){d(t.blob),n()})},destroyTempState:f,undo:function(){var t=a.undo();return c(t),t.url},redo:function(){var t=a.redo();return c(t),t.url},getHistoryStates:function(){return{undoEnabled:a.canUndo(),redoEnabled:a.canRedo()}}}},uw=function(t,n){var o,r,i=iw(t.currentState),u=function(t){var n=i.getHistoryStates();p.updateButtonUndoStates(t,n.undoEnabled,n.redoEnabled),Wo(t,U0.formActionEvent,{name:U0.saveState(),value:n.undoEnabled})},a=function(t){return t.toBlob()},c=function(t){Wo(t,U0.formActionEvent,{name:U0.disable(),value:{}})},s=function(t){e.getApplyButton(t).each(function(t){Kg.enable(t)}),Wo(t,U0.formActionEvent,{name:U0.enable(),value:{}})},l=function(t,n){return c(t),g.updateSrc(t,n)},f=function(n,t,e,o,r){c(n),Vx(t).then(e).then(a).then(o).then(function(t){return l(n,t)}).then(function(){u(n),r(),s(n)})["catch"](function(t){console.log(t),n.getSystem().isConnected()&&s(n)})},d=function(t,n,e){var o=i.getBlobState().blob;f(t,o,n,function(t){return i.updateTempState(t)},e)},m=function(t){var n=i.getBlobState().url;return i.destroyTempState(),u(t),n},g=tw(t.currentState.url),p=(o=hm(nw("Undo","undo",!0,function(t){Wo(t,W0.undo(),{direction:1})},t=n)),r=hm(nw("Redo","redo",!0,function(t){Wo(t,W0.redo(),{direction:1})},t)),{container:Tv.sketch({dom:{tag:"div",classes:["tox-image-tools__toolbar","tox-image-tools__sidebar"]},components:[o.asSpec(),r.asSpec(),nw("Zoom in","zoom-in",!1,function(t){Wo(t,W0.zoom(),{direction:1})},t),nw("Zoom out","zoom-out",!1,function(t){Wo(t,W0.zoom(),{direction:-1})},t)]}),updateButtonUndoStates:function(t,n,e){o.getOpt(t).each(function(t){ew(t,n)}),r.getOpt(t).each(function(t){ew(t,e)})}}),e=G0(g,n);return{dom:{tag:"div",attributes:{role:"presentation"}},components:[e.memContainer.asSpec(),g.memContainer.asSpec(),p.container],behaviours:ec([vl.config({store:{mode:"manual",getValue:function(){return i.getBlobState()}}}),Sd("image-tools-events",[$o(W0.undo(),function(n,t){var e=i.undo();l(n,e).then(function(t){s(n),u(n)})}),$o(W0.redo(),function(n,t){var e=i.redo();l(n,e).then(function(t){s(n),u(n)})}),$o(W0.zoom(),function(t,n){n=n.event.direction;g.zoom(t,n)}),$o(W0.back(),function(t,n){var e;t=m(e=t),l(e,t).then(function(t){s(e)}),(0,n.event.swap)(),g.hideCrop()}),$o(W0.apply(),function(t,n){i.applyTempState(function(){m(t),(0,n.event.swap)()})}),$o(W0.transform(),function(t,n){return d(t,n.event.transform,$)}),$o(W0.tempTransform(),function(t,n){var e;e=t,t=n.event.transform,n=i.getTempState().blob,f(e,n,t,function(t){return i.addTempState(t)},$)}),$o(W0.transformApply(),function(t,n){var e,o;e=t,o=n.event.transform,t=n.event.swap,n=i.getBlobState().blob,f(e,n,o,function(t){t=i.addBlobState(t);return m(e),t},t)}),$o(W0.swap(),function(n,t){p.updateButtonUndoStates(n,!1,!1);var e=t.event.transform,o=t.event.swap;e.fold(function(){o()},function(t){d(n,t,o)})})]),Gy()])}},aw=function(t){return!Vt(t,"items")},cw="data-value",sw=function(n,e,t,o){return R(t,function(t){return aw(t)?{type:"togglemenuitem",text:t.text,value:t.value,active:t.value===o,onAction:function(){vl.setValue(n,t.value),Wo(n,Vv,{name:e}),Cd.focus(n)}}:{type:"nestedmenuitem",text:t.text,getSubmenuItems:function(){return sw(n,e,t.items,o)}}})},lw=function(t,n){return rt(t,function(t){return aw(t)?Li(t.value===n,t):lw(t.items,n)})},fw=of({name:"HtmlSelect",configFields:[Bn("options"),sr("selectBehaviours",[Cd,vl]),Un("selectClasses",[]),Un("selectAttributes",{}),Hn("data")],factory:function(e,t){var n=R(e.options,function(t){return{dom:{tag:"option",value:t.value,innerHtml:t.text}}}),o=e.data.map(function(t){return ze("initialValue",t)}).getOr({});return{uid:e.uid,dom:{tag:"select",classes:e.selectClasses,attributes:e.selectAttributes},components:n,behaviours:yl(e.selectBehaviours,[Cd.config({}),vl.config({store:Q({mode:"manual",getValue:function(t){return eu(t.element)},setValue:function(t,n){L(e.options,function(t){return t.value===n}).isSome()&&ou(t.element,n)}},o)})])}}}),dw=function(e,n){var t=e.label.map(function(t){return Rv(t,n)}),o=[Kg.config({disabled:function(){return e.disabled||n.isDisabled()}}),xp(),hd.config({mode:"execution",useEnter:!0!==e.multiline,useControlEnter:!0===e.multiline,execute:function(t){return jo(t,Lv),Z.some(!0)}}),Sd("textfield-change",[$o(so(),function(t,n){Wo(t,Vv,{name:e.name})}),$o(yo(),function(t,n){Wo(t,Vv,{name:e.name})})]),Bv.config({})],r=e.validation.map(function(e){return lb.config({getRoot:function(t){return br(t.element)},invalidClass:"tox-invalid",validator:{validate:function(t){var n=vl.getValue(t),t=e.validator(n);return eb(!0===t?at.value(n):at.error(t))},validateOnLoad:e.validateOnLoad}})}).toArray(),i=e.placeholder.fold(U({}),function(t){return{placeholder:n.translate(t)}}),u=e.inputMode.fold(U({}),function(t){return{inputmode:t}}),u=Q(Q({},i),u),u=Dv.parts.field({tag:!0===e.multiline?"textarea":"input",inputAttributes:u,inputClasses:[e.classname],inputBehaviours:ec(nt([o,r])),selectOnFocus:!1,factory:qv}),o=(e.flex?["tox-form__group--stretched"]:[]).concat(e.maximized?["tox-form-group--maximize"]:[]),r=[Kg.config({disabled:function(){return e.disabled||n.isDisabled()},onDisabled:function(t){Dv.getField(t).each(Kg.disable)},onEnabled:function(t){Dv.getField(t).each(Kg.enable)}}),xp()];return Mv(t,u,o,r)},Ro=Object.freeze({__proto__:null,events:function(t,n){var e=t.stream.streams.setup(t,n);return qo([$o(t.event,e),ir(function(){return n.cancel()})].concat(t.cancelEvent.map(function(t){return[$o(t,function(){return n.cancel()})]}).getOr([])))}}),Kr=function(t){var n=Zn(null);return pi({readState:function(){return{timer:null!==n.get()?"set":"unset"}},setTimer:function(t){n.set(t)},cancel:function(){var t=n.get();null!==t&&t.cancel()}})},Ht=Object.freeze({__proto__:null,throttle:Kr,init:function(t){return t.stream.streams.state(t)}}),Ja=[An("stream",_n("mode",{throttle:[Bn("delay"),Un("stopEvent",!0),ha("streams",{setup:function(t,n){var e=t.stream,o=Sm(t.onStream,e.delay);return n.setTimer(o),function(t,n){o.throttle(t,n),e.stopEvent&&n.stop()}},state:Kr})]})),Un("event","input"),Hn("cancelEvent"),ga("onStream")],mw=rc({fields:Ja,name:"streaming",active:Ro,state:Ht}),gw=function(t,n,e){e=vl.getValue(e);vl.setValue(n,e),hw(n)},pw=function(t,n){var e=t.element,o=eu(e),t=e.dom;"number"!==Wr(e,"type")&&n(t,o)},hw=function(t){pw(t,function(t,n){return t.setSelectionRange(n.length,n.length)})},vw=function(t,n,o){if(t.selectsOver){var e=vl.getValue(n),r=t.getDisplayText(e),e=vl.getValue(o);return 0===t.getDisplayText(e).indexOf(r)?Z.some(function(){var e;gw(0,n,o),e=r.length,pw(n,function(t,n){return t.setSelectionRange(e,n.length)})}):Z.none()}return Z.none()},bw=U("alloy.typeahead.itemexecute"),t=U([Hn("lazySink"),Bn("fetch"),Un("minChars",5),Un("responseTime",1e3),da("onOpen"),Un("getHotspot",Z.some),Un("getAnchorOverrides",U({})),Un("layouts",Z.none()),Un("eventOrder",{}),Qn("model",{},[Un("getDisplayText",function(t){return t.meta!==undefined&&t.meta.text!==undefined?t.meta.text:t.value}),Un("selectsOver",!0),Un("populateFromBrowse",!0)]),da("onSetValue"),ma("onExecute"),da("onItemExecute"),Un("inputClasses",[]),Un("inputAttributes",{}),Un("inputStyles",{}),Un("matchWidth",!0),Un("useMinWidth",!1),Un("dismissOnBlur",!0),la(["openClass"]),Hn("initialData"),sr("typeaheadBehaviours",[Cd,vl,mw,hd,Fd,fb]),En("previewing",function(){return Zn(!0)})].concat(e()).concat(hu())),Kr=U([ge({schema:[sa()],name:"menu",overrides:function(o){return{fakeFocus:!0,onHighlight:function(n,e){o.previewing.get()?n.getSystem().getByUid(o.uid).each(function(t){vw(o.model,t,e).fold(function(){return pf.dehighlight(n,e)},function(t){return t()})}):n.getSystem().getByUid(o.uid).each(function(t){o.model.populateFromBrowse&&gw(o.model,t,e)}),o.previewing.set(!1)},onExecute:function(t,n){return t.getSystem().getByUid(o.uid).toOptional().map(function(t){return Wo(t,bw(),{item:n}),!0})},onHover:function(t,n){o.previewing.set(!1),t.getSystem().getByUid(o.uid).each(function(t){o.model.populateFromBrowse&&gw(o.model,t,n)})}}}})]),yw=pl({name:"Typeahead",configFields:t(),partFields:Kr(),factory:function(r,t,n,i){var e=function(t,n,e){r.previewing.set(!1);var o=fb.getCoupled(t,"sandbox");il.isOpen(o)?uf.getCurrent(o).each(function(t){pf.getHighlighted(t).fold(function(){e(t)},function(){Yo(o,t.element,"keydown",n)})}):xb(r,u(t),t,o,i,function(t){uf.getCurrent(t).each(e)},Kv.HighlightFirst).get($)},o=Xv(r),u=function(e){return function(t){return t.map(function(t){var n=It(t.menus),n=j(n,function(t){return P(t.items,function(t){return"item"===t.type})});return vl.getState(e).update(R(n,function(t){return t.data})),t})}},a=[Cd.config({}),vl.config({onSetValue:r.onSetValue,store:Q({mode:"dataset",getDataKey:function(t){return eu(t.element)},getFallbackEntry:function(t){return{value:t,meta:{}}},setValue:function(t,n){ou(t.element,r.model.getDisplayText(n))}},r.initialData.map(function(t){return ze("initialValue",t)}).getOr({}))}),mw.config({stream:{mode:"throttle",delay:r.responseTime,stopEvent:!1},onStream:function(t,n){var e,o=fb.getCoupled(t,"sandbox");Cd.isFocused(t)&&eu(t.element).length>=r.minChars&&(e=uf.getCurrent(o).bind(function(t){return pf.getHighlighted(t).map(vl.getValue)}),r.previewing.set(!0),xb(r,u(t),t,o,i,function(t){uf.getCurrent(o).each(function(t){e.fold(function(){r.model.selectsOver&&pf.highlightFirst(t)},function(n){pf.highlightBy(t,function(t){return vl.getValue(t).value===n.value}),pf.getHighlighted(t).orThunk(function(){return pf.highlightFirst(t),Z.none()})})})},Kv.HighlightFirst).get($))},cancelEvent:_o()}),hd.config({mode:"special",onDown:function(t,n){return e(t,n,pf.highlightFirst),Z.some(!0)},onEscape:function(t){t=fb.getCoupled(t,"sandbox");return il.isOpen(t)?(il.close(t),Z.some(!0)):Z.none()},onUp:function(t,n){return e(t,n,pf.highlightLast),Z.some(!0)},onEnter:function(n){var t=fb.getCoupled(n,"sandbox"),e=il.isOpen(t);if(e&&!r.previewing.get())return uf.getCurrent(t).bind(function(t){return pf.getHighlighted(t)}).map(function(t){return Wo(n,bw(),{item:t}),!0});var o=vl.getValue(n);return jo(n,_o()),r.onExecute(t,n,o),e&&il.close(t),Z.some(!0)}}),Fd.config({toggleClass:r.markers.openClass,aria:{mode:"expanded"}}),fb.config({others:{sandbox:function(t){return _b(r,t,{onOpen:function(){return Fd.on(t)},onClose:function(){return Fd.off(t)}})}}}),Sd("typeaheadevents",[ar(function(t){var n=$;Sb(r,u(t),t,i,n,Kv.HighlightFirst).get($)}),$o(bw(),function(t,n){var e=fb.getCoupled(t,"sandbox");gw(r.model,t,n.event.item),jo(t,_o()),r.onItemExecute(t,e,n.event.item,vl.getValue(t)),il.close(e),hw(t)})].concat(r.dismissOnBlur?[$o(bo(),function(t){t=fb.getCoupled(t,"sandbox");dc(t.element).isNone()&&il.close(t)})]:[]))];return{uid:r.uid,dom:Yv(zt(r,{inputAttributes:{role:"combobox","aria-autocomplete":"list","aria-haspopup":"true"}})),behaviours:Q(Q({},o),yl(r.typeaheadBehaviours,a)),eventOrder:r.eventOrder}}}),xw=function(i){return Q(Q({},i),{toCached:function(){return xw(i.toCached())},bindFuture:function(n){return xw(i.bind(function(t){return t.fold(function(t){return eb(at.error(t))},function(t){return n(t)})}))},bindResult:function(n){return xw(i.map(function(t){return t.bind(n)}))},mapResult:function(n){return xw(i.map(function(t){return t.map(n)}))},mapError:function(n){return xw(i.map(function(t){return t.mapError(n)}))},foldResult:function(n,e){return i.map(function(t){return t.fold(n,e)})},withTimeout:function(t,r){return xw(nb(function(n){var e=!1,o=setTimeout(function(){e=!0,n(at.error(r()))},t);i.get(function(t){e||(clearTimeout(o),n(t))})}))}})},ww=function(t){return xw(nb(t))},Ja=function(t){return xw(eb(at.value(t)))},Sw=ww,kw={type:"separator"},Cw=function(t){return{type:"menuitem",value:t.url,text:t.title,meta:{attach:t.attach},onAction:$}},Ow=function(t,n){return{type:"menuitem",value:n,text:t,meta:{attach:undefined},onAction:$}},_w=function(t,n){return e=t,n=P(n,function(t){return t.type===e}),R(n,Cw);var e},Tw=function(t,n){var e=t.toLowerCase();return P(n,function(t){var n=(t.meta!==undefined&&t.meta.text!==undefined?t.meta:t).text;return le(n.toLowerCase(),e)||le(t.value.toLowerCase(),e)})},Ew=function(e,t,o){var t=vl.getValue(t),r=t.meta.text!==undefined?t.meta.text:t.value;return o.getLinkInformation().fold(function(){return[]},function(t){var n,n=Tw(r,(n=o.getHistory(e),R(n,function(t){return Ow(t,t)})));return"file"===e?(t=[n,Tw(r,_w("header",t.targets)),Tw(r,nt([Z.from(t.anchorTop).map(function(t){return Ow("<top>",t)}).toArray(),_w("anchor",t.targets),Z.from(t.anchorBottom).map(function(t){return Ow("<bottom>",t)}).toArray()]))],z(t,function(t,n){return 0===t.length||0===n.length?t.concat(n):t.concat(kw,n)},[])):n})},Dw=Qr("aria-invalid"),Bw=function(r,n,e){var t,o,i,u,a=n.shared.providers,c=function(t){t=vl.getValue(t);e.addToHistory(t.value,r.filetype)},s=Dv.parts.field({factory:yw,dismissOnBlur:!0,inputClasses:["tox-textfield"],sandboxClasses:["tox-dialog__popups"],inputAttributes:{"aria-errormessage":Dw,type:"url"},minChars:0,responseTime:0,fetch:function(t){t=Ew(r.filetype,t,e),t=O0(t,$m.BUBBLE_TO_SANDBOX,n,!1);return eb(t)},getHotspot:function(t){return p.getOpt(t)},onSetValue:function(t,n){t.hasConfigured(lb)&&lb.run(t).get($)},typeaheadBehaviours:ec(nt([e.getValidationHandler().map(function(o){return lb.config({getRoot:function(t){return br(t.element)},invalidClass:"tox-control-wrap--status-invalid",notify:{onInvalid:function(t,n){f.getOpt(t).each(function(t){jr(t.element,"title",a.translate(n))})}},validator:{validate:function(t){var n=vl.getValue(t);return Sw(function(e){o({type:r.filetype,url:n.value},function(t){var n;"invalid"===t.status?(n=at.error(t.message),e(n)):(t=at.value(t.message),e(t))})})},validateOnLoad:!1}})}).toArray(),[Kg.config({disabled:function(){return r.disabled||a.isDisabled()}}),Bv.config({}),Sd("urlinput-events",nt(["file"===r.filetype?[$o(so(),function(t){Wo(t,Vv,{name:r.name})})]:[],[$o(lo(),function(t){Wo(t,Vv,{name:r.name}),c(t)}),$o(yo(),function(t){Wo(t,Vv,{name:r.name}),c(t)})]]))]])),eventOrder:((d={})[so()]=["streaming","urlinput-events","invalidating"],d),model:{getDisplayText:function(t){return t.value},selectsOver:!1,populateFromBrowse:!1},markers:{openClass:"tox-textfield--popup-open"},lazySink:n.shared.getSink,parts:{menu:dg(0,0,"normal")},onExecute:function(t,n,e){Wo(n,Lv,{})},onItemExecute:function(t,n,e,o){c(t),Wo(t,Vv,{name:r.name})}}),l=r.label.map(function(t){return Rv(t,a)}),f=hm((t="invalid",o=Z.some(Dw),void 0===u&&(u=t),{dom:{tag:"div",classes:["tox-icon","tox-control-wrap__status-icon-"+t],innerHtml:bm(i=void 0===(i="warning")?t:i,a.icons),attributes:Q({title:a.translate(u),"aria-live":"polite"},o.fold(function(){return{}},function(t){return{id:t}}))}})),d=hm({dom:{tag:"div",classes:["tox-control-wrap__status-icon-wrap"]},components:[f.asSpec()]}),m=e.getUrlPicker(r.filetype),g=Qr("browser.url.event"),p=hm({dom:{tag:"div",classes:["tox-control-wrap"]},components:[s,d.asSpec()],behaviours:ec([Kg.config({disabled:function(){return r.disabled||a.isDisabled()}})])}),h=hm(F0({name:r.name,icon:Z.some("browse"),text:r.label.getOr(""),disabled:r.disabled,primary:!1,borderless:!0},function(t){return jo(t,g)},a,[],["tox-browse-url"]));return Dv.sketch({dom:Iv([]),components:l.toArray().concat([{dom:{tag:"div",classes:["tox-form__controls-h-stack"]},components:nt([[p.asSpec()],m.map(function(){return h.asSpec()}).toArray()])}]),fieldBehaviours:ec([Kg.config({disabled:function(){return r.disabled||a.isDisabled()},onDisabled:function(t){Dv.getField(t).each(Kg.disable),h.getOpt(t).each(Kg.disable)},onEnabled:function(t){Dv.getField(t).each(Kg.enable),h.getOpt(t).each(Kg.enable)}}),xp(),Sd("url-input-events",[$o(g,function(o){uf.getCurrent(o).each(function(n){var t=vl.getValue(n),e=Q({fieldname:r.name},t);m.each(function(t){t(e).get(function(t){vl.setValue(n,t),Wo(o,Vv,{name:r.name})})})})})])])})},Aw=function(r){return function(n,e,o){return Rt(e,"name").fold(function(){return r(e,o)},function(t){return n.field(t,r(e,o))})}},Mw={bar:Aw(function(t,n){return n=n.shared,{dom:{tag:"div",classes:["tox-bar","tox-form__controls-h-stack"]},components:R(t.items,n.interpreter)}}),collection:Aw(function(t,n){return Gv(t,n.shared.providers)}),alertbanner:Aw(function(t,n){return e=t,n=n.shared.providers,Tv.sketch({dom:{tag:"div",attributes:{role:"alert"},classes:["tox-notification","tox-notification--in","tox-notification--"+e.level]},components:[{dom:{tag:"div",classes:["tox-notification__icon"]},components:[pm.sketch({dom:{tag:"button",classes:["tox-button","tox-button--naked","tox-button--icon"],innerHtml:bm(e.icon,n.icons),attributes:{title:n.translate(e.iconTooltip)}},action:function(t){Wo(t,zv,{name:"alert-banner",value:e.url})}})]},{dom:{tag:"div",classes:["tox-notification__body"],innerHtml:n.translate(e.text)}}]});var e}),input:Aw(function(t,n){return t=t,n=n.shared.providers,dw({name:t.name,multiline:!1,label:t.label,inputMode:t.inputMode,placeholder:t.placeholder,flex:!1,disabled:t.disabled,classname:"tox-textfield",validation:Z.none(),maximized:t.maximized},n)}),textarea:Aw(function(t,n){return t=t,n=n.shared.providers,dw({name:t.name,multiline:!0,label:t.label,inputMode:Z.none(),placeholder:t.placeholder,flex:!0,disabled:t.disabled,classname:"tox-textarea",validation:Z.none(),maximized:t.maximized},n)}),label:Aw(function(t,n){return e=t,t=n.shared,n={dom:{tag:"label",innerHtml:t.providers.translate(e.label),classes:["tox-label"]}},t=R(e.items,t.interpreter),{dom:{tag:"div",classes:["tox-form__group"]},components:[n].concat(t),behaviours:ec([Gy(),wd.config({}),ox(Z.none()),hd.config({mode:"acyclic"})])};var e}),iframe:(ow=function(t,n){return gx(t,n.shared.providers)},function(t,n,e){n=zt(n,{source:"dynamic"});return Aw(ow)(t,n,e)}),button:Aw(function(t,n){return V0(t,n.shared.providers)}),checkbox:Aw(function(t,n){return e=t,o=n.shared.providers,r=vl.config({store:{mode:"manual",getValue:function(t){return t.element.dom.checked},setValue:function(t,n){t.element.dom.checked=n}}}),t=function(t){return t.element.dom.click(),Z.some(!0)},n=Dv.parts.field({factory:{sketch:h},dom:{tag:"input",classes:["tox-checkbox__input"],attributes:{type:"checkbox"}},behaviours:ec([Gy(),Kg.config({disabled:function(){return e.disabled||o.isDisabled()}}),Bv.config({}),Cd.config({}),r,hd.config({mode:"special",onEnter:t,onSpace:t,stopSpaceKeyup:!0}),Sd("checkbox-events",[$o(lo(),function(t,n){Wo(t,Vv,{name:e.name})})])])}),r=Dv.parts.label({dom:{tag:"span",classes:["tox-checkbox__label"],innerHtml:o.translate(e.label)},behaviours:ec([Db.config({})])}),t=hm({dom:{tag:"div",classes:["tox-checkbox__icons"]},components:[(t=function(t){return{dom:{tag:"span",classes:["tox-icon","tox-checkbox-icon__"+t],innerHtml:bm("checked"===t?"selected":"unselected",o.icons)}}})("checked"),t("unchecked")]}),Dv.sketch({dom:{tag:"label",classes:["tox-checkbox"]},components:[n,t.asSpec(),r],fieldBehaviours:ec([Kg.config({disabled:function(){return e.disabled||o.isDisabled()},disableClass:"tox-checkbox--disabled",onDisabled:function(t){Dv.getField(t).each(Kg.disable)},onEnabled:function(t){Dv.getField(t).each(Kg.enable)}}),xp()])});var e,o,r}),colorinput:Aw(function(t,n){return Fb(t,n.shared,n.colorinput)}),colorpicker:Aw(function(t){var n=function(t){return"tox-"+t},n=Uy(Ky,n),o=hm(n.sketch({dom:{tag:"div",classes:["tox-color-picker-container"],attributes:{role:"presentation"}},onValidHex:function(t){Wo(t,zv,{name:"hex-valid",value:!0})},onInvalidHex:function(t){Wo(t,zv,{name:"hex-valid",value:!1})}}));return{dom:{tag:"div"},components:[o.asSpec()],behaviours:ec([vl.config({store:{mode:"manual",getValue:function(t){t=o.get(t);return uf.getCurrent(t).bind(function(t){return vl.getValue(t).hex}).map(function(t){return"#"+t}).getOr("")},setValue:function(t,n){var e=/^#([a-fA-F0-9]{3}(?:[a-fA-F0-9]{3})?)/.exec(n),t=o.get(t);uf.getCurrent(t).fold(function(){console.log("Can not find form")},function(t){vl.setValue(t,{hex:Z.from(e[1]).getOr("")}),Py.getField(t,"hex").each(function(t){jo(t,so())})})}}}),Gy()])}}),dropzone:Aw(function(t,n){return ix(t,n.shared.providers)}),grid:Aw(function(t,n){return n=n.shared,{dom:{tag:"div",classes:["tox-form__grid","tox-form__grid--"+t.columns+"col"]},components:R(t.items,n.interpreter)}}),listbox:Aw(function(t,n){return e=t,r=(o=n).shared.providers,i=J(e.items).filter(aw),t=e.label.map(function(t){return Rv(t,r)}),n={dom:{tag:"div",classes:["tox-listboxfield"]},components:[Dv.parts.field({dom:{},factory:{sketch:function(t){return y0({uid:t.uid,text:i.map(function(t){return t.text}),icon:Z.none(),tooltip:e.label,role:Z.none(),fetch:function(t,n){t=sw(t,e.name,e.items,vl.getValue(t));n(O0(t,$m.CLOSE_ON_EXECUTE,o,!1))},onSetup:U($),getApi:U({}),columns:1,presets:"normal",classes:[],dropdownBehaviours:[Bv.config({}),vl.config({store:{mode:"manual",initialValue:i.map(function(t){return t.value}).getOr(""),getValue:function(t){return Wr(t.element,cw)},setValue:function(n,t){lw(e.items,t).each(function(t){jr(n.element,cw,t.value),Wo(n,v0,{text:t.text})})}}})]},"tox-listbox",o.shared)}}})]},Dv.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:nt([t.toArray(),[n]]),fieldBehaviours:ec([Kg.config({disabled:U(e.disabled),onDisabled:function(t){Dv.getField(t).each(Kg.disable)},onEnabled:function(t){Dv.getField(t).each(Kg.enable)}})])});var e,o,r,i}),selectbox:Aw(function(t,n){return e=t,o=n.shared.providers,r=R(e.items,function(t){return{text:o.translate(t.text),value:t.value}}),t=e.label.map(function(t){return Rv(t,o)}),n=Dv.parts.field({dom:{},selectAttributes:{size:e.size},options:r,factory:fw,selectBehaviours:ec([Kg.config({disabled:function(){return e.disabled||o.isDisabled()}}),Bv.config({}),Sd("selectbox-change",[$o(lo(),function(t,n){Wo(t,Vv,{name:e.name})})])])}),r=1<e.size?Z.none():Z.some({dom:{tag:"div",classes:["tox-selectfield__icon-js"],innerHtml:bm("chevron-down",o.icons)}}),r={dom:{tag:"div",classes:["tox-selectfield"]},components:nt([[n],r.toArray()])},Dv.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:nt([t.toArray(),[r]]),fieldBehaviours:ec([Kg.config({disabled:function(){return e.disabled||o.isDisabled()},onDisabled:function(t){Dv.getField(t).each(Kg.disable)},onEnabled:function(t){Dv.getField(t).each(Kg.enable)}}),xp()])});var e,o,r}),sizeinput:Aw(function(t,n){return j0(t,n.shared.providers)}),urlinput:Aw(function(t,n){return Bw(t,n,n.urlinput)}),customeditor:Aw(function(e){var o=Zn(Z.none()),n=hm({dom:{tag:e.tag}}),r=Zn(Z.none());return{dom:{tag:"div",classes:["tox-custom-editor"]},behaviours:ec([Sd("custom-editor-events",[rr(function(t){n.getOpt(t).each(function(n){(Vt(e,"init")?e.init(n.element.dom):Jy.load(e.scriptId,e.scriptUrl).then(function(t){return t(n.element.dom,e.settings)})).then(function(n){r.get().each(function(t){n.setValue(t)}),r.set(Z.none()),o.set(Z.some(n))})})})]),vl.config({store:{mode:"manual",getValue:function(){return o.get().fold(function(){return r.get().getOr("")},function(t){return t.getValue()})},setValue:function(t,n){o.get().fold(function(){r.set(Z.some(n))},function(t){return t.setValue(n)})}}}),Gy()]),components:[n.asSpec()]}}),htmlpanel:Aw(function(t){return"presentation"===t.presets?Tv.sketch({dom:{tag:"div",classes:["tox-form__group"],innerHtml:t.html}}):Tv.sketch({dom:{tag:"div",classes:["tox-form__group"],innerHtml:t.html,attributes:{role:"document"}},containerBehaviours:ec([Bv.config({}),Cd.config({})])})}),imagetools:Aw(function(t,n){return uw(t,n.shared.providers)}),table:Aw(function(t,n){return o=t,e=n.shared.providers,r=function(t){return{dom:{tag:"td",innerHtml:e.translate(t)}}},t=function(t){return{dom:{tag:"tr"},components:R(t,r)}},{dom:{tag:"table",classes:["tox-dialog__table"]},components:[(n=o.header,{dom:{tag:"thead"},components:[{dom:{tag:"tr"},components:R(n,function(t){return{dom:{tag:"th",innerHtml:e.translate(t)}}})}]}),(o=o.cells,{dom:{tag:"tbody"},components:R(o,t)})],behaviours:ec([Bv.config({}),Cd.config({})])};var e,o,r}),panel:Aw(function(t,n){return{dom:{tag:"div",classes:t.classes},components:R(t.items,n.shared.interpreter)}})},Fw={field:function(t,n){return n}},Iw=function(n,t,e){var o=zt(e,{shared:{interpreter:function(t){return Rw(n,t,o)}}});return Rw(n,t,o)},Rw=function(n,e,o){return Rt(Mw,e.type).fold(function(){return console.error('Unknown factory type "'+e.type+'", defaulting to container: ',e),e},function(t){return t(n,e,o)})},Vw={valignCentre:[],alignCentre:[],alignLeft:[],alignRight:[],right:[],left:[],bottom:[],top:[]},Pw=function(t,n,e){var o={maxHeightFunction:Dc()};return function(){return e()?{anchor:"node",root:Tr(t()),node:Z.from(t()),bubble:Ic(12,12,Vw),layouts:{onRtl:function(){return[cm]},onLtr:function(){return[am]}},overrides:o}:{anchor:"hotspot",hotspot:n(),bubble:Ic(-12,12,Vw),layouts:{onRtl:function(){return[Va]},onLtr:function(){return[Pa]}},overrides:o}}},Hw=function(t,n,e){return function(){return e()?{anchor:"node",root:Tr(t()),node:Z.from(t()),layouts:{onRtl:function(){return[sm]},onLtr:function(){return[sm]}}}:{anchor:"hotspot",hotspot:n(),layouts:{onRtl:function(){return[Na]},onLtr:function(){return[Na]}}}}},zw=function(t,n,e){var o,r,i,u=dp(t),a=function(){return ne.fromDom(t.getBody())},c=function(){return ne.fromDom(t.getContentAreaContainer())},s=function(){return u||!e()};return{inlineDialog:Pw(c,n,s),banner:Hw(c,n,s),cursor:(r=t,function(){return{anchor:"selection",root:i(),getSelection:function(){var t=r.selection.getRng();return Z.some(rs.range(ne.fromDom(t.startContainer),t.startOffset,ne.fromDom(t.endContainer),t.endOffset))}}}),node:(o=i=a,function(t){return{anchor:"node",root:o(),node:t}})}},Lw=function(t){return{colorPicker:function(t,n){Ph(r)(t,n)},hasCustomColors:function(){return Oh(o)},getColors:function(){return _h(e)},getColorCols:(n=e=o=r=t,function(){return Dh(n)})};var n,e,o,r},Nw=[{title:"Headings",items:[{title:"Heading 1",format:"h1"},{title:"Heading 2",format:"h2"},{title:"Heading 3",format:"h3"},{title:"Heading 4",format:"h4"},{title:"Heading 5",format:"h5"},{title:"Heading 6",format:"h6"}]},{title:"Inline",items:[{title:"Bold",format:"bold"},{title:"Italic",format:"italic"},{title:"Underline",format:"underline"},{title:"Strikethrough",format:"strikethrough"},{title:"Superscript",format:"superscript"},{title:"Subscript",format:"subscript"},{title:"Code",format:"code"}]},{title:"Blocks",items:[{title:"Paragraph",format:"p"},{title:"Blockquote",format:"blockquote"},{title:"Div",format:"div"},{title:"Pre",format:"pre"}]},{title:"Align",items:[{title:"Left",format:"alignleft"},{title:"Center",format:"aligncenter"},{title:"Right",format:"alignright"},{title:"Justify",format:"alignjustify"}]}],jw=function(t){return z(t,function(t,n){if(Vt(n,"items")){var e=jw(n.items);return{customFormats:t.customFormats.concat(e.customFormats),formats:t.formats.concat([{title:n.title,items:e.formats}])}}if(Vt(n,"inline")||Vt(n,"block")||Vt(n,"selector")){e="custom-"+(v(n.name)?n.name:n.title.toLowerCase());return{customFormats:t.customFormats.concat([{name:e,format:n}]),formats:t.formats.concat([{title:n.title,format:e,icon:n.icon}])}}return Q(Q({},t),{formats:t.formats.concat(n)})},{customFormats:[],formats:[]})},Ww=function(r){return Z.from(r.getParam("style_formats")).filter(c).map(function(t){var n,e,o,t=(n=r,e=jw(t),o=function(t){tt(t,function(t){n.formatter.has(t.name)||n.formatter.register(t.name,t.format)})},n.formatter?o(e.customFormats):n.on("init",function(){o(e.customFormats)}),e.formats);return r.getParam("style_formats_merge",!1,"boolean")?Nw.concat(t):t}).getOr(Nw)},Uw=function(t,n,e){e={type:"formatter",isSelected:n(t.format),getStylePreview:e(t.format)};return zt(t,e)},Gw=function(o,t,r,i){var u=function(t){return R(t,function(t){var n=_t(t);if(Pt(t,"items")){var e=u(t.items);return zt(zt(t,{type:"submenu"}),{getStyleItems:U(e)})}return Pt(t,"format")?Uw(t,r,i):1===n.length&&A(n,"title")?zt(t,{type:"separator"}):(n=v((e=t).name)?e.name:Qr(e.title),t={type:"formatter",format:t="custom-"+n,isSelected:r(t),getStylePreview:i(t)},t=zt(e,t),o.formatter.register(n,t),t)})};return u(t)},Xw=$y.trim,Ro=function(e){return function(t){if(u(n=t)&&1===n.nodeType){if(t.contentEditable===e)return!0;if(t.getAttribute("data-mce-contenteditable")===e)return!0}var n;return!1}},Yw=Ro("true"),qw=Ro("false"),Kw=function(t,n,e,o,r){return{type:t,title:n,url:e,level:o,attach:r}},Jw=function(t){return t.innerText||t.textContent},$w=function(t){return(n=t)&&"A"===n.nodeName&&(n.id||n.name)!==undefined&&Zw(t);var n},Qw=function(t){return t&&/^(H[1-6])$/.test(t.nodeName)},Zw=function(t){return function(t){for(;t=t.parentNode;){var n=t.contentEditable;if(n&&"inherit"!==n)return Yw(t)}return!1}(t)&&!qw(t)},tS=function(t){return Qw(t)&&Zw(t)},nS=function(t){var n,e=t.id||Qr("h");return Kw("header",Jw(t),"#"+e,Qw(n=t)?parseInt(n.nodeName.substr(1),10):0,function(){t.id=e})},eS=function(t){var n=t.id||t.name,t=Jw(t);return Kw("anchor",t||"#"+n,"#"+n,0,$)},oS=function(t){var n;return n="h1,h2,h3,h4,h5,h6,a:not([href])",R(hs(ne.fromDom(t),n),function(t){return t.dom})},rS=function(t){return 0<Xw(t.title).length},iS=function(t){t=oS(t);return P(R(P(t,tS),nS).concat(R(P(t,$w),eS)),rS)},uS="tinymce-url-history",aS=function(t){return v(t)&&/^https?/.test(t)},cS=function(t){return b(t)&&Ft(t,function(t){return!(c(t=t)&&t.length<=5&&W(t,aS))}).isNone()},sS=function(){var t,n=yh.getItem(uS);if(null===n)return{};try{t=JSON.parse(n)}catch(e){if(e instanceof SyntaxError)return console.log("Local storage "+uS+" was not valid JSON",e),{};throw e}return cS(t)?t:(console.log("Local storage "+uS+" was not valid format",t),{})},lS=function(t){var n=sS();return Rt(n,t).getOr([])},fS=function(n,t){var e,o;aS(n)&&(e=sS(),o=Rt(e,t).getOr([]),o=P(o,function(t){return t!==n}),e[t]=[n].concat(o).slice(0,5),function(t){if(!cS(t))throw new Error("Bad format for history:\n"+JSON.stringify(t));yh.setItem(uS,JSON.stringify(t))}(e))},dS=function(t){return!!t},mS=function(t){return Dt($y.makeMap(t,/[, ]/),dS)},gS=function(t){return Z.from(t.getParam("file_picker_callback")).filter(l)},pS=function(t,n){var e,o,r,i,e=(e=t,o=Z.some(e.getParam("file_picker_types")).filter(dS),r=Z.some(e.getParam("file_browser_callback_types")).filter(dS),i=o.or(r).map(mS),gS(e).fold(d,function(t){return i.fold(S,function(t){return 0<_t(t).length&&t})}));return y(e)?e?gS(t):Z.none():e[n]?gS(t):Z.none()},hS=function(t){return Z.from(t).filter(v).getOrUndefined()},vS=function(t){return Z.from((t=(n=t).getParam("file_picker_validator_handler",undefined,"function"))===undefined?n.getParam("filepicker_validator_handler",undefined,"function"):t);var n},bS=function(n){return{getHistory:lS,addToHistory:fS,getLinkInformation:function(){return!1===(t=n).getParam("typeahead_urls")?Z.none():Z.some({targets:iS(t.getBody()),anchorTop:hS(t.getParam("anchor_top","#top")),anchorBottom:hS(t.getParam("anchor_bottom","#bottom"))});var t},getValidationHandler:function(){return vS(n)},getUrlPicker:function(t){return pS(r=n,i=t).map(function(o){return function(n){return nb(function(e){var t=Q({filetype:i,fieldname:n.fieldname},Z.from(n.meta).getOr({}));o.call(r,function(t,n){if(!v(t))throw new Error("Expected value to be string");if(n!==undefined&&!b(n))throw new Error("Expected meta to be a object");e({value:t,meta:n})},n.value,t)})}});var r,i}}},yS=function(t,n,e){var o,r,i=Zn(!1),u={isPositionedAtTop:function(){return"top"===o.get()},getDockingMode:(o=Zn(lp(n)?"bottom":"top")).get,setDockingMode:o.set},a={shared:{providers:{icons:function(){return n.ui.registry.getAll().icons},menuItems:function(){return n.ui.registry.getAll().menuItems},translate:Hg.translate,isDisabled:function(){return n.mode.isReadOnly()||n.ui.isDisabled()},getSetting:n.getParam.bind(n)},interpreter:function(t){return Rw(Fw,t,a)},anchors:zw(n,e,u.isPositionedAtTop),header:u,getSink:function(){return at.value(t)}},urlinput:bS(n),styleselect:function(e){var o=function(t){return function(){return e.formatter.match(t)}},r=function(n){return function(){var t=e.formatter.get(n);return t!==undefined?Z.some({tag:0<t.length&&(t[0].inline||t[0].block)||"div",styles:e.dom.parseStyle(e.formatter.getCssText(n))}):Z.none()}},i=function(t){var n=t.items;return n!==undefined&&0<n.length?j(n,i):[t.format]},u=Zn([]),a=Zn([]),c=Zn([]),s=Zn([]),l=Zn(!1);e.on("PreInit",function(t){var n=Ww(e),n=Gw(e,n,o,r);u.set(n),a.set(j(n,i))}),e.on("addStyleModifications",function(t){var n=Gw(e,t.items,o,r);c.set(n),l.set(t.replace),s.set(j(n,i))});return{getData:function(){var t=l.get()?[]:u.get(),n=c.get();return t.concat(n)},getFlattenedKeys:function(){var t=l.get()?[]:a.get(),n=s.get();return t.concat(n)}}}(n),colorinput:Lw(n),dialog:{isDraggableModal:(r=n,function(){return r.getParam("draggable_modal",!1,"boolean")})},isContextMenuOpen:function(){return i.get()},setContextMenuState:function(t){return i.set(t)}};return a},xS=U(function(t,n){!function(t,n){n=Ou.max(t,n,["margin-left","border-left-width","padding-left","padding-right","border-right-width","margin-right"]);Yi(t,"max-width",n+"px")}(t,Math.floor(n))}),wS="contexttoolbar-hide",Ht=U([Bn("dom"),Un("shell",!0),sr("toolbarBehaviours",[wd])]),e=U([Il({name:"groups",overrides:function(){return{behaviours:ec([wd.config({})])}}})]),SS=pl({name:"Toolbar",configFields:Ht(),partFields:e(),factory:function(n,t,e,o){var r=function(t){return n.shell?Z.some(t):Ul(t,n,"groups")},t=n.shell?{behaviours:[wd.config({})],components:[]}:{behaviours:[],components:t};return{uid:n.uid,dom:n.dom,components:t.components,behaviours:yl(n.toolbarBehaviours,t.behaviours),apis:{setGroups:function(t,n){r(t).fold(function(){throw console.error("Toolbar was defined to not be a shell, but no groups container was specified in components"),new Error("Toolbar was defined to not be a shell, but no groups container was specified in components")},function(t){wd.set(t,n)})}},domModification:{attributes:{role:"group"}}}},apis:{setGroups:function(t,n,e){t.setGroups(n,e)}}}),kS=function(t,n,e){return{within:t,extra:n,withinWidth:e}},CS=function(t,n,o){var e,r=(e=function(t,n){var e=o(t);return Z.some({element:t,start:n,finish:n+e,width:e})},z(t,function(n,t){return e(t,n.len).fold(U(n),function(t){return{len:t.finish,list:n.list.concat([t])}})},{len:0,list:[]}).list),i=P(r,function(t){return t.finish<=n}),t=H(i,function(t,n){return t+n.width},0);return{within:i,extra:r.slice(i.length),withinWidth:t}},OS=function(t){return R(t,function(t){return t.element})},_S=function(t,n,e,o){var r=function(t,n,e){e=CS(n,t,e);return 0===e.extra.length?Z.some(e):Z.none()}(t,n,e).getOrThunk(function(){return CS(n,t-e(o),e)}),i=r.within,u=r.extra,r=r.withinWidth;return 1===u.length&&u[0].width<=e(o)?function(t,n,e){n=OS(t.concat(n));return kS(n,[],e)}(i,u,r):1<=u.length?function(t,n,e,o){e=OS(t).concat([e]);return kS(e,OS(n),o)}(i,u,o,r):(r=r,kS(OS(i),[],r))},TS=function(t,n){n=R(n,function(t){return pu(t)});SS.setGroups(t,n)},ES=function(t,n,e){var o,r,i=n.builtGroups.get();0!==i.length&&(o=Gl(t,n,"primary"),r=fb.getCoupled(t,"overflowGroup"),Yi(o.element,"visibility","hidden"),t=i.concat([r]),i=rt(t,function(n){return dc(n.element).bind(function(t){return n.getSystem().getByDom(t).toOptional()})}),e([]),TS(o,t),t=_u(o.element),0===(n=_S(t,n.builtGroups.get(),function(t){return _u(t.element)},r)).extra.length?(wd.remove(o,r),e([])):(TS(o,n.within),e(n.extra)),tu(o.element,"visibility"),nu(o.element),i.each(Cd.focus))},t=U([sr("splitToolbarBehaviours",[fb]),En("builtGroups",function(){return Zn([])})]),Kr=U([la(["overflowToggledClass"]),jn("getOverflowBounds"),Bn("lazySink"),En("overflowGroups",function(){return Zn([])})].concat(t())),Ja=U([Fl({factory:SS,schema:Ht(),name:"primary"}),ge({schema:Ht(),name:"overflow"}),ge({name:"overflow-button"}),ge({name:"overflow-group"})]),Ro=U([la(["toggledClass"]),Bn("lazySink"),In("fetch"),jn("getBounds"),Wn("fireDismissalEventInstead",[Un("event",Io())]),pe()]),e=U([ge({name:"button",overrides:function(t){return{dom:{attributes:{"aria-haspopup":"true"}},buttonBehaviours:ec([Fd.config({toggleClass:t.markers.toggledClass,aria:{mode:"expanded"},toggleOnExecute:!1})])}}}),ge({factory:SS,schema:Ht(),name:"toolbar",overrides:function(n){return{toolbarBehaviours:ec([hd.config({mode:"cyclic",onEscape:function(t){return Ul(t,n,"button").each(Cd.focus),Z.none()}})])}}})]),DS=function(t,n){t=fb.getCoupled(t,"toolbarSandbox");il.isOpen(t)?il.close(t):il.open(t,n.toolbar())},BS=function(t,n,e,o){var r=e.getBounds.map(function(t){return t()}),e=e.lazySink(t).getOrDie();Ls.positionWithinBounds(e,{anchor:"hotspot",hotspot:t,layouts:o,overrides:{maxWidthFunction:xS()}},n,r)},AS=function(t,n,e,o,r){SS.setGroups(n,r),BS(t,n,e,o),Fd.on(t)},MS=pl({name:"FloatingToolbarButton",factory:function(u,t,a,n){return Q(Q({},pm.sketch(Q(Q({},n.button()),{action:function(t){DS(t,n)},buttonBehaviours:wl({dump:n.button().buttonBehaviours},[fb.config({others:{toolbarSandbox:function(t){return o=t,e=a,r=u,{dom:{tag:"div",attributes:{id:(i=Ju()).id}},behaviours:ec([hd.config({mode:"special",onEscape:function(t){return il.close(t),Z.some(!0)}}),il.config({onOpen:function(t,n){r.fetch().get(function(t){AS(o,n,r,e.layouts,t),i.link(o.element),hd.focusIn(n)})},onClose:function(){Fd.off(o),Cd.focus(o),i.unlink(o.element)},isPartOf:function(t,n,e){return Qu(n,e)||Qu(o,e)},getAttachPoint:function(){return r.lazySink(o).getOrDie()}}),cc.config({channels:Q(Q({},ll(Q({isExtraPart:d},r.fireDismissalEventInstead.map(function(t){return{fireEventInstead:{event:t.event}}}).getOr({})))),dl({doReposition:function(){il.getState(fb.getCoupled(o,"toolbarSandbox")).each(function(t){BS(o,t,r,e.layouts)})}}))})])};var o,e,r,i}}})])}))),{apis:{setGroups:function(n,e){il.getState(fb.getCoupled(n,"toolbarSandbox")).each(function(t){AS(n,t,u,a.layouts,e)})},reposition:function(n){il.getState(fb.getCoupled(n,"toolbarSandbox")).each(function(t){BS(n,t,u,a.layouts)})},toggle:function(t){DS(t,n)},getToolbar:function(t){return il.getState(fb.getCoupled(t,"toolbarSandbox"))},isOpen:function(t){return il.isOpen(fb.getCoupled(t,"toolbarSandbox"))}}})},configFields:Ro(),partFields:e(),apis:{setGroups:function(t,n,e){t.setGroups(n,e)},reposition:function(t,n){t.reposition(n)},toggle:function(t,n){t.toggle(n)},getToolbar:function(t,n){return t.getToolbar(n)},isOpen:function(t,n){return t.isOpen(n)}}}),Ro=U([Bn("items"),la(["itemSelector"]),sr("tgroupBehaviours",[hd])]),e=U([fn({name:"items",unit:"item"})]),FS=pl({name:"ToolbarGroup",configFields:Ro(),partFields:e(),factory:function(t,n,e,o){return{uid:t.uid,dom:t.dom,components:n,behaviours:yl(t.tgroupBehaviours,[hd.config({mode:"flow",selector:t.markers.itemSelector})]),domModification:{attributes:{role:"toolbar"}}}}}),IS=function(t){return R(t,function(t){return pu(t)})},RS=function(t,e,o){ES(t,o,function(n){o.overflowGroups.set(n),e.getOpt(t).each(function(t){MS.setGroups(t,IS(n))})})},VS=pl({name:"SplitFloatingToolbar",configFields:Kr(),partFields:Ja(),factory:function(e,t,n,o){var r=hm(MS.sketch({fetch:function(){return nb(function(t){t(IS(e.overflowGroups.get()))})},layouts:{onLtr:function(){return[Pa,Va]},onRtl:function(){return[Va,Pa]},onBottomLtr:function(){return[za,Ha]},onBottomRtl:function(){return[Ha,za]}},getBounds:n.getOverflowBounds,lazySink:e.lazySink,fireDismissalEventInstead:{},markers:{toggledClass:e.markers.overflowToggledClass},parts:{button:o["overflow-button"](),toolbar:o.overflow()}}));return{uid:e.uid,dom:e.dom,components:t,behaviours:yl(e.splitToolbarBehaviours,[fb.config({others:{overflowGroup:function(){return FS.sketch(Q(Q({},o["overflow-group"]()),{items:[r.asSpec()]}))}}})]),apis:{setGroups:function(t,n){e.builtGroups.set(R(n,t.getSystem().build)),RS(t,r,e)},refresh:function(t){return RS(t,r,e)},toggle:function(t){r.getOpt(t).each(function(t){MS.toggle(t)})},isOpen:function(t){return r.getOpt(t).map(MS.isOpen).getOr(!1)},reposition:function(t){r.getOpt(t).each(function(t){MS.reposition(t)})},getOverflow:function(t){return r.getOpt(t).bind(MS.getToolbar)}},domModification:{attributes:{role:"group"}}}},apis:{setGroups:function(t,n,e){t.setGroups(n,e)},refresh:function(t,n){t.refresh(n)},reposition:function(t,n){t.reposition(n)},toggle:function(t,n){t.toggle(n)},isOpen:function(t,n){return t.isOpen(n)},getOverflow:function(t,n){return t.getOverflow(n)}}}),PS=function(n,t){return t.getAnimationRoot.fold(function(){return n.element},function(t){return t(n)})},HS=function(t){return t.dimension.property},zS=function(t,n){return t.dimension.getDimension(n)},LS=function(t,n){t=PS(t,n);Vi(t,[n.shrinkingClass,n.growingClass])},NS=function(t,n){Fi(t.element,n.openClass),Ai(t.element,n.closedClass),Yi(t.element,HS(n),"0px"),nu(t.element)},jS=function(t,n){Fi(t.element,n.closedClass),Ai(t.element,n.openClass),tu(t.element,HS(n))},WS=function(t,n,e,o){e.setCollapsed(),Yi(t.element,HS(n),zS(n,t.element)),nu(t.element),LS(t,n),NS(t,n),n.onStartShrink(t),n.onShrunk(t)},US=function(t,n,e,o){o=o.getOrThunk(function(){return zS(n,t.element)});e.setCollapsed(),Yi(t.element,HS(n),o),nu(t.element);o=PS(t,n);Fi(o,n.growingClass),Ai(o,n.shrinkingClass),NS(t,n),n.onStartShrink(t)},GS=function(t,n,e){var o=zS(n,t.element);("0px"===o?WS:US)(t,n,e,Z.some(o))},XS=function(t,n,e){var o=PS(t,n),r=Ii(o,n.shrinkingClass),i=zS(n,t.element);jS(t,n);var u=zS(n,t.element);(r?function(){Yi(t.element,HS(n),i),nu(t.element)}:function(){NS(t,n)})(),Fi(o,n.shrinkingClass),Ai(o,n.growingClass),jS(t,n),Yi(t.element,HS(n),u),e.setExpanded(),n.onStartGrow(t)},YS=function(t,n,e){t=PS(t,n);return!0===Ii(t,n.growingClass)},qS=function(t,n,e){t=PS(t,n);return!0===Ii(t,n.shrinkingClass)},e=Object.freeze({__proto__:null,refresh:function(t,n,e){e.isExpanded()&&(tu(t.element,HS(n)),e=zS(n,t.element),Yi(t.element,HS(n),e))},grow:function(t,n,e){e.isExpanded()||XS(t,n,e)},shrink:function(t,n,e){e.isExpanded()&&GS(t,n,e)},immediateShrink:function(t,n,e){e.isExpanded()&&WS(t,n,e,Z.none())},hasGrown:function(t,n,e){return e.isExpanded()},hasShrunk:function(t,n,e){return e.isCollapsed()},isGrowing:YS,isShrinking:qS,isTransitioning:function(t,n,e){return YS(t,n)||qS(t,n)},toggleGrow:function(t,n,e){(e.isExpanded()?GS:XS)(t,n,e)},disableTransitions:LS}),Kr=Object.freeze({__proto__:null,exhibit:function(t,n,e){var o=n.expanded;return vi(o?{classes:[n.openClass],styles:{}}:{classes:[n.closedClass],styles:ze(n.dimension.property,"0px")})},events:function(e,o){return qo([or(mo(),function(t,n){n.event.raw.propertyName===e.dimension.property&&(LS(t,e),o.isExpanded()&&tu(t.element,e.dimension.property),(o.isExpanded()?e.onGrown:e.onShrunk)(t))})])}}),Ja=[Bn("closedClass"),Bn("openClass"),Bn("shrinkingClass"),Bn("growingClass"),Hn("getAnimationRoot"),da("onShrunk"),da("onStartShrink"),da("onGrown"),da("onStartGrow"),Un("expanded",!1),An("dimension",_n("property",{width:[ha("property","width"),ha("getDimension",function(t){return _u(t)+"px"})],height:[ha("property","height"),ha("getDimension",function(t){return bu(t)+"px"})]}))],KS=rc({fields:Ja,name:"sliding",active:Kr,apis:e,state:Object.freeze({__proto__:null,init:function(t){var n=Zn(t.expanded);return pi({isExpanded:function(){return!0===n.get()},isCollapsed:function(){return!1===n.get()},setCollapsed:x(n.set,!1),setExpanded:x(n.set,!0),readState:function(){return"expanded: "+n.get()}})}})}),t=U([la(["closedClass","openClass","shrinkingClass","growingClass","overflowToggledClass"]),da("onOpened"),da("onClosed")].concat(t())),Ht=U([Fl({factory:SS,schema:Ht(),name:"primary"}),Fl({factory:SS,schema:Ht(),name:"overflow",overrides:function(n){return{toolbarBehaviours:ec([KS.config({dimension:{property:"height"},closedClass:n.markers.closedClass,openClass:n.markers.openClass,shrinkingClass:n.markers.shrinkingClass,growingClass:n.markers.growingClass,onShrunk:function(t){Ul(t,n,"overflow-button").each(function(t){Fd.off(t),Cd.focus(t)}),n.onClosed(t)},onGrown:function(t){hd.focusIn(t),n.onOpened(t)},onStartGrow:function(t){Ul(t,n,"overflow-button").each(Fd.on)}}),hd.config({mode:"acyclic",onEscape:function(t){return Ul(t,n,"overflow-button").each(Cd.focus),Z.some(!0)}})])}}}),ge({name:"overflow-button",overrides:function(t){return{buttonBehaviours:ec([Fd.config({toggleClass:t.markers.overflowToggledClass,aria:{mode:"pressed"},toggleOnExecute:!1})])}}}),ge({name:"overflow-group"})]),JS=function(n,e){Ul(n,e,"overflow-button").bind(function(){return Ul(n,e,"overflow")}).each(function(t){$S(n,e),KS.toggleGrow(t)})},$S=function(t,e){Ul(t,e,"overflow").each(function(n){ES(t,e,function(t){t=R(t,function(t){return pu(t)});SS.setGroups(n,t)}),Ul(t,e,"overflow-button").each(function(t){KS.hasGrown(n)&&Fd.on(t)}),KS.refresh(n)})},QS=pl({name:"SplitSlidingToolbar",configFields:t(),partFields:Ht(),factory:function(e,t,n,o){var r="alloy.toolbar.toggle";return{uid:e.uid,dom:e.dom,components:t,behaviours:yl(e.splitToolbarBehaviours,[fb.config({others:{overflowGroup:function(n){return FS.sketch(Q(Q({},o["overflow-group"]()),{items:[pm.sketch(Q(Q({},o["overflow-button"]()),{action:function(t){jo(n,r)}}))]}))}}}),Sd("toolbar-toggle-events",[$o(r,function(t){JS(t,e)})])]),apis:{setGroups:function(t,n){!function(t,n){t=R(n,t.getSystem().build);e.builtGroups.set(t)}(t,n),$S(t,e)},refresh:function(t){return $S(t,e)},toggle:function(t){return JS(t,e)},isOpen:function(t){return Ul(t,e,"overflow").map(KS.hasGrown).getOr(!1)}},domModification:{attributes:{role:"group"}}}},apis:{setGroups:function(t,n,e){t.setGroups(n,e)},refresh:function(t,n){t.refresh(n)},toggle:function(t,n){t.toggle(n)},isOpen:function(t,n){return t.isOpen(n)}}}),ZS=U(Qr("toolbar-height-change")),tk=function(t){var n=t.title.fold(function(){return{}},function(t){return{attributes:{title:t}}});return{dom:Q({tag:"div",classes:["tox-toolbar__group"]},n),components:[FS.parts.items({})],items:t.items,markers:{itemSelector:"*:not(.tox-split-button) > .tox-tbtn:not([disabled]), .tox-split-button:not([disabled]), .tox-toolbar-nav-js:not([disabled])"},tgroupBehaviours:ec([Bv.config({}),Cd.config({})])}},nk=function(t){return FS.sketch(tk(t))},ek=function(e,t){var n=rr(function(t){var n=R(e.initGroups,nk);SS.setGroups(t,n)});return ec([Cp(e.providers.isDisabled),xp(),hd.config({mode:t,onEscape:e.onEscape,selector:".tox-toolbar__group"}),Sd("toolbar-events",[n])])},ok=function(t){var n=t.cyclicKeying?"cyclic":"acyclic";return{uid:t.uid,dom:{tag:"div",classes:["tox-toolbar-overlord"]},parts:{"overflow-group":tk({title:Z.none(),items:[]}),"overflow-button":B0({name:"more",icon:Z.some("more-drawer"),disabled:!1,tooltip:Z.some("More..."),primary:!1,borderless:!1},Z.none(),t.providers)},splitToolbarBehaviours:ek(t,n)}},rk=function(o){var t=ok(o),n=VS.parts.primary({dom:{tag:"div",classes:["tox-toolbar__primary"]}});return VS.sketch(Q(Q({},t),{lazySink:o.getSink,getOverflowBounds:function(){var t=o.moreDrawerData.lazyHeader().element,n=Lu(t),e=hr(t),t=Lu(e),e=Math.max(e.dom.scrollHeight,t.height);return Hu(n.x+4,t.y,n.width-8,e)},parts:Q(Q({},t.parts),{overflow:{dom:{tag:"div",classes:["tox-toolbar__overflow"],attributes:o.attributes}}}),components:[n],markers:{overflowToggledClass:"tox-tbtn--enabled"}}))},ik=function(t){var n=QS.parts.primary({dom:{tag:"div",classes:["tox-toolbar__primary"]}}),e=QS.parts.overflow({dom:{tag:"div",classes:["tox-toolbar__overflow"]}}),t=ok(t);return QS.sketch(Q(Q({},t),{components:[n,e],markers:{openClass:"tox-toolbar__overflow--open",closedClass:"tox-toolbar__overflow--closed",growingClass:"tox-toolbar__overflow--growing",shrinkingClass:"tox-toolbar__overflow--shrinking",overflowToggledClass:"tox-tbtn--enabled"},onOpened:function(t){t.getSystem().broadcastOn([ZS()],{type:"opened"})},onClosed:function(t){t.getSystem().broadcastOn([ZS()],{type:"closed"})}}))},uk=function(t){var n=t.cyclicKeying?"cyclic":"acyclic";return SS.sketch({uid:t.uid,dom:{tag:"div",classes:["tox-toolbar"].concat(t.type===Jm.scrolling?["tox-toolbar--scrolling"]:[])},components:[SS.parts.groups({})],toolbarBehaviours:ek(t,n)})},ak=rn([Mn("type"),An("items",an([sn([Mn("name"),Pn("items",mn)]),mn]))].concat(Oi)),Ht=[Nn("text"),Nn("tooltip"),Nn("icon"),In("fetch"),Jn("onSetup",function(){return $})],ck=rn(p([Mn("type")],Ht)),sk=function(t){return Sn("menubutton",ck,t)},lk=rn([Mn("type"),Nn("tooltip"),Nn("icon"),Nn("text"),jn("select"),In("fetch"),Jn("onSetup",function(){return $}),qn("presets","normal",["normal","color","listpreview"]),Un("columns",1),In("onAction"),In("onItemAction")]),Oi=Object.freeze({__proto__:null,events:function(o,r){var i=function(n,e){o.updateState.each(function(t){t=t(n,e);r.set(t)}),o.renderComponents.each(function(t){t=t(e,r.get()),t=R(t,n.getSystem().build);Us(n,t)})};return qo([$o(xo(),function(t,n){var e=n;e.universal||(n=o.channel,A(e.channels,n)&&i(t,e.data))}),rr(function(n,t){o.initialData.each(function(t){i(n,t)})})])}}),Ht=Object.freeze({__proto__:null,getState:function(t,n,e){return e}}),jn=[Bn("channel"),Hn("renderComponents"),Hn("updateState"),Hn("initialData")],fk=rc({fields:jn,name:"reflecting",active:Oi,apis:Ht,state:Object.freeze({__proto__:null,init:function(){var n=Zn(Z.none());return{readState:function(){return n.get().fold(U("none"),h)},get:function(){return n.get()},set:function(t){return n.set(t)},clear:function(){return n.set(Z.none())}}}})}),pe=U([Bn("toggleClass"),Bn("fetch"),ga("onExecute"),Un("getHotspot",Z.some),Un("getAnchorOverrides",U({})),pe(),ga("onItemExecute"),Hn("lazySink"),Bn("dom"),da("onOpen"),sr("splitDropdownBehaviours",[fb,hd,Cd]),Un("matchWidth",!1),Un("useMinWidth",!1),Un("eventOrder",{}),Hn("role")].concat(hu())),ga=Fl({factory:pm,schema:[Bn("dom")],name:"arrow",defaults:function(){return{buttonBehaviours:ec([Cd.revoke()])}},overrides:function(n){return{dom:{tag:"span",attributes:{role:"presentation"}},action:function(t){t.getSystem().getByUid(n.uid).each(Uo)},buttonBehaviours:ec([Fd.config({toggleOnExecute:!1,toggleClass:n.toggleClass})])}}}),hu=Fl({factory:pm,schema:[Bn("dom")],name:"button",defaults:function(){return{buttonBehaviours:ec([Cd.revoke()])}},overrides:function(e){return{dom:{tag:"span",attributes:{role:"presentation"}},action:function(n){n.getSystem().getByUid(e.uid).each(function(t){e.onExecute(t,n)})}}}}),hu=U([ga,hu,Il({factory:{sketch:function(t){return{uid:t.uid,dom:{tag:"span",styles:{display:"none"},attributes:{"aria-hidden":"true"},innerHtml:t.text}}}},schema:[Bn("text")],name:"aria-descriptor"}),ge({schema:[sa()],name:"menu",defaults:function(o){return{onExecute:function(n,e){n.getSystem().getByUid(o.uid).each(function(t){o.onItemExecute(t,n,e)})}}}}),C()]),dk=pl({name:"SplitDropdown",configFields:pe(),partFields:hu(),factory:function(o,t,n,e){var r=function(t){uf.getCurrent(t).each(function(t){pf.highlightFirst(t),hd.focusIn(t)})},i=function(t){Sb(o,h,t,e,r,Kv.HighlightFirst).get($)},u=function(t){t=Gl(t,o,"button");return Uo(t),Z.some(!0)},a=Q(Q({},qo([rr(function(e,t){Ul(e,o,"aria-descriptor").each(function(t){var n=Qr("aria");jr(t.element,"id",n),jr(e.element,"aria-describedby",n)})})])),Rd(Z.some(i)));return{uid:o.uid,dom:o.dom,components:t,apis:{repositionMenus:function(t){Fd.isOn(t)&&Tb(t)}},eventOrder:Q(Q({},o.eventOrder),((t={})[wo()]=["disabling","toggling","alloy.base.behaviour"],t)),events:a,behaviours:yl(o.splitDropdownBehaviours,[fb.config({others:{sandbox:function(t){var n=Gl(t,o,"arrow");return _b(o,t,{onOpen:function(){Fd.on(n),Fd.on(t)},onClose:function(){Fd.off(n),Fd.off(t)}})}}}),hd.config({mode:"special",onSpace:u,onEnter:u,onDown:function(t){return i(t),Z.some(!0)}}),Cd.config({}),Fd.config({toggleOnExecute:!1,aria:{mode:"expanded"}})]),domModification:{attributes:{role:o.role.getOr("button"),"aria-haspopup":!0}}}},apis:{repositionMenus:function(t,n){return t.repositionMenus(n)}}}),mk=function(n){return{isDisabled:function(){return Kg.isDisabled(n)},setDisabled:function(t){return Kg.set(n,t)}}},gk=function(n){return{setActive:function(t){Fd.set(n,t)},isActive:function(){return Fd.isOn(n)},isDisabled:function(){return Kg.isDisabled(n)},setDisabled:function(t){return Kg.set(n,t)}}},pk=function(t,n){return t.map(function(t){return{"aria-label":n.translate(t),title:n.translate(t)}}).getOr({})},hk=Qr("focus-button"),vk=["checklist","ordered-list"],bk=["indent","outdent","table-insert-column-after","table-insert-column-before","unordered-list"],yk=function(n,e,t,o,r,i){var u=function(t){return Hg.isRtl()&&A(vk,t)?t+"-rtl":t},a=Hg.isRtl()&&n.exists(function(t){return A(bk,t)});return{dom:{tag:"button",classes:["tox-tbtn"].concat(e.isSome()?["tox-tbtn--select"]:[]).concat(a?["tox-tbtn__icon-rtl"]:[]),attributes:pk(t,i)},components:Dp([n.map(function(t){return d0(u(t),i.icons)}),e.map(function(t){return g0(t,"tox-tbtn",i)})]),eventOrder:((t={})[to()]=["focusing","alloy.base.behaviour","common-button-display-events"],t),buttonBehaviours:ec([Cp(i.isDisabled),xp(),Sd("common-button-display-events",[$o(to(),function(t,n){n.event.prevent(),jo(t,hk)})])].concat(o.map(function(t){return fk.config({channel:t,initialData:{icon:n,text:e},renderComponents:function(t,n){return Dp([t.icon.map(function(t){return d0(u(t),i.icons)}),t.text.map(function(t){return g0(t,"tox-tbtn",i)})])}})}).toArray()).concat(r.getOr([])))}},xk=function(t,n,e){var o,r=Zn($),i=yk(t.icon,t.text,t.tooltip,Z.none(),Z.none(),e);return pm.sketch({dom:i.dom,components:i.components,eventOrder:h0,buttonBehaviours:ec([Sd("toolbar-button-events",[(o={onAction:t.onAction,getApi:n.getApi},ar(function(n,t){Op(o,n)(function(t){Wo(n,p0,{buttonApi:t}),o.onAction(t)})})),_p(n,r),Tp(n,r)]),Cp(function(){return t.disabled||e.isDisabled()}),xp()].concat(n.toolbarButtonBehaviours))})},wk=function(t,n,e){return xk(t,{toolbarButtonBehaviours:[].concat(0<e.length?[Sd("toolbarButtonWith",e)]:[]),getApi:mk,onSetup:t.onSetup},n)},Sk=function(t,n,e){return zt(xk(t,{toolbarButtonBehaviours:[wd.config({}),Fd.config({toggleClass:"tox-tbtn--enabled",aria:{mode:"pressed"},toggleOnExecute:!1})].concat(0<e.length?[Sd("toolbarToggleButtonWith",e)]:[]),getApi:gk,onSetup:t.onSetup},n))},kk=function(n,t){var e,o,r,i=Qr("channel-update-split-dropdown-display"),u=function(e){return{isDisabled:function(){return Kg.isDisabled(e)},setDisabled:function(t){return Kg.set(e,t)},setIconFill:function(t,n){qu(e.element,'svg path[id="'+t+'"], rect[id="'+t+'"]').each(function(t){jr(t,"fill",n)})},setIconStroke:function(t,n){qu(e.element,'svg path[id="'+t+'"], rect[id="'+t+'"]').each(function(t){jr(t,"stroke",n)})},setActive:function(n){jr(e.element,"aria-pressed",n),qu(e.element,"span").each(function(t){e.getSystem().getByDom(t).each(function(t){return Fd.set(t,n)})})},isActive:function(){return qu(e.element,"span").exists(function(t){return e.getSystem().getByDom(t).exists(Fd.isOn)})}}},a=Zn($),c={getApi:u,onSetup:n.onSetup};return dk.sketch({dom:{tag:"div",classes:["tox-split-button"],attributes:Q({"aria-pressed":!1},pk(n.tooltip,t.providers))},onExecute:function(t){n.onAction(u(t))},onItemExecute:function(t,n,e){},splitDropdownBehaviours:ec([kp(t.providers.isDisabled),xp(),Sd("split-dropdown-events",[$o(hk,Cd.focus),_p(c,a),Tp(c,a)]),Db.config({})]),eventOrder:((a={})[Mo()]=["alloy.base.behaviour","split-dropdown-events"],a),toggleClass:"tox-tbtn--enabled",lazySink:t.getSink,fetch:(e=u,o=n,r=t.providers,function(n){return nb(function(t){return o.fetch(t)}).map(function(t){return Z.from(uv(zt(Hh(Qr("menu-value"),t,function(t){o.onItemAction(e(n),t)},o.columns,o.presets,$m.CLOSE_ON_EXECUTE,o.select.getOr(d),r),{movement:Lh(o.columns,o.presets),menuBehaviours:Ag("auto"!==o.columns?[]:[rr(function(e,t){Dg(e,4,cg(o.presets)).each(function(t){var n=t.numRows,t=t.numColumns;hd.setGridSize(e,n,t)})})])})))})}),parts:{menu:dg(0,n.columns,n.presets)},components:[dk.parts.button(yk(n.icon,n.text,Z.none(),Z.some(i),Z.some([Fd.config({toggleClass:"tox-tbtn--enabled",toggleOnExecute:!1})]),t.providers)),dk.parts.arrow({dom:{tag:"button",classes:["tox-tbtn","tox-split-button__chevron"],innerHtml:bm("chevron-down",t.providers.icons)},buttonBehaviours:ec([kp(t.providers.isDisabled),xp()])}),dk.parts["aria-descriptor"]({text:t.providers.translate("To open the popup, press Shift+Enter")})]})},Ck=function(o,r){return $o(p0,function(t,n){var e,t=o.get(t),t=(e=t,{hide:function(){return jo(e,Oo())},getValue:function(){return vl.getValue(e)}});r.onAction(t,n.event.buttonApi)})},Ok=function(t,n,e){var o,r,i,u={backstage:{shared:{providers:e}}};return"contextformtogglebutton"===n.type?(o=t,i=u,(e=(r=n).original).primary,e=g(e,["primary"]),e=kn(Xm(Q(Q({},e),{type:"togglebutton",onAction:$}))),Sk(e,i.backstage.shared.providers,[Ck(o,r)])):(r=t,t=u,(n=(u=n).original).primary,n=g(n,["primary"]),n=kn(Um(Q(Q({},n),{type:"button",onAction:$}))),wk(n,t.backstage.shared.providers,[Ck(r,u)]))},_k=function(t,n){var e,o,r,i,u=t.label.fold(function(){return{}},function(t){return{"aria-label":t}}),u=hm(qv.sketch({inputClasses:["tox-toolbar-textfield","tox-toolbar-nav-js"],data:t.initValue(),inputAttributes:u,selectOnFocus:!0,inputBehaviours:ec([hd.config({mode:"special",onEnter:function(t){return a.findPrimary(t).map(function(t){return Uo(t),!0})},onLeft:function(t,n){return n.cut(),Z.none()},onRight:function(t,n){return n.cut(),Z.none()}})])})),a=(e=u,o=t.commands,r=n,i=R(o,function(t){return hm(Ok(e,t,r))}),{asSpecs:function(){return R(i,function(t){return t.asSpec()})},findPrimary:function(e){return rt(o,function(t,n){return t.primary?Z.from(i[n]).bind(function(t){return t.getOpt(e)}).filter(w(Kg.isDisabled)):Z.none()})}});return[{title:Z.none(),items:[u.asSpec()]},{title:Z.none(),items:a.asSpecs()}]},Tk=_k,Ek=function(t,n){var e,o,r,i=Iu(window),u=zu(ne.fromDom(t.getContentAreaContainer())),a=op(t)||rp(t)||up(t),e=(e=u,o=i,r=Math.max(o.x,e.x),e=e.right-r,o=o.width-(r-o.x),{x:r,width:Math.min(e,o)}),o=e.x,e=e.width;if(t.inline&&!a)return Hu(o,i.y,e,i.height);i=function(t,n,e,o){var r=ne.fromDom(t.getContainer()),i=qu(r,".tox-editor-header").getOr(r),i=zu(i),n=i.y>=n.bottom,n=o&&!n;if(t.inline&&n)return{y:Math.max(i.bottom,e.y),bottom:e.bottom};if(t.inline&&!n)return{y:e.y,bottom:Math.min(i.y,e.bottom)};r=zu(r);return n?{y:Math.max(i.bottom,e.y),bottom:Math.min(r.bottom,e.bottom)}:{y:Math.max(r.y,e.y),bottom:Math.min(i.y,e.bottom)}}(t,u,i,n.header.isPositionedAtTop()),n=i.y,i=i.bottom;return Hu(o,n,e,i-n)},Dk=function(n,t){t=P(t,function(t){return t.predicate(n.dom)}),t=V(t,function(t){return"contexttoolbar"===t.type});return{contextToolbars:t.pass,contextForms:t.fail}},Bk=function(t,n,e){n=Dk(t,n);if(0<n.contextForms.length)return Z.some({elem:t,toolbars:[n.contextForms[0]]});e=Dk(t,e);if(0<e.contextForms.length)return Z.some({elem:t,toolbars:[e.contextForms[0]]});if(0<n.contextToolbars.length||0<e.contextToolbars.length){e=function(t){if(t.length<=1)return t;var n=function(n){return M(t,function(t){return t.position===n})},e=function(n){return P(t,function(t){return t.position===n})},o=n("selection"),r=n("node");if(o||r){if(r&&o){n=e("node"),r=R(e("selection"),function(t){return Q(Q({},t),{position:"node"})});return n.concat(r)}return e(o?"selection":"node")}return e("line")}(n.contextToolbars.concat(e.contextToolbars));return Z.some({elem:t,toolbars:e})}return Z.none()},Ak=function(t,n,o){return t(n)?Z.none():We(n,function(t){var n=Dk(t,o.inNodeScope),e=n.contextToolbars,n=n.contextForms,e=0<n.length?n:function(t){if(t.length<=1)return t;var n=function(n){return L(t,function(t){return t.position===n})};return n("selection").orThunk(function(){return n("node")}).orThunk(function(){return n("line")}).map(function(t){return t.position}).fold(function(){return[]},function(n){return P(t,function(t){return t.position===n})})}(e);return 0<e.length?Z.some({elem:t,toolbars:e}):Z.none()},t)},Mk=function(t,n){var e,o=ne.fromDom(n.getBody()),r=function(t){return Ie(t,o)},i=ne.fromDom(n.selection.getNode());return r(e=i)||Ve(o,e)?Bk(i,t.inNodeScope,t.inEditorScope).orThunk(function(){return Ak(r,i,t)}):Z.none()},Fk=function(e,r){var t={},i=[],u=[],a={},c={},o=function(n,e){var o=kn(Sn("ContextForm",Ym,e));(t[n]=o).launch.map(function(t){a["form:"+n]=Q(Q({},e.launch),{type:"contextformtogglebutton"===t.type?"togglebutton":"button",onAction:function(){r(o)}})}),("editor"===o.scope?u:i).push(o),c[n]=o},s=function(n,e){Sn("ContextToolbar",qm,e).each(function(t){("editor"===e.scope?u:i).push(t),c[n]=t})},n=_t(e);return tt(n,function(t){var n=e[t];"contextform"===n.type?o(t,n):"contexttoolbar"===n.type&&s(t,n)}),{forms:t,inNodeScope:i,inEditorScope:u,lookupTable:c,formNavigators:a}},Ik=Qr("forward-slide"),Rk=Qr("backward-slide"),Vk=Qr("change-slide-event"),Pk="tox-pop--resizing",Hk=function(t){var n=Zn(Z.none()),e=function(){return n.get().each(t)};return{clear:function(){e(),n.set(Z.none())},isSet:function(){return n.get().isSome()},set:function(t){e(),n.set(Z.some(t))}}},zk=function(){return Hk(function(t){return t.destroy()})},Lk=function(){return Hk(function(t){return t.unbind()})},Nk=function(o,r){return function(n){var e=Lk(),t=function(){n.setActive(o.formatter.match(r));var t=o.formatter.formatChanged(r,n.setActive);e.set(t)};return o.initialized?t():o.once("init",t),function(){o.off("init",t),e.clear()}}},jk=function(o,r,i){return function(t){var n=function(){return i(t)},e=function(){i(t),o.on(r,n)};return o.initialized?e():o.once("init",e),function(){o.off("init",e),o.off(r,n)}}},Wk=function(n){return function(t){return function(){n.undoManager.transact(function(){n.focus(),n.execCommand("mceToggleFormat",!1,t.format)})}}},Uk=function(t,n){return function(){return t.execCommand(n)}},Gk=function(t,n,e){var i,u,r,a,c,o=e.dataset,s="basic"===o.type?function(){return R(o.data,function(t){return Uw(t,e.isSelectedFor,e.getPreviewFor)})}:o.getData;return{items:(i=n,u=e,r=function(t,n,e,o){var r=i.shared.providers.translate(t.title);if("separator"===t.type)return Z.some({type:"separator",text:r});if("submenu"!==t.type)return Z.some(Q({type:"togglemenuitem",text:r,icon:t.icon,active:t.isSelected(o),disabled:e,onAction:u.onAction(t)},t.getStylePreview().fold(function(){return{}},function(t){return{meta:{style:t}}})));e=j(t.getStyleItems(),function(t){return a(t,n,o)});return 0===n&&e.length<=0?Z.none():Z.some({type:"nestedmenuitem",text:r,disabled:e.length<=0,getSubmenuItems:function(){return j(t.getStyleItems(),function(t){return a(t,n,o)})}})},a=function(t,n,e){var o="formatter"===t.type&&u.isInvalid(t);return 0===n?o?[]:r(t,n,!1,e).toArray():r(t,n,o,e).toArray()},{validateItems:c=function(t){var n=u.getCurrentValue(),e=u.shouldHide?0:1;return j(t,function(t){return a(t,e,n)})},getFetch:function(o,r){return function(t,n){var e=r(),e=c(e);n(O0(e,$m.CLOSE_ON_EXECUTE,o,!1))}}}),getStyleItems:s}},Xk=function(t,n,e){var o=Gk(0,n,e),r=o.items,o=o.getStyleItems,t=jk(t,"NodeChange",function(t){t=t.getComponent();e.updateText(t)});return y0({text:e.icon.isSome()?Z.none():e.text,icon:e.icon,tooltip:Z.from(e.tooltip),role:Z.none(),fetch:r.getFetch(n,o),onSetup:t,getApi:function(t){return{getComponent:U(t)}},columns:1,presets:"normal",classes:e.icon.isSome()?[]:["bespoke"],dropdownBehaviours:[]},"tox-tbtn",n.shared)};(sa=rw=rw||{})[sa.SemiColon=0]="SemiColon",sa[sa.Space=1]="Space";var Yk,qk=function(t,n,e,o){e=t.getParam(n,e,"string");return{type:"basic",data:(e=e,e=o===rw.SemiColon?e.replace(/;$/,"").split(";"):e.split(" "),R(e,function(t){var n=t,e=t,t=t.split("=");return 1<t.length&&(n=t[0],e=t[1]),{title:n,format:e}}))}},Kk=[{title:"Left",icon:"align-left",format:"alignleft",command:"JustifyLeft"},{title:"Center",icon:"align-center",format:"aligncenter",command:"JustifyCenter"},{title:"Right",icon:"align-right",format:"alignright",command:"JustifyRight"},{title:"Justify",icon:"align-justify",format:"alignjustify",command:"JustifyFull"}],Jk=function(e){var t={type:"basic",data:Kk};return{tooltip:"Align",text:Z.none(),icon:Z.some("align-left"),isSelectedFor:function(t){return function(){return e.formatter.match(t)}},getCurrentValue:Z.none,getPreviewFor:function(t){return Z.none},onAction:function(n){return function(){return L(Kk,function(t){return t.format===n.format}).each(function(t){return e.execCommand(t.command)})}},updateText:function(t){var n=L(Kk,function(t){return e.formatter.match(t.format)}).fold(U("left"),function(t){return t.title.toLowerCase()});Wo(t,b0,{icon:"align-"+n})},dataset:t,shouldHide:!1,isInvalid:function(t){return!e.formatter.canApply(t.format)}}},$k=["-apple-system","Segoe UI","Roboto","Helvetica Neue","sans-serif"],Qk=function(t){t=t.split(/\s*,\s*/);return R(t,function(t){return t.replace(/^['"]+|['"]+$/g,"")})},Zk=function(r){var i="System Font",o=function(){var n=function(t){return t?Qk(t)[0]:""},t=r.queryCommandValue("FontName"),e=u.data,o=t?t.toLowerCase():"";return{matchOpt:L(e,function(t){t=t.format;return t.toLowerCase()===o||n(t).toLowerCase()===n(o).toLowerCase()}).orThunk(function(){return Li(0===(t=o).indexOf("-apple-system")&&(n=Qk(t.toLowerCase()),W($k,function(t){return-1<n.indexOf(t.toLowerCase())})),{title:i,format:o});var t,n}),font:t}},u=qk(r,"font_formats","Andale Mono=andale mono,monospace;Arial=arial,helvetica,sans-serif;Arial Black=arial black,sans-serif;Book Antiqua=book antiqua,palatino,serif;Comic Sans MS=comic sans ms,sans-serif;Courier New=courier new,courier,monospace;Georgia=georgia,palatino,serif;Helvetica=helvetica,arial,sans-serif;Impact=impact,sans-serif;Symbol=symbol;Tahoma=tahoma,arial,helvetica,sans-serif;Terminal=terminal,monaco,monospace;Times New Roman=times new roman,times,serif;Trebuchet MS=trebuchet ms,geneva,sans-serif;Verdana=verdana,geneva,sans-serif;Webdings=webdings;Wingdings=wingdings,zapf dingbats",rw.SemiColon);return{tooltip:"Fonts",text:Z.some(i),icon:Z.none(),isSelectedFor:function(n){return function(t){return t.exists(function(t){return t.format===n})}},getCurrentValue:function(){return o().matchOpt},getPreviewFor:function(t){return function(){return Z.some({tag:"div",styles:-1===t.indexOf("dings")?{"font-family":t}:{}})}},onAction:function(t){return function(){r.undoManager.transact(function(){r.focus(),r.execCommand("FontName",!1,t.format)})}},updateText:function(t){var n=o(),e=n.matchOpt,n=n.font,n=e.fold(U(n),function(t){return t.title});Wo(t,v0,{text:n})},dataset:u,shouldHide:!1,isInvalid:d}},t1={"8pt":"1","10pt":"2","12pt":"3","14pt":"4","18pt":"5","24pt":"6","36pt":"7"},n1={"xx-small":"7pt","x-small":"8pt",small:"10pt",medium:"12pt",large:"14pt","x-large":"18pt","xx-large":"24pt"},e1=function(t,n){return/[0-9.]+px$/.test(t)?function(t,n){n=Math.pow(10,n);return Math.round(t*n)/n}(72*parseInt(t,10)/96,n||0)+"pt":Rt(n1,t).getOr(t)},o1=function(e){var o=function(){var o=Z.none(),r=u.data,i=e.queryCommandValue("FontSize");if(i)for(var t=function(t){var n=e1(i,t),e=Rt(t1,n).getOr("");o=L(r,function(t){return t.format===i||t.format===n||t.format===e})},n=3;o.isNone()&&0<=n;n--)t(n);return{matchOpt:o,size:i}},t=U(Z.none),u=qk(e,"fontsize_formats","8pt 10pt 12pt 14pt 18pt 24pt 36pt",rw.Space);return{tooltip:"Font sizes",text:Z.some("12pt"),icon:Z.none(),isSelectedFor:function(n){return function(t){return t.exists(function(t){return t.format===n})}},getPreviewFor:t,getCurrentValue:function(){return o().matchOpt},onAction:function(t){return function(){e.undoManager.transact(function(){e.focus(),e.execCommand("FontSize",!1,t.format)})}},updateText:function(t){var n=o(),e=n.matchOpt,n=n.size,n=e.fold(U(n),function(t){return t.title});Wo(t,v0,{text:n})},dataset:u,shouldHide:!1,isInvalid:d}},r1=function(t,n){var e=n(),n=R(e,function(t){return t.format});return Z.from(t.formatter.closest(n)).bind(function(n){return L(e,function(t){return t.format===n})}).orThunk(function(){return Li(t.formatter.match("p"),{title:"Paragraph",format:"p"})})},i1=function(e){var o=qk(e,"block_formats","Paragraph=p;Heading 1=h1;Heading 2=h2;Heading 3=h3;Heading 4=h4;Heading 5=h5;Heading 6=h6;Preformatted=pre",rw.SemiColon);return{tooltip:"Blocks",text:Z.some("Paragraph"),icon:Z.none(),isSelectedFor:function(t){return function(){return e.formatter.match(t)}},getCurrentValue:Z.none,getPreviewFor:function(n){return function(){var t=e.formatter.get(n);return Z.some({tag:0<t.length&&(t[0].inline||t[0].block)||"div",styles:e.dom.parseStyle(e.formatter.getCssText(n))})}},onAction:Wk(e),updateText:function(t){var n=r1(e,function(){return o.data}).fold(U("Paragraph"),function(t){return t.title});Wo(t,v0,{text:n})},dataset:o,shouldHide:!1,isInvalid:function(t){return!e.formatter.canApply(t.format)}}},u1=function(o,t){return{tooltip:"Formats",text:Z.some("Paragraph"),icon:Z.none(),isSelectedFor:function(t){return function(){return o.formatter.match(t)}},getCurrentValue:Z.none,getPreviewFor:function(n){return function(){var t=o.formatter.get(n);return t!==undefined?Z.some({tag:0<t.length&&(t[0].inline||t[0].block)||"div",styles:o.dom.parseStyle(o.formatter.getCssText(n))}):Z.none()}},onAction:Wk(o),updateText:function(t){var e=function(t){var n=t.items;return n!==undefined&&0<n.length?j(n,e):[{title:t.title,format:t.format}]},n=j(Ww(o),e),n=r1(o,U(n)).fold(U("Paragraph"),function(t){return t.title});Wo(t,v0,{text:n})},shouldHide:o.getParam("style_formats_autohide",!1,"boolean"),isInvalid:function(t){return!o.formatter.canApply(t.format)},dataset:t}},a1=[{name:"history",items:["undo","redo"]},{name:"styles",items:["styleselect"]},{name:"formatting",items:["bold","italic"]},{name:"alignment",items:["alignleft","aligncenter","alignright","alignjustify"]},{name:"indentation",items:["outdent","indent"]},{name:"permanent pen",items:["permanentpen"]},{name:"comments",items:["addcomment"]}],C=function(o,r){return function(t,n,e){t=o(t).mapError(function(t){return On(t)}).getOrDie();return r(t,n,e)}},c1={button:C(Um,function(t,n){return n=n.backstage.shared.providers,wk(t,n,[])}),togglebutton:C(Xm,function(t,n){return n=n.backstage.shared.providers,Sk(t,n,[])}),menubutton:C(sk,function(t,n){return T0(t,"tox-tbtn",n.backstage,Z.none())}),splitbutton:C(function(t){return Sn("SplitButton",lk,t)},function(t,n){return kk(t,n.backstage.shared)}),grouptoolbarbutton:C(function(t){return Sn("GroupToolbarButton",ak,t)},function(t,n,e){var o=e.ui.registry.getAll().buttons,r=((r={})[Wc]=n.backstage.shared.header.isPositionedAtTop()?ta.TopToBottom:ta.BottomToTop,r);if(cp(e)!==Jm.floating)throw new Error("Toolbar groups are only supported when using floating toolbar mode");return function(n,t,e,o){t=t.shared;return MS.sketch({lazySink:t.getSink,fetch:function(){return nb(function(t){t(R(e(n.items),nk))})},markers:{toggledClass:"tox-tbtn--enabled"},parts:{button:yk(n.icon,n.text,n.tooltip,Z.none(),Z.none(),t.providers),toolbar:{dom:{tag:"div",classes:["tox-toolbar__overflow"],attributes:o}}}})}(t,n.backstage,function(t){return d1(e,{buttons:o,toolbar:t,allowToolbarGroups:!1},n,Z.none())},r)}),styleSelectButton:function(t,n){return e=t,t=n.backstage,n=Q({type:"advanced"},t.styleselect),Xk(e,t,u1(e,n));var e},fontsizeSelectButton:function(t,n){return n=n.backstage,Xk(t,n,o1(t))},fontSelectButton:function(t,n){return n=n.backstage,Xk(t,n,Zk(t))},formatButton:function(t,n){return n=n.backstage,Xk(t,n,i1(t))},alignMenuButton:function(t,n){return n=n.backstage,Xk(t,n,Jk(t))}},s1={styleselect:c1.styleSelectButton,fontsizeselect:c1.fontsizeSelectButton,fontselect:c1.fontSelectButton,formatselect:c1.formatButton,align:c1.alignMenuButton},l1=function(t){var e,n=t.toolbar,t=t.buttons;return!1===n?[]:n===undefined||!0===n?(e=t,t=R(a1,function(t){var n=P(t.items,function(t){return Vt(e,t)||Vt(s1,t)});return{name:t.name,items:n}}),P(t,function(t){return 0<t.items.length})):v(n)?function(t){t=t.split("|");return R(t,function(t){return{items:t.trim().split(" ")}})}(n):a(n,function(t){return Vt(t,"name")&&Vt(t,"items")})?n:(console.error("Toolbar type should be string, string[], boolean or ToolbarGroup[]"),[])},f1=function(r,n,i,u,a,t){return Rt(n,i.toLowerCase()).orThunk(function(){return t.bind(function(t){return rt(t,function(t){return Rt(n,t+i.toLowerCase())})})}).fold(function(){return Rt(s1,i.toLowerCase()).map(function(t){return t(r,a)}).orThunk(function(){return Z.none()})},function(t){return"grouptoolbarbutton"!==t.type||u?(e=a,o=r,Rt(c1,(n=t).type).fold(function(){return console.error("skipping button defined by",n),Z.none()},function(t){return Z.some(t(n,e,o))})):(console.warn("Ignoring the '"+i+"' toolbar button. Group toolbar buttons are only supported when using floating toolbar mode and cannot be nested."),Z.none());var n,e,o})},d1=function(e,o,r,i){var t=l1(o),t=R(t,function(t){var n=j(t.items,function(t){return 0===t.trim().length?[]:f1(e,o.buttons,t,o.allowToolbarGroups,r,i).toArray()});return{title:Z.from(e.translate(t.name)),items:n}});return P(t,function(t){return 0<t.items.length})},m1={valignCentre:[],alignCentre:[],alignLeft:["tox-pop--align-left"],alignRight:["tox-pop--align-right"],right:["tox-pop--right"],left:["tox-pop--left"],bottom:["tox-pop--bottom"],top:["tox-pop--top"]},g1={maxHeightFunction:Dc(),maxWidthFunction:xS()},p1=function(t,n,e){return"line"===t?{bubble:Ic(12,0,m1),layouts:{onLtr:function(){return[ja]},onRtl:function(){return[Wa]}},overrides:g1}:{bubble:Ic(0,12,m1),layouts:(o=e,r=function(n){return o.get().exists(function(t){return Ie(n,t)})?mm:sm},n?{onLtr:function(t){return[Na,Va,Pa,Ha,za,La,r(t)]},onRtl:function(t){return[Na,Pa,Va,za,Ha,La,r(t)]}}:{onLtr:function(t){return[La,Na,Ha,Va,za,Pa,r(t)]},onRtl:function(t){return[La,Na,za,Pa,Ha,Va,r(t)]}}),overrides:g1};var o,r},h1=function(r,t,e,i){var o,u,a=Ae().deviceType.isTouch,c=Zn(Z.none()),s=Zn(Z.none()),l=gu((o={sink:e,onEscape:function(){return r.focus(),Z.some(!0)}},u=Zn([]),Zd.sketch({dom:{tag:"div",classes:["tox-pop"]},fireDismissalEventInstead:{event:"doNotDismissYet"},onShow:function(t){u.set([]),Zd.getContent(t).each(function(t){tu(t.element,"visibility")}),Fi(t.element,Pk),tu(t.element,"width")},inlineBehaviours:ec([Sd("context-toolbar-events",[or(mo(),function(t,n){Fi(t.element,Pk),tu(t.element,"width")}),$o(Vk,function(t,n){var e=t.element;tu(e,"width");var o=_u(e);Zd.setContent(t,n.event.contents),Ai(e,Pk);var r=_u(e);Yi(e,"width",o+"px"),Zd.getContent(t).each(function(t){n.event.focus.bind(function(t){return sc(t),dc(e)}).orThunk(function(){return hd.focusIn(t),fc(_r(e))})}),gm.setTimeout(function(){Yi(t.element,"width",r+"px")},0)}),$o(Ik,function(n,t){Zd.getContent(n).each(function(t){u.set(u.get().concat([{bar:t,focus:fc(_r(n.element))}]))}),Wo(n,Vk,{contents:t.event.forwardContents,focus:Z.none()})}),$o(Rk,function(n,t){et(u.get()).each(function(t){u.set(u.get().slice(0,u.get().length-1)),Wo(n,Vk,{contents:pu(t.bar),focus:t.focus})})})]),hd.config({mode:"special",onEscape:function(n){return et(u.get()).fold(function(){return o.onEscape()},function(t){return jo(n,Rk),Z.some(!0)})}})]),lazySink:function(){return at.value(o.sink)}}))),f=function(){return Ek(r,i.backstage.shared)},d=function(){if(a()&&i.backstage.isContextMenuOpen())return!0;var t,n,e=(t=s.get().filter(ji).map(function(t){return t.dom.getBoundingClientRect()}).getOrThunk(function(){return r.selection.getRng().getBoundingClientRect()}),n=r.inline?Au().top:Lu(ne.fromDom(r.getBody())).y,{y:t.top+n,bottom:t.bottom+n}),o=f();return t=e.y,n=e.bottom,e=o.y,o=o.bottom,!(Math.max(t,e)<=Math.min(n,o))},n=function(){c.set(Z.none()),s.set(Z.none()),Zd.hide(l)},m=function(){Zd.hide(l)},g=function(){c.get().each(function(t){var n=l.element;tu(n,"display"),d()?Yi(n,"display","none"):Ls.positionWithinBounds(e,t,l,Z.some(f()))})},p=function(t){return{dom:{tag:"div",classes:["tox-pop__dialog"]},components:[t],behaviours:ec([hd.config({mode:"acyclic"}),Sd("pop-dialog-wrap-events",[rr(function(t){r.shortcuts.add("ctrl+F9","focus statusbar",function(){return hd.focusIn(t)})}),ir(function(t){r.shortcuts.remove("ctrl+F9")})])])}},h=Nt(function(){return Fk(t,function(t){t=v([t]);Wo(l,Ik,{forwardContents:p(t)})})}),v=function(t){var n=r.ui.registry.getAll().buttons,e=h(),o=Q(Q({},n),e.formNavigators),e=cp(r)===Jm.scrolling?Jm.scrolling:Jm["default"],t=nt(R(t,function(t){return"contexttoolbar"===t.type?d1(r,{buttons:o,toolbar:t.items,allowToolbarGroups:!1},i,Z.some(["form:"])):(n=i.backstage.shared.providers,Tk(t,n));var n}));return uk({type:e,uid:Qr("context-toolbar"),initGroups:t,onEscape:Z.none,cyclicKeying:!0,providers:i.backstage.shared.providers})};r.on("contexttoolbar-show",function(n){var t=h();Rt(t.lookupTable,n.toolbarKey).each(function(t){b([t],n.target===r?Z.none():Z.some(n)),Zd.getContent(l).each(hd.focusIn)})});var b=function(t,n){var e,o;y.stop(),a()&&i.backstage.isContextMenuOpen()||(e=v(t),o=n.map(ne.fromDom),n=function(t,n){n="node"===t?i.backstage.shared.anchors.node(n):i.backstage.shared.anchors.cursor();return zt(n,p1(t,a(),s))}(t[0].position,o),c.set(Z.some(n)),t=l.element,tu(t,"display"),Zd.showWithinBounds(l,n,p(e),function(){return Z.some(f())}),s.set(o),d()&&Yi(t,"display","none"))},y=gm.debounce(function(){var t;r.hasFocus()&&!r.removed&&(t=h(),Mk(t,r).fold(n,function(t){b(t.toolbars,Z.some(t.elem.dom))}))},0);r.on("init",function(){r.on(wS,m),r.on("ScrollContent ScrollWindow longpress",g),r.on("click keyup focus SetContent ObjectResized ResizeEditor",function(){y()}),r.on("focusout",function(t){gm.setEditorTimeout(r,function(){dc(e.element).isNone()&&dc(l.element).isNone()&&n()},0)}),r.on("SwitchMode",function(){r.mode.isReadOnly()&&n()}),r.on("AfterProgressState",function(t){t.state?n():r.hasFocus()&&y()}),r.on("NodeChange",function(t){dc(l.element).fold(y,$)})})},v1=ca,pe=po,hu=U([Un("shell",!1),Bn("makeItem"),Un("setupItem",$),xl("listBehaviours",[wd])]),sa=Il({name:"items",overrides:function(){return{behaviours:ec([wd.config({})])}}}),C=U([sa]),b1=pl({name:U("CustomList")(),configFields:hu(),partFields:C(),factory:function(u,t,n,e){var t=u.shell?{behaviours:[wd.config({})],components:[]}:{behaviours:[],components:t},o=function(t){return u.shell?Z.some(t):Ul(t,u,"items")};return{uid:u.uid,dom:u.dom,components:t.components,behaviours:yl(u.listBehaviours,t.behaviours),apis:{setItems:function(r,i){o(r).fold(function(){throw console.error("Custom List was defined to not be a shell, but no item container was specified in components"),new Error("Custom List was defined to not be a shell, but no item container was specified in components")},function(n){var t=wd.contents(n),e=i.length,o=e-t.length,o=0<o?F(o,function(){return u.makeItem()}):[],e=t.slice(e);tt(e,function(t){return wd.remove(n,t)}),tt(o,function(t){return wd.append(n,t)});o=wd.contents(n);tt(o,function(t,n){u.setupItem(r,t,i[n],n)})})}}}},apis:{setItems:function(t,n,e){t.setItems(n,e)}}}),y1=U([]),x1=Object.freeze({__proto__:null,setup:$,isDocked:d,getBehaviours:y1}),w1=function(t){return(Pi(Qi(t,"position"),"fixed")?Z.none():xr(t)).orThunk(function(){var n=ne.fromTag("span");return br(t).bind(function(t){Ir(t,n);t=xr(n);return Pr(n),t})})},S1=function(t){return w1(t).map(ku).getOrThunk(function(){return wu(0,0)})},k1=Pe([{"static":[]},{absolute:["positionCss"]},{fixed:["positionCss"]}]),C1=function(t,n){var e=t.element;Ai(e,n.transitionClass),Fi(e,n.fadeOutClass),Ai(e,n.fadeInClass),n.onShow(t)},O1=function(t,n){var e=t.element;Ai(e,n.transitionClass),Fi(e,n.fadeInClass),Ai(e,n.fadeOutClass),n.onHide(t)},_1=function(t,n,e){return W(t,function(t){switch(t){case"bottom":return n.bottom<=e.bottom;case"top":return n.y>=e.y}})},T1=function(n,t){return t.getInitialPosition().map(function(t){return Hu(t.bounds.x,t.bounds.y,_u(n),bu(n))})},E1=function(t,n,e){e.setInitialPosition(Z.some({style:function(t){var n={},e=t.dom;if(Ni(e))for(var o=0;o<e.style.length;o++){var r=e.style.item(o);n[r]=e.style[r]}return n}(t),position:Ji(t,"position")||"static",bounds:n}))},D1=function(e,o,r){return r.getInitialPosition().bind(function(t){switch(r.setInitialPosition(Z.none()),t.position){case"static":return Z.some(k1["static"]());case"absolute":var n=w1(e).map(zu).getOrThunk(function(){return zu(Wi())});return Z.some(k1.absolute(gc("absolute",Rt(t.style,"left").map(function(t){return o.x-n.x}),Rt(t.style,"top").map(function(t){return o.y-n.y}),Rt(t.style,"right").map(function(t){return n.right-o.right}),Rt(t.style,"bottom").map(function(t){return n.bottom-o.bottom}))));default:return Z.none()}})},B1=function(t,n,e){var o,r,i,t=t.element;return Pi(Qi(t,"position"),"fixed")?(r=n,T1(o=t,i=e).filter(function(t){return _1(i.getModes(),t,r)}).bind(function(t){return D1(o,t,i)})):function(t,n,e){var o=zu(t);if(_1(e.getModes(),o,n))return Z.none();E1(t,o,e);var r=Nu(),t=o.x-r.x,e=n.y-r.y,r=r.bottom-n.bottom,n=o.y<=n.y;return Z.some(k1.fixed(gc("fixed",Z.some(t),n?Z.some(e):Z.none(),Z.none(),n?Z.none():Z.some(r))))}(t,n,e)},A1=function(n,t){tt(["left","right","top","bottom","position"],function(t){return tu(n.element,t)}),t.onUndocked(n)},M1=function(t,n,e){pc(t.element,e),("fixed"===e.position?n.onDocked:n.onUndocked)(t)},F1=function(o,t,r,i,u){void 0===u&&(u=!1),t.contextual.each(function(e){e.lazyContext(o).each(function(t){var n,n=(n=i,(t=t).y<n.bottom&&t.bottom>n.y);n!==r.isVisible()&&(r.setVisible(n),u&&!n?(Ri(o.element,[e.fadeOutClass]),e.onHide(o)):(n?C1:O1)(o,e))})})},I1=function(n,e,t){var o,r,i=n.element;t.setDocked(!1),o=t,r=n.element,T1(r,o).bind(function(t){return D1(r,t,o)}).each(function(t){t.fold(function(){return A1(n,e)},function(t){return M1(n,e,t)},$)}),t.setVisible(!0),e.contextual.each(function(t){Vi(i,[t.fadeInClass,t.fadeOutClass,t.transitionClass]),t.onShow(n)}),R1(n,e,t)},R1=function(t,n,e){var o,r,i,u,a;t.getSystem().isConnected()&&(o=t,i=e,u=(r=n).lazyViewport(o),(a=i.isDocked())&&F1(o,r,i,u),B1(o,u,i).each(function(t){i.setDocked(!a),t.fold(function(){return A1(o,r)},function(t){return M1(o,r,t)},function(t){F1(o,r,i,u,!0),M1(o,r,t)})}))},V1=function(t,n,e){e.isDocked()&&I1(t,n,e)},ca=Object.freeze({__proto__:null,refresh:R1,reset:V1,isDocked:function(t,n,e){return e.isDocked()},getModes:function(t,n,e){return e.getModes()},setModes:function(t,n,e,o){return e.setModes(o)}}),po=Object.freeze({__proto__:null,events:function(o,r){return qo([or(mo(),function(n,e){o.contextual.each(function(t){Ii(n.element,t.transitionClass)&&(Vi(n.element,[t.transitionClass,t.fadeInClass]),(r.isVisible()?t.onShown:t.onHidden)(n)),e.stop()})}),$o(Bo(),function(t,n){R1(t,o,r)}),$o(Ao(),function(t,n){V1(t,o,r)})])}}),sa=[Wn("contextual",[Mn("fadeInClass"),Mn("fadeOutClass"),Mn("transitionClass"),In("lazyContext"),da("onShow"),da("onShown"),da("onHide"),da("onHidden")]),Jn("lazyViewport",Nu),$n("modes",["top","bottom"],mn),da("onDocked"),da("onUndocked")],P1=rc({fields:sa,name:"docking",active:po,apis:ca,state:Object.freeze({__proto__:null,init:function(t){var n=Zn(!1),e=Zn(!0),o=Zn(Z.none()),r=Zn(t.modes);return pi({isDocked:n.get,setDocked:n.set,getInitialPosition:o.get,setInitialPosition:o.set,isVisible:e.get,setVisible:e.set,getModes:r.get,setModes:r.set,readState:function(){return"docked:  "+n.get()+", visible: "+e.get()+", modes: "+r.get().join(",")}})}})}),H1={fadeInClass:"tox-editor-dock-fadein",fadeOutClass:"tox-editor-dock-fadeout",transitionClass:"tox-editor-dock-transition"},z1="tox-tinymce--toolbar-sticky-on",L1="tox-tinymce--toolbar-sticky-off",N1=function(t,n){return A(P1.getModes(t),n)},j1=function(o){var r=o.element;br(r).each(function(t){var n,e="padding-"+P1.getModes(o)[0];P1.isDocked(o)?(n=_u(t),Yi(r,"width",n+"px"),Yi(t,e,yu(n=r)+(parseInt(Ji(n,"margin-top"),10)||0)+(parseInt(Ji(n,"margin-bottom"),10)||0)+"px")):(tu(r,"width"),tu(t,e))})},W1=function(t,n){n?(Fi(t,H1.fadeOutClass),Ri(t,[H1.transitionClass,H1.fadeInClass])):(Fi(t,H1.fadeInClass),Ri(t,[H1.fadeOutClass,H1.transitionClass]))},U1=function(t,n){t=ne.fromDom(t.getContainer());n?(Ai(t,z1),Fi(t,L1)):(Ai(t,L1),Fi(t,z1))},G1=function(r,t){var n,i=Zn(Z.none()),e=t.getSink,o=function(n){e().each(function(t){return n(t.element)})},u=function(t){r.inline||j1(t),U1(r,P1.isDocked(t)),t.getSystem().broadcastOn([al()],{}),e().each(function(t){return t.getSystem().broadcastOn([al()],{})})},n=r.inline?[]:[cc.config({channels:((n={})[ZS()]={onReceive:j1},n)})];return p([Cd.config({}),P1.config({contextual:Q({lazyContext:function(t){var n=yu(t.element),e=r.inline?r.getContentAreaContainer():r.getContainer(),o=zu(ne.fromDom(e)),e=o.height-n,n=o.y+(N1(t,"top")?0:n);return Z.some(Hu(o.x,n,o.width,e))},onShow:function(){o(function(t){return W1(t,!0)})},onShown:function(r){o(function(t){return Vi(t,[H1.transitionClass,H1.fadeInClass])}),i.get().each(function(t){var n,e,o;n=r.element,o=gr(e=t),fc(o).filter(function(t){return!Ie(e,t)}).filter(function(t){return Ie(t,ne.fromDom(o.dom.body))||Ve(n,t)}).each(function(){return sc(e)}),i.set(Z.none())})},onHide:function(t){var n;i.set((t=t.element,n=e,dc(t).orThunk(function(){return n().toOptional().bind(function(t){return dc(t.element)})}))),o(function(t){return W1(t,!1)})},onHidden:function(){o(function(t){return Vi(t,[H1.transitionClass])})}},H1),lazyViewport:function(t){var n=Nu(),e=r.getParam("toolbar_sticky_offset",0,"number"),o=n.y+(N1(t,"top")?e:0),e=n.height-(N1(t,"bottom")?e:0);return Hu(n.x,o,n.width,e)},modes:[t.header.getDockingMode()],onDocked:u,onUndocked:u})],n)},X1=Object.freeze({__proto__:null,setup:function(t,n,e){t.inline||(n.header.isPositionedAtTop()||t.on("ResizeEditor",function(){e().each(P1.reset)}),t.on("ResizeWindow ResizeEditor",function(){e().each(j1)}),t.on("SkinLoaded",function(){e().each(function(t){P1.isDocked(t)?P1.reset(t):P1.refresh(t)})}),t.on("FullscreenStateChanged",function(){e().each(P1.reset)})),t.on("AfterScrollIntoView",function(f){e().each(function(t){P1.refresh(t);var n,e,o,r,i,u,a,c,s,l=t.element;Yf(l)&&(n=f,o=gr(e=l),r=o.dom.defaultView.innerHeight,i=Au(o),u=ne.fromDom(n.elm),a=Lu(u),c=bu(u),s=a.y,t=s+c,l=ku(e),n=bu(e),u=l.top,a=u+n,e=Math.abs(u-i.top)<2,l=Math.abs(a-(i.top+r))<2,e&&s<a?Mu(i.left,s-n,o):l&&u<t&&Mu(i.left,s-r+c+n,o))})}),t.on("PostRender",function(){U1(t,!1)})},isDocked:function(t){return t().map(P1.isDocked).getOr(!1)},getBehaviours:G1}),Y1=of({factory:function(n,e){var t={focus:hd.focusIn,setMenus:function(t,n){n=R(n,function(n){var t={type:"menubutton",text:n.text,fetch:function(t){t(n.getItems())}},t=sk(t).mapError(function(t){return On(t)}).getOrDie();return T0(t,"tox-mbtn",e.backstage,Z.some("menuitem"))});wd.set(t,n)}};return{uid:n.uid,dom:n.dom,components:[],behaviours:ec([wd.config({}),Sd("menubar-events",[rr(function(t){n.onSetup(t)}),$o(ro(),function(e,t){qu(e.element,".tox-mbtn--active").each(function(n){Ku(t.event.target,".tox-mbtn").each(function(t){Ie(n,t)||e.getSystem().getByDom(n).each(function(n){e.getSystem().getByDom(t).each(function(t){Eb.expand(t),Eb.close(n),Cd.focus(t)})})})})}),$o(Vo(),function(e,t){t.event.prevFocus.bind(function(t){return e.getSystem().getByDom(t).toOptional()}).each(function(n){t.event.newFocus.bind(function(t){return e.getSystem().getByDom(t).toOptional()}).each(function(t){Eb.isOpen(n)&&(Eb.expand(t),Eb.close(n))})})})]),hd.config({mode:"flow",selector:".tox-mbtn",onEscape:function(t){return n.onEscape(t),Z.some(!0)}}),Bv.config({})]),apis:t,domModification:{attributes:{role:"menubar"}}}},name:"silver.Menubar",configFields:[Bn("dom"),Bn("uid"),Bn("onEscape"),Bn("backstage"),Un("onSetup",$)],apis:{focus:function(t,n){t.focus(n)},setMenus:function(t,n,e){t.setMenus(n,e)}}}),q1="container",K1=[sr("slotBehaviours",[])],J1=function(t){return"<alloy.field."+t+">"},$1=function(r,t){var e,n=function(t){return ql(r)},o=function(e,o){return function(t,n){return Ul(t,r,n).map(function(t){return e(t,n)}).getOr(o)}},i=function(t,n){return"true"!==Wr(t.element,"aria-hidden")},u=o(i,!1),a=o(function(t,n){var e;i(t)&&(e=t.element,Yi(e,"display","none"),jr(e,"aria-hidden","true"),Wo(t,Po(),{name:n,visible:!1}))}),c=(e=a,function(n,t){tt(t,function(t){return e(n,t)})}),o=o(function(t,n){var e;i(t)||(e=t.element,tu(e,"display"),Xr(e,"aria-hidden"),Wo(t,Po(),{name:n,visible:!0}))});return{uid:r.uid,dom:r.dom,components:t,behaviours:bl(r.slotBehaviours),apis:{getSlotNames:n,getSlot:function(t,n){return Ul(t,r,n)},isShowing:u,hideSlot:a,hideAllSlots:function(t){return c(t,n())},showSlot:o}}},hu=Dt({getSlotNames:function(t,n){return t.getSlotNames(n)},getSlot:function(t,n,e){return t.getSlot(n,e)},isShowing:function(t,n,e){return t.isShowing(n,e)},hideSlot:function(t,n,e){return t.hideSlot(n,e)},hideAllSlots:function(t,n){return t.hideAllSlots(n)},showSlot:function(t,n,e){return t.showSlot(n,e)}},mi),Q1=Q(Q({},hu),{sketch:function(t){var e,n={slot:function(t,n){return e.push(t),zl(q1,J1(t),n)},record:U(e=[])},t=t(n),n=n.record(),n=R(n,function(t){return Fl({name:t,pname:J1(t)})});return Zl(q1,K1,n,$1,t)}}),Z1=rn([Nn("icon"),Nn("tooltip"),Jn("onShow",$),Jn("onHide",$),Jn("onSetup",function(){return $})]),tC=function(t){return{element:function(){return t.element.dom}}},nC=function(e,o){var r=R(_t(o),function(t){var n=o[t],n=kn(Sn("sidebar",Z1,n));return{name:t,getApi:tC,onSetup:n.onSetup,onShow:n.onShow,onHide:n.onHide}});return R(r,function(t){var n=Zn($);return e.slot(t.name,{dom:{tag:"div",classes:["tox-sidebar__pane"]},behaviours:Ag([_p(t,n),Tp(t,n),$o(Po(),function(n,t){var e=t.event;L(r,function(t){return t.name===e.name}).each(function(t){(e.visible?t.onShow:t.onHide)(t.getApi(n))})})])})})},eC=function(t,e){uf.getCurrent(t).each(function(t){return wd.set(t,[(n=e,Q1.sketch(function(t){return{dom:{tag:"div",classes:["tox-sidebar__pane-container"]},components:nC(t,n),slotBehaviours:Ag([rr(function(t){return Q1.hideAllSlots(t)})])}}))]);var n})},oC=function(t){return uf.getCurrent(t).bind(function(t){return KS.isGrowing(t)||KS.hasGrown(t)?uf.getCurrent(t).bind(function(n){return L(Q1.getSlotNames(n),function(t){return Q1.isShowing(n,t)})}):Z.none()})},rC=Qr("FixSizeEvent"),iC=Qr("AutoSizeEvent"),C=Object.freeze({__proto__:null,block:function(t,n,e,o){jr(t.element,"aria-busy",!0);var r=n.getRoot(t).getOr(t),i=ec([hd.config({mode:"special",onTab:function(){return Z.some(!0)},onShiftTab:function(){return Z.some(!0)}}),Cd.config({})]),i=o(r,i),u=r.getSystem().build(i);wd.append(r,pu(u)),u.hasConfigured(hd)&&n.focus&&hd.focusIn(u),e.isBlocked()||n.onBlock(t),e.blockWith(function(){return wd.remove(r,u)})},unblock:function(t,n,e){Xr(t.element,"aria-busy"),e.isBlocked()&&n.onUnblock(t),e.clear()}}),$n=[Jn("getRoot",Z.none),Kn("focus",!0),da("onBlock"),da("onUnblock")],uC=rc({fields:$n,name:"blocking",apis:C,state:Object.freeze({__proto__:null,init:function(){var n=zk();return pi({readState:n.isSet,blockWith:function(t){n.set({destroy:t})},clear:n.clear,isBlocked:n.isSet})}})}),aC=function(t){var n=ne.fromHtml(t),e=wr(n),o=function(t){t=t.dom.attributes!==undefined?t.dom.attributes:[];return z(t,function(t,n){return"class"===n.name?t:Q(Q({},t),((t={})[n.name]=n.value,t))},{})}(n),t=Array.prototype.slice.call(n.dom.classList,0),e=0===e.length?{}:{innerHtml:zr(n)};return Q({tag:cr(n),classes:t,attributes:o},e)},cC=function(t){return uf.getCurrent(t).each(function(t){return sc(t.element)})},sC=function(t,n,e,o){var r,i,u,a,c=n.element;r=e,u="data-mce-"+(i="tabindex"),Z.from(t.iframeElement).map(ne.fromDom).each(function(n){r?(Ur(n,i).each(function(t){return jr(n,u,t)}),jr(n,i,-1)):(Xr(n,i),Ur(n,u).each(function(t){jr(n,i,t),Xr(n,u)}))}),e?(uC.block(n,(a=o,function(t,n){return{dom:{tag:"div",attributes:{"aria-label":a.translate("Loading..."),tabindex:"0"},classes:["tox-throbber__busy-spinner"]},components:[{dom:aC('<div class="tox-spinner"><div></div><div></div><div></div></div>')}]}})),tu(c,"display"),Xr(c,"aria-hidden"),t.hasFocus()&&cC(n)):(o=uf.getCurrent(n).exists(function(t){return lc(t.element)}),uC.unblock(n),Yi(c,"display","none"),jr(c,"aria-hidden","true"),o&&t.focus())},lC=function(e,o,n){var r=Zn(!1),i=Zn(Z.none()),u=function(t){var n;!r.get()||"focusin"===(n=t).type&&(n.composed?J(n.composedPath()):Z.from(n.target)).map(ne.fromDom).filter(lr).exists(function(t){return Ii(t,"mce-pastebin")})||(t.preventDefault(),cC(o()),e.editorManager.setActive(e))};e.inline||e.on("PreInit",function(){e.dom.bind(e.getWin(),"focusin",u),e.on("BeforeExecCommand",function(t){"mcefocus"===t.command.toLowerCase()&&!0!==t.value&&u(t)})});var a=function(t){t!==r.get()&&(r.set(t),sC(e,o(),t,n.providers),e.fire("AfterProgressState",{state:t}))};e.on("ProgressState",function(t){var n;i.get().each(gm.clearTimeout),s(t.time)?(n=gm.setEditorTimeout(e,function(){return a(t.state)},t.time),i.set(Z.some(n))):(a(t.state),i.set(Z.none()))})},sa=pe.optional({factory:Y1,name:"menubar",schema:[Bn("backstage")]}),po=pe.optional({factory:{sketch:function(t){return b1.sketch({uid:t.uid,dom:t.dom,listBehaviours:ec([hd.config({mode:"acyclic",selector:".tox-toolbar"})]),makeItem:function(){return uk({type:t.type,uid:Qr("multiple-toolbar-item"),cyclicKeying:!1,initGroups:[],providers:t.providers,onEscape:function(){return t.onEscape(),Z.some(!0)}})},setupItem:function(t,n,e,o){SS.setGroups(n,e)},shell:!0})}},name:"multiple-toolbar",schema:[Bn("dom"),Bn("onEscape")]}),ca=pe.optional({factory:{sketch:function(t){var n;return((n=t).type===Jm.sliding?ik:n.type===Jm.floating?rk:uk)({type:t.type,uid:t.uid,onEscape:function(){return t.onEscape(),Z.some(!0)},cyclicKeying:!1,initGroups:[],getSink:t.getSink,providers:t.providers,moreDrawerData:{lazyToolbar:t.lazyToolbar,lazyMoreButton:t.lazyMoreButton,lazyHeader:t.lazyHeader},attributes:t.attributes})}},name:"toolbar",schema:[Bn("dom"),Bn("onEscape"),Bn("getSink")]}),hu=pe.optional({factory:{sketch:function(t){var n=t.editor,e=t.sticky?G1:y1;return{uid:t.uid,dom:t.dom,components:t.components,behaviours:ec(e(n,t.sharedBackstage))}}},name:"header",schema:[Bn("dom")]}),$n=pe.optional({name:"socket",schema:[Bn("dom")]}),C=pe.optional({factory:{sketch:function(t){return{uid:t.uid,dom:{tag:"div",classes:["tox-sidebar"],attributes:{role:"complementary"}},components:[{dom:{tag:"div",classes:["tox-sidebar__slider"]},components:[],behaviours:ec([Bv.config({}),Cd.config({}),KS.config({dimension:{property:"width"},closedClass:"tox-sidebar--sliding-closed",openClass:"tox-sidebar--sliding-open",shrinkingClass:"tox-sidebar--sliding-shrinking",growingClass:"tox-sidebar--sliding-growing",onShrunk:function(t){uf.getCurrent(t).each(Q1.hideAllSlots),jo(t,iC)},onGrown:function(t){jo(t,iC)},onStartGrow:function(t){Wo(t,rC,{width:Qi(t.element,"width").getOr("")})},onStartShrink:function(t){Wo(t,rC,{width:_u(t.element)+"px"})}}),wd.config({}),uf.config({find:function(t){t=wd.contents(t);return J(t)}})])}],behaviours:ec([Yy(0),Sd("sidebar-sliding-events",[$o(rC,function(t,n){Yi(t.element,"width",n.event.width)}),$o(iC,function(t,n){tu(t.element,"width")})])])}}},name:"sidebar",schema:[Bn("dom")]}),pe=pe.optional({factory:{sketch:function(t){return{uid:t.uid,dom:{tag:"div",attributes:{"aria-hidden":"true"},classes:["tox-throbber"],styles:{display:"none"}},behaviours:ec([wd.config({}),uC.config({focus:!1}),uf.config({find:function(t){return J(t.components())}})]),components:[]}}},name:"throbber",schema:[Bn("dom")]}),fC=pl({name:"OuterContainer",factory:function(e,t,n){return{uid:e.uid,dom:e.dom,components:t,apis:{getSocket:function(t){return v1.getPart(t,e,"socket")},setSidebar:function(t,n){v1.getPart(t,e,"sidebar").each(function(t){return eC(t,n)})},toggleSidebar:function(t,n){v1.getPart(t,e,"sidebar").each(function(t){var e;e=n,uf.getCurrent(t).each(function(n){uf.getCurrent(n).each(function(t){KS.hasGrown(n)?Q1.isShowing(t,e)?KS.shrink(n):(Q1.hideAllSlots(t),Q1.showSlot(t,e)):(Q1.hideAllSlots(t),Q1.showSlot(t,e),KS.grow(n))})})})},whichSidebar:function(t){return v1.getPart(t,e,"sidebar").bind(oC).getOrNull()},getHeader:function(t){return v1.getPart(t,e,"header")},getToolbar:function(t){return v1.getPart(t,e,"toolbar")},setToolbar:function(t,n){v1.getPart(t,e,"toolbar").each(function(t){t.getApis().setGroups(t,n)})},setToolbars:function(t,n){v1.getPart(t,e,"multiple-toolbar").each(function(t){b1.setItems(t,n)})},refreshToolbar:function(t){v1.getPart(t,e,"toolbar").each(function(t){return t.getApis().refresh(t)})},toggleToolbarDrawer:function(t){v1.getPart(t,e,"toolbar").each(function(n){var t,e;t=n.getApis().toggle,e=function(t){return t(n)},t!==undefined&&null!==t?Z.some(e(t)):Z.none()})},isToolbarDrawerToggled:function(t){return v1.getPart(t,e,"toolbar").bind(function(n){return Z.from(n.getApis().isOpen).map(function(t){return t(n)})}).getOr(!1)},getThrobber:function(t){return v1.getPart(t,e,"throbber")},focusToolbar:function(t){v1.getPart(t,e,"toolbar").orThunk(function(){return v1.getPart(t,e,"multiple-toolbar")}).each(function(t){hd.focusIn(t)})},setMenubar:function(t,n){v1.getPart(t,e,"menubar").each(function(t){Y1.setMenus(t,n)})},focusMenubar:function(t){v1.getPart(t,e,"menubar").each(function(t){Y1.focus(t)})}},behaviours:e.behaviours}},configFields:[Bn("dom"),Bn("behaviours")],partFields:[hu,sa,ca,po,$n,C,pe],apis:{getSocket:function(t,n){return t.getSocket(n)},setSidebar:function(t,n,e){t.setSidebar(n,e)},toggleSidebar:function(t,n,e){t.toggleSidebar(n,e)},whichSidebar:function(t,n){return t.whichSidebar(n)},getHeader:function(t,n){return t.getHeader(n)},getToolbar:function(t,n){return t.getToolbar(n)},setToolbar:function(t,n,e){e=R(e,nk);t.setToolbar(n,e)},setToolbars:function(t,n,e){e=R(e,function(t){return R(t,nk)});t.setToolbars(n,e)},refreshToolbar:function(t,n){return t.refreshToolbar(n)},toggleToolbarDrawer:function(t,n){t.toggleToolbarDrawer(n)},isToolbarDrawerToggled:function(t,n){return t.isToolbarDrawerToggled(n)},getThrobber:function(t,n){return t.getThrobber(n)},setMenubar:function(t,n,e){t.setMenubar(n,e)},focusMenubar:function(t,n){t.focusMenubar(n)},focusToolbar:function(t,n){t.focusToolbar(n)}}}),dC={file:{title:"File",items:"newdocument restoredraft | preview | export print | deleteallconversations"},edit:{title:"Edit",items:"undo redo | cut copy paste pastetext | selectall | searchreplace"},view:{title:"View",items:"code | visualaid visualchars visualblocks | spellchecker | preview fullscreen | showcomments"},insert:{title:"Insert",items:"image link media addcomment pageembed template codesample inserttable | charmap emoticons hr | pagebreak nonbreaking anchor toc | insertdatetime"},format:{title:"Format",items:"bold italic underline strikethrough superscript subscript codeformat | formats blockformats fontformats fontsizes align lineheight | forecolor backcolor | removeformat"},tools:{title:"Tools",items:"spellchecker spellcheckerlanguage | a11ycheck code wordcount"},table:{title:"Table",items:"inserttable | cell row column | advtablesort | tableprops deletetable"},help:{title:"Help",items:"help"}},mC=function(t){return"string"==typeof t?t.split(" "):t},gC=function(r,i){var u=Q(Q({},dC),i.menus),e=0<_t(i.menus).length,t=i.menubar===undefined||!0===i.menubar?mC("file edit view insert format tools table help"):mC(!1===i.menubar?"":i.menubar),t=P(t,function(t){var n=Vt(dC,t);return e?n||Rt(i.menus,t).exists(function(t){return Vt(t,"items")}):n}),t=R(t,function(t){var n,e,o,t=u[t];return n={title:t.title,items:mC(t.items)},e=i,o=r.getParam("removed_menuitems","").split(/[ ,]/),{text:n.title,getItems:function(){return j(n.items,function(t){var n=t.toLowerCase();return 0===n.trim().length||M(o,function(t){return t===n})?[]:"separator"===n||"|"===n?[{type:"separator"}]:e.menuItems[n]?[e.menuItems[n]]:[]})}}});return P(t,function(t){return 0<t.getItems().length&&M(t.getItems(),function(t){return"separator"!==t.type})})},pC=function(t){var n=function(){t._skinLoaded=!0,t.fire("SkinLoaded")};return function(){t.initialized?n():t.on("init",n)}},hC=function(n,e){return function(){return t={message:e},n.fire("SkinLoadError",t);var t}},vC=function(e,o,r){return new Fm(function(t,n){r.load(o,t,n),e.on("remove",function(){return r.unload(o)})})},bC=function(t,n){var e;return(e=ne.fromDom(t.getElement()),Er(e).isSome())?vC(t,n+"/skin.shadowdom.min.css",Pg.DOM.styleSheetLoader):Fm.resolve()},hu=function(t,n){var e,o,r,r=(o=(e=n).getParam("skin"),r=e.getParam("skin_url"),!1!==o&&(o=o||"oxide",r=r?e.documentBaseURI.toAbsolute(r):Jg.baseURL+"/skins/ui/"+o),r);r&&n.contentCSS.push(r+(t?"/content.inline":"/content")+".min.css"),!1===n.getParam("skin")==!1&&v(r)?Fm.all([vC(n,r+"/skin.min.css",n.ui.styleSheetLoader),bC(n,r)]).then(pC(n),hC(n,"Skin could not be loaded")):pC(n)()},yC=x(hu,!1),xC=x(hu,!0),wC=function(n,t,e,o){var r=t.outerContainer,t=e.toolbar,i=e.buttons;a(t,v)?(t=t.map(function(t){t={toolbar:t,buttons:i,allowToolbarGroups:e.allowToolbarGroups};return d1(n,t,{backstage:o},Z.none())}),fC.setToolbars(r,t)):fC.setToolbar(r,d1(n,e,{backstage:o},Z.none()))},sa=Ae(),SC=sa.os.isiOS()&&sa.os.version.major<=12,kC=Object.freeze({__proto__:null,render:function(e,n,t,o,r){var i=Zn(0),u=n.outerContainer;yC(e);var a=ne.fromDom(r.targetNode),c=Tr(_r(a));r=n.mothership,$s(a,r,Mr),Js(c,n.uiMothership),e.on("PostRender",function(){wC(e,n,t,o),i.set(e.getWin().innerWidth),fC.setMenubar(u,gC(e,t)),fC.setSidebar(u,t.sidebar),function(e,t){var n=e.dom,o=e.getWin(),r=e.getDoc().documentElement,i=Zn(wu(o.innerWidth,o.innerHeight)),u=Zn(wu(r.offsetWidth,r.offsetHeight)),a=function(){var t=i.get();t.left===o.innerWidth&&t.top===o.innerHeight||(i.set(wu(o.innerWidth,o.innerHeight)),gh(e))},r=function(){var t=e.getDoc().documentElement,n=u.get();n.left===t.offsetWidth&&n.top===t.offsetHeight||(u.set(wu(t.offsetWidth,t.offsetHeight)),gh(e))},c=function(t){return e.fire("ScrollContent",t)};n.bind(o,"resize",a),n.bind(o,"scroll",c);var s=lv(ne.fromDom(e.getBody()),"load",r),l=t.uiMothership.element;e.on("hide",function(){Yi(l,"display","none")}),e.on("show",function(){tu(l,"display")}),e.on("NodeChange",r),e.on("remove",function(){s.unbind(),n.unbind(o,"resize",a),n.unbind(o,"scroll",c),o=null})}(e,n)});var s,l,f,c=fC.getSocket(u).getOrDie("Could not find expected socket element");SC&&(qi(c.element,{overflow:"scroll","-webkit-overflow-scrolling":"touch"}),s=function(){e.fire("ScrollContent")},l=20,f=null,d=sv(c.element,"scroll",{cancel:function(){null!==f&&(clearTimeout(f),f=null)},throttle:function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];null===f&&(f=setTimeout(function(){s.apply(null,t),f=null},l))}}.throttle),e.on("remove",d.unbind)),yp(e,n),e.addCommand("ToggleSidebar",function(t,n){fC.toggleSidebar(u,n),e.fire("ToggleSidebar")}),e.addQueryValueHandler("ToggleSidebar",function(){return fC.whichSidebar(u)});var d=cp(e);return d!==Jm.sliding&&d!==Jm.floating||e.on("ResizeWindow ResizeEditor ResizeContent",function(){var t=e.getWin().innerWidth;t!==i.get()&&(fC.refreshToolbar(n.outerContainer),i.set(t))}),{iframeContainer:c.element.dom,editorContainer:u.element.dom,api:{enable:function(){bp(n,!1)},disable:function(){bp(n,!0)},isDisabled:function(){return Kg.isDisabled(u)}}}}}),CC=function(t){return/^[0-9\.]+(|px)$/i.test(""+t)?Z.some(parseInt(""+t,10)):Z.none()},OC=function(t){return s(t)?t+"px":t},_C=function(n,t,e){t=t.filter(function(t){return n<t}),e=e.filter(function(t){return t<n});return t.or(e).getOr(n)},TC=function(t){var n,e,o,r;return(e=$g(n=t),o=tp(n),r=ep(n),CC(e).map(function(t){return _C(t,o,r)})).getOr($g(t))},EC=function(t){var n=Qg(t),e=Zg(t),o=np(t);return CC(n).map(function(t){return _C(t,e,o)})},DC=function(r,i,t,n,o){var e=t.uiMothership,u=t.outerContainer,a=Pg.DOM,c=dp(r),s=pp(r),l=np(r).or(EC(r)),f=n.shared.header,d=f.isPositionedAtTop,n=cp(r),m=n===Jm.sliding||n===Jm.floating,g=Zn(!1),p=function(){return g.get()&&!r.removed},h=function(t){return m?t.fold(U(0),function(t){return 1<t.components().length?bu(t.components()[1].element):0}):0},v=function(){e.broadcastOn([al()],{})},b=function(t){var n,e;void 0===t&&(t=!1),p()&&(c||(n=l.getOrThunk(function(){var t=CC(Ji(Wi(),"margin-left")).getOr(0);return _u(Wi())-ku(i).left+t}),Yi(o.get().element,"max-width",n+"px")),m&&fC.refreshToolbar(u),c||(e=fC.getToolbar(u),n=h(e),e=zu(i),n=d()?Math.max(e.y-bu(o.get().element)+n,0):e.bottom,qi(u.element,{position:"absolute",top:Math.round(n)+"px",left:Math.round(e.x)+"px"})),s&&(e=o.get(),t?P1.reset(e):P1.refresh(e)),v())},y=function(t){var n,e;void 0===t&&(t=!0),!c&&s&&p()&&(n=f.getDockingMode(),(e=function(t){switch(sp(r)){case ap.auto:var n=fC.getToolbar(u),e=h(n),o=bu(t.element)-e,n=zu(i);if(n.y>o)return"top";e=hr(i),e=Math.max(e.dom.scrollHeight,bu(e));return n.bottom<e-o||Nu().bottom<n.bottom-o?"bottom":"top";case ap.bottom:return"bottom";case ap.top:default:return"top"}}(o.get()))!==n&&(function(t){var n=o.get();P1.setModes(n,[t]),f.setDockingMode(t);t=d()?ta.TopToBottom:ta.BottomToTop;jr(n.element,Wc,t)}(e),t&&b(!0)))};return{isVisible:p,isPositionedAtTop:d,show:function(){g.set(!0),Yi(u.element,"display","flex"),a.addClass(r.getBody(),"mce-edit-focus"),tu(e.element,"display"),y(!1),b()},hide:function(){g.set(!1),t.outerContainer&&(Yi(u.element,"display","none"),a.removeClass(r.getBody(),"mce-edit-focus")),Yi(e.element,"display","none")},update:b,updateMode:y,repositionPopups:v}},BC=function(t,n){t=zu(t);return{pos:n?t.y:t.bottom,bounds:t}},AC=Object.freeze({__proto__:null,render:function(n,e,o,r,t){var i=e.mothership,u=e.uiMothership,a=e.outerContainer,c=Zn(null),s=ne.fromDom(t.targetNode),l=DC(n,s,e,r,c),f=n.getParam("toolbar_persist",!1,"boolean");xC(n);var d=function(){var t;c.get()?l.show():(c.set(fC.getHeader(a).getOrDie()),t=mp(n),Js(t,i),Js(t,u),wC(n,e,o,r),fC.setMenubar(a,gC(n,o)),l.show(),function(i,u,a,t){var c=Zn(BC(u,a.isPositionedAtTop())),n=function(t){var n=BC(u,a.isPositionedAtTop()),e=n.pos,o=n.bounds,r=c.get(),n=r.pos,r=r.bounds,r=o.height!==r.height||o.width!==r.width;c.set({pos:e,bounds:o}),r&&gh(i,t),a.isVisible()&&(n!==e?a.update(!0):r&&(a.updateMode(),a.repositionPopups()))};t||(i.on("activate",a.show),i.on("deactivate",a.hide)),i.on("SkinLoaded ResizeWindow",function(){return a.update(!0)}),i.on("NodeChange keydown",function(t){gm.requestAnimationFrame(function(){return n(t)})}),i.on("ScrollWindow",function(){return a.updateMode()});var e=Lk();e.set(lv(ne.fromDom(i.getBody()),"load",n)),i.on("remove",function(){e.clear()})}(n,s,l,f),n.nodeChanged())},m=function(){return gm.setEditorTimeout(n,d,0)};return n.on("show",d),n.on("hide",l.hide),f||(n.on("focus",m),n.on("blur",l.hide)),n.on("init",function(){(n.hasFocus()||f)&&m()}),yp(n,e),{editorContainer:a.element.dom,api:{show:function(){l.show()},hide:function(){l.hide()},enable:function(){bp(e,!1)},disable:function(){bp(e,!0)},isDisabled:function(){return Kg.isDisabled(a)}}}}}),MC=function(t,n){var e,o,r,i,u,a,c,s;e=Gk(0,a=n,Jk(r=t)),r.ui.registry.addNestedMenuItem("align",{text:a.shared.providers.translate("Align"),getSubmenuItems:function(){return e.items.validateItems(e.getStyleItems())}}),o=Gk(0,i=n,Zk(r=t)),r.ui.registry.addNestedMenuItem("fontformats",{text:i.shared.providers.translate("Fonts"),getSubmenuItems:function(){return o.items.validateItems(o.getStyleItems())}}),a=t,i=Q({type:"advanced"},(r=n).styleselect),u=Gk(0,r,u1(a,i)),a.ui.registry.addNestedMenuItem("formats",{text:"Formats",getSubmenuItems:function(){return u.items.validateItems(u.getStyleItems())}}),c=Gk(0,n,i1(a=t)),a.ui.registry.addNestedMenuItem("blockformats",{text:"Blocks",getSubmenuItems:function(){return c.items.validateItems(c.getStyleItems())}}),s=Gk(0,n,o1(t=t)),t.ui.registry.addNestedMenuItem("fontsizes",{text:"Font sizes",getSubmenuItems:function(){return s.items.validateItems(s.getStyleItems())}})},FC=function(t){var n;t.ui.registry.addButton("outdent",{tooltip:"Decrease indent",icon:"outdent",onSetup:jk(n=t,"NodeChange",function(t){t.setDisabled(!n.queryCommandState("outdent"))}),onAction:Uk(t,"outdent")}),t.ui.registry.addButton("indent",{tooltip:"Increase indent",icon:"indent",onAction:Uk(t,"indent")})},IC={unsupportedLength:["em","ex","cap","ch","ic","rem","lh","rlh","vw","vh","vi","vb","vmin","vmax","cm","mm","Q","in","pc","pt","px"],fixed:["px","pt"],relative:["%"],empty:[""]},RC=(ca="[eE][+-]?[0-9]+",ca=["Infinity",(po="[0-9]+")+"\\."+($n=function(t){return"(?:"+t+")?"})(po)+$n(ca),"\\."+po+$n(ca),po+$n(ca)].join("|"),new RegExp("^("+("[+-]?(?:"+ca+")")+")(.*)$")),VC=function(t,o){return Z.from(RC.exec(t)).bind(function(t){var n,e=Number(t[1]),t=t[2];return n=t,M(o,function(t){return M(IC[t],function(t){return n===t})})?Z.some({value:e,unit:t}):Z.none()})},PC=function(t){return VC(t,["fixed","relative","empty"]).map(function(t){return t.value+t.unit}).getOr(t)},HC=function(o){var r=o.getParam("lineheight_formats","1 1.1 1.2 1.3 1.4 1.5 2","string").split(" "),i=new Map,u=zk(),a=function(){var t=PC(o.queryCommandValue("LineHeight"));Z.from(i.get(t)).fold(function(){return u.clear()},function(t){u.set({destroy:function(){t.setActive(!1)}}),t.setActive(!0)})};return o.on("nodeChange",a),R(r,function(n,e){return{type:"togglemenuitem",text:n,onSetup:function(t){return i.set(PC(n),t),e+1===r.length&&a(),function(){0===e&&(o.off("nodeChange",a),u.clear())}},onAction:function(){return o.execCommand("LineHeight",!1,n)}}})},zC=function(t){var n,e;(n=t).ui.registry.addNestedMenuItem("lineheight",{type:"nestedmenuitem",text:"Line height",getSubmenuItems:function(){return HC(n)}}),(e=t).ui.registry.addMenuButton("lineheight",{tooltip:"Line height",icon:"line-height",fetch:function(t){return t(HC(e))}})},LC=function(t,n){return function(){t.execCommand("mceToggleFormat",!1,n)}},NC=function(t){var n,e;!function(e){$y.each([{name:"bold",text:"Bold",icon:"bold"},{name:"italic",text:"Italic",icon:"italic"},{name:"underline",text:"Underline",icon:"underline"},{name:"strikethrough",text:"Strikethrough",icon:"strike-through"},{name:"subscript",text:"Subscript",icon:"subscript"},{name:"superscript",text:"Superscript",icon:"superscript"}],function(t,n){e.ui.registry.addToggleButton(t.name,{tooltip:t.text,icon:t.icon,onSetup:Nk(e,t.name),onAction:LC(e,t.name)})});for(var t=1;t<=6;t++){var n="h"+t;e.ui.registry.addToggleButton(n,{text:n.toUpperCase(),tooltip:"Heading "+t,onSetup:Nk(e,n),onAction:LC(e,n)})}}(t),n=t,$y.each([{name:"cut",text:"Cut",action:"Cut",icon:"cut"},{name:"copy",text:"Copy",action:"Copy",icon:"copy"},{name:"paste",text:"Paste",action:"Paste",icon:"paste"},{name:"help",text:"Help",action:"mceHelp",icon:"help"},{name:"selectall",text:"Select all",action:"SelectAll",icon:"select-all"},{name:"newdocument",text:"New document",action:"mceNewDocument",icon:"new-document"},{name:"removeformat",text:"Clear formatting",action:"RemoveFormat",icon:"remove-formatting"},{name:"remove",text:"Remove",action:"Delete",icon:"remove"}],function(t){n.ui.registry.addButton(t.name,{tooltip:t.text,icon:t.icon,onAction:Uk(n,t.action)})}),e=t,$y.each([{name:"blockquote",text:"Blockquote",action:"mceBlockQuote",icon:"quote"}],function(t){e.ui.registry.addToggleButton(t.name,{tooltip:t.text,icon:t.icon,onAction:Uk(e,t.action),onSetup:Nk(e,t.name)})})},jC=function(t){var n;NC(t),n=t,$y.each([{name:"bold",text:"Bold",action:"Bold",icon:"bold",shortcut:"Meta+B"},{name:"italic",text:"Italic",action:"Italic",icon:"italic",shortcut:"Meta+I"},{name:"underline",text:"Underline",action:"Underline",icon:"underline",shortcut:"Meta+U"},{name:"strikethrough",text:"Strikethrough",action:"Strikethrough",icon:"strike-through",shortcut:""},{name:"subscript",text:"Subscript",action:"Subscript",icon:"subscript",shortcut:""},{name:"superscript",text:"Superscript",action:"Superscript",icon:"superscript",shortcut:""},{name:"removeformat",text:"Clear formatting",action:"RemoveFormat",icon:"remove-formatting",shortcut:""},{name:"newdocument",text:"New document",action:"mceNewDocument",icon:"new-document",shortcut:""},{name:"cut",text:"Cut",action:"Cut",icon:"cut",shortcut:"Meta+X"},{name:"copy",text:"Copy",action:"Copy",icon:"copy",shortcut:"Meta+C"},{name:"paste",text:"Paste",action:"Paste",icon:"paste",shortcut:"Meta+V"},{name:"selectall",text:"Select all",action:"SelectAll",icon:"select-all",shortcut:"Meta+A"}],function(t){n.ui.registry.addMenuItem(t.name,{text:t.text,icon:t.icon,shortcut:t.shortcut,onAction:Uk(n,t.action)})}),n.ui.registry.addMenuItem("codeformat",{text:"Code",icon:"sourcecode",onAction:LC(n,"code")})},WC=function(n,e){return jk(n,"Undo Redo AddUndo TypingUndo ClearUndos SwitchMode",function(t){t.setDisabled(n.mode.isReadOnly()||!n.undoManager[e]())})},UC=function(t){var n;(n=t).ui.registry.addMenuItem("undo",{text:"Undo",icon:"undo",shortcut:"Meta+Z",onSetup:WC(n,"hasUndo"),onAction:Uk(n,"undo")}),n.ui.registry.addMenuItem("redo",{text:"Redo",icon:"redo",shortcut:"Meta+Y",onSetup:WC(n,"hasRedo"),onAction:Uk(n,"redo")}),(t=t).ui.registry.addButton("undo",{tooltip:"Undo",icon:"undo",disabled:!0,onSetup:WC(t,"hasUndo"),onAction:Uk(t,"undo")}),t.ui.registry.addButton("redo",{tooltip:"Redo",icon:"redo",disabled:!0,onSetup:WC(t,"hasRedo"),onAction:Uk(t,"redo")})},GC=function(t){var n;t.ui.registry.addToggleMenuItem("visualaid",{text:"Visual aids",onSetup:jk(n=t,"VisualAid",function(t){t.setActive(n.hasVisual)}),onAction:Uk(t,"mceToggleVisualAid")})},XC=function(t){t.ui.registry.addButton("visualaid",{tooltip:"Visual aids",text:"Visual aids",onAction:Uk(t,"mceToggleVisualAid")}),GC(t)},YC=function(t,n){var e;e=t,tt([{name:"alignleft",text:"Align left",cmd:"JustifyLeft",icon:"align-left"},{name:"aligncenter",text:"Align center",cmd:"JustifyCenter",icon:"align-center"},{name:"alignright",text:"Align right",cmd:"JustifyRight",icon:"align-right"},{name:"alignjustify",text:"Justify",cmd:"JustifyFull",icon:"align-justify"}],function(t){e.ui.registry.addToggleButton(t.name,{tooltip:t.text,icon:t.icon,onAction:Uk(e,t.cmd),onSetup:Nk(e,t.name)})}),e.ui.registry.addButton("alignnone",{tooltip:"No alignment",icon:"align-none",onAction:Uk(e,"JustifyNone")}),jC(t),MC(t,n),UC(t),function(t){Eh(t);var n=Zn(null),e=Zn(null);Rh(t,"forecolor","forecolor","Text color",n),Rh(t,"backcolor","hilitecolor","Background color",e),Vh(t,"forecolor","forecolor","Text color"),Vh(t,"backcolor","hilitecolor","Background color")}(t),XC(t),FC(t),zC(t)},qC=function(t,n){return{anchor:"makeshift",x:t,y:n}},KC=function(t){return"longpress"===t.type||0===t.type.indexOf("touch")},JC=function(t,n){var e=Pg.DOM.getPos(t);return t=e.x,e=e.y,qC(n.x+t,n.y+e)},$C=function(t,n){return"contextmenu"===n.type||"longpress"===n.type?t.inline?function(t){if(KC(t)){var n=t.touches[0];return qC(n.pageX,n.pageY)}return qC(t.pageX,t.pageY)}(n):JC(t.getContentAreaContainer(),function(t){if(KC(t)){var n=t.touches[0];return qC(n.clientX,n.clientY)}return qC(t.clientX,t.clientY)}(n)):QC(t)},QC=function(t){return{anchor:"selection",root:ne.fromDom(t.selection.getNode())}},ZC=function(t){return{anchor:"node",node:Z.some(ne.fromDom(t.selection.getNode())),root:ne.fromDom(t.getBody())}},tO=function(t,n,e,o,r,i){var e=e(),u=i?ZC(t):$C(t,n);O0(e,$m.CLOSE_ON_EXECUTE,o,!1).map(function(t){n.preventDefault(),Zd.showMenuAt(r,u,{menu:{markers:lg("normal")},data:t})})},nO={onLtr:function(){return[Na,Va,Pa,Ha,za,La,sm,lm,cm,um,am,im]},onRtl:function(){return[Na,Pa,Va,za,Ha,La,sm,lm,am,im,cm,um]}},eO={valignCentre:[],alignCentre:[],alignLeft:["tox-pop--align-left"],alignRight:["tox-pop--align-right"],right:["tox-pop--right"],left:["tox-pop--left"],bottom:["tox-pop--bottom"],top:["tox-pop--top"]},oO=function(n,e,t,o,r,i,u){var a,c=i?ZC(n):(a=n,i=e,Q({bubble:Ic(0,12,eO),layouts:nO,overrides:{maxWidthFunction:xS(),maxHeightFunction:Dc()}},$C(a,i)));O0(t,$m.CLOSE_ON_EXECUTE,o,!0).map(function(t){e.preventDefault(),Zd.showMenuWithinBounds(r,c,{menu:{markers:lg("normal"),highlightImmediately:u},data:t,type:"horizontal"},function(){return Z.some(Ek(n,o.shared))}),n.fire(wS)})},rO=function(n,e,o,r,i,u){var t,a=Ae(),c=a.os.isiOS(),s=a.os.isOSX(),l=a.os.isAndroid(),f=a.deviceType.isTouch(),d=function(){var t=o();oO(n,e,t,r,i,u,!(l||c||s&&f))};!s&&!c||u?(l&&!u&&n.selection.setCursorLocation(e.target,0),d()):(t=function(){!function(t){var n=t.selection.getRng(),e=function(){gm.setEditorTimeout(t,function(){t.selection.setRng(n)},10),i()};t.once("touchend",e);var o=function(t){t.preventDefault(),t.stopImmediatePropagation()};t.on("mousedown",o,!0);var r=function(){return i()};t.once("longpresscancel",r);var i=function(){t.off("touchend",e),t.off("longpresscancel",r),t.off("mousedown",o)}}(n),d()},!function(t,n){var e=t.selection;if(e.isCollapsed()||n.touches.length<1)return!1;var o=n.touches[0],e=e.getRng();return ws(t.getWin(),rs.domRange(e)).exists(function(t){return t.left<=o.clientX&&t.right>=o.clientX&&t.top<=o.clientY&&t.bottom>=o.clientY})}(n,e)?(n.once("selectionchange",t),n.once("touchend",function(){return n.off("selectionchange",t)})):t())},iO=function(t){return"string"==typeof t?t.split(/[ ,]/):t},uO=function(t){return t.getParam("contextmenu_never_use_native",!1,"boolean")},aO=function(t){return n="contextmenu",e="link linkchecker image imagetools table spellchecker configurepermanentpen",o=(t=t).ui.registry.getAll().contextMenus,Z.from(t.getParam(n)).map(iO).getOrThunk(function(){return P(iO(e),function(t){return Vt(o,t)})});var n,e,o},cO=function(t){return v(t)?"|"===t:"separator"===t.type},sO={type:"separator"},lO=function(n){var t,e=function(t){return{text:t.text,icon:t.icon,disabled:t.disabled,shortcut:t.shortcut}};if(v(n))return n;switch(n.type){case"separator":return sO;case"submenu":return Q(Q({type:"nestedmenuitem"},e(n)),{getSubmenuItems:function(){var t=n.getSubmenuItems();return v(t)?t:R(t,lO)}});default:return Q(Q({type:"menuitem"},e(n)),{onAction:(t=n.onAction,function(){return t()})})}},fO=function(t,n){if(0===n.length)return t;var e=et(t).filter(function(t){return!cO(t)}).fold(function(){return[]},function(t){return[sO]});return t.concat(e).concat(n).concat([sO])},dO=function(t,n){return"longpress"!==n.type&&(2!==n.button||n.target===t.getBody()&&""===n.pointerType)},mO=function(t,n){return dO(t,n)?t.selection.getStart(!0):n.target},gO=function(r,t,n){var e=Ae().deviceType.isTouch,i=gu(Zd.sketch({dom:{tag:"div"},lazySink:t,onEscape:function(){return r.focus()},onShow:function(){return n.setContextMenuState(!0)},onHide:function(){return n.setContextMenuState(!1)},fireDismissalEventInstead:{},inlineBehaviours:ec([Sd("dismissContextMenu",[$o(Io(),function(t,n){il.close(t),r.focus()})])])})),o=function(t){return Zd.hide(i)},u=function(o){var t;uO(r)&&o.preventDefault(),t=r,o.ctrlKey&&!uO(t)||!1===r.getParam("contextmenu")||(t=function(t,n){var e=t.getParam("contextmenu_avoid_overlap","","string");if(dO(t,n))return!0;if(e){n=mO(t,n);return dv(ne.fromDom(n),e)}return!1}(r,o),(e()?rO:tO)(r,o,function(){var t=mO(r,o),n=r.ui.registry.getAll(),e=aO(r);return function(e,t,o){t=z(t,function(n,t){return Rt(e,t.toLowerCase()).map(function(t){t=t.update(o);if(v(t))return fO(n,t.split(" "));if(0<t.length){t=R(t,lO);return fO(n,t)}return n}).getOrThunk(function(){return n.concat([t])})},[]);return 0<t.length&&cO(t[t.length-1])&&t.pop(),t}(n.contextMenus,e,t)},n,i,t))};r.on("init",function(){var t="ResizeEditor ScrollContent ScrollWindow longpresscancel"+(e()?"":" ResizeWindow");r.on(t,o),r.on("longpress contextmenu",u)})},C=Pe([{offset:["x","y"]},{absolute:["x","y"]},{fixed:["x","y"]}]),pO=function(n){return function(t){return t.translate(-n.left,-n.top)}},hO=function(n){return function(t){return t.translate(n.left,n.top)}},vO=function(e){return function(t,n){return z(e,function(t,n){return n(t)},wu(t,n))}},bO=function(t,n,e){return t.fold(vO([hO(e),pO(n)]),vO([pO(n)]),vO([]))},yO=function(t,n,e){return t.fold(vO([hO(e)]),vO([]),vO([hO(n)]))},xO=function(t,n,e){return t.fold(vO([]),vO([pO(e)]),vO([hO(n),pO(e)]))},wO=function(t,n,e){t=t.fold(function(t,n){return{position:Z.some("absolute"),left:Z.some(t+"px"),top:Z.some(n+"px")}},function(t,n){return{position:Z.some("absolute"),left:Z.some(t-e.left+"px"),top:Z.some(n-e.top+"px")}},function(t,n){return{position:Z.some("fixed"),left:Z.some(t+"px"),top:Z.some(n+"px")}});return Q({right:Z.none(),bottom:Z.none()},t)},SO=function(t,i,u,a){var n=function(o,r){return function(t,n){var e=o(i,u,a);return r(t.getOr(e.left),n.getOr(e.top))}};return t.fold(n(xO,kO),n(yO,CO),n(bO,OO))},kO=C.offset,CO=C.absolute,OO=C.fixed,_O=function(t,n){n=Wr(t,n);return o(n)?NaN:parseInt(n,10)},TO=function(t,n,e,o){return r=n,t=(n=t).element,n=_O(t,r.leftAttr),r=_O(t,r.topAttr),(isNaN(n)||isNaN(r)?Z.none():Z.some(wu(n,r))).fold(function(){return e},function(t){return OO(t.left+o.left,t.top+o.top)});var r},EO=function(t,n,e,o,r,i){var e=TO(t,n,e,o),o=(n.mustSnap?AO:MO)(t,n,e,r,i),u=bO(e,r,i);return function(t,n,e){t=t.element;jr(t,n.leftAttr,e.left+"px"),jr(t,n.topAttr,e.top+"px")}(t,n,u),o.fold(function(){return{coord:OO(u.left,u.top),extra:Z.none()}},function(t){return{coord:t.output,extra:t.extra}})},DO=function(t,n){!function(t,n){t=t.element;Xr(t,n.leftAttr),Xr(t,n.topAttr)}(t,n)},BO=function(t,e,o,r){return rt(t,function(t){var n=t.sensor;return function(t,n,e,o,r,i){t=yO(t,r,i),i=yO(n,r,i);return Math.abs(t.left-i.left)<=e&&Math.abs(t.top-i.top)<=o}(e,n,t.range.left,t.range.top,o,r)?Z.some({output:SO(t.output,e,o,r),extra:t.extra}):Z.none()})},AO=function(t,n,r,i,u){var e=n.getSnapPoints(t);return BO(e,r,i,u).orThunk(function(){return z(e,function(n,e){var t=e.sensor,o=function(t,n,e,o){t=yO(t,e,o),e=yO(n,e,o),o=Math.abs(t.left-e.left),e=Math.abs(t.top-e.top);return wu(o,e)}(r,t,(e.range.left,e.range.top,i),u);return n.deltas.fold(function(){return{deltas:Z.some(o),snap:Z.some(e)}},function(t){return(o.left+o.top)/2<=(t.left+t.top)/2?{deltas:Z.some(o),snap:Z.some(e)}:n})},{deltas:Z.none(),snap:Z.none()}).snap.map(function(t){return{output:SO(t.output,r,i,u),extra:t.extra}})})},MO=function(t,n,e,o,r){t=n.getSnapPoints(t);return BO(t,e,o,r)},pe=Object.freeze({__proto__:null,snapTo:function(t,n,e,o){var r=n.getTarget(t.element);n.repositionTarget&&(n=gr(t.element),t=Au(n),n=S1(r),o={coord:SO((o=o).output,o.output,t,n),extra:o.extra},n=wO(o.coord,0,n),Ki(r,n))}}),FO="data-initial-z-index",IO=function(t,n){var e;t.getSystem().addToGui(n),br((e=n).element).filter(lr).each(function(n){Qi(n,"z-index").each(function(t){jr(n,FO,t)}),Yi(n,"z-index",Ji(e.element,"z-index"))})},RO=function(t){br(t.element).filter(lr).each(function(n){Ur(n,FO).fold(function(){return tu(n,"z-index")},function(t){return Yi(n,"z-index",t)}),Xr(n,FO)}),t.getSystem().removeFromGui(t)},VO=function(t,n,e){return t.getSystem().build(Tv.sketch({dom:{styles:{left:"0px",top:"0px",width:"100%",height:"100%",position:"fixed","z-index":"1000000000000000"},classes:[n]},events:e}))},hu=Wn("snaps",[Bn("getSnapPoints"),da("onSensor"),Bn("leftAttr"),Bn("topAttr"),Un("lazyViewport",Nu),Un("mustSnap",!1)]),sa=[Un("useFixed",d),Bn("blockerClass"),Un("getTarget",h),Un("onDrag",$),Un("repositionTarget",!0),Un("onDrop",$),Jn("getBounds",Nu),hu],PO=function(n){return t=Qi(n,"left"),e=Qi(n,"top"),o=Qi(n,"position"),r=function(t,n,e){return("fixed"===e?OO:kO)(parseInt(t,10),parseInt(n,10))},(t.isSome()&&e.isSome()&&o.isSome()?Z.some(r(t.getOrDie(),e.getOrDie(),o.getOrDie())):Z.none()).getOrThunk(function(){var t=ku(n);return CO(t.left,t.top)});var t,e,o,r},HO=function(e,t,r,i,u,a,n){var o,c,s,l,f,d=t.fold(function(){var e,o,t=(e=a.left,o=a.top,r.fold(function(t,n){return kO(t+e,n+o)},function(t,n){return CO(t+e,n+o)},function(t,n){return OO(t+e,n+o)})),t=bO(t,i,u);return OO(t.left,t.top)},function(n){var t=EO(e,n,r,a,i,u);return t.extra.each(function(t){n.onSensor(e,t)}),t.coord});return o=d,c=i,s=u,t=(l=n).bounds,d=yO(o,c,s),n=Ea(d.left,t.x,t.x+t.width-l.width),l=Ea(d.top,t.y,t.y+t.height-l.height),f=CO(n,l),o.fold(function(){var t=xO(f,c,s);return kO(t.left,t.top)},U(f),function(){var t=bO(f,c,s);return OO(t.left,t.top)})},zO=function(t,n){return{bounds:t.getBounds(),height:yu(n.element),width:Tu(n.element)}},LO=function(c,s,t,n,e){var e=t.update(n,e),l=t.getStartData().getOrThunk(function(){return zO(s,c)});e.each(function(t){var n,e,o,r,i,u,a;n=c,o=l,r=t,a=(e=s).getTarget(n.element),e.repositionTarget&&(u=gr(n.element),i=Au(u),t=S1(a),u=PO(a),o=HO(n,e.snaps,u,i,t,r,o),t=wO(o,0,t),Ki(a,t)),e.onDrag(n,a,r)})},NO=function(n,t,e,o){t.each(RO),e.snaps.each(function(t){DO(n,t)});t=e.getTarget(n.element);o.reset(),e.onDrop(n,t)},po=function(t){return function(n,e){var o=function(t){e.setStartData(zO(n,t))};return qo(p([$o(Bo(),function(t){e.getStartData().each(function(){return o(t)})})],t(n,e,o)))}},jO=Object.freeze({__proto__:null,getData:function(t){return Z.from(wu(t.x,t.y))},getDelta:function(t,n){return wu(n.left-t.left,n.top-t.top)}}),WO=function(i,u,a){return[$o(to(),function(n,t){var e,o,r;0===t.event.raw.button&&(t.stop(),t={drop:t=function(){return NO(n,Z.some(o),i,u)},delayDrop:(e=mv(t,200)).schedule,forceDrop:t,move:function(t){e.cancel(),LO(n,i,u,jO,t)}},o=VO(n,i.blockerClass,(r=t,qo([$o(to(),r.forceDrop),$o(oo(),r.drop),$o(no(),function(t,n){r.move(n.event)}),$o(eo(),r.delayDrop)]))),a(n),IO(n,o))})]},$n=p(p([],sa),[ha("dragger",{handlers:po(WO)})]),UO=Object.freeze({__proto__:null,getData:function(t){t=t.raw.touches;return 1===t.length?function(t){t=t[0];return Z.some(wu(t.clientX,t.clientY))}(t):Z.none()},getDelta:function(t,n){return wu(n.left-t.left,n.top-t.top)}}),GO=function(r,i,u){var a=Zn(Z.none());return[$o(Je(),function(n,t){t.stop();var e,t=function(){NO(n,a.get(),r,i),a.set(Z.none())},o=VO(n,r.blockerClass,(e={drop:t,delayDrop:$,forceDrop:t,move:function(t){LO(n,r,i,UO,t)}},qo([$o(Je(),e.forceDrop),$o(Qe(),e.drop),$o(Ze(),e.drop),$o($e(),function(t,n){e.move(n.event)})])));a.set(Z.some(o));u(n),IO(n,o)}),$o($e(),function(t,n){n.stop(),LO(t,r,i,UO,n.event)}),$o(Qe(),function(t,n){n.stop(),NO(t,a.get(),r,i),a.set(Z.none())}),$o(Ze(),function(t){NO(t,a.get(),r,i),a.set(Z.none())})]},ca=p(p([],sa),[ha("dragger",{handlers:po(GO)})]),Pe=p(p([],sa),[ha("dragger",{handlers:po(function(t,n,e){return p(p([],WO(t,n,e)),GO(t,n,e))})})]),XO=uc({branchKey:"mode",branches:Object.freeze({__proto__:null,mouse:$n,touch:ca,mouseOrTouch:Pe}),name:"dragging",active:{events:function(t,n){return t.dragger.handlers(t,n)}},extra:{snap:function(t){return{sensor:t.sensor,range:t.range,output:t.output,extra:Z.from(t.extra)}}},state:Object.freeze({__proto__:null,init:function(){var r=Z.none(),n=Z.none(),t=U({});return pi({readState:t,reset:function(){r=Z.none(),n=Z.none()},update:function(o,t){return o.getData(t).bind(function(t){return n=o,e=t,t=r.map(function(t){return n.getDelta(t,e)}),r=Z.some(e),t;var n,e})},getStartData:function(){return n},setStartData:function(t){n=Z.some(t)}})}}),apis:pe}),YO=function(t,o,r,i,n,e){return t.fold(function(){return XO.snap({sensor:CO(r-20,i-20),range:wu(n,e),output:CO(Z.some(r),Z.some(i)),extra:{td:o}})},function(t){var n=r-20,e=i-20,t=t.element.dom.getBoundingClientRect();return XO.snap({sensor:CO(n,e),range:wu(40,40),output:CO(Z.some(r-t.width/2),Z.some(i-t.height/2)),extra:{td:o}})})},qO=function(t,r,i){return{getSnapPoints:t,leftAttr:"data-drag-left",topAttr:"data-drag-top",onSensor:function(t,n){var e,o=n.td;n=r.get(),e=o,n.exists(function(t){return Ie(t,e)})||(r.set(Z.some(o)),i(o))},mustSnap:!0}},KO=function(t){return hm(pm.sketch({dom:{tag:"div",classes:["tox-selector"]},buttonBehaviours:ec([XO.config({mode:"mouseOrTouch",blockerClass:"blocker",snaps:t}),Db.config({})]),eventOrder:{mousedown:["dragging","alloy.base.behaviour"],touchstart:["dragging","alloy.base.behaviour"]}}))},JO=function(i,e){var o=Zn([]),r=Zn([]),t=Zn(!1),u=Zn(Z.none()),a=Zn(Z.none()),n=function(t){var n=Lu(t);return YO(f.getOpt(e),t,n.x,n.y,n.width,n.height)},c=function(t){var n=Lu(t);return YO(d.getOpt(e),t,n.right,n.bottom,n.width,n.height)},s=qO(function(){return R(o.get(),n)},u,function(n){a.get().each(function(t){i.fire("TableSelectorChange",{start:n,finish:t})})}),l=qO(function(){return R(r.get(),c)},a,function(n){u.get().each(function(t){i.fire("TableSelectorChange",{start:t,finish:n})})}),f=KO(s),d=KO(l),m=gu(f.asSpec()),g=gu(d.asSpec()),p=function(t,n,e,o){e=e(n);XO.snapTo(t,e);!function(t,n,e,o){var r=n.dom.getBoundingClientRect();tu(t.element,"display");n=vr(ne.fromDom(i.getBody())).dom.innerHeight,e=e(r),n=o(r,n);(e||n)&&Yi(t.element,"display","none")}(t,n,function(t){return t[o]<0},function(t,n){return t[o]>n})},h=function(t){return p(m,t,n,"top")},v=function(t){return p(g,t,c,"bottom")};Ae().deviceType.isTouch()&&(i.on("TableSelectionChange",function(n){t.get()||(Gs(e,m),Gs(e,g),t.set(!0)),u.set(Z.some(n.start)),a.set(Z.some(n.finish)),n.otherCells.each(function(t){o.set(t.upOrLeftCells),r.set(t.downOrRightCells),h(n.start),v(n.finish)})}),i.on("ResizeEditor ResizeWindow ScrollContent",function(){u.get().each(h),a.get().each(v)}),i.on("TableSelectionClear",function(){t.get()&&(qs(m),qs(g),t.set(!1)),u.set(Z.none()),a.set(Z.none())}))},$O=function(i,o,r){o.delimiter||(o.delimiter="\xbb");return{dom:{tag:"div",classes:["tox-statusbar__path"],attributes:{role:"navigation"}},behaviours:ec([hd.config({mode:"flow",selector:"div[role=button]"}),Kg.config({disabled:r.isDisabled}),xp(),Bv.config({}),wd.config({}),Sd("elementPathEvents",[rr(function(n,t){i.shortcuts.add("alt+F11","focus statusbar elementpath",function(){return hd.focusIn(n)}),i.on("NodeChange",function(t){var e,t=function(t){for(var n=[],e=t.length;0<e--;){var o=t[e];if(1===o.nodeType&&!function(t){if(1===t.nodeType){if("BR"===t.nodeName||t.getAttribute("data-mce-bogus"))return!0;if("bookmark"===t.getAttribute("data-mce-type"))return!0}return!1}(o)){var r=i.fire("ResolveName",{name:o.nodeName.toLowerCase(),target:o});if(r.isDefaultPrevented()||n.push({name:r.name,element:o}),r.isPropagationStopped())break}}return n}(t.parents);0<t.length?wd.set(n,(t=R((t=t)||[],function(n,t){return pm.sketch({dom:{tag:"div",classes:["tox-statusbar__path-item"],attributes:{role:"button","data-index":t,"tab-index":-1,"aria-level":t+1},innerHtml:n.name},action:function(t){i.focus(),i.selection.select(n.element),i.nodeChanged()},buttonBehaviours:ec([Sp(r.isDisabled),xp()])})}),e={dom:{tag:"div",classes:["tox-statusbar__path-divider"],attributes:{"aria-hidden":!0},innerHtml:" "+o.delimiter+" "}},z(t.slice(1),function(t,n){return t.push(e),t.push(n),t},[t[0]]))):wd.set(n,[])})})])]),components:[]}};(C=Yk=Yk||{})[C.None=0]="None",C[C.Both=1]="Both",C[C.Vertical=2]="Vertical";var QO,ZO,t_=function(t,n,e){var o,r,i,u,a=ne.fromDom(t.getContainer()),e=(o=t,r=n,i=e,u=bu(a),n=_u(a),(e={}).height=_C(u+r.top,tp(o),ep(o)),i===Yk.Both&&(e.width=_C(n+r.left,Zg(o),np(o))),e);Et(e,function(t,n){return Yi(a,n,OC(t)),0}),t.fire("ResizeEditor")},n_=function(t,n,e,o){o=wu(20*e,20*o);return t_(t,o,n),Z.some(!0)},e_=function(o,t){var n,e,r=(e=!(n=o).hasPlugin("autoresize"),!1===(e=n.getParam("resize",e))?Yk.None:"both"===e?Yk.Both:Yk.Vertical);return r===Yk.None?Z.none():Z.some({dom:{tag:"div",classes:["tox-statusbar__resize-handle"],attributes:{title:t.translate("Resize")},innerHtml:bm("resize-handle",t.icons)},behaviours:ec([XO.config({mode:"mouse",repositionTarget:!1,onDrag:function(t,n,e){return t_(o,e,r)},blockerClass:"tox-blocker"}),hd.config({mode:"special",onLeft:function(){return n_(o,r,-1,0)},onRight:function(){return n_(o,r,1,0)},onUp:function(){return n_(o,r,0,-1)},onDown:function(){return n_(o,r,0,1)}}),Bv.config({}),Cd.config({})])})},o_=function(i,u){var t,n;return{dom:{tag:"div",classes:["tox-statusbar"]},components:(t=function(){var t,o,r,n,e=[];return i.getParam("elementpath",!0,"boolean")&&e.push($O(i,{},u)),i.hasPlugin("wordcount")&&e.push((t=i,o=u,r=function(t,n,e){return wd.set(t,[fu(o.translate(["{0} "+e,n[e]]))])},pm.sketch({dom:{tag:"button",classes:["tox-statusbar__wordcount"]},components:[],buttonBehaviours:ec([Sp(o.isDisabled),xp(),Bv.config({}),wd.config({}),vl.config({store:{mode:"memory",initialValue:{mode:"words",count:{words:0,characters:0}}}}),Sd("wordcount-events",[ar(function(t){var n=vl.getValue(t),e="words"===n.mode?"characters":"words";vl.setValue(t,{mode:e,count:n.count}),r(t,n.count,e)}),rr(function(e){t.on("wordCountUpdate",function(t){var n=vl.getValue(e).mode;vl.setValue(e,{mode:n,count:t.wordCount}),r(e,t.wordCount,n)})})])]),eventOrder:((n={})[wo()]=["disabling","alloy.base.behaviour","wordcount-events"],n)}))),i.getParam("branding",!0,"boolean")&&e.push({dom:{tag:"span",classes:["tox-statusbar__branding"],innerHtml:'<a href="https://www.tiny.cloud/?utm_campaign=editor_referral&amp;utm_medium=poweredby&amp;utm_source=tinymce&amp;utm_content=v5" rel="noopener" target="_blank" tabindex="-1" aria-label="'+(n=Hg.translate(["Powered by {0}","Tiny"]))+'">'+n+"</a>"}}),0<e.length?[{dom:{tag:"div",classes:["tox-statusbar__text-container"]},components:e}]:[]}(),n=e_(i,u),t.concat(n.toArray()))}},r_=function(a){var t,n,e,o=a.inline,c=o?AC:kC,s=pp(a)?X1:x1,r=Z.none(),i=Ae(),u=i.browser.isIE()?["tox-platform-ie"]:[],l=i.deviceType.isTouch()?["tox-platform-touch"]:[],f=lp(a),d=mp(a),m=Hg.isRtl()?{attributes:{dir:"rtl"}}:{},g={attributes:((E={})[Wc]=f?ta.BottomToTop:ta.TopToBottom,E)},p=function(){return r.bind(fC.getHeader)},h=function(){Yi(K.element,"width",document.body.clientWidth+"px")},v=gu((t=Ie(Wi(),d)&&"grid"===Ji(d,"display"),n={dom:Q({tag:"div",classes:["tox","tox-silver-sink","tox-tinymce-aux"].concat(u).concat(l)},m),behaviours:ec([Ls.config({useFixed:function(){return s.isDocked(p)}})])},e={dom:{styles:{width:document.body.clientWidth+"px"}},events:qo([$o(Ao(),h)])},zt(n,t?e:{}))),b=function(){return at.value(v)},y=hm({dom:{tag:"div",classes:["tox-anchorbar"]}}),x=function(){return r.bind(function(t){return fC.getThrobber(t)}).getOrDie("Could not find throbber element")},w=yS(v,a,function(){return r.bind(function(t){return y.getOpt(t)}).getOrDie("Could not find a anchor bar element")}),S=fC.parts.menubar({dom:{tag:"div",classes:["tox-menubar"]},backstage:w,onEscape:function(){a.focus()}}),k=cp(a),C=fC.parts.toolbar(Q({dom:{tag:"div",classes:["tox-toolbar"]},getSink:b,providers:w.shared.providers,onEscape:function(){a.focus()},type:k,lazyToolbar:function(){return r.bind(function(t){return fC.getToolbar(t)}).getOrDie("Could not find more toolbar element")},lazyHeader:function(){return p().getOrDie("Could not find header element")}},g)),O=fC.parts["multiple-toolbar"]({dom:{tag:"div",classes:["tox-toolbar-overlord"]},providers:w.shared.providers,onEscape:function(){a.focus()},type:k}),_=fC.parts.socket({dom:{tag:"div",classes:["tox-edit-area"]}}),T=fC.parts.sidebar({dom:{tag:"div",classes:["tox-sidebar"]}}),i=fC.parts.throbber({dom:{tag:"div",classes:["tox-throbber"]},backstage:w}),E=a.getParam("statusbar",!0,"boolean")&&!o?Z.some(o_(a,w.shared.providers)):Z.none(),_={dom:{tag:"div",classes:["tox-sidebar-wrap"]},components:[_,T]},D=up(a),B=rp(a),T=op(a),S=fC.parts.header({dom:Q({tag:"div",classes:["tox-editor-header"]},g),components:nt([T?[S]:[],D?[O]:B?[C]:[],dp(a)?[]:[y.asSpec()]]),sticky:pp(a),editor:a,sharedBackstage:w.shared}),S=nt([f?[]:[S],o?[]:[_],f?[S]:[]]),S=nt([[{dom:{tag:"div",classes:["tox-editor-container"]},components:S}],o?[]:E.toArray(),[i]]),E=gp(a),i=Q(Q({role:"application"},Hg.isRtl()?{dir:"rtl"}:{}),E?{"aria-hidden":"true"}:{}),A=gu(fC.sketch({dom:{tag:"div",classes:["tox","tox-tinymce"].concat(o?["tox-tinymce-inline"]:[]).concat(f?["tox-tinymce--toolbar-bottom"]:[]).concat(l).concat(u),styles:Q({visibility:"hidden"},E?{opacity:"0",border:"0"}:{}),attributes:i},components:S,behaviours:ec([xp(),Kg.config({disableClass:"tox-tinymce--disabled"}),hd.config({mode:"cyclic",selector:".tox-menubar, .tox-toolbar, .tox-toolbar__primary, .tox-toolbar__overflow--open, .tox-sidebar__overflow--open, .tox-statusbar__path, .tox-statusbar__wordcount, .tox-statusbar__branding a, .tox-statusbar__resize-handle"})])})),r=Z.some(A);a.shortcuts.add("alt+F9","focus menubar",function(){fC.focusMenubar(A)}),a.shortcuts.add("alt+F10","focus toolbar",function(){fC.focusToolbar(A)}),a.addCommand("ToggleToolbarDrawer",function(){fC.toggleToolbarDrawer(A)}),a.addQueryStateHandler("ToggleToolbarDrawer",function(){return fC.isToolbarDrawerToggled(A)});var M,F,I,R,V,P,H,z,L,N,j,W,U,G,X,Y,q=Ev(A),K=Ev(v);M=a,F=q,I=K,R=function(n,e){tt([F,I],function(t){t.broadcastEvent(n,e)})},V=function(n,e){tt([F,I],function(t){t.broadcastOn([n],e)})},S=function(t){return V(ul(),{target:t.target})},P=sv(ne.fromDom(document),"touchstart",S),H=sv(ne.fromDom(document),"touchmove",function(t){return R(Eo(),t)}),z=sv(ne.fromDom(document),"touchend",function(t){return R(Do(),t)}),L=sv(ne.fromDom(document),"mousedown",S),N=sv(ne.fromDom(document),"mouseup",function(t){0===t.raw.button&&V(cl(),{target:t.target})}),j=function(t){return V(ul(),{target:ne.fromDom(t.target)})},W=function(t){0===t.button&&V(cl(),{target:ne.fromDom(t.target)})},U=function(t){return R(Bo(),fv(t))},G=function(t){V(al(),{}),R(Ao(),fv(t))},X=function(){return V(al(),{})},Y=function(t){t.state&&V(ul(),{target:ne.fromDom(M.getContainer())})},M.on("PostRender",function(){M.on("click",j),M.on("tap",j),M.on("mouseup",W),M.on("ScrollWindow",U),M.on("ResizeWindow",G),M.on("ResizeEditor",X),M.on("AfterProgressState",Y)}),M.on("remove",function(){M.off("click",j),M.off("tap",j),M.off("mouseup",W),M.off("ScrollWindow",U),M.off("ResizeWindow",G),M.off("ResizeEditor",X),M.off("AfterProgressState",Y),L.unbind(),P.unbind(),H.unbind(),z.unbind(),N.unbind()}),M.on("detach",function(){Qs(F),Qs(I),F.destroy(),I.destroy()});var J=function(){var t,n=OC(TC(a)),t=OC(EC(t=a).getOr(Qg(t)));return a.inline||(Zi("div","width",t)&&Yi(A.element,"width",t),Zi("div","height",n)?Yi(A.element,"height",n):Yi(A.element,"height","200px")),n};return{mothership:q,uiMothership:K,backstage:w,renderUI:function(){var o,r;s.setup(a,w.shared,p),YC(a,w),gO(a,b,w),r=(o=a).ui.registry.getAll().sidebars,tt(_t(r),function(n){var t=r[n],e=function(){return Pi(Z.from(o.queryCommandValue("ToggleSidebar")),n)};o.ui.registry.addToggleButton(n,{icon:t.icon,tooltip:t.tooltip,onAction:function(t){o.execCommand("ToggleSidebar",!1,n),t.setActive(e())},onSetup:function(t){var n=function(){return t.setActive(e())};return o.on("ToggleSidebar",n),function(){o.off("ToggleSidebar",n)}}})}),lC(a,x,w.shared),Dt(a.getParam("toolbar_groups",{},"object"),function(t,n){a.ui.registry.addGroupToolbarButton(n,t)});var t=a.ui.registry.getAll(),n=t.buttons,e=t.menuItems,i=t.contextToolbars,u=t.sidebars,t=ip(a),n={menuItems:e,menus:function(t){t=t.getParam("menu");return t?Dt(t,function(t){return Q(Q({},t),{items:t.items})}):{}}(a),menubar:a.getParam("menubar"),toolbar:t.getOrThunk(function(){return a.getParam("toolbar",!0)}),allowToolbarGroups:k===Jm.floating,buttons:n,sidebar:u};h1(a,i,v,{backstage:w}),JO(a,v);u=a.getElement(),i=J();return c.render(a,{mothership:q,uiMothership:K,outerContainer:A},n,w,{targetNode:u,height:i})},getUi:function(){return{channels:{broadcastAll:K.broadcast,broadcastOn:K.broadcastOn,register:$}}}}},hu=U([Bn("lazySink"),Hn("dragBlockClass"),Jn("getBounds",Nu),Un("useTabstopAt",S),Un("eventOrder",{}),sr("modalBehaviours",[hd]),ma("onExecute"),pa("onEscape")]),sa={sketch:h},po=U([Il({name:"draghandle",overrides:function(t,n){return{behaviours:ec([XO.config({mode:"mouse",getTarget:function(t){return Yu(t,'[role="dialog"]').getOr(t)},blockerClass:t.dragBlockClass.getOrDie(new Error("The drag blocker class was not specified for a dialog with a drag handle: \n"+JSON.stringify(n,null,2)).message),getBounds:t.getDragBounds})])}}}),Fl({schema:[Bn("dom")],name:"title"}),Fl({factory:sa,schema:[Bn("dom")],name:"close"}),Fl({factory:sa,schema:[Bn("dom")],name:"body"}),Il({factory:sa,schema:[Bn("dom")],name:"footer"}),ge({factory:{sketch:function(t,n){return Q(Q({},t),{dom:n.dom,components:n.components})}},schema:[Un("dom",{tag:"div",styles:{position:"fixed",left:"0px",top:"0px",right:"0px",bottom:"0px"}}),Un("components",[])],name:"blocker"})]),i_=pl({name:"ModalDialog",configFields:hu(),partFields:po(),factory:function(i,t,n,o){var r=Zn(Z.none()),e=Qr("modal-events"),u=Q(Q({},i.eventOrder),((u={})[Mo()]=[e].concat(i.eventOrder["alloy.system.attached"]||[]),u));return{uid:i.uid,dom:i.dom,components:t,apis:{show:function(t){r.set(Z.some(t));var n=i.lazySink(t).getOrDie(),e=o.blocker(),e=n.getSystem().build(Q(Q({},e),{components:e.components.concat([pu(t)]),behaviours:ec([Cd.config({}),Sd("dialog-blocker-events",[or(io(),function(){hd.focusIn(t)})])])}));Gs(n,e),hd.focusIn(t)},hide:function(n){r.set(Z.none()),br(n.element).each(function(t){n.getSystem().getByDom(t).each(function(t){qs(t)})})},getBody:function(t){return Gl(t,i,"body")},getFooter:function(t){return Gl(t,i,"footer")},setIdle:function(t){uC.unblock(t)},setBusy:function(t,n){uC.block(t,n)}},eventOrder:u,domModification:{attributes:{role:"dialog","aria-modal":"true"}},behaviours:yl(i.modalBehaviours,[wd.config({}),hd.config({mode:"cyclic",onEnter:i.onExecute,onEscape:i.onEscape,useTabstopAt:i.useTabstopAt}),uC.config({getRoot:r.get}),Sd(e,[rr(function(t){var n,e,o,r;n=t.element,e=Gl(t,i,"title").element,o=Ur(n,"id").fold(function(){var t=Qr("dialog-label");return jr(e,"id",t),t},h),jr(n,"aria-labelledby",o),o=t.element,r=Gl(t,i,"body").element,t=Z.from(Wr(o,"id")).fold(function(){var t=Qr("dialog-describe");return jr(r,"id",t),t},h),jr(o,"aria-describedby",t)})])])}},apis:{show:function(t,n){t.show(n)},hide:function(t,n){t.hide(n)},getBody:function(t,n){return t.getBody(n)},getFooter:function(t,n){return t.getFooter(n)},setBusy:function(t,n,e){t.setBusy(n,e)},setIdle:function(t,n){t.setIdle(n)}}}),uc=rn([Mn("type"),Mn("name")].concat(Zr)),$n=gn,ca=[Tn("name","name",Wt(function(){return Qr("button-name")}),mn),Nn("icon"),qn("align","end",["start","end"]),Kn("primary",!1),Kn("disabled",!1)],Pe=p(p([],ca),[Mn("text")]),pe=p([Fn("type",["submit","cancel","custom"])],Pe),C=p([Fn("type",["menu"]),Nn("text"),Nn("tooltip"),Nn("icon"),Pn("items",uc)],ca),ma=_n("type",{submit:pe,cancel:pe,custom:pe,menu:C}),pa=[Mn("type"),Mn("text"),Fn("level",["info","warn","error","success"]),Mn("icon"),Un("url","")],u_=rn(pa),sa=[Mn("type"),Mn("text"),Kn("disabled",!1),Kn("primary",!1),Tn("name","name",Wt(function(){return Qr("button-name")}),mn),Nn("icon"),Kn("borderless",!1)],a_=rn(sa),ge=[Mn("type"),Mn("name"),Mn("label"),Kn("disabled",!1)],c_=rn(ge),hu=gn,po=[Mn("type"),Mn("name")],Zr=po.concat([Nn("label")]),uc=Zr.concat([Un("columns","auto")]),s_=rn(uc),ca=sn([Mn("value"),Mn("text"),Mn("icon")]),l_=rn(Zr),pe=mn,f_=rn(Zr),C=mn,d_=po.concat([Yn("tag","textarea"),Mn("scriptId"),Mn("scriptUrl"),(QO=undefined,Gn("settings",QO,vn))]),m_=po.concat([Yn("tag","textarea"),In("init")]),g_=xn(function(t){return Sn("customeditor.old",on(m_),t).orThunk(function(){return Sn("customeditor.new",on(d_),t)})}),pa=mn,p_=rn(Zr),sa=un(Qt),h_=function(t){return[Mn("type"),An("columns",dn),t]},ge=[Mn("type"),Mn("html"),qn("presets","presentation",["presentation","document"])],v_=rn(ge),uc=Zr.concat([Kn("sandboxed",!0)]),b_=rn(uc),po=mn,In=Zr.concat([An("currentState",rn([Bn("blob"),Mn("url")]))]),y_=rn(In),ge=Zr.concat([Nn("inputMode"),Nn("placeholder"),Kn("maximized",!1),Kn("disabled",!1)]),x_=rn(ge),uc=mn,In=[Mn("text"),Mn("value")],ge=[Mn("text"),Pn("items",(ZO=Nt(function(){return w_}),{extract:function(t,n){return ZO().extract(t,n)},toString:function(){return ZO().toString()}}))],w_=an([rn(In),rn(ge)]),an=Zr.concat([Pn("items",w_),Kn("disabled",!1)]),S_=rn(an),In=mn,ge=Zr.concat([Vn("items",[Mn("text"),Mn("value")]),Xn("size",1),Kn("disabled",!1)]),k_=rn(ge),an=mn,Xn=Zr.concat([Kn("constrain",!0),Kn("disabled",!1)]),C_=rn(Xn),ge=rn([Mn("width"),Mn("height")]),Xn=[Mn("type"),Pn("header",mn),Pn("cells",un(mn))],O_=rn(Xn),Kn=Zr.concat([Nn("placeholder"),Kn("maximized",!1),Kn("disabled",!1)]),__=rn(Kn),Kn=mn,qn=Zr.concat([qn("filetype","file",["image","media","file"]),Un("disabled",!1)]),T_=rn(qn),qn=rn([Mn("value"),Un("meta",{})]),E_=function(n){return Tn("items","items",jt(),un(xn(function(t){return Sn("Checking item of "+n,D_,t).fold(function(t){return at.error(On(t))},function(t){return at.value(t)})})))},D_=en(function(){return yn("type",{alertbanner:u_,bar:rn((t=E_("bar"),[Mn("type"),t])),button:a_,checkbox:c_,colorinput:l_,colorpicker:f_,dropzone:p_,grid:rn(h_(E_("grid"))),iframe:b_,input:x_,listbox:S_,selectbox:k_,sizeinput:C_,textarea:__,urlinput:T_,customeditor:g_,htmlpanel:v_,imagetools:y_,collection:s_,label:rn((t=E_("label"),[Mn("type"),Mn("label"),t])),table:O_,panel:B_});var t}),en=[Mn("type"),Un("classes",[]),Pn("items",D_)],B_=rn(en),en=[Tn("name","name",Wt(function(){return Qr("tab-name")}),mn),Mn("title"),Pn("items",D_)],en=[Mn("type"),Vn("tabs",en)],en=rn(en),Pe=Pe,ma=ma,A_=rn([Mn("title"),An("body",yn("type",{panel:B_,tabpanel:en})),Yn("size","normal"),Pn("buttons",ma),Un("initialData",{}),Jn("onAction",$),Jn("onChange",$),Jn("onSubmit",$),Jn("onClose",$),Jn("onCancel",$),Un("onTabChange",$)]),M_=rn(p([Fn("type",["cancel","custom"])],Pe)),F_=rn([Mn("title"),Mn("url"),Ln("height"),Ln("width"),zn("buttons",un(M_)),Jn("onAction",$),Jn("onCancel",$),Jn("onClose",$),Jn("onMessage",$)]),I_=function(t){return b(t)?[t].concat(j(It(t),I_)):c(t)?j(t,I_):[]},R_=function(t){return v(t.type)&&v(t.name)},V_={checkbox:hu,colorinput:pe,colorpicker:C,dropzone:sa,input:uc,iframe:po,sizeinput:ge,selectbox:an,listbox:In,size:ge,textarea:Kn,urlinput:qn,customeditor:pa,collection:ca,togglemenuitem:$n},P_=function(t){t=P(I_(t),R_),t=j(t,function(n){return Z.from(V_[n.type]).fold(function(){return[]},function(t){return[An(n.name,t)]})});return rn(t)},H_=function(t){return{internalDialog:kn(Sn("dialog",A_,t)),dataValidator:P_(t),initialData:t.initialData}},z_={open:function(t,n){n=H_(n);return t(n.internalDialog,n.initialData,n.dataValidator)},openUrl:function(t,n){return t(kn(Sn("dialog",F_,n)))},redial:H_},L_=function(t){var e=[],o={};return Et(t,function(t,n){t.fold(function(){e.push(n)},function(t){o[n]=t})}),0<e.length?at.error(e):at.value(o)},$n=of({name:"TabButton",configFields:[Un("uid",undefined),Bn("value"),Tn("dom","dom",Xt(function(){return{attributes:{role:"tab",id:Qr("aria"),"aria-selected":"false"}}}),ln()),Hn("action"),Un("domModification",{}),sr("tabButtonBehaviours",[Cd,hd,vl]),Bn("view")],factory:function(t,n){return{uid:t.uid,dom:t.dom,components:t.components,events:Rd(t.action),behaviours:yl(t.tabButtonBehaviours,[Cd.config({}),hd.config({mode:"execution",useSpace:!0,useEnter:!0}),vl.config({store:{mode:"memory",initialValue:t.value}})]),domModification:t.domModification}}}),la=U([Bn("tabs"),Bn("dom"),Un("clickToDismiss",!1),sr("tabbarBehaviours",[pf,hd]),la(["tabClass","selectedClass"])]),$n=fn({factory:$n,name:"tabs",unit:"tab",overrides:function(o){var r=function(t,n){pf.dehighlight(t,n),Wo(t,zo(),{tabbar:t,button:n})},i=function(t,n){pf.highlight(t,n),Wo(t,Ho(),{tabbar:t,button:n})};return{action:function(t){var n=t.getSystem().getByUid(o.uid).getOrDie(),e=pf.isHighlighted(n,t);(e&&o.clickToDismiss?r:e?$:i)(n,t)},domModification:{classes:[o.markers.tabClass]}}}}),$n=U([$n]),N_=pl({name:"Tabbar",configFields:la(),partFields:$n(),factory:function(t,n,e,o){return{uid:t.uid,dom:t.dom,components:n,"debug.sketcher":"Tabbar",domModification:{attributes:{role:"tablist"}},behaviours:yl(t.tabbarBehaviours,[pf.config({highlightClass:t.markers.selectedClass,itemClass:t.markers.tabClass,onHighlight:function(t,n){jr(n.element,"aria-selected","true")},onDehighlight:function(t,n){jr(n.element,"aria-selected","false")}}),hd.config({mode:"flow",getInitial:function(t){return pf.getHighlighted(t).map(function(t){return t.element})},selector:"."+t.markers.tabClass,executeOnMove:!0})])}}}),$n=of({name:"Tabview",configFields:[sr("tabviewBehaviours",[wd])],factory:function(t,n){return{uid:t.uid,dom:t.dom,behaviours:yl(t.tabviewBehaviours,[wd.config({})]),domModification:{attributes:{role:"tabpanel"}}}}}),da=U([Un("selectFirst",!0),da("onChangeTab"),da("onDismissTab"),Un("tabs",[]),sr("tabSectionBehaviours",[])]),sr=Fl({factory:N_,schema:[Bn("dom"),Rn("markers",[Bn("tabClass"),Bn("selectedClass")])],name:"tabbar",defaults:function(t){return{tabs:t.tabs}}}),$n=Fl({factory:$n,name:"tabview"}),$n=U([sr,$n]),j_=pl({name:"TabSection",configFields:da(),partFields:$n(),factory:function(r,t,n,e){var o=function(t,n){Ul(t,r,"tabbar").each(function(t){n(t).each(Uo)})};return{uid:r.uid,dom:r.dom,components:t,behaviours:bl(r.tabSectionBehaviours),events:qo(nt([r.selectFirst?[rr(function(t,n){o(t,pf.getFirst)})]:[],[$o(Ho(),function(t,n){var e,o,n=n.event.button;e=n,o=vl.getValue(e),Ul(e,r,"tabview").each(function(n){L(r.tabs,function(t){return t.value===o}).each(function(t){t=t.view();Ur(e.element,"id").each(function(t){jr(n.element,"aria-labelledby",t)}),wd.set(n,t),r.onChangeTab(n,e,t)})})}),$o(zo(),function(t,n){n=n.event.button;r.onDismissTab(t,n)})]])),apis:{getViewItems:function(t){return Ul(t,r,"tabview").map(function(t){return wd.contents(t)}).getOr([])},showTab:function(t,e){o(t,function(n){var t=pf.getCandidates(n);return L(t,function(t){return vl.getValue(t)===e}).filter(function(t){return!pf.isHighlighted(n,t)})})}}}},apis:{getViewItems:function(t,n){return t.getViewItems(n)},showTab:function(t,n,e){t.showTab(n,e)}}}),W_=function(t,n){Yi(t,"height",n+"px"),Ae().browser.isIE()?tu(t,"flex-basis"):Yi(t,"flex-basis",n+"px")},U_=function(t,a,n){Yu(t,'[role="dialog"]').each(function(u){qu(u,'[role="tablist"]').each(function(i){n.get().map(function(t){return Yi(a,"height","0"),Yi(a,"flex-basis","0"),Math.min(t,(e=a,o=i,r=hr(n=u).dom,t=Yu(n,".tox-dialog-wrap").getOr(n),t="fixed"===Ji(t,"position")?Math.max(r.clientHeight,window.innerHeight):Math.max(r.offsetHeight,r.scrollHeight),r=bu(e),e=e.dom.offsetLeft>=o.dom.offsetLeft+_u(o)?Math.max(bu(o),r):r,o=parseInt(Ji(n,"margin-top"),10)||0,r=parseInt(Ji(n,"margin-bottom"),10)||0,t-(bu(n)+o+r-e)));var n,e,o,r}).each(function(t){W_(a,t)})})})},G_=function(t){return qu(t,'[role="tabpanel"]')},X_=function(i){var u;return{smartTabHeight:(u=Zn(Z.none()),{extraEvents:[rr(function(t){var o=t.element;G_(o).each(function(n){var e;Yi(n,"visibility","hidden"),t.getSystem().getByDom(n).toOptional().each(function(t){var e,o,r,t=(o=n,r=t,R(e=i,function(t,n){wd.set(r,e[n].view());n=o.dom.getBoundingClientRect();return wd.set(r,[]),n.height})),t=J(q(t,function(t,n){return n<t?-1:t<n?1:0}));u.set(t)}),U_(o,n,u),tu(n,"visibility"),e=t,J(i).each(function(t){return j_.showTab(e,t.value)}),gm.requestAnimationFrame(function(){U_(o,n,u)})})}),$o(Ao(),function(t){var n=t.element;G_(n).each(function(t){U_(n,t,u)})}),$o(Uv,function(t,n){var r=t.element;G_(r).each(function(n){var t=fc(_r(n));Yi(n,"visibility","hidden");var e=Qi(n,"height").map(function(t){return parseInt(t,10)});tu(n,"height"),tu(n,"flex-basis");var o=n.dom.getBoundingClientRect().height;e.forall(function(t){return t<o})?(u.set(Z.from(o)),U_(r,n,u)):e.each(function(t){W_(n,t)}),tu(n,"visibility"),t.each(sc)})})],selectFirst:!1}),naiveTabHeight:{extraEvents:[],selectFirst:!0}}},Y_="send-data-to-section",q_="send-data-to-view",K_=Qr("update-dialog"),J_=Qr("update-title"),$_=Qr("update-body"),Q_=Qr("update-footer"),Z_=Qr("body-send-message"),tT=function(t,n,s,e){return{dom:{tag:"div",classes:["tox-dialog__content-js"],attributes:Q(Q({},n.map(function(t){return{id:t}}).getOr({})),e?{"aria-live":"polite"}:{})},components:[],behaviours:ec([Yy(0),fk.config({channel:$_,updateState:function(t,n){return Z.some({isTabPanel:function(){return"tabpanel"===n.body.type}})},renderComponents:function(t){return"tabpanel"!==t.body.type?[(e=t.body,o=s,{dom:{tag:"div",classes:["tox-dialog__body"]},components:[{dom:{tag:"div",classes:["tox-dialog__body-content"]},components:[(n=hm(Py.sketch(function(n){return{dom:{tag:"div",classes:["tox-form"].concat(e.classes)},components:R(e.items,function(t){return Iw(n,t,o)})}}))).asSpec()]}],behaviours:ec([hd.config({mode:"acyclic",useTabstopAt:w(dx)}),Xy(n),nx(n,{postprocess:function(t){return L_(t).fold(function(t){return console.error(t),{}},h)}})])})]:[(n=t.body,r=s,i=Zn({}),u=function(t){var n=vl.getValue(t),t=L_(n).getOr({}),n=i.get(),t=zt(n,t);i.set(t)},a=function(t){var n=i.get();vl.setValue(t,n)},c=Zn(null),t=R(n.tabs,function(t){return{value:t.name,dom:{tag:"div",classes:["tox-dialog__body-nav-item"],innerHtml:r.shared.providers.translate(t.title)},view:function(){return[Py.sketch(function(n){return{dom:{tag:"div",classes:["tox-form"]},components:R(t.items,function(t){return Iw(n,t,r)}),formBehaviours:ec([hd.config({mode:"acyclic",useTabstopAt:w(dx)}),Sd("TabView.form.events",[rr(a),ir(u)]),cc.config({channels:Le([{key:Y_,value:{onReceive:u}},{key:q_,value:{onReceive:a}}])})])}})]}}}),n=X_(t).smartTabHeight,j_.sketch({dom:{tag:"div",classes:["tox-dialog__body"]},onChangeTab:function(t,n,e){n=vl.getValue(n);Wo(t,Wv,{name:n,oldName:c.get()}),c.set(n)},tabs:t,components:[j_.parts.tabbar({dom:{tag:"div",classes:["tox-dialog__body-nav"]},components:[N_.parts.tabs({})],markers:{tabClass:"tox-tab",selectedClass:"tox-dialog__body-nav-item--active"},tabbarBehaviours:ec([Bv.config({})])}),j_.parts.tabview({dom:{tag:"div",classes:["tox-dialog__body-content"]}})],selectFirst:n.selectFirst,tabSectionBehaviours:ec([Sd("tabpanel",n.extraEvents),hd.config({mode:"acyclic"}),uf.config({find:function(t){return J(j_.getViewItems(t))}}),vl.config({store:{mode:"manual",getValue:function(t){return t.getSystem().broadcastOn([Y_],{}),i.get()},setValue:function(t,n){i.set(n),t.getSystem().broadcastOn([q_],{})}}})])}))];var e,o,n,r,i,u,a,c},initialData:t})])}},nT=Mp.deviceType.isTouch(),eT=function(t,n){return{dom:{tag:"div",styles:{display:"none"},classes:["tox-dialog__header"]},components:[t,n]}},oT=function(t,n){return i_.parts.close(pm.sketch({dom:{tag:"button",classes:["tox-button","tox-button--icon","tox-button--naked"],attributes:{type:"button","aria-label":n.translate("Close")}},action:t,buttonBehaviours:ec([Bv.config({})])}))},rT=function(){return i_.parts.title({dom:{tag:"div",classes:["tox-dialog__title"],innerHtml:"",styles:{display:"none"}}})},iT=function(t,n){return i_.parts.body({dom:{tag:"div",classes:["tox-dialog__body"]},components:[{dom:{tag:"div",classes:["tox-dialog__body-content"]},components:[{dom:aC("<p>"+n.translate(t)+"</p>")}]}]})},uT=function(t){return i_.parts.footer({dom:{tag:"div",classes:["tox-dialog__footer"]},components:t})},aT=function(t,n){return[Tv.sketch({dom:{tag:"div",classes:["tox-dialog__footer-start"]},components:t}),Tv.sketch({dom:{tag:"div",classes:["tox-dialog__footer-end"]},components:n})]},cT=function(n){var t="tox-dialog",e=t+"-wrap",o=e+"__backdrop",r=t+"__disable-scroll";return i_.sketch({lazySink:n.lazySink,onEscape:function(t){return n.onEscape(t),Z.some(!0)},useTabstopAt:function(t){return!dx(t)},dom:{tag:"div",classes:[t].concat(n.extraClasses),styles:Q({position:"relative"},n.extraStyles)},components:p([n.header,n.body],n.footer.toArray()),parts:{blocker:{dom:aC('<div class="'+e+'"></div>'),components:[{dom:{tag:"div",classes:nT?[o,o+"--opaque"]:[o]}}]}},dragBlockClass:e,modalBehaviours:ec(p([Cd.config({}),Sd("dialog-events",n.dialogEvents.concat([or(io(),function(t,n){hd.focusIn(t)})])),Sd("scroll-lock",[rr(function(){Ai(Wi(),r)}),ir(function(){Fi(Wi(),r)})])],n.extraBehaviours)),eventOrder:Q(((e={})[wo()]=["dialog-events"],e[Mo()]=["scroll-lock","dialog-events","alloy.base.behaviour"],e[Fo()]=["alloy.base.behaviour","dialog-events","scroll-lock"],e),n.eventOrder)})},sT=function(t){return pm.sketch({dom:{tag:"button",classes:["tox-button","tox-button--icon","tox-button--naked"],attributes:{type:"button","aria-label":t.translate("Close"),title:t.translate("Close")}},components:[{dom:{tag:"div",classes:["tox-icon"],innerHtml:bm("close",t.icons)}}],action:function(t){jo(t,Hv)}})},lT=function(t,n,e){var o=function(t){return[fu(e.translate(t.title))]};return{dom:{tag:"div",classes:["tox-dialog__title"],attributes:Q({},n.map(function(t){return{id:t}}).getOr({}))},components:o(t),behaviours:ec([fk.config({channel:J_,renderComponents:o})])}},fT=function(){return{dom:aC('<div class="tox-dialog__draghandle"></div>')}},dT=function(t,n){return e={title:n.shared.providers.translate(t),draggable:n.dialog.isDraggableModal()},o=n.shared.providers,t=i_.parts.title(lT(e,Z.none(),o)),n=i_.parts.draghandle(fT()),o=i_.parts.close(sT(o)),o=[t].concat(e.draggable?[n]:[]).concat([o]),Tv.sketch({dom:aC('<div class="tox-dialog__header"></div>'),components:o});var e,o},mT=function(t,n,e){return{dom:{tag:"div",classes:["tox-dialog__busy-spinner"],attributes:{"aria-label":e.translate(t)},styles:{left:"0px",right:"0px",bottom:"0px",top:"0px",position:"absolute"}},behaviours:n,components:[{dom:aC('<div class="tox-spinner"><div></div><div></div><div></div></div>')}]}},gT=function(t,o,n){return{onClose:function(){return n.closeWindow()},onBlock:function(e){i_.setBusy(t(),function(t,n){return mT(e.message,n,o)})},onUnblock:function(){i_.setIdle(t())}}},pT=function(t,n,e,o){return gu(cT(Q(Q({},t),{lazySink:o.shared.getSink,extraBehaviours:p([fk.config({channel:K_,updateState:function(t,n){return Z.some(n)},initialData:n}),rx({})],t.extraBehaviours),onEscape:function(t){jo(t,Hv)},dialogEvents:e,eventOrder:((e={})[xo()]=[fk.name(),cc.name()],e[Mo()]=["scroll-lock",fk.name(),"messages","dialog-events","alloy.base.behaviour"],e[Fo()]=["alloy.base.behaviour","dialog-events","messages",fk.name(),"scroll-lock"],e)})))},hT=function(t){return R(t,function(t){return"menu"===t.type?(e=R((n=t).items,function(t){var n=Zn(!1);return Q(Q({},t),{storage:n})}),Q(Q({},n),{items:e})):t;var n,e})},vT=function(t){return z(t,function(t,n){return"menu"!==n.type?t:z(n.items,function(t,n){return t[n.name]=n.storage,t},t)},{})},bT=function(t,e){return[nr(io(),fx),t(Pv,function(t,n){e.onClose(),n.onClose()}),t(Hv,function(t,n,e,o){n.onCancel(t),jo(o,Pv)}),$o(jv,function(t,n){return e.onUnblock()}),$o(Nv,function(t,n){return e.onBlock(n.event)})]},yT=function(i,t){var n=function(t,r){return $o(t,function(e,o){u(e,function(t,n){r(i(),t,o.event,e)})})},u=function(n,e){fk.getState(n).get().each(function(t){e(t,n)})};return p(p([],bT(n,t)),[n(zv,function(t,n,e){n.onAction(t,{name:e.name})})])},xT=function(i,t,c){var n=function(t,r){return $o(t,function(e,o){u(e,function(t,n){r(i(),t,o.event,e)})})},u=function(n,e){fk.getState(n).get().each(function(t){e(t.internalDialog,n)})};return p(p([],bT(n,t)),[n(Lv,function(t,n){return n.onSubmit(t)}),n(Vv,function(t,n,e){n.onChange(t,{name:e.name})}),n(zv,function(t,n,e,o){var r=function(){return hd.focusIn(o)},i=function(t){return Gr(t,"disabled")||Ur(t,"aria-disabled").exists(function(t){return"true"===t})},u=_r(o.element),a=fc(u);n.onAction(t,{name:e.name,value:e.value}),fc(u).fold(r,function(n){i(n)||a.exists(function(t){return Ve(n,t)&&i(t)})?r():c().toOptional().filter(function(t){return!Ve(t.element,n)}).each(r)})}),n(Wv,function(t,n,e){n.onTabChange(t,{newTabName:e.name,oldTabName:e.oldName})}),ir(function(t){var n=i();vl.setValue(t,n.getData())})])},wT=function(t,n){var e=n.map(function(t){return t.footerButtons}).getOr([]),n=V(e,function(t){return"start"===t.align}),e=function(t,n){return Tv.sketch({dom:{tag:"div",classes:["tox-dialog__footer-"+t]},components:R(n,function(t){return t.memento.asSpec()})})};return[e("start",n.pass),e("end",n.fail)]},ST=function(t,e){return{dom:aC('<div class="tox-dialog__footer"></div>'),components:[],behaviours:ec([fk.config({channel:Q_,initialData:t,updateState:function(t,n){var r=R(n.buttons,function(t){var n=hm(R0(t,t.type,e));return{name:t.name,align:t.align,memento:n}});return Z.some({lookupByName:function(t,n){return e=t,o=n,L(r,function(t){return t.name===o}).bind(function(t){return t.memento.getOpt(e)});var e,o},footerButtons:r})},renderComponents:wT})])}},kT=ST,CT=function(t,n){return i_.parts.footer(ST(t,n))},OT=function(n,e){if(n.getRoot().getSystem().isConnected()){var o=uf.getCurrent(n.getFormWrapper()).getOr(n.getFormWrapper());return Py.getField(o,e).fold(function(){var t=n.getFooter();return fk.getState(t).get().bind(function(t){return t.lookupByName(o,e)})},function(t){return Z.some(t)})}return Z.none()},_T=function(i,o,u){var t=function(t){var n=i.getRoot();n.getSystem().isConnected()&&t(n)},a={getData:function(){var t=i.getRoot(),n=t.getSystem().isConnected()?i.getFormWrapper():t,t=vl.getValue(n),n=Dt(u,function(t){return t.get()});return Q(Q({},t),n)},setData:function(r){t(function(t){var n=a.getData(),e=Q(Q({},n),r),o=function(t,n){t=t.getRoot();return fk.getState(t).get().map(function(t){return kn(Sn("data",t.dataValidator,n))}).getOr(n)}(i,e),n=i.getFormWrapper();vl.setValue(n,o),Et(u,function(t,n){Vt(e,n)&&t.set(e[n])})})},disable:function(t){OT(i,t).each(Kg.disable)},enable:function(t){OT(i,t).each(Kg.enable)},focus:function(t){OT(i,t).each(Cd.focus)},block:function(n){if(!v(n))throw new Error("The dialogInstanceAPI.block function should be passed a blocking message of type string as an argument");t(function(t){Wo(t,Nv,{message:n})})},unblock:function(){t(function(t){jo(t,jv)})},showTab:function(e){t(function(t){var n=i.getBody();fk.getState(n).get().exists(function(t){return t.isTabPanel()})&&uf.getCurrent(n).each(function(t){j_.showTab(t,e)})})},redial:function(e){t(function(t){var n=o(e);t.getSystem().broadcastOn([K_],n),t.getSystem().broadcastOn([J_],n.internalDialog),t.getSystem().broadcastOn([$_],n.internalDialog),t.getSystem().broadcastOn([Q_],n.internalDialog),a.setData(n.initialData)})},close:function(){t(function(t){jo(t,Pv)})}};return a},TT=function(t,n,e){var o=dT(t.internalDialog.title,e),r=function(t,n){n=tT(t,Z.none(),n,!1);return i_.parts.body(n)}({body:t.internalDialog.body},e),i=hT(t.internalDialog.buttons),u=vT(i),a=CT({buttons:i},e),c=xT(function(){return l},gT(function(){return s},e.shared.providers,n),e.shared.getSink),i=function(t){switch(t){case"large":return["tox-dialog--width-lg"];case"medium":return["tox-dialog--width-md"];default:return[]}}(t.internalDialog.size),i={header:o,body:r,footer:Z.some(a),extraClasses:i,extraBehaviours:[],extraStyles:{}},s=pT(i,t,c,e),e={getRoot:U(s),getBody:function(){return i_.getBody(s)},getFooter:function(){return i_.getFooter(s)},getFormWrapper:function(){var t=i_.getBody(s);return uf.getCurrent(t).getOr(t)}},l=_T(e,n.redial,u);return{dialog:s,instanceApi:l}},ET=function(t,n,o,e){var r,i=Qr("dialog-label"),u=Qr("dialog-content"),r=hm((r={title:t.internalDialog.title,draggable:!0},c=i,s=o.shared.providers,Tv.sketch({dom:aC('<div class="tox-dialog__header"></div>'),components:[lT(r,Z.some(c),s),fT(),sT(s)],containerBehaviours:ec([XO.config({mode:"mouse",blockerClass:"blocker",getTarget:function(t){return Ku(t,'[role="dialog"]').getOrDie()},snaps:{getSnapPoints:function(){return[]},leftAttr:"data-drag-left",topAttr:"data-drag-top"}})])}))),a=hm((c={body:t.internalDialog.body},s=o,e=e,tT(c,Z.some(u),s,e))),c=hT(t.internalDialog.buttons),s=vT(c),l=hm(kT({buttons:c},o)),e=xT(function(){return d},{onBlock:function(e){uC.block(f,function(t,n){return mT(e.message,n,o.shared.providers)})},onUnblock:function(){uC.unblock(f)},onClose:function(){return n.closeWindow()}},o.shared.getSink),f=gu({dom:{tag:"div",classes:["tox-dialog","tox-dialog-inline"],attributes:((c={role:"dialog"})["aria-labelledby"]=i,c["aria-describedby"]=u,c)},eventOrder:((c={})[xo()]=[fk.name(),cc.name()],c[wo()]=["execute-on-form"],c[Mo()]=["reflecting","execute-on-form"],c),behaviours:ec([hd.config({mode:"cyclic",onEscape:function(t){return jo(t,Pv),Z.some(!0)},useTabstopAt:function(t){return!dx(t)&&("button"!==cr(t)||"disabled"!==Wr(t,"disabled"))}}),fk.config({channel:K_,updateState:function(t,n){return Z.some(n)},initialData:t}),Cd.config({}),Sd("execute-on-form",e.concat([or(io(),function(t,n){hd.focusIn(t)})])),uC.config({getRoot:function(){return Z.some(f)}}),wd.config({}),rx({})]),components:[r.asSpec(),a.asSpec(),l.asSpec()]}),d=_T({getRoot:U(f),getFooter:function(){return l.get(f)},getBody:function(){return a.get(f)},getFormWrapper:function(){var t=a.get(f);return uf.getCurrent(t).getOr(t)}},n.redial,s);return{dialog:f,instanceApi:d}},DT=tinymce.util.Tools.resolve("tinymce.util.URI"),BT=["insertContent","setContent","execCommand","close","block","unblock"],AT=function(t){return b(t)&&-1!==BT.indexOf(t.mceAction)},MT=function(e,t,o,n){var r,i,u=dT(e.title,n),a=function(t){t={dom:{tag:"div",classes:["tox-dialog__content-js"]},components:[{dom:{tag:"div",classes:["tox-dialog__body-iframe"]},components:[sx({dom:{tag:"iframe",attributes:{src:t.url}},behaviours:ec([Bv.config({}),Cd.config({})])})]}],behaviours:ec([hd.config({mode:"acyclic",useTabstopAt:w(dx)})])};return i_.parts.body(t)}(e),c=e.buttons.bind(function(t){return 0===t.length?Z.none():Z.some(CT({buttons:t},n))}),s=yT(function(){return h},gT(function(){return p},n.shared.providers,t)),l=Q(Q({},e.height.fold(function(){return{}},function(t){return{height:t+"px","max-height":t+"px"}})),e.width.fold(function(){return{}},function(t){return{width:t+"px","max-width":t+"px"}})),f=e.width.isNone()&&e.height.isNone()?["tox-dialog--width-lg"]:[],d=new DT(e.url,{base_uri:new DT(window.location.href)}),m=d.protocol+"://"+d.host+(d.port?":"+d.port:""),g=Zn(Z.none()),t=[Sd("messages",[rr(function(){var t=sv(ne.fromDom(window),"message",function(t){var n;d.isSameOrigin(new DT(t.raw.origin))&&(n=t.raw.data,AT(n)?function(t,n,e){switch(e.mceAction){case"insertContent":t.insertContent(e.content);break;case"setContent":t.setContent(e.content);break;case"execCommand":var o=!!y(e.ui)&&e.ui;t.execCommand(e.cmd,o,e.value);break;case"close":n.close();break;case"block":n.block(e.message);break;case"unblock":n.unblock()}}(o,h,n):!AT(t=n)&&b(t)&&Vt(t,"mceAction")&&e.onMessage(h,n))});g.set(Z.some(t))}),ir(function(){g.get().each(function(t){return t.unbind()})})]),cc.config({channels:((t={})[Z_]={onReceive:function(t,n){qu(t.element,"iframe").each(function(t){t.dom.contentWindow.postMessage(n,m)})}},t)})],p=pT({header:u,body:a,footer:c,extraClasses:f,extraBehaviours:t,extraStyles:l},e,s,n),h=(i=function(t){r.getSystem().isConnected()&&t(r)},{block:function(n){if(!v(n))throw new Error("The urlDialogInstanceAPI.block function should be passed a blocking message of type string as an argument");i(function(t){Wo(t,Nv,{message:n})})},unblock:function(){i(function(t){jo(t,jv)})},close:function(){i(function(t){jo(t,Pv)})},sendMessage:function(n){i(function(t){t.getSystem().broadcastOn([Z_],n)})}});return{dialog:r=p,instanceApi:h}},FT=function(t){var a,c,s,l,d=t.backstage,m=t.editor,g=pp(m),e=(c=(a=t).backstage.shared,{open:function(t,n){var e=function(){i_.hide(u),n()},o=hm(R0({name:"close-alert",text:"OK",primary:!0,align:"end",disabled:!1,icon:Z.none()},"cancel",a.backstage)),r=rT(),i=oT(e,c.providers),u=gu(cT({lazySink:function(){return c.getSink()},header:eT(r,i),body:iT(t,c.providers),footer:Z.some(uT(aT([],[o.asSpec()]))),onEscape:e,extraClasses:["tox-alert-dialog"],extraBehaviours:[],extraStyles:{},dialogEvents:[$o(Hv,e)],eventOrder:{}}));i_.show(u);o=o.get(u);Cd.focus(o)}}),o=(l=(s=t).backstage.shared,{open:function(t,n){var e=function(t){i_.hide(a),n(t)},o=hm(R0({name:"yes",text:"Yes",primary:!0,align:"end",disabled:!1,icon:Z.none()},"submit",s.backstage)),r=R0({name:"no",text:"No",primary:!1,align:"end",disabled:!1,icon:Z.none()},"cancel",s.backstage),i=rT(),u=oT(function(){return e(!1)},l.providers),a=gu(cT({lazySink:function(){return l.getSink()},header:eT(i,u),body:iT(t,l.providers),footer:Z.some(uT(aT([],[r,o.asSpec()]))),onEscape:function(){return e(!1)},extraClasses:["tox-confirm-dialog"],extraBehaviours:[],extraStyles:{},dialogEvents:[$o(Hv,function(){return e(!1)}),$o(Lv,function(){return e(!0)})],eventOrder:{}}));i_.show(a);o=o.get(a);Cd.focus(o)}}),r=function(t,e){return z_.openUrl(function(t){var n=MT(t,{closeWindow:function(){i_.hide(n.dialog),e(n.instanceApi)}},m,d);return i_.show(n.dialog),n.instanceApi},t)},i=function(t,r){return z_.open(function(t,n,e){var n=n,o=TT({dataValidator:e,initialData:n,internalDialog:t},{redial:z_.redial,closeWindow:function(){i_.hide(o.dialog),r(o.instanceApi)}},d);return i_.show(o.dialog),o.instanceApi.setData(n),o.instanceApi},t)},u=function(t,s,l,f){return z_.open(function(t,n,e){var o,r,i=kn(Sn("data",e,n)),u=(o=Zn(Z.none()),{clear:function(){return o.set(Z.none())},set:function(t){return o.set(Z.some(t))},isSet:function(){return o.get().isSome()},on:function(t){return o.get().each(t)}}),n=d.shared.header.isPositionedAtTop(),a=function(){return u.on(function(t){Zd.reposition(t),P1.refresh(t)})},c=ET({dataValidator:e,initialData:i,internalDialog:t},{redial:z_.redial,closeWindow:function(){u.on(Zd.hide),m.off("ResizeEditor",a),u.clear(),l(c.instanceApi)}},d,f),t=gu(Zd.sketch(Q(Q({lazySink:d.shared.getSink,dom:{tag:"div",classes:[]},fireDismissalEventInstead:{}},n?{}:{fireRepositionEventInstead:{}}),{inlineBehaviours:ec(p([Sd("window-manager-inline-events",[$o(Io(),function(t,n){jo(c.dialog,Hv)})])],(r=m,t=n,g&&t?[]:[P1.config({contextual:{lazyContext:function(){return Z.some(zu(ne.fromDom(r.getContentAreaContainer())))},fadeInClass:"tox-dialog-dock-fadein",fadeOutClass:"tox-dialog-dock-fadeout",transitionClass:"tox-dialog-dock-transition"},modes:["top"]})]))),isExtraPart:function(t,n){return dv(n=n,".tox-alert-dialog")||dv(n,".tox-confirm-dialog")}})));return u.set(t),Zd.showWithin(t,s,pu(c.dialog),Z.some(Wi())),g&&n||(P1.refresh(t),m.on("ResizeEditor",a)),c.instanceApi.setData(i),hd.focusIn(c.dialog),c.instanceApi},t)};return{open:function(t,n,e){return n!==undefined&&"toolbar"===n.inline?u(t,d.shared.anchors.inlineDialog(),e,n.ariaAttrs):n!==undefined&&"cursor"===n.inline?u(t,d.shared.anchors.cursor(),e,n.ariaAttrs):i(t,e)},openUrl:function(t,n){return r(t,n)},alert:function(t,n){e.open(t,function(){n()})},close:function(t){t.close()},confirm:function(t,n){o.open(t,function(t){n(t)})}}};m.add("silver",function(t){var n=r_(t),e=n.uiMothership,o=n.backstage,r=n.renderUI,n=n.getUi;av(t,o.shared);t=FT({editor:t,backstage:o});return{renderUI:r,getWindowManagerImpl:U(t),getNotificationManagerImpl:function(){return wm(0,{backstage:o},e)},ui:n()}})}();